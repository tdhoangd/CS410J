var D2LMicrosoftAjax=D2LMicrosoftAjax||{};
D2LMicrosoftAjax.Hijri={ticks1970:621355968E5,monthDays:[0,30,59,89,118,148,177,207,236,266,295,325,355],minDate:-425216736E5,maxDate:253402300799999,adjustment:0,toGregorian:function(hyear,hmonth,hday){var daysSinceJan0101=this.daysToYear(hyear)+this.monthDays[hmonth]+hday-1-this.adjustment;var gdate=new Date(daysSinceJan0101*864E5-this.ticks1970);gdate.setMinutes(gdate.getMinutes()+gdate.getTimezoneOffset());return gdate},fromGregorian:function(gdate){if(gdate<this.minDate||gdate>this.maxDate)return null;
var ticks=this.ticks1970+(gdate-0)-gdate.getTimezoneOffset()*6E4,daysSinceJan0101=Math.floor(ticks/864E5)+1+this.adjustment;var hday,hmonth,hyear=Math.floor((daysSinceJan0101-227013)*30/10631)+1,absDays=this.daysToYear(hyear),daysInYear=this.isLeapYear(hyear)?355:354;if(daysSinceJan0101<absDays){hyear--;absDays-=daysInYear}else if(daysSinceJan0101===absDays){hyear--;absDays=this.daysToYear(hyear)}else if(daysSinceJan0101>absDays+daysInYear){absDays+=daysInYear;hyear++}hmonth=0;var daysIntoYear=daysSinceJan0101-
absDays;while(hmonth<=11&&daysIntoYear>this.monthDays[hmonth])hmonth++;hmonth--;hday=daysIntoYear-this.monthDays[hmonth];return[hyear,hmonth,hday]},daysToYear:function(year){var yearsToYear30=Math.floor((year-1)/30)*30,yearsInto30=year-yearsToYear30-1,days=Math.floor(yearsToYear30*10631/30)+227013;while(yearsInto30>0){days+=this.isLeapYear(yearsInto30)?355:354;yearsInto30--}return days},isLeapYear:function(year){return(year*11+14)%30<11}};var D2LMicrosoftAjax=D2LMicrosoftAjax||{};
D2LMicrosoftAjax.UmAlQura={_yearInfo:[[746,-21987072E5],[1769,-21681216E5],[3794,-21374496E5],[3748,-21067776E5],[3402,-2076192E6],[2710,-20456064E5],[1334,-20150208E5],[2741,-19844352E5],[3498,-19537632E5],[2980,-19230912E5],[2889,-18925056E5],[2707,-186192E7],[1323,-18313344E5],[2647,-18007488E5],[1206,-17700768E5],[2741,-17394912E5],[1450,-17088192E5],[3413,-16782336E5],[3370,-16475616E5],[2646,-1616976E6],[1198,-15863904E5],[2397,-15558048E5],[748,-15251328E5],[1749,-14945472E5],[1706,-14638752E5],
[1365,-14332896E5],[1195,-1402704E6],[2395,-13721184E5],[698,-13414464E5],[1397,-13108608E5],[2994,-12801888E5],[1892,-12495168E5],[1865,-12189312E5],[1621,-11883456E5],[683,-115776E7],[1371,-11271744E5],[2778,-10965024E5],[1748,-10658304E5],[3785,-10352448E5],[3474,-10045728E5],[3365,-9739872E5],[2637,-9434016E5],[685,-912816E6],[1389,-8822304E5],[2922,-8515584E5],[2898,-8208864E5],[2725,-7903008E5],[2635,-7597152E5],[1175,-7291296E5],[2359,-698544E6],[694,-667872E6],[1397,-6372864E5],[3434,-6066144E5],
[3410,-5759424E5],[2710,-5453568E5],[2349,-5147712E5],[605,-4841856E5],[1245,-4536E8],[2778,-422928E6],[1492,-392256E6],[3497,-3616704E5],[3410,-3309984E5],[2730,-3004128E5],[1238,-2698272E5],[2486,-2392416E5],[884,-2085696E5],[1897,-177984E6],[1874,-147312E6],[1701,-1167264E5],[1355,-861408E5],[2731,-555552E5],[1370,-248832E5],[2773,57024E5],[3538,363744E5],[3492,670464E5],[3401,97632E6],[2709,1282176E5],[1325,1588032E5],[2653,1893888E5],[1370,2200608E5],[2773,2506464E5],[1706,2813184E5],[1685,311904E6],
[1323,3424896E5],[2647,3730752E5],[1198,4037472E5],[2422,4343328E5],[1388,4650048E5],[2901,4955904E5],[2730,5262624E5],[2645,556848E6],[1197,5874336E5],[2397,6180192E5],[730,6486912E5],[1497,6792768E5],[3506,7099488E5],[2980,7406208E5],[2890,7712064E5],[2645,801792E6],[693,8323776E5],[1397,8629632E5],[2922,8936352E5],[3026,9243072E5],[3012,9549792E5],[2953,9855648E5],[2709,10161504E5],[1325,1046736E6],[1453,10773216E5],[2922,11079936E5],[1748,11386656E5],[3529,11692512E5],[3474,11999232E5],[2726,
12305088E5],[2390,12610944E5],[686,129168E7],[1389,13222656E5],[874,13529376E5],[2901,13835232E5],[2730,14141952E5],[2381,14447808E5],[1181,14753664E5],[2397,1505952E6],[698,1536624E6],[1461,15672096E5],[1450,15978816E5],[3413,16284672E5],[2714,16591392E5],[2350,16897248E5],[622,17203104E5],[1373,1750896E6],[2778,1781568E6],[1748,181224E7],[1701,18428256E5],[0,18734112E5]],minDate:-21987072E5,maxDate:1873411199999,toGregorian:function(hyear,hmonth,hday){var days=hday-1,gyear=hyear-1318;if(gyear<0||
gyear>=this._yearInfo.length)return null;var info=this._yearInfo[gyear],gdate=new Date(info[1]),monthLength=info[0];gdate.setMinutes(gdate.getMinutes()+gdate.getTimezoneOffset());for(var i=0;i<hmonth;i++){days+=29+(monthLength&1);monthLength=monthLength>>1}gdate.setDate(gdate.getDate()+days);return gdate},fromGregorian:function(gdate){var ticks=gdate-gdate.getTimezoneOffset()*6E4;if(ticks<this.minDate||ticks>this.maxDate)return null;var hyear=0,hmonth=1;while(ticks>this._yearInfo[++hyear][1]);if(ticks!==
this._yearInfo[hyear][1])hyear--;var info=this._yearInfo[hyear],days=Math.floor((ticks-info[1])/864E5),monthLength=info[0];hyear+=1318;var daysInMonth=29+(monthLength&1);while(days>=daysInMonth){days-=daysInMonth;monthLength=monthLength>>1;daysInMonth=29+(monthLength&1);hmonth++}return[hyear,hmonth-1,days+1]}};var D2L=D2L||{LP:{Web:{UI:{Html:{}}},Globalization:{Formatting:{Domain:{Default:{}}}},LayeredArch:{}},LE:{},PT:{},LOR:{},EP:{},IM:{},WCS:{}};
D2L.LP.Web.UI.Desktop={CompositeViews:{},Controls:{},MasterPages:{}};
D2L.LP.Web.UI.ObjectRepository={Get:function(key,subKey){var obj=D2L.LP.Web.UI.ObjectRepository.TryGet(key,subKey);if(obj===null)throw"'"+key+"'["+subKey+"] not found in object repository.";return obj},GetDictionary:function(key){if(D2L.OR[key]===undefined)return null;var resultDic={};for(var subKey in D2L.OR[key])resultDic[subKey]=D2L.LP.Web.Serialization.Json.Deserialize(D2L.OR[key][subKey]);return resultDic},HasKey:function(key){return D2L.OR[key]!==undefined},HasKeys:function(key,subKey){return D2L.OR[key]!==
undefined&&D2L.OR[key][subKey]!==undefined},Remove:function(key,subKey){if(D2L.OR[key]===undefined)return;if(subKey===undefined)delete D2L.OR[key];else if(D2L.OR[key][subKey]!==undefined)delete D2L.OR[key][subKey]},RpcReceivePayloadProvider:function(data){if(data===undefined||data===null)return;for(var key in data)D2L.OR[key]=data[key]},TryClone:function(key,subKey,newKey,newSubKey){if(key===undefined||subKey===undefined||newKey===undefined||newSubKey===undefined)return false;if(D2L.OR[key]===undefined)return false;
if(D2L.OR[newKey]===undefined)D2L.OR[newKey]={};D2L.OR[newKey][newSubKey]=D2L.OR[key][subKey];return true},TryGet:function(key,subKey){if(subKey===undefined)subKey="0";if(D2L.OR[key]===undefined||D2L.OR[key][subKey]===undefined)return null;return D2L.LP.Web.Serialization.Json.Deserialize(D2L.OR[key][subKey])}};D2L.O=function(key,subKey){return D2L.LP.Web.UI.ObjectRepository.Get(key,subKey)};D2L.OR={};D2L.Class=function(){};D2L.Class.prototype.Construct=function(){};D2L.Class.prototype.Dispose=function(){};
D2L.Class.prototype.AttachObject=function(obj,attrName,val){if(obj!==undefined&&obj!==null)obj[attrName]=val};D2L.Class.Create=function(def){var classDef=function(){if(arguments[0]!==D2L.Class)this.Construct.apply(this,arguments)};var proto=new this(D2L.Class);for(var n in def){var item=def[n];proto[n]=item}classDef.prototype=proto;return classDef};
D2L.Class.Extend=function(def){var classDef=function(){if(arguments[0]!==D2L.Class)this.Construct.apply(this,arguments)};var proto=new this(D2L.Class);var superClass=this.prototype;for(var n in def){var item=def[n];if(item instanceof Function)item.$=superClass;proto[n]=item}classDef.prototype=proto;classDef.extend=this.extend;classDef.Extend=this.extend;return classDef};D2L.Class.extend=D2L.Class.Extend;
D2L.GarbageCollection={m_objects:[],Register:function(obj){this.m_objects.push(obj)},Dispose:function(){var length=this.m_objects.length;for(var i=0;i<length;i++)if(this.m_objects[i].Dispose)this.m_objects[i].Dispose()}};D2L.Class.prototype.Construct=function(doRegisterForDisposal){if(doRegisterForDisposal===undefined)doRegisterForDisposal=false;if(doRegisterForDisposal&&D2L.GarbageCollection!==undefined)D2L.GarbageCollection.Register(this)};D2L.LP.Web.UI.Events=D2L.LP.Web.UI.Events||{};
D2L.LP.Web.UI.Events.AggregateEvents=function(events,callback){var evt=new D2L.LP.Web.UI.Events.Event;var numTriggered=0;var handleTrigger=function(){numTriggered++;if(numTriggered>=events.length){if(callback!==undefined)callback();evt.Trigger()}};for(var i=0;i<events.length;i++){var e=events[i];if(e===undefined||e===null||e.HasTriggered===undefined||e.HasTriggered())handleTrigger();else e.AddListener(handleTrigger)}if(events.length===0)setTimeout(handleTrigger,0);return evt};
D2L.LP.Web.UI.Events.Event=D2L.Class.Create({Construct:function(argumentDelegate){this.m_callbacks=[];this.m_argumentDelegate=argumentDelegate;this.m_hasTriggered=false;this.m_releaseCallbacks=[]},AddListener:function(callback){this.m_callbacks.push(callback)},AddReleaseListener:function(callback){this.m_releaseCallbacks.push(callback)},HasTriggered:function(){return this.m_hasTriggered},RemoveListener:function(callback){for(var i=0;i<this.m_callbacks.length;i++)if(this.m_callbacks[i]===callback)this.m_callbacks.splice(i,
1)},Release:function(){for(var i=0;i<this.m_releaseCallbacks.length;i++)this.m_releaseCallbacks[i].apply(this.m_releaseCallbacks[i])},Trigger:function(){this.m_hasTriggered=true;var args=arguments;if(typeof this.m_argumentDelegate!=="undefined")args=this.m_argumentDelegate();for(var i=0;i<this.m_callbacks.length;i++){var result=this.m_callbacks[i].apply(this.m_callbacks[i],args);if(typeof result!=="undefined"&&result===false)return}}});D2L.LP.Web.UI.Events.OnLoad=D2L.LP.Web.UI.Events.OnLoad||new D2L.LP.Web.UI.Events.Event;
D2L.LocalTime=D2L.Class.Create({Construct:function(hour,minute,second){var now=new Date;this.m_hour=hour!==undefined?hour:now.getHours();this.m_minute=minute!==undefined?minute:now.getMinutes();this.m_second=second!==undefined?second:now.getSeconds()},_deserialize:function(deserializer){this.m_hour=deserializer.GetMember("Hour");this.m_minute=deserializer.GetMember("Minute");this.m_second=deserializer.GetMember("Second")},_serialize:function(serializer){serializer.AddMember("Hour",this.m_hour);serializer.AddMember("Minute",
this.m_minute);serializer.AddMember("Second",this.m_second)},GetHour:function(){return this.m_hour},GetMinute:function(){return this.m_minute},GetSecond:function(){return this.m_second}});
D2L.LocalDateTime=D2L.Class.Create({Construct:function(year,month,day,hour,minute,second){var now=new Date;this.m_year=year!==undefined?year:now.getFullYear();this.m_month=month!==undefined?month:now.getMonth+1;this.m_day=day!==undefined?day:now.getDate();this.m_hour=hour!==undefined?hour:now.getHours();this.m_minute=minute!==undefined?minute:now.getMinutes();this.m_second=second!==undefined?second:now.getSeconds()},_deserialize:function(deserializer){this.m_year=deserializer.GetMember("Year");this.m_month=
deserializer.GetMember("Month");this.m_day=deserializer.GetMember("Day");this.m_hour=deserializer.GetMember("Hour");this.m_minute=deserializer.GetMember("Minute");this.m_second=deserializer.GetMember("Second")},_serialize:function(serializer){serializer.AddMember("Year",this.m_year);serializer.AddMember("Month",this.m_month);serializer.AddMember("Day",this.m_day);serializer.AddMember("Hour",this.m_hour);serializer.AddMember("Minute",this.m_minute);serializer.AddMember("Second",this.m_second)},GetYear:function(){return this.m_year},
GetMonth:function(){return this.m_month},GetDay:function(){return this.m_day},GetHour:function(){return this.m_hour},GetMinute:function(){return this.m_minute},GetSecond:function(){return this.m_second},GetDateString:function(){var ret;ret=this.GetYear();ret+=this.PadInt(this.GetMonth(),2);ret+=this.PadInt(this.GetDay(),2);ret+=this.PadInt(this.GetHour(),2);ret+=this.PadInt(this.GetMinute(),2);return ret},GetTimestamp:function(){var date=new Date(this.GetYear(),this.GetMonth()-1,this.GetDay(),this.GetHour(),
this.GetMinute(),this.GetSecond(),0);return date.getTime()},PadInt:function(val,digits){var ret=val.toString();while(ret.length<digits)ret="0"+ret;return ret}});D2L.LocalDateTime.ToJavaScriptDate=function(localDateTime){return new Date(localDateTime.GetYear(),localDateTime.GetMonth()-1,localDateTime.GetDay(),localDateTime.GetHour(),localDateTime.GetMinute(),localDateTime.GetSecond(),0)};
D2L.LocalDateTime.FromJavaScriptDate=function(jsDate){return new D2L.LocalDateTime(jsDate.getFullYear(),jsDate.getMonth()+1,jsDate.getDate(),jsDate.getHours(),jsDate.getMinutes(),jsDate.getSeconds())};
D2L.LocalDateTime.Compare=function(first,second,ignoreTime){if(ignoreTime){first=new D2L.LocalDateTime(first.GetYear(),first.GetMonth(),first.GetDay());second=new D2L.LocalDateTime(second.GetYear(),second.GetMonth(),second.GetDay())}var firstJsDate=D2L.LocalDateTime.ToJavaScriptDate(first);var secondJsDate=D2L.LocalDateTime.ToJavaScriptDate(second);if(firstJsDate<secondJsDate)return-1;else if(firstJsDate>secondJsDate)return 1;else return 0};D2L.LP.Web.Serialization={Json:{},Url:{}};
D2L.LP.Web.Serialization.Serializer=D2L.Class.Extend({Construct:function(){this.m_scopeString="";this.m_values=[]},AddMember:function(name,value){var type=typeof value;if(type==="undefined"||type==="function")return;if(type==="number"||type==="boolean"||type==="string"||value===null)this.m_values.push([this.m_scopeString+name,value]);else if(D2L.LP.Web.UI.Html.JavaScript.IsArray(value)){var isObjArray=value.length>0&&typeof value[0]==="object";for(var i=0;i<value.length;i++)if(isObjArray&&i>0)this.AddMember(name+
"`"+i,value[i]);else this.AddMember(name,value[i])}else if(type==="object"){this.m_scopeString+=name+"$";if(value._serialize!==undefined)value._serialize(this);else for(var key in value)this.AddMember(key,value[key]);this.m_scopeString=this.m_scopeString.substr(0,this.m_scopeString.length-(name.length+1))}},GetMembers:function(){return this.m_values}});
D2L.LP.Web.Serialization.Json.Deserialize=function(jsonString){if(jsonString===undefined||jsonString===null||typeof jsonString!=="string")return undefined;var typeReviver=function(value){var type=D2L.LP.Web.Serialization.Json.GetType(this,value._type);if(type!==undefined&&type.func!==undefined){var obj=new type.func;if(obj._deserialize!==undefined){obj._deserialize(new D2L.LP.Web.Serialization.Json.Deserializer(value));value=obj}}return value};var functionReviver=function(value){return D2L.LP.Web.Serialization.Json.FunctionReviver(this,
value)};var dictionaryReviver=function(value){return D2L.LP.Web.Serialization.Json.DictionaryReviver(this,value)};var normalizeType=function(t){if(t=="url")return"D2L.LP.Web.Http.UrlLocation";else if(t=="id")return"D2L.LP.Web.UI.Html.AbsoluteHtmlId";return t};var json=JSON.parse(jsonString,function(key,value){if(value===undefined||value===null||value._type===undefined)return value;var ret;value._type=normalizeType(value._type);if(value._type=="D2L.LP.Util.Dictionary")ret=dictionaryReviver(value);
else if(value._type=="call"){ret=functionReviver(value);ret._isCall=true}else if(value._type=="func")ret=functionReviver(value);else if(value._type=="pipe"){value.N="D2L.LP.Web.UI.Html.JavaScript.CallFunctionPipeline";value.D=true;ret=functionReviver(value)}else ret=typeReviver(value);return ret});return json};
D2L.LP.Web.Serialization.Json.Deserializer=D2L.Class.Create({Construct:function(json){this.m_json=json},GetMember:function(name,defaultValue){return this.HasMember(name)?this.m_json[name]:defaultValue},HasMember:function(name){return this.m_json[name]!==undefined}});
D2L.LP.Web.Serialization.Json.GetType=function(type,typeString){var typeSegments=typeString.replace(/\+/g,".").split(".");var prevType=type;for(var i=0;i<typeSegments.length;i++){if(type[typeSegments[i]]===undefined)return undefined;prevType=type;type=type[typeSegments[i]]}if(i!=typeSegments.length)return undefined;return{obj:prevType,func:type}};
D2L.LP.Web.Serialization.Json.FunctionReviver=function(win,value){var type=D2L.LP.Web.Serialization.Json.GetType(win,value.N);if(type===undefined)throw"Unrecognized function '"+value.N+"'.";if(value.P===undefined)value.P=[];var isParamDelayed=false;for(var i=0;i<value.P.length;i++){var p=value.P[i];if(p!==undefined&&p!==null&&p._isDelayed===true){isParamDelayed=true;break}}var fixParam=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam;var retFunc=function(){var evt=new D2L.LP.Web.UI.Events.Event;
evt._isDelayed=true;var isDelayed=value.D===true;var params=[];var args=arguments;var callFunction=function(){for(var i=0;i<args.length;i++)params.push(args[i]);if(type.func.apply===undefined){evt.Release();throw"'"+value.N+"' is not a function.";}return type.func.apply(type.obj,params)};if(!isDelayed&&!isParamDelayed){for(var i=0;i<value.P.length;i++)params.push(fixParam(value.P[i]));return callFunction()}var finish=function(){if(isDelayed){var result=callFunction();result.AddListener(function(val){evt.Trigger(val)});
result.AddReleaseListener(function(){evt.Release()})}else evt.Trigger(callFunction())};var buildParam=function(index){if(index==value.P.length){finish();return}var p=value.P[index];if(p===undefined||p===null||p._isDelayed===undefined||p._isDelayed===false){params.push(fixParam(p));buildParam(++index);return}if(p._isCall===true)p=p();p.AddListener(function(val){params.push(fixParam(val));buildParam(++index)});p.AddReleaseListener(function(){evt.Release()})};setTimeout(function(){buildParam(0)},0);
return evt};if(value._type=="call")retFunc._isDelayed=value.D===true||isParamDelayed;return retFunc};D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam=function(p){if(p===undefined||p===null)return p;if(typeof p=="object"){var origP=p;p=new p.constructor;for(var key in origP)p[key]=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam(origP[key])}if(p._isCall)p=p();return p};
D2L.LP.Web.Serialization.Json.DictionaryReviver=function(win,dict){delete dict["_type"];var isDelayed=false;var dictKeys=[];var newDict={};for(var key in dict){var val=dict[key];dictKeys.push(key);if(val!==undefined&&val!==null&&val._isDelayed===true)isDelayed=true}if(!isDelayed)return dict;var fixParam=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam;var evt=new D2L.LP.Web.UI.Events.Event;evt._isDelayed=true;var buildParam=function(index){if(index==dictKeys.length){evt.Trigger(newDict);return}var p=
dict[dictKeys[index]];if(p===undefined||p===null||p._isDelayed===undefined||p._isDelayed===false){newDict[dictKeys[index]]=fixParam(p);buildParam(++index);return}if(p._isCall===true)p=p();p.AddListener(function(v){newDict[dictKeys[index]]=fixParam(v);buildParam(++index)});p.AddReleaseListener(function(){evt.Release()})};setTimeout(function(){buildParam(0)},0);return evt};if(!this.JSON)this.JSON={};
(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,
k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function")value=value.toJSON(key);if(typeof rep==="function")value=rep.call(holder,key,value);switch(typeof value){case "string":return quote(value);case "number":return isFinite(value)?String(value):"null";case "boolean":case "null":return String(value);case "object":if(!value)return"null";gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;
for(i=0;i<length;i+=1)partial[i]=str(i,value)||"null";v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}}}else for(k in value)if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}v=partial.length===0?"{}":gap?"{\n"+gap+
partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function")JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number")for(i=0;i<space;i+=1)indent+=" ";else if(typeof space==="string")indent=space;rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number"))throw new Error("JSON.stringify");return str("",{"":value})};if(typeof JSON.parse!=="function")JSON.parse=
function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object")for(k in value)if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined)value[k]=v;else delete value[k]}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse");}})();D2L.LP.Web.Serialization.Url.Serialize=function(value){if(value===undefined||value===null)return"";if(typeof value!=="object")return value.toString();var serializer=new D2L.LP.Web.Serialization.Url.Serializer;for(var key in value)serializer.AddMember(key,value[key]);return serializer.Serialize()};
D2L.LP.Web.Serialization.Url.Serializer=D2L.LP.Web.Serialization.Serializer.Extend({Construct:function(){arguments.callee.$.Construct.call(this)},Serialize:function(){var ret="";var delim="";var values=this.GetMembers();for(var i=0;i<values.length;i++){var kvp=values[i];ret+=delim+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(kvp[0])+"="+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(kvp[1]);delim="&"}return ret}});D2L.LP.Web.Http={};D2L.LP.Web.Http.ILocation=function(){};
D2L.LP.Web.Http.ILocation.prototype.GetUrl=function(){};
D2L.LP.Web.Http.UrlLocation=D2L.Class.Create({Construct:function(url){if(url===undefined||url===null)url="";this.m_url=url},_deserialize:function(deserializer){this.m_url=deserializer.GetMember("Url")},_serialize:function(serializer){serializer.AddMember("Url",this.m_url)},GetUrl:function(){return this.m_url},WithQueryString:function(param,value){var url=this.m_url;var delim=url.indexOf("?",0)==-1?"?":"&";var serializer=new D2L.LP.Web.Serialization.Url.Serializer;serializer.AddMember(param,value);
var serializedValue=serializer.Serialize();url+=delim+serializedValue;return new D2L.LP.Web.Http.UrlLocation(url)},HasQueryString:function(param){param=param.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+param+"=([^&#]*)");return regex.test(this.m_url)},RemoveQueryString:function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("([\\?&])"+name+"=([^&#]*)");if(!regex.test(this.m_url))return;var pos=0;var url=this.m_url.replace(regex,function(match,
p1,p2,offset){pos=offset;return p1});if(url.length>pos&&url[pos+1]=="&")url=url.substr(0,pos+1)+url.substr(pos+2);else url=url.substr(0,url.length-1);this.m_url=url}});D2L.LP.Web.Http.UrlLocation.Create=function(url,query){var urlLocation=new D2L.LP.Web.Http.UrlLocation(url);for(var key in query)urlLocation=urlLocation.WithQueryString(key,query[key]);return urlLocation};
D2L.LP.Web.Mvc={RouteLocation:{Create:function(pattern,query,route){for(var key in route)pattern=pattern.replace(new RegExp("{"+key+"}","gi"),D2L.LP.Web.UI.Html.JavaScript.UrlEncode(route[key]));var url=new D2L.LP.Web.Http.UrlLocation(pattern);for(var key in query)url=url.WithQueryString(key,query[key]);return url}}};
D2L.LP.Web.UI.FlashMessages={RpcReceivePayloadProvider:function(data){var win=window;while(win!=win.parent&&win.D2L!==undefined&&win.D2L.LP!==undefined&&win.D2L.LP.Web!==undefined&&win.D2L.LP.Web.UI!==undefined&&win.D2L.LP.Web.UI.FlashMessages!==undefined)win=win.parent;var $data=$(data);win.document.body.appendChild($data.get(0));win.D2L.LP.Web.UI.Events.OnViewRender.Trigger($data.get(0))}};D2L.LP.Web.UI.Rpc={ReceivePayloadProviders:{},SendPayloadProviders:{}};
D2L.LP.Web.UI.Rpc.Initialize=function(loginUrl,message,sendPayloadProviders,receivePayloadProviders){if(sendPayloadProviders!==undefined)D2L.LP.Web.UI.Rpc.SendPayloadProviders=sendPayloadProviders;if(receivePayloadProviders!==undefined)D2L.LP.Web.UI.Rpc.ReceivePayloadProviders=receivePayloadProviders;D2L.LP.Web.UI.Rpc.OnFailure.AddListener(function(args){var reason=args.reason;var keepAlive=args.keepAlive;if(reason===D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated){if(keepAlive!==undefined&&keepAlive)location.href=
loginUrl.GetUrl()}else alert(message)})};
D2L.LP.Web.UI.Rpc.Connect=function(verb,loc,params,options){var ret=new D2L.LP.Web.UI.Events.Event;if(verb===undefined||verb===null||verb!="GET"&&verb!="POST")throw"Invalid RPC verb: '"+verb+"'.";if(loc===undefined||loc===null)throw"Invalid RPC location: '"+loc+"'.";if(options===undefined||options===null)options={};if(params===undefined||params===null)params={};for(var key in params)if(params[key]===null)delete params[key];loc=loc.GetUrl();var complete=false;var timedOut=false;var isSynchronous=options.isSynchronous||
false;var fail=function(showErrorMsg){ret.Trigger(false);if(showErrorMsg===undefined)showErrorMsg=true;var errorMsg=function(){D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.Unknown})};if(options.failure!==undefined){var result=options.failure.call(options.failure);var isDelayedReturn=typeof result!=="undefined"?result.Trigger!==undefined:false;var delayedReturnListener=function(returnVal){this.Trigger(returnVal);if(returnVal!==true)errorMsg()};if(result===true)showErrorMsg=
false;else if(isDelayedReturn){showErrorMsg=false;result.AddListener(delayedReturnListener)}}if(showErrorMsg)errorMsg()};var xhr=new XMLHttpRequest;var handleXhrResult=function(xhrResult){if(timedOut||xhrResult.readyState!=4)return;complete=true;if(xhrResult.status==200){var response=xhrResult.responseText.trim();var events=[];if(response.length>0){var payload;try{payload=D2L.LP.Web.Serialization.Json.Deserialize(response.substr(9))}catch(e){throw"Unable to parse JSON response: "+response;}if(payload.Redirect){D2L.LP.Web.UI.Html.Dom.Navigate(payload.Location);
return}var receivePayloadProviders=D2L.LP.Web.UI.Rpc.ReceivePayloadProviders;for(var key in receivePayloadProviders)if(payload.Data[key]!==undefined)events.push(receivePayloadProviders[key].call(receivePayloadProviders[key],payload.Data[key]));response=payload.Payload}D2L.LP.Web.UI.Events.AggregateEvents(events,function(){ret.Trigger(true);if(typeof options.success!=="undefined")options.success.call(options.success,response)})}else{if(xhrResult.status==403&&xhrResult.responseText=="Not authenticated."){ret.Release();
if(options.notAuthenticated!==undefined)options.notAuthenticated.call(options.notAuthenticated);else D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated,keepAlive:options.keepAlive});return}var showError=xhrResult.status!=0;fail(showError)}};if(!isSynchronous)xhr.onreadystatechange=function(){handleXhrResult(xhr)};var sendPayloadProviders=D2L.LP.Web.UI.Rpc.SendPayloadProviders;for(var key in sendPayloadProviders)sendPayloadProviders[key].call(sendPayloadProviders[key],
params);var serializeParametersAndSend=function(xsrfToken){params["isXhr"]="true";params["requestId"]=D2L.LP.Web.UI.Rpc.GetUniqueRequestId();if(xsrfToken)params[D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName()]=xsrfToken;if(options.keepAlive!==undefined&&!options.keepAlive)params["X-D2L-Session"]="no-keep-alive";if(options.includeXsrfHeader!==undefined&&options.includeXsrfHeader)xhr.setRequestHeader("X-Csrf-Token",D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());if(options.appId!==undefined&&
options.appId.length>0)xhr.setRequestHeader("X-D2L-App-Id",options.appId);var serializedParams=D2L.LP.Web.Serialization.Url.Serialize(params);if(verb==D2L.LP.Web.UI.Rpc.Verbs.GET){var sep=loc.indexOf("?")>-1?"&":"?";loc+=sep+serializedParams}xhr.open(verb,loc,!isSynchronous);var data=undefined;if(verb==D2L.LP.Web.UI.Rpc.Verbs.POST){xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");data=serializedParams}if(options.timeout!==undefined)setTimeout(function(){if(complete)return;
timedOut=true;fail()},options.timeout);xhr.send(data)};if(verb==D2L.LP.Web.UI.Rpc.Verbs.POST){var xsrfToken=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();serializeParametersAndSend(xsrfToken)}else serializeParametersAndSend(null);if(isSynchronous)handleXhrResult(xhr);return ret};
D2L.LP.Web.UI.Rpc.ConnectPartial=function(placeholderId,verb,loc,params,options){if(options===undefined||options===null)options={};if(params===undefined||params===null)params={};var ret=new D2L.LP.Web.UI.Events.Event;params["_d2l_prc"]=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId.GetValue());D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,{success:function(result){ret.Trigger(result);if(typeof options.success!=="undefined")options.success.call(options.success)},failure:function(){ret.Trigger(false);
if(options.failure!==undefined)options.failure.call(options.failure)},keepAlive:options.keepAlive,timeout:6E4,notAuthenticated:function(){D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated})}});return ret};D2L.LP.Web.UI.Rpc.GetUniqueRequestId=function(){var me=D2L.LP.Web.UI.Rpc;if(me.m_requestIdCounter===undefined)me.m_requestIdCounter=1;me.m_requestIdCounter++;return me.m_requestIdCounter};
D2L.LP.Web.UI.Rpc.ConnectObject=function(verb,loc,params,options){var ret=new D2L.LP.Web.UI.Events.Event;var callSuccess=function(result){if(options.isSynchronous)ret=result;else ret.Trigger(result)};if(options===undefined)options={};options.success=function(result){callSuccess(result)};var connectRet=D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,options);connectRet.AddListener(function(result){if(result===false)ret.Trigger(false)});connectRet.AddReleaseListener(function(){ret.Release()});return ret};
D2L.LP.Web.UI.Rpc.ConnectObjectSynchronous=function(verb,loc,params,options){if(options===undefined)options={};options.isSynchronous=true;return D2L.LP.Web.UI.Rpc.ConnectObject(verb,loc,params,options)};D2L.LP.Web.UI.Rpc.Verbs={GET:"GET",POST:"POST"};D2L.LP.Web.UI.Rpc.OnFailure=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Rpc.FailureReasons={Unknown:1,NotAuthenticated:2};D2L.Files={RestrictedExtensions:[],TypeInfos:null,TypeInfosDr:null};
D2L.Control=D2L.Class.extend({Construct:function(doRegisterForDisposal){arguments.callee.$.Construct.call(this,doRegisterForDisposal);this.IDomNode=null;this.IChildrenDomNode=null;this.isD2LControl=true;this.m_children=[];this.m_hasDomBeenBuilt=false;this.m_isIntegrated=false;this.m_nextSibling=null;this.m_previousSibling=null;this.m_parent=null;this.m_window=window;this.m_ignoreTransformEvent=false;this.m_mappedId="";this.m_controlId=new D2L.Control.Id;this.OnChildAdd=new D2L.EventHandler;this.OnChildRemove=
new D2L.EventHandler;this.OnChildRemoveStructure=new D2L.EventHandler;this.OnDomInsertion=new D2L.EventHandler;this.m_parentChangeEvent=new D2L.EventHandler},AppendChild:function(node,sourceDomNode){return this.InsertBefore(node,undefined,sourceDomNode)},AppendChildren:function(children,sourceDomNode){this.m_ignoreTransformEvent=true;for(var i=0;i<children.length;i++){if(i==children.length-1)this.m_ignoreTransformEvent=false;this.AppendChild(children[i],sourceDomNode)}this.m_ignoreTransformEvent=
false},AppendTo:function(parentNode){if(parentNode){if(parentNode.d2l_win!==undefined)this.SetWindow(parentNode.d2l_win);if(!this.m_hasDomBeenBuilt)this.BuildDom();if(parentNode.isD2LControl)parentNode.AppendChild(this);else if(parentNode.appendChild){parentNode.appendChild(this.IDomNode);this.OnDomInsertion.Trigger()}}},BuildDom:function(){this.m_hasDomBeenBuilt=true},Children:function(){return this.m_children},ChildrenDomNode:function(){return this.IChildrenDomNode?this.IChildrenDomNode:this.IDomNode},
CreateCell:function(row,index){if(index===undefined)index=-1;var cell=row.insertCell(index);this.AttachObject(cell,"d2l_win",this.GetWindow());return cell},CreateElement:function(elementName){return this.GetUI().CreateElement(elementName)},CreateTextNode:function(text){return this.GetUI().CreateTextNode(text)},GetControlId:function(){return this.m_controlId},GetDomNode:function(){if(this.IDomNode===null&&this.m_mappedId.length>0)this.IDomNode=UI.GetById(this.GetMappedId());return this.IDomNode},GetMappedId:function(){if(this.m_mappedId.length===
0)if(this.IDomNode!==null&&this.IDomNode.id.length>0)this.m_mappedId=this.IDomNode.id;else this.m_mappedId=UI.GetUniqueHtmlId();return this.m_mappedId},GetUI:function(){return this.GetWindow()["UI"]},GetWindow:function(){if(this.Parent())return this.Parent().GetWindow();else return this.m_window},IsRendered:function(){return this.m_hasDomBeenBuilt},Integrate:function(parent,IDomNode){this.IntegrateChild(parent,IDomNode)},IntegrateChild:function(parent,IDomNode){if(parent){this.m_parent=parent;this.ParentChangeEvent().Trigger(parent);
if(parent.m_children.length>0){parent.m_children[parent.m_children.length-1].m_nextSibling=this;this.m_previousSibling=parent.m_children[parent.m_children.length-1]}parent.m_children.push(this)}if(IDomNode){this.IDomNode=IDomNode;this.AttachObject(this.IDomNode,"ID2L",this);this.m_hasDomBeenBuilt=true}},IntegrateControlInfo:function(controlInfo,isRendered){if(this.IsIntegrated())return;this.m_isIntegrated=true;if(isRendered===undefined)isRendered=true;this.m_hasDomBeenBuilt=isRendered;if(isRendered&&
this.GetDomNode()!==null)this.AttachObject(this.GetDomNode(),"ID2L",this)},IntegrateControl:function(controlInfo,isRendered){this.IntegrateControlInfo(controlInfo,isRendered)},IntegrateControlMin:function(controlInfo,isRendered){this.IntegrateControlInfo(controlInfo,isRendered)},InsertBefore:function(child,beforeChild,sourceDomNode){if(!child||child===undefined||child===null)return null;if(!child.isD2LControl){var control=new D2L.Control;control.IDomNode=child;control.m_hasDomBeenBuilt=true;child=
control}if(child.Parent()==this)child=this.RemoveChildStructure(child);if(!this.m_hasDomBeenBuilt)this.BuildDom();if(sourceDomNode===undefined)sourceDomNode=this.ChildrenDomNode();if(beforeChild&&!beforeChild.m_hasDomBeenBuilt)beforeChild.BuildDom();var i;var beforePos=-1;if(beforeChild)for(i=0;i<this.m_children.length;i++)if(this.m_children[i]==beforeChild){beforePos=i;break}if(beforeChild&&(beforePos==-1||beforeChild.IDomNode.parentNode!=sourceDomNode)){beforeChild=null;beforePos=-1}child.m_parent=
this;child.ParentChangeEvent().Trigger(this);if(beforePos>-1){if(this.m_children[beforePos].m_previousSibling){this.m_children[beforePos].m_previousSibling.m_nextSibling=child;child.m_previousSibling=this.m_children[beforePos].m_previousSibling}this.m_children[beforePos].m_previousSibling=child;child.m_nextSibling=this.m_children[beforePos];this.m_children.splice(beforePos,0,child)}else{if(this.m_children.length>0){this.m_children[this.m_children.length-1].m_nextSibling=child;child.m_previousSibling=
this.m_children[this.m_children.length-1]}this.m_children.push(child)}if(!child.m_hasDomBeenBuilt)child.BuildDom();if(beforePos>-1){if(child.IDomNode.parentNode!=sourceDomNode){sourceDomNode.insertBefore(child.IDomNode,beforeChild.IDomNode);this.OnDomInsertion.Trigger()}}else if(child.IDomNode&&(!child.IDomNode.parentNode||child.IDomNode.parentNode!=sourceDomNode))try{if(child.IDomNode.tagName&&child.IDomNode.tagName.toLowerCase()!="tr"){sourceDomNode.appendChild(child.IDomNode);child.OnDomInsertion.Trigger()}}catch(e){}this.OnChildAdd.Trigger(new D2L.Event("ChildAdd",
this),child);if(!this.m_ignoreTransformEvent){var transformEvent=new D2L.TransformEvent(child.IDomNode);transformEvent.Bubble()}return child},InsertSorted:function(child,isGreaterThan){var beforeChild;for(var i=0;i<this.Children().length;i++)if(isGreaterThan(this.Children()[i],child)){beforeChild=this.Children()[i];break}return this.InsertBefore(child,beforeChild)},IsFirstSibling:function(){return this.PreviousSibling()===null},IsInDom:function(){try{var domNode=this.GetDomNode();if(domNode!==null){while(domNode.parentNode!==
null)domNode=domNode.parentNode;return domNode==document}}catch(e){return false}return false},IsIntegrated:function(){return this.m_isIntegrated},IsLastSibling:function(){return this.NextSibling()===null},NextSibling:function(){return this.m_nextSibling},Parent:function(){return this.m_parent},ParentChangeEvent:function(){return this.m_parentChangeEvent},PreviousSibling:function(){return this.m_previousSibling},Remove:function(fadeOut){if(fadeOut===undefined)fadeOut=undefined;if(this.IDomNode){var me=
this;var doRemoval=function(){if(me.m_parent&&me.m_parent.isD2LControl)return me.m_parent.RemoveChild(me);else if(me.IDomNode.parentNode){if(me.IDomNode.parentNode.deleteRow)me.IDomNode.parentNode.deleteRow(me.IDomNode.rowIndex);else me.IDomNode=me.IDomNode.parentNode.removeChild(me.IDomNode);var transformEvent=new D2L.TransformEvent(me.IDomNode);transformEvent.Bubble()}};if(fadeOut){var myAnim=new YAHOO.util.Anim(this.IDomNode,{opacity:{to:0}},0.5);myAnim.onComplete.subscribe(function(){doRemoval()});
myAnim.animate()}else doRemoval();return me}return null},RemoveChild:function(child){if(!child||child===undefined||child===null)return null;child=this.RemoveChildStructure(child);if(child)this.OnChildRemove.Trigger(new D2L.Event("ChildRemove",this),child);return child},RemoveChildStructure:function(child){if(!child||child===undefined||child===null)return null;for(var i=0;i<this.m_children.length;i++)if(this.m_children[i]==child)break;if(i>=this.m_children.length)return null;var domNode=child;if(child.NextSibling())child.NextSibling().m_previousSibling=
child.PreviousSibling();if(child.PreviousSibling())child.PreviousSibling().m_nextSibling=child.NextSibling();child.m_parent=null;child.m_nextSibling=null;child.m_previousSibling=null;domNode=child.IDomNode;if(domNode&&domNode.parentNode){this.m_children.splice(i,1);if(domNode.parentNode.deleteRow)domNode.parentNode.deleteRow(domNode.rowIndex);else domNode=domNode.parentNode.removeChild(domNode);var transformEvent=new D2L.TransformEvent(domNode);transformEvent.Bubble()}this.OnChildRemoveStructure.Trigger(new D2L.Event("ChildRemoveStructure",
this),child);return child},RequireControlId:function(){if(this.m_controlId.ID().length===0)this.SetControlId(UI.GetUniqueHtmlId())},SetControlId:function(id,sid){UI.GetControlMap().UnregisterControl(this);this.m_controlId=new D2L.Control.Id(id,sid);UI.GetControlMap().RegisterControl(this)},SetDomNode:function(domNode){this.IDomNode=domNode;return this.IDomNode},SetValidator:function(validator){this.RequireControlId();validator.RequireControlId();UI.GetValidationManager().SetControlValidator(this.GetControlId(),
validator.GetControlId())},SetValidationGroup:function(group){this.RequireControlId();UI.GetValidationManager().SetControlValidationGroup(this.GetControlId(),group)},SetValidationSubject:function(subject){this.RequireControlId();UI.GetValidationManager().SetControlSubject(this.GetControlId(),subject)},SetWindow:function(w){this.m_window=w}});D2L.Control.TextFormat={Normal:1,Bold:2};D2L.C=function(name,id,sid){if(name!==undefined&&name!==null&&name.length>0)window[name]=UI.GetControl(id,sid)};
D2L.Control.Id=D2L.Class.extend({Construct:function(id,sid){arguments.callee.$.Construct.call(this);if(id===undefined)id="";else if(!id.isString)id=id.toString();if(sid===undefined)sid="";else if(!sid.isString)sid=sid.toString();this.m_id=id.toLowerCase();this.m_sid=sid.toLowerCase()},Deserialize:function(deserializer){this.m_id=deserializer.GetMember("ID");if(deserializer.HasMember("SID"))this.m_sid=deserializer.GetMember("SID")},DeserializeMin:function(deserializer){this.m_id=deserializer.GetMember();
if(deserializer.HasMember())this.m_sid=deserializer.GetMember()},Serialize:function(serializer){serializer.AddMember("ID",this.m_id);if(this.m_sid.length>0)serializer.AddMember("SID",this.m_sid)},ID:function(){return this.m_id},SID:function(){return this.m_sid}});D2L.JavaScriptFunctionOnClickAdapter=function(onClick){var f=new Function(onClick);f()};D2L.Util={};
D2L.Util.MethodProxy=D2L.Class.extend({Construct:function(beginMethod,endMethod,isAsynchronous){arguments.callee.$.Construct.call(this);if(isAsynchronous===undefined)isAsynchronous=true;this.m_beginMethod=beginMethod;this.m_endMethod=endMethod;this.m_isAsynchronous=isAsynchronous},Call:function(){var ret=undefined;if(this.m_isAsynchronous){var dr=new D2L.Util.DelayedReturn;ret=dr;if(this.m_endMethod)ret=dr.RegisterWithReturn(this.m_endMethod);if(this.m_beginMethod)dr.Trigger(this.m_beginMethod.apply(this.m_beginMethod,
arguments))}else{if(this.m_beginMethod)ret=this.m_beginMethod.apply(this.m_beginMethod,arguments);if(this.m_endMethod)ret=this.m_endMethod.apply(this.m_endMethod,[ret])}return ret}});
D2L.UI=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.displayGroups=null;this.formName="d2l_form";this.form={};this.initialized=false;this.Form=D2L.UI.GetByName;this.ValidateArray=new Array;this.prefetchedImages=new Array;this.windowId="";this.Callback=new Object;this.LanguageManager=new D2L.Language.LanguageManager;this.DisplayGroupsManager=null;this.qsParams=null;this.m_bodyType=D2L.UI.BodyType.Normal;this.m_controlMap=null;this.m_culture=null;this.m_d2lTextCacheManager=
null;this.m_displayGroupManager=null;this.m_dragDropManager=null;this.m_formManager=null;this.m_helpDialogs={};this.m_hitCode="";this.m_hitCodeCount=0;this.m_isPageFullScreen=true;this.m_messageArea=null;this.m_messageAreaParentId="";this.m_messageAreaSiblingId="";this.m_multiEditManager=null;this.m_onPageLoad=new D2L.EventHandler;this.m_onPageUnload=new D2L.EventHandler;this.m_pageLoadTime=0;this.m_parentDialog=null;this.m_parentDialogDr=new D2L.Util.DelayedReturn;this.m_relativeFontSizeManager=
null;this.m_relativeZIndex=1E3;this.m_reorderManager=null;this.m_shimController=null;this.m_stateManager=null;this.m_uniqueHtmlId=0;this.m_validationManager=null;this.m_warnings=[];this.m_windowEventManager=null;var me=this;this.OnPageLoad().RegisterMethod(function(){var now=new Date;me.m_pageLoadTime=now.getTime()-D2L.InitTime;me.GetControlMap();me.GetReorderManager().Init();if(me.m_warnings.length>0){var ma=me.GetMessageArea();for(var i=0;i<me.m_warnings.length;i++)ma.AddWarningMessage(new D2L.LP.Text.SmlText(me.m_warnings[i]),
false);setTimeout(function(){ma.RenderWarningLabel();ma.RenderHeight()})}me.FixPNGs();D2L.LP.Web.UI.Events.OnLoad.Trigger()})},DeserializeMin:function(deserializer){window["UI"]=this;window["Nav"]=new D2L.Nav;window["WindowEventManager"]=this.GetWindowEventManager();window["Events"]=FindEventController();window["RpcManager"]=new D2L.Rpc.Manager;window["FormManager"]=this.GetFormManager();this.windowId=deserializer.GetMember();this.pageId=deserializer.GetMember();this.m_bodyType=deserializer.GetMember();
this.m_relativeFontSizeManager=new D2L.Style.RelativeFontSizeManager(deserializer.GetDictionaryMin());this.m_displayGroupManager=deserializer.GetObjectMin(D2L.DisplayGroups.DisplayGroupManager);this.m_reorderManager=deserializer.GetObjectMin(D2L.Reorder.ReorderManager);this.m_validationManager=deserializer.GetObjectMin(D2L.Validation.Manager);this.m_multiEditManager=deserializer.GetObjectMin(D2L.MultiEdit.Manager);this.m_culture=deserializer.GetObjectMin(D2L.Culture);window["Culture"]=this.m_culture;
this.m_warnings=deserializer.GetMember();this.m_isPageFullScreen=deserializer.GetBoolean();D2L.Util.DateTime.LoadDateTime=deserializer.GetObject();var ariaController=new D2L.UI.AriaController(this)},CreateArray:function(){return[]},CreateElement:function(elementName){var ele=document.createElement(elementName);this.AttachObject(ele,"d2l_win",window);return ele},CreateTextNode:function(text){var emptySpace="\ufeff";if(text===undefined||text===null)return document.createTextNode(emptySpace);else if(text.isString){if(text.length===
0)text=emptySpace;return document.createTextNode(text)}else{var textNode=document.createTextNode(emptySpace);text.AssignText(textNode,"data");return textNode}},C:function(anchor,onClick){if(anchor.className!="dlk_d"&&anchor.className.indexOf("di_l_d")<0){var f=new Function(onClick);f.call(anchor)}},FixPNGs:function(){if(this.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&this.GetBrowserInfo().MajorVersion<7)var pngs=YAHOO.util.Dom.getElementsBy(function(elem){if(elem!==undefined&&elem!==null&&elem.src!==
undefined&&elem.runtimeStyle!==undefined)return elem.src.indexOf(".png")>-1;return false},"img",undefined,function(elem){var src=elem.src;elem.src="/d2l/img/lp/pixel.gif";elem.runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"')"})},G:function(id){return this.GetById(id)},GenerateHitCode:function(){var now=new Date;var hitCodeSeed=D2L.LP.Web.Authentication.Xsrf.GetHitCodeSeed();this.m_hitCodeCount++;var count=(this.m_hitCodeCount%10).toString();this.m_hitCode=hitCodeSeed+
(now.getTime()+1E8)%1E8+count;if(this.form){var input=this.GetByName("d2l_hitCode");if(input)input.value=this.m_hitCode}return this.m_hitCode},GetBrowserInfo:function(){return BrowserInfo},GetById:function(id){return document.getElementById(id)},GetByClassName:function(className){return YAHOO.util.Dom.getElementsByClassName(className)},GetByTagName:function(tagName){return document.getElementsByTagName(tagName)},GetControl:function(ID,SID){return this.GetControlMap().GetControl(ID,SID)},GetControls:function(ID){return this.GetControlMap().GetControls(ID)},
GC:function(mappedId){return this.GetControlMap().GetControlByMappedId(mappedId)},GetControlMap:function(){if(this.m_controlMap===null)if(!this.GetForm())return new D2L.ControlMap;else if(this.GetForm().d2l_controlMap!==undefined)this.m_controlMap=D2L.Serialization.JsonDeserializerMin.Deserialize(this.GetForm().d2l_controlMap.value,D2L.ControlMap);else this.m_controlMap=new D2L.ControlMap;return this.m_controlMap},GetCulture:function(){return this.m_culture},GetDisplayGroupManager:function(){return this.m_displayGroupManager},
GetLanguageManager:function(){return this.LanguageManager},GetForm:function(){return document.forms[this.formName]},GetFormManager:function(){if(this.m_formManager===null)this.m_formManager=new D2L.FormManager;return this.m_formManager},GetD2LTextCacheManager:function(){if(this.m_d2lTextCacheManager===null)this.m_d2lTextCacheManager=new D2L.LP.Text.Cache;return this.m_d2lTextCacheManager},GetHitCode:function(){return this.m_hitCode},GetMessageArea:function(){try{if(this.GetBodyType()==D2L.UI.BodyType.IFrame&&
window.parent!==window&&window.parent["UI"]!==undefined&&window.parent["UI"]!==window["UI"])return window.parent["UI"].GetMessageArea()}catch(e){}if(this.m_messageArea===null){this.m_messageArea=UI.GetControl("ctl_messageArea");if(this.m_messageArea===null)this.m_messageArea=new D2L.Control.MessageArea}return this.m_messageArea},GetMultiEditManager:function(){return this.m_multiEditManager},GetPageLoadTime:function(){return this.m_pageLoadTime},GetParentDialog:function(){return this.m_parentDialog},
GetParentDialogDelayed:function(){return this.m_parentDialogDr},GetRelativeFontSizeManager:function(){return this.m_relativeFontSizeManager},GetReorderManager:function(){return this.m_reorderManager},GetShimController:function(){if(this.m_shimController===null)this.m_shimController=new D2L.UI.ShimController(this);return this.m_shimController},GetStateManager:function(){if(this.m_stateManager===null)if(!this.GetForm())return new D2L.State.StateManager;else if(this.GetForm().d2l_state!==undefined)this.m_stateManager=
D2L.Serialization.JsonDeserializerMin.Deserialize(this.GetForm().d2l_state.value,D2L.State.StateManager);else this.m_stateManager=new D2L.State.StateManager;return this.m_stateManager},GetValidationManager:function(){if(this.m_validationManager===null)if(!this.GetForm())return new D2L.Validation.Manager;else if(this.GetForm().d2l_validationManager!==undefined)this.m_validationManager=D2L.Serialization.JsonDeserializerMin.Deserialize(this.GetForm().d2l_validationManager.value,D2L.Validation.Manager);
else this.m_validationManager=new D2L.Validation.Manager;return this.m_validationManager},GetWindowEventManager:function(){if(this.m_windowEventManager===null)this.m_windowEventManager=new D2L.WindowEventManager;return this.m_windowEventManager},HideNavBar:function(){var navBar=window.document.getElementById("d_navBar");if(navBar==null)return;var hasNavBar=false;var firstTime=true;var w=window;while(w&&!hasNavBar){try{if(!firstTime&&w.document.getElementById("d_navBar")!==null){hasNavBar=true;break}}catch(e){break}firstTime=
false;var frames=w.document.getElementsByTagName("frame");for(var i=0;i<frames.length;i++)if(frames[i].name=="nav"&&frames[i].contentWindow!=window){hasNavBar=true;break}if(w==w.parent)break;w=w.parent}if(hasNavBar)YAHOO.util.Dom.addClass(this.GetBodyElement(),"dbd_noNav")},EncodeUrl:function(str){return D2L.Util.Url.Encode(str)},Init:function(){this.HideNavBar();if(document.forms)this.form=document.forms[this.formName];this.initialized=true;this.GenerateHitCode();var d=new Date;var me=this;var termCopyright=
new D2L.LP.Text.LangTerm("Standard.Misc.txtCopyright",d.getFullYear());termCopyright.GetText().Register(function(val){window.defaultStatus=val;me.AttachObject(document,"onmouseout",function(){window.status=val})});this.DisplayGroupsManager=this.GetDisplayGroupManager();this.displayGroups=this.DisplayGroupsManager;this.StateManager=this.GetStateManager();window["StateManager"]=this.GetStateManager();window["ValidationManager"]=this.GetValidationManager()},InitMessageArea:function(parentId,siblingId){this.m_messageAreaParentId=
parentId;this.m_messageAreaSiblingId=siblingId},IsPageFullScreen:function(){return this.m_isPageFullScreen},IsValidJsVariableName:function(name){var validRegEx=/^([a-zA-Z])+([a-zA-Z0-9_])*$/;return validRegEx.test(name)},GetByName:function(name){var retVal=null;var form=this.form;if(!this.initialized)form=document.forms[this.formName];if(form[name])retVal=form[name];else if(window[name])retVal=window[name];if(retVal)if(D2L.Util.JavaScript.IsArray(retVal))for(var i=0;i<retVal.length;i++){if(retVal[i].ID2L)retVal[i]=
retVal[i].ID2L}else if(retVal.ID2L)retVal=retVal.ID2L;return retVal},GetBodyElement:function(){return document.getElementById("d2l_body")},GetBodyType:function(){return this.m_bodyType},PrefetchImage:function(name,src,width,height,alt){if(!alt||alt===undefined)alt="";if(!this.prefetchedImages[name]||this.prefetchedImages[name]&&this.prefetchedImages[name]===null){var img=new Image(width,height);img.src=src;img.alt=alt;img.w=width;img.h=height;this.prefetchedImages[name]=img}else if(this.prefetchedImages[name]&&
this.prefetchedImages[name].src!=src){this.prefetchedImages[name].src=src;this.prefetchedImages[name].alt=alt;this.prefetchedImages[name].w=width;this.prefetchedImages[name].h=height}},FetchImage:function(name){return this.prefetchedImages[name]},SwapImages:function(oldImage,prefetchedImageName,alt){if(this.prefetchedImages[prefetchedImageName]&&oldImage){var img=this.prefetchedImages[prefetchedImageName];var imgAlt=alt!==undefined?alt:img.alt.length>0?img.alt:"";oldImage.src=img.src;oldImage.width=
img.w;oldImage.height=img.h;if(imgAlt.length>0){oldImage.alt=imgAlt;oldImage.title=imgAlt}}},SetPageHeadingTitle:function(title){var heading=document.getElementById("d_page_title");if(heading!=null){var headingSpan=heading.firstChild;if(headingSpan!=null)if(headingSpan.firstChild!=null)headingSpan.firstChild.nodeValue=title}},AddCallback:function(method,windowId){var success=false;var win=this.FindWindow(windowId);if(win!==null)if(win[method]){success=true;this.Callback[method]=win[method]}if(!success)this.Callback[method]=
function(){return null}},FindWindow:function(windowId,searchUp){if(searchUp===undefined)searchUp=true;var retVal=null;var SearchWindow=function(w){if(w.UI&&w.UI.windowId==windowId)return w;var frames=w.document.getElementsByTagName("frame");for(var i=0;i<frames.length;i++){var fWin=frames[i].contentWindow;if(fWin["UI"]){retVal=fWin.UI.FindWindow(windowId,false);if(retVal)return retVal}}var iframes=w.document.getElementsByTagName("iframe");for(var i=0;i<iframes.length;i++){var fWin=iframes[i].contentWindow;
if(fWin["UI"]){retVal=fWin.UI.FindWindow(windowId,false);if(retVal)return retVal}}if(w.opener&&w.opener.UI){retVal=w.opener.UI.FindWindow(windowId);if(retVal)return retVal}return null};var root=window;if(searchUp)while(root&&root.parent!=root&&root["UI"])root=root.parent;return SearchWindow(root)},GetUniqueHtmlId:function(){this.m_uniqueHtmlId=this.m_uniqueHtmlId+1;return"d2l_cntl_"+this.windowId+"_"+this.m_uniqueHtmlId},GetWindowWidth:function(w){if(w===undefined)w=window;if(w.innerWidth)return w.innerWidth;
else if(w.document.documentElement&&w.document.documentElement.clientWidth)return w.document.documentElement.clientWidth;else if(w.document.body)return w.document.body.clientWidth;return 0},GetWindowHeight:function(w){if(w===undefined)w=window;if(w.innerHeight)return w.innerHeight;else if(w.document.documentElement&&w.document.documentElement.clientHeight)return w.document.documentElement.clientHeight;else if(w.document.body)return w.document.body.clientHeight;return 0},GetPageWidth:function(w){if(w===
undefined)w=window;return Math.max(w.document.documentElement.scrollWidth,UI.GetWindowWidth(w))},GetPageHeight:function(w){if(w===undefined)w=window;var doc=undefined;try{doc=w.document}catch(e){}var dh=0;var sh=0;var oh=0;if(doc!==undefined){if(doc.height!==undefined)dh=doc.height;if(doc.body!==undefined){if(doc.body.scrollHeight!==undefined)sh=doc.body.scrollHeight;if(doc.body.offsetHeight!==undefined)oh=doc.body.offsetHeight}}return Math.max(Math.max(dh,sh),oh)},GetScrollLeft:function(w){if(w===
undefined)w=window;if(w.document.documentElement&&w.document.documentElement.scrollLeft)return w.document.documentElement.scrollLeft;else if(w.document.body)return w.document.body.scrollLeft;return 0},GetScrollTop:function(w){if(w===undefined)w=window;if(w.document.documentElement&&w.document.documentElement.scrollTop)return w.document.documentElement.scrollTop;else if(w.document.body)return w.document.body.scrollTop;return 0},GetCursorX:function(w,evt){var x=0;if(w.event)x=w.event.clientX+w.document.documentElement.scrollLeft+
w.document.body.scrollLeft;else x=evt.clientX+w.scrollX;return x},GetCursorY:function(w,evt){var y=0;if(w.event)y=w.event.clientY+w.document.documentElement.scrollTop+w.document.body.scrollTop;else y=evt.clientY+w.scrollY;return y},GetCursorPositionInEdit:function(w,textElement){if(w===undefined)w=window;if(textElement.selectionStart)return textElement.selectionStart;else if(w.document.selection){var sOldText=textElement.value;var objRange=w.document.selection.createRange();var sOldRange=objRange.text;
var sWeirdString="$5b6aaf4b8a6c6c498a74cc6d$";objRange.text=sOldRange+sWeirdString;objRange.moveStart("character",0-sOldRange.length-sWeirdString.length);var sNewText=textElement.value;objRange.text=sOldRange;for(var i=0;i<=sNewText.length;i++){var sTemp=sNewText.substring(i,i+sWeirdString.length);if(sTemp==sWeirdString){var cursorPos=i-sOldRange.length;return cursorPos}}return 0}return 0},SetCursorPositionInEdit:function(w,textElement,cursorPosition){textElement.focus();if(textElement.selectionStart&&
cursorPosition>=0)textElement.setSelectionRange(cursorPosition,cursorPosition);else if(textElement.createTextRange){var range=textElement.createTextRange();range.collapse(true);range.moveEnd("character",cursorPosition);range.moveStart("character",cursorPosition);range.select()}},SetParentDialog:function(dialog){this.m_parentDialog=dialog;this.m_parentDialogDr.Trigger(this.m_parentDialog)},EnableLoadingPageShim:function(isShimEnabled){if(isShimEnabled)this.GetShimController().Shim(null,true);else this.GetShimController().ClearShims()},
Confirm:function(callback,primaryMessage,secondaryMessage,opener,positiveText,negativeText){if(opener!==undefined&&opener!==null&&(opener.isString!==undefined||opener.m_isLangTerm!==undefined)){negativeText=positiveText;positiveText=opener;opener=undefined}var d=new D2L.Dialog.Confirm(this.GetUniqueHtmlId(),callback,primaryMessage,secondaryMessage);if(positiveText!==undefined)d.SetPositiveButtonText(positiveText);if(negativeText!==undefined)d.SetNegativeButtonText(negativeText);return d.Open(opener)},
Error:function(primaryMessage,secondaryMessage,opener){var d=new D2L.Dialog.Error(this.GetUniqueHtmlId(),primaryMessage,secondaryMessage);return d.Open(opener)},Info:function(primaryMessage,secondaryMessage,opener){var d=new D2L.Dialog.Info(this.GetUniqueHtmlId(),primaryMessage,secondaryMessage);return d.Open(opener)},Warning:function(primaryMessage,secondaryMessage,opener){var d=new D2L.Dialog.Warning(this.GetUniqueHtmlId(),primaryMessage,secondaryMessage);return d.Open(opener)},GetRelativeZIndex:function(){this.m_relativeZIndex--;
return this.m_relativeZIndex},GetZIndex:function(){var win=window;while(win.parent!=win&&win.parent.D2L!==undefined)win=win.parent;var z=win.D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex();return z},AH:function(pTitle,collectionName){var p=new d2l_Popup;p.height=800;p.width=800;p.title=pTitle;p.bodySource="/d2l/lp/Lang/admin/modify/language_instructions_edit.d2l";p.queryString="ou="+Global.OrgUnitId+"&cname="+collectionName;p.AddCloseButton();p.AddSaveButton();p.Open()},HT:function(primary,secondary,
source){var d=new D2L.Dialog.Info(this.GetUniqueHtmlId(),new D2L.LP.Text.HtmlText(primary,false),new D2L.LP.Text.HtmlText(secondary,false));d.SetOpener(source);return d.Open()},OnPageLoad:function(){return this.m_onPageLoad},OnPageUnload:function(){return this.m_onPageUnload},Test:function(){return true}});
D2L.LP.Web.UI.Html.Aria={LogMessage:function(message){var ariaLog=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-aria-log");if(ariaLog===null){ariaLog=document.createElement("div");ariaLog.className="d2l-aria-log d2l-offscreen";D2L.LP.Web.UI.Html.Aria.SetRole(ariaLog,"alert");D2L.LP.Web.UI.Html.Aria.SetAttribute(ariaLog,"live","assertive");document.body.appendChild(ariaLog)}ariaLog.innerHTML="";ariaLog.appendChild(document.createTextNode(message))},Politeness:{Off:"off",Polite:"polite",Assertive:"assertive",
Rude:"rude"},RemoveAttribute:function(element,attribute){if(element!==undefined&&element!==null)element.removeAttribute("aria-"+attribute)},SetAttribute:function(element,attribute,value){if(element!==undefined&&element!==null)D2L.LP.Web.UI.Html.Dom.SetAttribute(element,"aria-"+attribute,value)},SetRole:function(element,role){if(element!==undefined&&element!==null)D2L.LP.Web.UI.Html.Dom.SetAttribute(element,"role",role)},RpcReceivePayloadProvider:function(data){if(data.Items===undefined||data.Items===
null)return;var messages=data.Items;for(var i=0;i<messages.length;i++)D2L.LP.Web.UI.Html.Aria.LogMessage(messages[i].Message)}};D2L.LP.Web.Authentication=D2L.LP.Web.Authentication||{};
D2L.LP.Web.Authentication.Xsrf={m_xsrfTokenParameterName:"",Init:function(xsrfTokenParameterName,xsrfToken,hitCodeSeed){D2L.LP.Web.Authentication.Xsrf.m_xsrfTokenParameterName=xsrfTokenParameterName;D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("XSRF.HitCodeSeed",hitCodeSeed);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("XSRF.Token",xsrfToken)},GetHitCodeSeed:function(){var hitCodeSeed=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get("XSRF.HitCodeSeed");return hitCodeSeed},GetXsrfTokenParameterName:function(){return D2L.LP.Web.Authentication.Xsrf.m_xsrfTokenParameterName},
GetXsrfToken:function(){var token=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get("XSRF.Token");return token},CreateXsrfHidden:function(){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();return hidden}};D2L.LP.Web.UI.Html.Ids={};
D2L.LP.Web.UI.Html.AbsoluteHtmlId=D2L.Class.Create({Construct:function(value){if(value===undefined||value===null)value="";this.m_value=value},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("Value")},_serialize:function(serializer){serializer.AddMember("Value",this.m_value)},GetValue:function(){return this.m_value},$:function(){var node=document.getElementById(this.m_value);return $(node)}});D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create=function(id){return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id)};
D2L.LP.Web.UI.Html.Ids.Index=0;D2L.LP.Web.UI.Html.UniqueHtmlId=D2L.Class.Create({Construct:function(){D2L.LP.Web.UI.Html.Ids.Index++;this.m_value="d2l_c_"+D2L.LP.Web.UI.Html.Ids.Index+"_"+Math.floor(Math.random()*1E3)},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("Value")},_serialize:function(serializer){serializer.AddMember("Value",this.m_value)},GetValue:function(){return this.m_value},$:function(){var node=document.getElementById(this.m_value);return $(node)}});
D2L.LP.Web.UI.Html.JavaScript=D2L.LP.Web.UI.Html.JavaScript||{};D2L.LP.Web.UI.Html.JavaScript.CompareBoolean=function(type,left,right){if(type===0)return left!=right;else return left==right};D2L.LP.Web.UI.Html.JavaScript.Console={Error:function(){},Info:function(){},Warn:function(){},Log:function(){},Debug:function(){},IsEnabled:function(){return false}};D2L.LP.Web.UI.Html.Dom=D2L.LP.Web.UI.Html.Dom||{};D2L.LP.Web.UI.Html.Dom.ClassDestructors={};
D2L.LP.Web.UI.Html.Dom.AddClassDestructor=function(className,callback){if(D2L.LP.Web.UI.Html.Dom.ClassDestructors[className]===undefined)D2L.LP.Web.UI.Html.Dom.ClassDestructors[className]=[];D2L.LP.Web.UI.Html.Dom.ClassDestructors[className].push(callback)};D2L.LP.Web.UI.Html.Dom.ClassInitializers={};D2L.LP.Web.UI.Html.Dom.AddClassInitializer=function(className,callback){if(D2L.LP.Web.UI.Html.Dom.ClassInitializers[className]===undefined)D2L.LP.Web.UI.Html.Dom.ClassInitializers[className]=[];D2L.LP.Web.UI.Html.Dom.ClassInitializers[className].push(callback)};
D2L.LP.Web.UI.Html.Dom.AddClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return;$(domNode).addClass(className)};D2L.LP.Web.UI.Html.Dom.AddClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null)D2L.LP.Web.UI.Html.Dom.AddClassName(className,node)};
D2L.LP.Web.UI.Html.Dom.AddEventListener=function(eventName,domNode,callback,useCapture){if(!domNode)return;if(domNode.addEventListener){useCapture=useCapture||false;if(eventName.length>2&&eventName.substr(0,2)=="on")eventName=eventName.substr(2);domNode.addEventListener(eventName,callback,useCapture)}else if(domNode.attachEvent){if(eventName.substr(0,2)!="on")eventName="on"+eventName;domNode.attachEvent(eventName,callback)}};
D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener=function(domNode,callback){var handleKeyPress=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs(e);if(args.IsCtrl())D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=true;var result=callback.call(callback,args);return result};var handleKeyUp=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs(e);if(args.IsCtrl())D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=false};D2L.LP.Web.UI.Html.Dom.AddEventListener("keydown",
domNode,handleKeyPress);D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",domNode,handleKeyUp)};D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs=D2L.Class.extend({Construct:function(e){this.m_event=e},GetKey:function(){return this.m_event.keyCode},GetEventObject:function(){return this.m_event},GetTarget:function(){return D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(this.m_event)},IsCtrl:function(){return this.m_event.keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Control}});
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour=function(e){if(e.preventDefault!==undefined)e.preventDefault();else e.returnValue=false};
D2L.LP.Web.UI.Html.Dom.CancelEventBubble=function(e){if(e.stopPropagation!==undefined)e.stopPropagation();else if(e.cancelBubble!==undefined)e.cancelBubble=true};
D2L.LP.Web.UI.Html.Dom.DispatchEvent=function(eventName,node){if(document.createEvent){var evt;if(eventName=="click"){evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null)}else{evt=document.createEvent("HTMLEvents");evt.initEvent(eventName,true,true)}return!node.dispatchEvent(evt)}else if(node.fireEvent)return node.fireEvent("on"+eventName);return false};
D2L.LP.Web.UI.Html.Dom.Focus=function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.FocusNode(node)};D2L.LP.Web.UI.Html.Dom.FocusNode=function(node){if(!node||node.focus==undefined)return;try{node.focus()}catch(e){}};D2L.LP.Web.UI.Html.Dom.GetActiveElement=function(doc){if(doc===null||doc===undefined)return document.activeElement;else return doc.activeElement};
D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null)return null;var result=[];var parentElem=elem.parentNode;className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");while(parentElem!==null){if(oRegExp.test(parentElem.className))result.push(parentElem);parentElem=parentElem.parentNode}return result};D2L.LP.Web.UI.Html.Dom.GetAttribute=function(node,attrName){return node.getAttribute(attrName)};
D2L.LP.Web.UI.Html.Dom.GetBoundingRect=function(elem,baseOnDocumentCoordinates){if(baseOnDocumentCoordinates===undefined)baseOnDocumentCoordinates=true;var offsetParent=elem.offsetParent,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,top=elem.offsetTop,left=elem.offsetLeft;var width=elem.offsetWidth;var height=elem.offsetHeight;var positionedOffsetParent;if(!baseOnDocumentCoordinates)positionedOffsetParent=D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent(elem);while((elem=elem.parentNode)&&
elem!==body&&elem!==docElem){if(!baseOnDocumentCoordinates&&elem===positionedOffsetParent)break;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;offsetParent=elem.offsetParent}}return{top:top,right:left+width,bottom:top+height,left:left,width:width,height:height}};
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName=function(className,elem){var elems;if(elem===undefined||elem===null||elem===document)elems=$("."+className);else elems=$(elem).find("."+className);return $.makeArray(elems)};
D2L.LP.Web.UI.Html.Dom.GetElementById=function(id,doc){if(id===undefined||id===null)return null;if(id.GetValue!==undefined)id=id.GetValue();doc=doc||document;var elem=doc.getElementById(id);if(elem!==null&&elem.id!=id)if(doc.all){var possibleNodes=doc.all[id];for(var i=0;i<possibleNodes.length;i++)if(possibleNodes[i].id==id)return possibleNodes[i];return null}else return null;else return elem};D2L.LP.Web.UI.Html.Dom.GetEventTargetElement=function(e){return e.srcElement||e.target};
D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName=function(className,elem){for(var i=0;i<elem.childNodes.length;i++){var childNode=elem.childNodes[i];if(D2L.LP.Web.UI.Html.Dom.HasClassName(className,childNode))return childNode}return null};
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName=function(className,elem){if(elem===undefined||elem===null)elem=document;if(elem.getElementsByClassName!==undefined||elem.querySelectorAll!==undefined){var nodes;if(elem.getElementsByClassName!==undefined)nodes=elem.getElementsByClassName(className);else nodes=elem.querySelectorAll("."+className);if(nodes.length>0)return nodes[0];return null}var allElems=elem.all?elem.all:elem.getElementsByTagName("*");var elems=[];className=className.replace(/\-/g,
"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");for(var i=0;i<allElems.length;i++)if(oRegExp.test(allElems[i].className))return allElems[i];return null};D2L.LP.Web.UI.Html.Dom.GetFirstElementChild=function(elem){if(elem.firstElementChild!==undefined)return elem.firstElementChild;var childrenCount=elem.childNodes.length;for(var i=0;i<childrenCount;i++)if(elem.childNodes[i].nodeType==1)return elem.childNodes[i];return null};
D2L.LP.Web.UI.Html.Dom.GetLastElementChild=function(elem){if(elem.lastElementChild!==undefined)return elem.lastElementChild;var childrenCount=elem.childNodes.length;for(var i=childrenCount-1;i>=0;i--)if(elem.childNodes[i].nodeType==1)return elem.childNodes[i];return null};
D2L.LP.Web.UI.Html.Dom.GetMousePosition=function(win,evt){var pos={x:0,y:0};if(evt.targetTouches&&evt.targetTouches[0]){pos.x=evt.targetTouches[0].pageX;pos.y=evt.targetTouches[0].pageY}else if(evt.changedTouches&&evt.changedTouches[0]){pos.x=evt.changedTouches[0].pageX;pos.y=evt.changedTouches[0].pageY}else if(win.event){pos.x=win.event.clientX+win.document.documentElement.scrollLeft+win.document.body.scrollLeft;pos.y=win.event.clientY+win.document.documentElement.scrollTop+win.document.body.scrollTop}else{pos.x=
evt.clientX+win.scrollX;pos.y=evt.clientY+win.scrollY}return pos};D2L.LP.Web.UI.Html.Dom.GetNextElementSibling=function(elem){if(elem.nextElementSibling!==undefined)return elem.nextElementSibling;var sibling=elem.nextSibling;while(sibling!==null){if(sibling.nodeType==1)return sibling;sibling=sibling.nextSibling}return null};
D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement=function(domNode,includeHidden){if(domNode===undefined||domNode===null)return null;if(includeHidden===undefined)includeHidden=false;var checkDecendents=function(node){var children=node.childNodes;for(var i=0;i<children.length;i++){var isFocusable=D2L.LP.Web.UI.Html.Dom.IsFocusable(children[i],includeHidden);if(isFocusable)return children[i];var childResult=checkDecendents(children[i]);if(childResult)return childResult}return null};var recursiveFunc=function(node,
skipFocusCheck,ignoreChildren){if(!skipFocusCheck&&D2L.LP.Web.UI.Html.Dom.IsFocusable(node,includeHidden))return node;if(!ignoreChildren){var childResult=checkDecendents(node);if(childResult)return childResult}var nextSibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(nextSibling){var siblingResult=recursiveFunc(nextSibling,false,false);if(siblingResult)return siblingResult;return null}var parent=null;if(node.parentNode)parent=node.parentNode;else{var win=null;if(node.defaultView)win=node.defaultView;
else if(node.parentWindow)win=node.parentWindow;if(win!=null&&win.D2L)if(win.frameElement)if(win.frameElement.parentNode)parent=win.frameElement.parentNode}if(!parent)return null;var nextSiblingOfParent=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(parent);if(nextSiblingOfParent){var r=recursiveFunc(nextSiblingOfParent,false,false);if(r)return r}return null};var result=recursiveFunc(domNode,true,false);return result};
D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null)return null;var parentElem;try{parentElem=elem.parentNode}catch(e){return null}className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");while(parentElem!==null){if(oRegExp.test(parentElem.className))return parentElem;parentElem=parentElem.parentNode}return null};
D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null)return null;var parentElems=new Array;var parentElem;try{parentElem=elem.parentNode}catch(e){return null}className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");while(parentElem!==null){if(oRegExp.test(parentElem.className))parentElems.push(parentElem);parentElem=parentElem.parentNode}return parentElems};
D2L.LP.Web.UI.Html.Dom.GetPageSize=function(w){var ret={width:0,height:0};var doc=undefined;try{doc=w.document}catch(e){}if(doc===undefined)return ret;var dh=0;var dw=0;var sh=0;var sw=0;var oh=0;var ow=0;var dbH=0;var dbW=0;if(doc.height!==undefined){dh=doc.height;dw=doc.width}if(doc.body!==undefined&&doc.body!==null){if(doc.body.scrollHeight!==undefined)sh=doc.body.scrollHeight;if(doc.body.scrollWidth!==undefined)sw=doc.body.scrollWidth;if(doc.body.offsetHeight!==undefined)oh=doc.body.offsetHeight;
if(doc.body.offsetWidth!==undefined)ow=doc.body.offsetWidth;if(doc.documentElement.scrollHeight!==undefined)dbH=doc.documentElement.scrollHeight;if(doc.documentElement.scrollWidth!==undefined)dbW=doc.documentElement.scrollWidth}ret.height=Math.min(dbH,Math.max(Math.max(dh,sh),oh));ret.width=Math.min(dbW,Math.max(Math.max(dw,sw),ow));return ret};
D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent=function(elem){var offsetParent=elem.offsetParent||document.body;while(offsetParent&&D2L.LP.Web.UI.Html.Css.GetStyle(offsetParent,"position")==="static"&&offsetParent!==document.body&&offsetParent!==document.documentElement)offsetParent=offsetParent.offsetParent;return offsetParent};
D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling=function(elem){if(elem===undefined||elem===null)return null;if(elem.previousElementSibling!==undefined)return elem.previousElementSibling;var sibling=elem.previousSibling;while(sibling!==null){if(sibling.nodeType==1)return sibling;sibling=sibling.previousSibling}return null};
D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement=function(domNode,includeHidden){if(domNode===undefined||domNode===null)return null;if(includeHidden===undefined)includeHidden=false;var checkDecendents=function(node){var children=node.childNodes;for(var i=children.length-1;i>=0;i--){var childResult=checkDecendents(children[i]);if(childResult)return childResult;var isFocusable=D2L.LP.Web.UI.Html.Dom.IsFocusable(children[i],includeHidden);if(isFocusable)return children[i]}return null};var recursiveFunc=
function(node,skipFocusCheck,ignoreChildren){if(!skipFocusCheck&&D2L.LP.Web.UI.Html.Dom.IsFocusable(node,includeHidden))return node;if(!ignoreChildren){var childResult=checkDecendents(node);if(childResult)return childResult}var prevSibling=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(prevSibling){var siblingResult=recursiveFunc(prevSibling,false,false);if(siblingResult)return siblingResult;return null}var parent=null;if(node.parentNode)parent=node.parentNode;else{var win=null;if(node.defaultView)win=
node.defaultView;else if(node.parentWindow)win=node.parentWindow;if(win!=null&&win.D2L)if(win.frameElement)if(win.frameElement.parentNode)parent=win.frameElement.parentNode}if(!parent)return null;var prevSiblingOfParent=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(parent);if(prevSiblingOfParent){var r=recursiveFunc(prevSiblingOfParent,false,false);if(r)return r}return null};var result=recursiveFunc(domNode,true,true);return result};
D2L.LP.Web.UI.Html.Dom.GetScrollPosition=function(w){w=w||window;var ret={top:0,left:0};if(w.pageYOffset!==undefined){ret.top=w.pageYOffset;ret.left=w.pageXOffset}else if(w.document.documentElement!==undefined&&w.document.documentElement.scrollTop!==undefined){ret.top=w.document.documentElement.scrollTop;ret.left=w.document.documentElement.scrollLeft}else if(w.document.body!==undefined){ret.top=w.document.body.scrollTop;ret.left=w.document.body.scrollLeft}return ret};
D2L.LP.Web.UI.Html.Dom.GetTextContent=function(node){if(node==null)return null;if(node.textContent!==undefined)return node.textContent;else if(node.innerText!==undefined)return node.innerText;else return null};
D2L.LP.Web.UI.Html.Dom.GetViewportSize=function(w){w=w||window;var ret={width:0,height:0};if(w.innerWidth!==undefined){ret.width=w.innerWidth;ret.height=w.innerHeight}else if(w.document.documentElement&&w.document.documentElement.clientWidth){ret.width=w.document.documentElement.clientWidth;ret.height=w.document.documentElement.clientHeight}else if(w.document.body){ret.width=w.document.body.clientWidth;ret.height=w.document.body.clientHeight}return ret};
D2L.LP.Web.UI.Html.Dom.HasAnyClassName=function(classNames,domNode){if(!classNames||!domNode||domNode.className===undefined)return false;for(var i=0;i<classNames.length;i++){var hasClass=$(domNode).hasClass(classNames[i]);if(hasClass)return true}return false};D2L.LP.Web.UI.Html.Dom.HasAttribute=function(node,attrName){if(node.hasAttribute!==undefined)return node.hasAttribute(attrName);else{var val=node.getAttribute(attrName);return val!==null&&val.length>0}};
D2L.LP.Web.UI.Html.Dom.HasClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return false;var hasClass=$(domNode).hasClass(className);return hasClass};
D2L.LP.Web.UI.Html.Dom.IndexOf=function(source,searchValue,from){from=from||0;if(source.indexOf!==undefined)return source.indexOf(searchValue,from);if(!D2L.LP.Web.UI.Html.JavaScript.IsArray(source))return;if(from>=source.length)return-1;for(;from<source.length;from++)if(source[from]===searchValue)return from;return-1};D2L.LP.Web.UI.Html.Dom.IndexOfElement=function(elem){var i=0;var e=elem;while(e=e.previousSibling)if(e.nodeType==1)i++;return i};
D2L.LP.Web.UI.Html.Dom.InsertElementAfter=function(elem,insertAfterElem){var nextElement=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(insertAfterElem);var parent=insertAfterElem.parentNode;if(nextElement!=null)parent.insertBefore(elem,nextElement);else parent.appendChild(elem)};D2L.LP.Web.UI.Html.Dom.IsAncestor=function(ancestorNode,node){var cur=node;while(cur){if(cur===ancestorNode)return true;cur=cur.parentNode}return false};
D2L.LP.Web.UI.Html.Dom.FocusableElements={a:true,body:true,button:true,frame:true,iframe:true,img:true,input:true,isindex:true,object:true,select:true,textarea:true};
D2L.LP.Web.UI.Html.Dom.IsFocusable=function(node,includeHidden){if(node===undefined||node===null||node.disabled)return false;if(!includeHidden){var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(node);if(!isVisible)return false}if(node.attachEvent){if(node.getAttributeNode){var tabIndexAttr=node.getAttributeNode("tabindex");if(tabIndexAttr!==null&&tabIndexAttr.specified)return tabIndexAttr.value>=0}var nodeName=node.nodeName.toLowerCase();if(D2L.LP.Web.UI.Html.Dom.FocusableElements[nodeName])return true;
return false}return node.tabIndex>=0};
D2L.LP.Web.UI.Html.Dom.IsVisible=function(domNode){if(domNode===undefined||domNode===null)return false;var isVisible=function(node){if(node.style===undefined)return true;if(node.style.visibility&&node.style.visibility!="visible"&&node.style.visibility!="inherit")return false;if(node.style.display&&node.style.display=="none")return false;if(D2L.LP.Web.UI.Html.Css.GetStyle(node,"visibility")!="visible"&&D2L.LP.Web.UI.Html.Css.GetStyle(node,"visibility")!="inherit")return false;if(D2L.LP.Web.UI.Html.Css.GetStyle(node,
"display")=="none")return false;return true};var visible=isVisible(domNode);if(visible){var _parentNode=domNode.parentNode;while(_parentNode!=null){var doc=null;var win=null;if(_parentNode.nodeName.toLowerCase()=="document")doc=_parentNode;else if(_parentNode.ownerDocument)doc=_parentNode.ownerDocument;if(doc!=null)win=doc.defaultView?doc.defaultView:doc.parentWindow;if(win!=null&&win.D2L){visible=isVisible(_parentNode);if(visible)_parentNode=_parentNode.parentNode;else break}else break}}return visible};
D2L.LP.Web.UI.Html.Dom.Navigate=function(location,formId){if(formId!==undefined&&formId!==null)D2L.LP.Web.UI.Common.Controls.Form.StopChangeTracking(formId);window.location.assign(location.GetUrl())};
D2L.LP.Web.UI.Html.Dom.OpenWindow=function(windowName,location,width,height,hasMenubar,hasToolbar){if(hasMenubar===undefined)hasMenubar=false;if(hasToolbar===undefined)hasToolbar=false;windowName=windowName.replace(/[^a-zA-Z0-9]+/g,"_");var features="";if(width>0)features+="width="+width+",";if(height>0)features+="height="+height+",";features+="location=1,"+"menubar="+(hasMenubar?"1":"0")+","+"resizable=1,"+"status=1,"+"scrollbars=1,"+"toolbar="+(hasToolbar?"1":"0");var w=window.open(location.GetUrl(),
windowName,features);w.focus()};
D2L.LP.Web.UI.Html.Dom.OverlayElement=function(elem,targetElem,insertAfterElem,position,verticalOffset,horizontalOffset,isAutoPosition,isAutoScroll,attachToBody){if(attachToBody===undefined)attachToBody=false;if(isAutoPosition===undefined)isAutoPosition=true;if(isAutoScroll===undefined)isAutoScroll=false;if(insertAfterElem===undefined)insertAfterElem=targetElem;if(position===undefined)position=D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse;if(verticalOffset===undefined)verticalOffset=0;if(horizontalOffset===
undefined)horizontalOffset=0;var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(isRTL){var RTLposition=position;if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Left)RTLposition=D2L.LP.Web.UI.Html.Style.OverlayPosition.Right;else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Right)RTLposition=D2L.LP.Web.UI.Html.Style.OverlayPosition.Left;position=RTLposition;horizontalOffset=-horizontalOffset}if(attachToBody)insertAfterElem=
document.body.lastChild;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(elem,insertAfterElem);elem.style.left="";elem.style.right="";elem.style.top="";elem.style.bottom="";var targetRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(targetElem,attachToBody);var elemRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem,attachToBody);var viewPortSize=D2L.LP.Web.UI.Html.Dom.GetViewportSize();var left;var top;if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){var clickPos=D2L.LP.Web.UI.Events.m_lastMouseDownPosition;
var scrollPos=D2L.LP.Web.UI.Html.Dom.GetScrollPosition();left=clickPos.x-scrollPos.left;top=clickPos.y-scrollPos.top;elem.style.position="fixed"}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Top){left=targetRect.left;top=targetRect.top-elemRect.height}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Right){left=targetRect.left+targetRect.width;top=targetRect.top}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom){left=targetRect.left+(isRTL?targetRect.width:0);
top=targetRect.top+targetRect.height}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Left){left=targetRect.left;top=targetRect.top}else throw"Invalid Overlay Position";left+=horizontalOffset;top+=verticalOffset;if(isRTL&&position!=D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse)left=left-elemRect.width;elem.style.left=left+"px";elem.style.top=top+"px";if(isAutoPosition||isAutoScroll){var offsetParent=D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent(elem);var offsetParentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(offsetParent);
var elemNewRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem);var body=document.body;if(offsetParent==body){offsetParentRect.bottom=viewPortSize.height;elemNewRect.bottom-=document.documentElement.scrollTop;offsetParentRect.top=0;elemNewRect.top-=document.documentElement.scrollTop}var rightDelta=offsetParentRect.right-elemNewRect.right;var leftDelta=elemNewRect.left-offsetParentRect.left;var topDelta=elemNewRect.top-offsetParentRect.top;var bottomDelta=offsetParentRect.bottom-elemNewRect.bottom;if(isRTL){leftDelta=
elemNewRect.left;rightDelta=elemNewRect.right}if(isAutoPosition){if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){if(left+elemRect.width>viewPortSize.width)left=left-elemRect.width;if(top+elemRect.height>viewPortSize.height)top=top-elemRect.height}else{if(!isRTL&&rightDelta<0&&leftDelta>=0)left=targetRect.left-(isRTL?0:elemRect.width);if(isRTL&&leftDelta<0&&rightDelta>=0)left=targetRect.left-(isRTL?0:elemRect.width);if(bottomDelta<0&&topDelta>=0)top=targetRect.top-elemRect.height}if(left>=
0)elem.style.left=left+"px";if(top>=0)elem.style.top=top+"px"}if(isAutoScroll){var scroll=false;var xScrollBy=0;var yScrollBy=0;if(rightDelta<0){xScrollBy=Math.abs(rightDelta)+10;scroll=true}if(leftDelta<0){xScrollBy=leftDelta-10;scroll=true}if(bottomDelta<0){yScrollBy=Math.abs(bottomDelta)+10;scroll=true}if(topDelta<0){yScrollBy=topDelta-10;scroll=true}if(scroll)scrollBy(xScrollBy,yScrollBy)}}};D2L.LP.Web.UI.Html.Dom.RemoveAttribute=function(node,attrName){node.removeAttribute(attrName)};
D2L.LP.Web.UI.Html.Dom.RemoveChildElements=function(domNode){if(domNode)domNode.innerHTML=""};D2L.LP.Web.UI.Html.Dom.RemoveClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return;$(domNode).removeClass(className)};D2L.LP.Web.UI.Html.Dom.RemoveClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null)D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,node)};
D2L.LP.Web.UI.Html.Dom.RemoveElement=function(elem){if(elem&&elem.parentNode)elem.parentNode.removeChild(elem)};D2L.LP.Web.UI.Html.Dom.RemoveElementById=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.RemoveElement(elem)};
D2L.LP.Web.UI.Html.Dom.RemoveEventListener=function(eventName,domNode,callback,useCapture){if(domNode.removeEventListener){useCapture=useCapture||false;if(eventName.length>2&&eventName.substr(0,2)=="on")eventName=eventName.substr(2);domNode.removeEventListener(eventName,callback,useCapture)}else if(domNode.detachEvent){if(eventName.substr(0,2)!="on")eventName="on"+eventName;domNode.detachEvent(eventName,callback)}};
D2L.LP.Web.UI.Html.Dom.SetAttribute=function(node,attrName,attrValue){node.setAttribute(attrName,attrValue)};D2L.LP.Web.UI.Html.Dom.SetIsDisplayed=function(id,isDisplayed){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("SetIsDisplayed Error. Node does not exist: '"+id.GetValue()+"'.");return}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isDisplayed)};
D2L.LP.Web.UI.Html.Dom.SetIsDisplayedMultiple=function(ids,isDisplayed){for(var i=0;i<ids.length;i++)D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(ids[i],isDisplayed)};D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode=function(node,isDisplayed){if(isDisplayed)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node);D2L.LP.Web.UI.Events.OnVisibilityChange.Trigger(node,isDisplayed)};
D2L.LP.Web.UI.Html.Dom.Storage={m_isSupported:undefined,IsSupported:function(){var me=D2L.LP.Web.UI.Html.Dom.Storage;if(me.m_isSupported!==undefined)return me.m_isSupported;if(!window.localStorage){me.m_isSupported=false;return false}try{window.localStorage.setItem("test","");window.localStorage.removeItem("test")}catch(e){return false}return true},LocalIgnore:{},Repo:{},Common:{Get:function(storage,key){var me=D2L.LP.Web.UI.Html.Dom.Storage;var val;if(me.IsSupported())val=storage.getItem(key);else val=
D2L.LP.Web.UI.Html.Dom.Storage.Repo[key];if(val===undefined)val=null;return val},Remove:function(storage,key,triggerLocalEvent){if(triggerLocalEvent===undefined)triggerLocalEvent=true;var me=D2L.LP.Web.UI.Html.Dom.Storage;var oldValue=D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(storage,key);var isIE=window.navigator.userAgent.indexOf("MSIE")>-1;if(me.IsSupported()){if(isIE)me.LocalIgnore[key]=true;storage.removeItem(key);if(isIE)setTimeout(function(){me.LocalIgnore[key]=false},100)}else D2L.LP.Web.UI.Html.Dom.Storage.Repo[key]=
null;var newValue=D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(storage,key);if(oldValue==newValue)return;if(triggerLocalEvent)D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:key,NewValue:null,OldValue:oldValue})},Set:function(storage,key,value,triggerLocalEvent){var me=D2L.LP.Web.UI.Html.Dom.Storage;if(triggerLocalEvent===undefined)triggerLocalEvent=true;value=value.toString();var oldValue=me.Common.Get(storage,key);if(oldValue==value)return;var isIE=window.navigator.userAgent.indexOf("MSIE")>-1;var success=
false;if(me.IsSupported())try{if(isIE)me.LocalIgnore[key]=true;storage.setItem(key,value);if(isIE)setTimeout(function(){me.LocalIgnore[key]=false},100);success=true}catch(e){D2L.LP.Web.UI.Html.JavaScript.Console.Error("Local storage: disabled or limit reached.",e)}if(!success)me.Repo[key]=value;if(triggerLocalEvent)D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:key,NewValue:value,OldValue:oldValue})}},Local:{Get:function(key){return D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(window.localStorage,key)},
Remove:function(key,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Remove(window.localStorage,key,triggerLocalEvent)},Set:function(key,value,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Set(window.localStorage,key,value,triggerLocalEvent)}},OnStorage:function(e){if(e.oldValue===e.newValue)return;if(D2L.LP.Web.UI.Html.Dom.Storage.LocalIgnore[e.key])return;try{D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:e.key,NewValue:e.newValue,OldValue:e.oldValue})}catch(e){}},Session:{Get:function(key){return D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(window.sessionStorage,
key)},Remove:function(key,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Remove(window.sessionStorage,key,triggerLocalEvent)},Set:function(key,value,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Set(window.sessionStorage,key,value,triggerLocalEvent)}}};
D2L.LP.Web.UI.Html.Dom.ToggleVisibility=function(id,animate){var $node=id.$();if($node.length===0){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("Toggle Visiblity Error. Node does not exist: '"+id.GetValue()+"'.");return}if(animate)if($node.hasClass("d2l-hidden"))$node.css("display","none").removeClass("d2l-hidden").slideToggle();else $node.slideToggle();else $node.toggleClass("d2l-hidden")};
D2L.LP.Web.UI.Html.JavaScript.If=function(){var args=arguments;var ret=new D2L.LP.Web.UI.Events.Event;var executeStatement=function(index){if(index==args.length){ret.Trigger();return}var condition=args[index];var func=args[index+1];if(!condition){index=index+2;executeStatement(index);return}var val=undefined;if(func!==undefined&&func!==null)val=func.call(func);if(val===undefined||val===null||val.AddListener===undefined){ret.Trigger();return}val.AddListener(function(){ret.Trigger()});val.AddReleaseListener(function(){ret.Release()})};
setTimeout(function(){executeStatement(0)});return ret};D2L.LP.Web.UI.Html.JavaScript.CallFunctionPipeline=function(){return D2L.LP.Web.UI.Html.JavaScript.CallFunctionArrayPipeline(arguments)};
D2L.LP.Web.UI.Html.JavaScript.CallFunctionArrayPipeline=function(funcs){var ret=new D2L.LP.Web.UI.Events.Event;var handleResult=function(result,index){if(typeof result!=="undefined"&&(result===null||result===false)){ret.Trigger(false);return}if(typeof result!=="undefined"&&result.AddListener!==undefined){result.AddListener(function(r){handleResult(r,index)});result.AddReleaseListener(function(){ret.Release()})}else callFunction(++index)};var callFunction=function(index){if(index==funcs.length){ret.Trigger(true);
return}if(funcs[index]===undefined||funcs[index]===null)callFunction(++index);else{var result=funcs[index].apply(funcs[index]);handleResult(result,index)}};setTimeout(function(){callFunction(0)},0);return ret};
D2L.LP.Web.UI.Html.JavaScript.HtmlEncode=function(value){if(value==undefined||value==null)return value;if(value.indexOf("&")!=-1)value=value.replace(/&/g,"&amp;");if(value.indexOf("<")!=-1)value=value.replace(/</g,"&lt;");if(value.indexOf(">")!=-1)value=value.replace(/>/g,"&gt;");if(value.indexOf('"')!=-1)value=value.replace(/"/g,"&quot;");return value};
D2L.LP.Web.UI.Html.JavaScript.ObjectAccessor=function(obj,property){if(obj[property]!==undefined)if(typeof obj[property]==="function")return obj[property]();else return obj[property];return null};window.oldSetTimeout=window.setTimeout;window.setTimeout=function(method,time){if(time===undefined||time===0)return D2L.LP.Web.UI.Html.JavaScript.SetImmediate(method);else return window.oldSetTimeout(method,time)};
D2L.LP.Web.UI.Html.JavaScript.SetImmediate=function(handle){if(window.setImmediate!==undefined)return window.setImmediate(handle);else if(window.msSetImmediate!==undefined)return window.msSetImmediate(handle);else return window.oldSetTimeout(handle)};
D2L.LP.Web.UI.Html.JavaScript.SetTimeoutWithEvent=function(method,time){var evt=new D2L.LP.Web.UI.Events.Event;setTimeout(function(){var result=method.call(method);if(result===undefined||result===null||result.AddListener===undefined){evt.Trigger(result);return}result.AddListener(function(r){evt.Trigger(r)});result.AddReleaseListener(function(){evt.Release()})},time);return evt};
D2L.LP.Web.UI.Html.JavaScript.IncludeScript=function(src,params){var evt=new D2L.LP.Web.UI.Events.Event;var sep=src.indexOf("?")>-1?"&":"?";for(var key in params){src+=sep+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(key)+"="+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(params[key]);sep="&"}var scripts=document.body.getElementsByTagName("script");for(var i=0;i<scripts.length;i++)if(scripts[i].src.length>=src.length&&scripts[i].src.substr(scripts[i].src.length-src.length)==src){setTimeout(function(){evt.Trigger()},
0);return evt}var script=document.createElement("script");script.type="text/javascript";if(script.readyState)script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;evt.Trigger()}};else script.onload=function(){evt.Trigger()};script.src=src;document.body.appendChild(script);return evt};
D2L.LP.Web.UI.Html.JavaScript.IncludeScriptBlock=function(js){var script=document.createElement("script");script.type="text/javascript";script.appendChild(document.createTextNode(js));document.body.appendChild(script);return script};
D2L.LP.Web.UI.Html.JavaScript.Int={Parse:function(value){var val=D2L.LP.Web.UI.Html.JavaScript.Int.TryParse(value,null);return val},TryParse:function(value,defaultValue){if(value===undefined||value===null)return defaultValue;var val=parseInt(value);if(isNaN(val))return defaultValue;return val}};D2L.LP.Web.UI.Html.Css={};
D2L.LP.Web.UI.Html.Css.GetStyle=function(elem,styleAttribute){if(elem!=null&&elem!=undefined)if(window.getComputedStyle!==undefined)return window.getComputedStyle(elem,null).getPropertyValue(styleAttribute);else if(elem.currentStyle[styleAttribute])return elem.currentStyle[styleAttribute]};
D2L.LP.Web.UI.Html.Css.Capability={SupportsTransition:function(){return document.body.style.transition!==undefined||document.body.style.MozTransition!==undefined||document.body.style.webkitTransition!==undefined||document.body.style.msTransition!==undefined}};
D2L.LP.Web.UI.Html.JavaScript.RpcReceiveJsPayloadProvider=function(data){if(data===undefined||data===null)return true;var events=[];for(var i=0;i<data.length;i++){var item=data[i];if(item.Type=="File")events.push(D2L.LP.Web.UI.Html.JavaScript.IncludeScript(item.Content));else D2L.LP.Web.UI.Html.JavaScript.IncludeScriptBlock(item.Content)}var evt=D2L.LP.Web.UI.Events.AggregateEvents(events);return evt};
D2L.LP.Web.UI.Html.JavaScript.RpcReceiveCssPayloadProvider=function(data){if(data===undefined||data===null)return;var itemContent=null;var includeStyleBlock=function(){if(itemContent!==null){D2L.LP.Web.UI.Html.Style.IncludeStyleBlock(itemContent);itemContent=null}};for(var i=0;i<data.length;i++){var item=data[i];if(item.Type=="File"){includeStyleBlock();D2L.LP.Web.UI.Html.Style.IncludeStyleSheet(item.Content)}else if(itemContent===null)itemContent=item.Content;else itemContent+=item.Content}includeStyleBlock()};
D2L.LP.Web.UI.Html.JavaScript.TrimString=function(type,str){if(typeof str!="string")throw"TrimString Error: given variable is not a string.";if(type===0)return str.replace(/^\s+|\s+$/g,"");else if(type===1)return str.replace(/^\s+/,"");else if(type===2)return str.replace(/\s+$/,"")};
D2L.LP.Web.UI.Html.JavaScript.HtmlEncode=function(value){if(value==undefined||value==null)return value;if(value.indexOf("&")!=-1)value=value.replace(/&/g,"&amp;");if(value.indexOf("<")!=-1)value=value.replace(/</g,"&lt;");if(value.indexOf(">")!=-1)value=value.replace(/>/g,"&gt;");if(value.indexOf('"')!=-1)value=value.replace(/"/g,"&quot;");return value};
D2L.LP.Web.UI.Html.JavaScript.UrlEncode=function(value){if(value==undefined||value==null)return value;var encodedValue=encodeURIComponent(value);return encodedValue};D2L.LP.Web.UI.Html.JavaScript.UrlEncodePath=function(value){if(value==undefined||value==null)return value;var encodedValue="";var urlComponents=value.split("/");for(var i=0;i<urlComponents.length;i++)if(i==0)encodedValue+=encodeURIComponent(urlComponents[i]);else encodedValue+="/"+encodeURIComponent(urlComponents[i]);return encodedValue};
D2L.LP.Web.UI.Html.JavaScript.IsArray=function(obj){if(obj&&obj.pop&&obj.push)return true;return false};D2L.VS=function(varName,obj){D2L.V[varName]=obj};D2L.VG=function(varName){return D2L.V[varName]};D2L.VINS=function(varName){return D2L.V[varName]===undefined};D2L.V={};D2L.VDS=function(dictName,varName,obj){if(!D2L.VD[dictName])D2L.VD[dictName]={};D2L.VD[dictName][varName]=obj};D2L.VDG=function(dictName,varName){if(D2L.VD[dictName])return D2L.VD[dictName][varName];return null};D2L.VD={};
D2L.VAA=function(arrayName,obj){if(!D2L.VA[arrayName])D2L.VA[arrayName]=[];D2L.VA[arrayName].push(obj)};D2L.VAG=function(arrayName,index){if(D2L.VA[arrayName])return D2L.VA[arrayName][index];return null};D2L.VAGA=function(arrayName){if(D2L.VA[arrayName])return D2L.VA[arrayName];return[]};D2L.VA={};
D2L.LP.Web.UI.Html.Math={AnnotateMathML:function(encoding,title,originalMath,mathML){if(title===undefined)title="";var mathStartRegEx=/<math[^>]*>/i;var mathEndRegEx=/<\/math>/i;var mathBlockRegEx=/(display="block"|display='block')/gi;var mathStyleRegEx=/(style="(.*?)")/i;var mathStart=mathStartRegEx.exec(mathML);var mathMLContent=mathML.replace(/<math[^>]*>/gi,"").replace(/<\/math>/gi,"");var mathDisplayStyle=mathBlockRegEx.test(mathStart)?' display="block"':"";var mathStyleMatch=mathStyleRegEx.exec(mathStart);
var style="";var encode;if(D2L.LP.Web.UI.Html.JavaScript.HtmlEncode!=undefined)encode=D2L.LP.Web.UI.Html.JavaScript.HtmlEncode;else encode=D2L.Util.Html.Encode;if(mathStyleMatch!=null)style=mathStyleMatch[1];var encodedMath=encode(originalMath);var annotatedMathML='<math title="'+title+'" '+style+' xmlns="http://www.w3.org/1998/Math/MathML"'+mathDisplayStyle+"><semantics><mstyle>"+mathMLContent+'</mstyle><annotation encoding="'+encoding+'">'+'{"version":"1.1","math":"'+D2L.LP.Web.UI.Html.Math.EncodeMathML(encodedMath)+
'"}'+"</annotation></semantics></math>";return annotatedMathML},EncodeMathML:function(str){if(str.indexOf("&")!=-1||str.indexOf("<")!=-1||str.indexOf(">")!=-1||str.indexOf('"')!=-1){str=str.replace(/\&/g,"&amp;");str=str.replace(/\</g,"&lt;");str=str.replace(/\>/g,"&gt;");str=str.replace(/\"/g,"&quot;");var decodeCharRef=function(match){return match.replace("&amp;amp;","&")};str=str.replace(/&amp;amp;[\S]*?;/g,decodeCharRef)}return str},DecodeMathML:function(str){if(str.indexOf("&")!=-1){str=str.replace(/&amp;/g,
"&");str=str.replace(/&lt;/g,"<");str=str.replace(/&gt;/g,">");str=str.replace(/&quot;/g,'"')}return str},GetMath:function(node,callback){if(MathJax===undefined)return;MathJax.Hub.Queue(function(){var math=[];var allJax=MathJax.Hub.getAllJax(node);if(allJax!=null&&allJax.length>0)for(var i=0;i<allJax.length;i++){var jax=allJax[i];if(jax.root!==undefined&&jax.root.toMathML!==undefined)math.push({"originalMath":jax.originalText,"mathML":jax.root.toMathML()})}callback.call(callback,math)});return},Update:function(callback){D2L.LP.Web.UI.Html.Math.UpdateNode(null,
callback)},UpdateNode:function(node,callback){if(window.MathJax===undefined||window.MathJax===null){if(callback!==undefined&&callback!==null)callback.call(callback);return}if(node.nodeType!==9&&node.nodeType!==1)return;if(node!==null)MathJax.Hub.Queue(["Typeset",MathJax.Hub,node]);else MathJax.Hub.Queue(["Typeset",MathJax.Hub]);if(callback!==undefined&&callback!==null)MathJax.Hub.Queue(function(){callback.call(callback)})}};
D2LMathML={IsLatex:false,m_message:"",MobileInit:function(message){D2LMathML.m_message=message},DesktopInit:function(mathMLUrl,latexUrl){(function(){var head=document.getElementsByTagName("head")[0];var configScript='MathJax.Hub.Config({ delayStartupUntil: "onload",showProcessingMessages: false, messageStyle: "none", showMathMenu: true, showMathMenuMSIE: true, menuSettings: { context: "MathJax", zoom: "None" },NativeMML: { showMathMenuMSIE: false, scale: 140 }, "HTML-CSS": { linebreaks: { automatic: true, width: "container"}, imageFont: null, scale: 130 } });';
var script=document.createElement("script");script.type="text/x-mathjax-config";script.textContent=configScript;head.appendChild(script);var mathJaxScript=document.createElement("script");mathJaxScript.type="text/javascript";mathJaxScript.src=D2LMathML.IsLatex?latexUrl:mathMLUrl;head.appendChild(mathJaxScript)})()}};D2L.LP.Web.UI.Html.PartialRendering={};
D2L.LP.Web.UI.Html.PartialRendering={_includeClasses:[],AddClassNameToFocusIncludeList:function(className){D2L.LP.Web.UI.Html.PartialRendering._includeClasses[className]=true},InjectResult:function(placeholder,result,animationType,reviver,isInnerReplacement,pathToActiveElement){animationType=animationType||D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.None;var hasAnimation=animationType!=D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.None;var placeholderId=placeholder.getAttribute("id");
var prc=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId);var doInnerReplacement=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-placeholder-inner",placeholder);var firstNewNode=null;var parentNode=placeholder.parentNode;if(parentNode!==null){var validClassNames=[];var validateClassNames=false;if(prc!==null){validClassNames=prc.GetValidClassNames();validateClassNames=validClassNames!==null&&validClassNames.length>0}var temp=document.createElement("div");temp.innerHTML=result.Html;
var nodes=[];var fragment=document.createDocumentFragment();while(temp.firstChild){var isClassNameValid=true;if(validateClassNames&&temp.firstChild.nodeType==1)isClassNameValid=D2L.LP.Web.UI.Html.Dom.HasAnyClassName(validClassNames,temp.firstChild);if(!isClassNameValid)throw" The partial view contains nodes that are not valid in "+"the current context.  The partial view node has class name: "+temp.firstChild.className+", but the valid class names "+"for this context are: "+prc.GetValidClassNames()+
".";var newChild=fragment.appendChild(temp.firstChild);if(firstNewNode===null&&newChild.nodeType==1)firstNewNode=newChild;nodes.push(newChild)}var placeholderClone=null;if(hasAnimation)placeholderClone=D2L.LP.Web.UI.Html.PartialRendering.Animation.CloneForAnimation(placeholder);placeholder.innerHTML="";if(doInnerReplacement){placeholder.appendChild(fragment);D2L.LP.Web.UI.Events.OnViewRender.Trigger(placeholder)}else{parentNode.insertBefore(fragment,placeholder);parentNode.removeChild(placeholder);
for(var i=0;i<nodes.length;i++)D2L.LP.Web.UI.Events.OnViewRender.Trigger(nodes[i])}}for(var i=0;i<result.OnInit.length;i++)eval(result.OnInit[i]);for(var i=0;i<result.OnLoad.length;i++)eval(result.OnLoad[i]);var startAnimation=function(){var newNodesClone=[];for(var i=0;i<nodes.length;i++)newNodesClone.push(D2L.LP.Web.UI.Html.PartialRendering.Animation.CloneForAnimation(nodes[i]));D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateResult(animationType,firstNewNode,placeholderClone,newNodesClone)};
if(hasAnimation&&D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition())startAnimation();if(result.HistoryEntryLocation!==null&&result.HistoryEntryTitle!==null){D2L.LP.Web.UI.Html.JavaScript.History.Push(result.HistoryEntryLocation,result.HistoryEntryTitle,reviver);if(placeholder.parentNode!==null){var frag=D2L.LP.Web.UI.Desktop.Controls.Fragment.Build(placeholderId+"_focus");placeholder.parentNode.insertBefore(frag,placeholder);window.scrollTo(frag.offsetLeft,frag.offsetTop+frag.firstChild.offsetTop);
placeholder.parentNode.removeChild(frag)}if(firstNewNode!==null){var firstFocusable=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(firstNewNode);D2L.LP.Web.UI.Html.Dom.FocusNode(firstFocusable)}}else{var currNode=D2L.LP.Web.UI.Html.PartialRendering.FindElementByPath(pathToActiveElement,isInnerReplacement?placeholder:firstNewNode);if(currNode===null){var ph=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId);currNode=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(ph)}D2L.LP.Web.UI.Html.Dom.FocusNode(currNode)}return firstNewNode},
PartialRender:function(id,provider,animationType){D2L.LP.Web.UI.Html.PartialRendering.OnBefore.Trigger(id);var ret=new D2L.LP.Web.UI.Events.Event;var placeholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(placeholder===null){ret.Release();throw"Placeholder not found: '"+id.GetValue()+"'.";}var isInnerReplacement=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-placeholder-inner",placeholder);var hasLoading=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-loading",placeholder).length>0;var shim=
null,shim2=null;var done=false;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(placeholder);if(rect!==null){shim=document.createElement("div");shim.className="d2l-partial-render-shim1";shim2=document.createElement("div");shim2.className="d2l-partial-render-shimbg1";shim.style.top=shim2.style.top=rect.top+"px";shim.style.left=shim2.style.left=rect.left+"px";shim.style.width=shim2.style.width=rect.width+"px";shim.style.height=shim2.style.height=rect.height+"px";document.body.appendChild(shim);document.body.appendChild(shim2);
setTimeout(function(){if(!hasLoading&&!done){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-partial-render-shim2",shim);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-branding-bg",shim);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-partial-render-shimbg2",shim2)}},500)}var deleteShim=function(){if(shim!==null&&shim.parentNode!==null)shim.parentNode.removeChild(shim);if(shim2!==null&&shim2.parentNode!==null)shim2.parentNode.removeChild(shim2)};var finish=function(val){deleteShim();ret.Trigger(val);D2L.LP.Web.UI.Html.PartialRendering.OnAfter.Trigger(id)};
var activeElement=D2L.LP.Web.UI.Html.Dom.GetActiveElement(document);var pathToActiveElement=D2L.LP.Web.UI.Html.PartialRendering.GeneratePathToNode(activeElement,placeholder);var handleResult=function(result){done=true;if(!result){finish(false);return}placeholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(placeholder===null){finish(false);return}D2L.LP.Web.UI.Html.PartialRendering.InjectResult(placeholder,result,animationType,function(){D2L.LP.Web.UI.Html.PartialRendering.PartialRender(id,
provider,animationType)},isInnerReplacement,pathToActiveElement);finish(true)};var evt=provider.call(provider);evt.AddListener(handleResult);evt.AddReleaseListener(function(){ret.Release()});return ret},GetPartialRenderContext:function(placeholderId){var prc=null;if(placeholderId!==null)prc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,0);if(prc===null)prc=new D2L.LP.Web.UI.Html.PartialRendering.PartialHtmlRenderContext;var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId);
if(placeholderNode&&D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-primary",placeholderNode)!=null)prc.SetHasActiveForm(true);return prc},GeneratePathToNode:function(startNode,endNode){var path=[];var currElement=startNode;if(startNode==null||startNode==undefined||endNode==null||endNode==undefined)return[];while(true){var nodeIndex=D2L.LP.Web.UI.Html.Dom.IndexOfElement(currElement);path.push({tagName:currElement.tagName,className:currElement.className,childIndex:nodeIndex});if(currElement==
endNode)break;currElement=currElement.parentNode;if(currElement==null){path=[];break}}return path},FindElementByPath:function(path,rootNode){if(path===undefined||path===null||path.length===0)return false;if(!D2L.LP.Web.UI.Html.PartialRendering.CompareElements(path[path.length-1],rootNode))return false;var currNode=rootNode;for(var j=path.length-2;j>=0;j--){var pathElem=D2L.LP.Web.UI.Html.PartialRendering.FindMatchingElementInChildren(path[j],currNode);if(pathElem===null){currNode=null;break}currNode=
pathElem}return currNode},FindMatchingElementInChildren:function(refElem,parent){if(parent===undefined||parent===null)return null;var children=D2L.LP.Web.UI.Html.PartialRendering.GetChildNodes(parent);for(var i=0;i<children.length;i++)if(D2L.LP.Web.UI.Html.Dom.IndexOfElement(children[i])==refElem.childIndex&&D2L.LP.Web.UI.Html.PartialRendering.CompareElements(refElem,children[i]))return children[i];return null},GetChildNodes:function(parent){var children=[];var parentChildren=parent.childNodes;for(var i=
parentChildren.length;i>=0;i--)if(parentChildren[i]!==undefined&&parentChildren[i]!==null&&parentChildren[i].nodeType==1)children.push(parentChildren[i]);return children},RegexD2lClassName:/d2l_[0-9]*_[0-9]*_[0-9]*/,CompareElements:function(elem1,elem2){if(elem1==null||elem1==undefined||elem2==null||elem2==undefined)return false;if(elem1.tagName!=elem2.tagName)return false;var classes=D2L.LP.Web.UI.Html.PartialRendering.GetClassNamesForMatching(elem1);var classes2=D2L.LP.Web.UI.Html.PartialRendering.GetClassNamesForMatching(elem2);
if(classes.length!=classes2.length)return false;var numClassNameMatches=0;for(var i=0;i<classes.length;i++){if(!D2L.LP.Web.UI.Html.PartialRendering.RegexD2lClassName.test(classes[i]))if(!D2L.LP.Web.UI.Html.Dom.HasClassName(classes[i],elem2))break;numClassNameMatches++}return numClassNameMatches==classes.length},GetClassNamesForMatching:function(elem){var classNames=elem.className.split(" ");var validClassNames=[];for(var i=classNames.length-1;i>=0;i--){var className=classNames[i];if(className in D2L.LP.Web.UI.Html.PartialRendering._includeClasses)validClassNames.push(className)}return validClassNames}};
D2L.LP.Web.UI.Html.PartialRendering.Animation={AnimateResult:function(animationType,firstNewNode,placeholderClone,newNodesClone){switch(animationType){case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeft:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRight:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRightWithFade:var isSlideLeft=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade||
animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeft;var hasHFade=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRightWithFade;D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateHorizontalSlide(isSlideLeft,hasHFade,firstNewNode,placeholderClone,newNodesClone);break;case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUp:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDown:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDownWithFade:var isSlideUp=
animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUp;var hasVFade=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDownWithFade;D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateVerticalSlide(isSlideUp,hasVFade,firstNewNode,placeholderClone,newNodesClone);break}},AnimateHorizontalSlide:function(isSlideLeft,
hasFade,firstNewNode,placeholderClone,newNodesClone){var isRTLCulture=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(isRTLCulture)isSlideLeft=!isSlideLeft;var animationDuration=400;var separatorWidth=10;var prevWidth=placeholderClone.d2l_boundingRect.width;var sliderOpener=document.createElement("div");sliderOpener.className="d2l-partial-render-animation-horizontal-slider-opener";D2L.LP.Web.UI.Html.Aria.SetRole(sliderOpener,
"presentation");var sliderWindow=document.createElement("div");sliderWindow.className="d2l-partial-render-animation-horizontal-slider-window";sliderOpener.appendChild(sliderWindow);var slider=document.createElement("div");slider.className="d2l-partial-render-animation-horizontal-slider";sliderWindow.appendChild(slider);var sliderPrevPanel=document.createElement("div");sliderPrevPanel.className="d2l-partial-render-animation-horizontal-slider-prev";sliderPrevPanel.style.width=prevWidth+"px";D2L.LP.Web.UI.Html.Aria.SetRole(sliderPrevPanel,
"presentation");var separatorPanel=document.createElement("div");separatorPanel.className="d2l-partial-render-animation-horizontal-slider-separator";separatorPanel.style.width=separatorWidth+"px";separatorPanel.style.height="1px";var sliderNextPanel=document.createElement("div");sliderNextPanel.className="d2l-partial-render-animation-horizontal-slider-next";D2L.LP.Web.UI.Html.Aria.SetRole(sliderNextPanel,"presentation");if(isSlideLeft){slider.appendChild(sliderPrevPanel);slider.appendChild(separatorPanel);
slider.appendChild(sliderNextPanel);if(isRTLCulture)slider.style.left=prevWidth+"px";else slider.style.left="0px"}else{slider.appendChild(sliderNextPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderPrevPanel);if(isRTLCulture)slider.style.left="0px";else slider.style.left=-(prevWidth+separatorWidth)+"px"}if(hasFade){sliderNextPanel.style.opacity=0;sliderPrevPanel.style.opacity=1}var clearFloat=document.createElement("div");clearFloat.className="d2l-clear";slider.appendChild(clearFloat);
sliderPrevPanel.appendChild(placeholderClone);for(var i=0;i<newNodesClone.length;i++)sliderNextPanel.appendChild(newNodesClone[i]);firstNewNode.parentNode.insertBefore(sliderOpener,firstNewNode);var newContentBoundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(sliderNextPanel);slider.style.width=prevWidth+newContentBoundingRect.width+separatorWidth+"px";sliderWindow.style.width=newContentBoundingRect.width+"px";var startAnimation=function(){setTimeout(finishAnimation,animationDuration);if(isSlideLeft)if(isRTLCulture)slider.style.left=
"0px";else slider.style.left=-(prevWidth+separatorWidth)+"px";else if(isRTLCulture)slider.style.left=prevWidth+separatorWidth+"px";else slider.style.left="0px";if(hasFade){sliderNextPanel.style.opacity=1;sliderPrevPanel.style.opacity=0}};var finishAnimation=function(){sliderOpener.parentNode.removeChild(sliderOpener)};setTimeout(startAnimation,0)},AnimateVerticalSlide:function(isSlideUp,hasFade,firstNewNode,placeholderClone,newNodesClone){var animationDuration=400;var separatorHeight=10;var prevHeight=
placeholderClone.d2l_boundingRect.height;var sliderOpener=document.createElement("div");sliderOpener.className="d2l-partial-render-animation-vertical-slider-opener";D2L.LP.Web.UI.Html.Aria.SetRole(sliderOpener,"presentation");var sliderWindow=document.createElement("div");sliderWindow.className="d2l-partial-render-animation-vertical-slider-window";sliderOpener.appendChild(sliderWindow);var slider=document.createElement("div");slider.className="d2l-partial-render-animation-vertical-slider";sliderWindow.appendChild(slider);
var sliderPrevPanel=document.createElement("div");sliderPrevPanel.className="d2l-partial-render-animation-vertical-slider-prev";sliderPrevPanel.style.height=prevHeight+"px";D2L.LP.Web.UI.Html.Aria.SetRole(sliderPrevPanel,"presentation");var separatorPanel=document.createElement("div");separatorPanel.className="d2l-partial-render-animation-vertical-slider-separator";separatorPanel.style.height=separatorHeight+"px";separatorPanel.style.width="1px";var sliderNextPanel=document.createElement("div");sliderNextPanel.className=
"d2l-partial-render-animation-vertical-slider-next";D2L.LP.Web.UI.Html.Aria.SetRole(sliderNextPanel,"presentation");if(isSlideUp){slider.appendChild(sliderPrevPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderNextPanel);slider.style.top="0px"}else{slider.appendChild(sliderNextPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderPrevPanel);slider.style.top=-(prevHeight+separatorHeight)+"px"}if(hasFade){sliderNextPanel.style.opacity=0;sliderPrevPanel.style.opacity=1}sliderPrevPanel.appendChild(placeholderClone);
for(var i=0;i<newNodesClone.length;i++)sliderNextPanel.appendChild(newNodesClone[i]);firstNewNode.parentNode.insertBefore(sliderOpener,firstNewNode);var newContentBoundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(sliderNextPanel);slider.style.height=prevHeight+newContentBoundingRect.height+separatorHeight+"px";sliderWindow.style.height=newContentBoundingRect.height+"px";var startAnimation=function(){setTimeout(finishAnimation,animationDuration);if(isSlideUp)slider.style.top=-(prevHeight+separatorHeight)+
"px";else slider.style.top="0px";if(hasFade){sliderNextPanel.style.opacity=1;sliderPrevPanel.style.opacity=0}};var finishAnimation=function(){sliderOpener.parentNode.removeChild(sliderOpener)};setTimeout(startAnimation,0)},CloneForAnimation:function(node){var cleanupAttributes=function(attrElement){D2L.LP.Web.UI.Html.Aria.RemoveAttribute(attrElement,"live");attrElement.removeAttribute("name");attrElement.removeAttribute("id")};var clone=node.cloneNode(true);if(clone.nodeType==1){var allElems=clone.all?
clone.all:clone.getElementsByTagName("*");for(var i=0;i<allElems.length;i++){var elem=allElems[i];cleanupAttributes(elem)}cleanupAttributes(clone);var boundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);clone.style.width=boundingRect.width+"px";clone.d2l_boundingRect=boundingRect}return clone}};D2L.LP.Web.UI.Html.PartialRendering.Animation.Types={None:0,SlideLeft:1,SlideRight:2,SlideLeftWithFade:3,SlideRightWithFade:4,SlideUp:5,SlideDown:6,SlideUpWithFade:7,SlideDownWithFade:8};
D2L.LP.Web.UI.Html.PartialRendering.PartialHtmlRenderContext=D2L.Class.Create({Construct:function(){this.m_headingLevel=1;this.m_scope="";this.m_childScopeCounters="";this.m_validClassNames=[];this.m_hasActiveForm=false;this.m_isPrintMode=false},_deserialize:function(deserializer){this.m_headingLevel=deserializer.GetMember("HeadingLevel");this.m_scope=deserializer.GetMember("Scope");if(deserializer.HasMember("ChildScopeCounters"))this.m_childScopeCounters=deserializer.GetMember("ChildScopeCounters");
this.m_validClassNames=deserializer.GetMember("ValidClassNames");if(deserializer.HasMember("IsPrintMode"))this.m_isPrintMode=deserializer.GetMember("IsPrintMode")},_serialize:function(serializer){serializer.AddMember("headingLevel",this.m_headingLevel);serializer.AddMember("scope",this.m_scope);if(this.m_childScopeCounters)serializer.AddMember("childScopeCounters",this.m_childScopeCounters);serializer.AddMember("validClassNames",this.m_validClassNames);serializer.AddMember("hasActiveForm",this.m_hasActiveForm);
if(this.m_isPrintMode)serializer.AddMember("isPrintMode",this.m_isPrintMode)},GetValidClassNames:function(){return this.m_validClassNames},SetHasActiveForm:function(hasActiveForm){this.m_hasActiveForm=hasActiveForm}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Html.PartialRendering.OnAfter=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Html.ReturnPoints={LocalStorageKey:"ReturnPoints",Get:function(key,defaultLocation){var me=D2L.LP.Web.UI.Html.ReturnPoints;me.ValidateKey(key);me.ValidateLocation(defaultLocation);var data=me.Read();for(var i=data.length-1;i>-1;i--)if(data[i].key===key){var location=new D2L.LP.Web.Http.UrlLocation(data[i].url);data=data.slice(0,i);me.Write(data);return location}return defaultLocation},Set:function(key,location){var me=D2L.LP.Web.UI.Html.ReturnPoints;if(location===undefined)location=
new D2L.LP.Web.Http.UrlLocation(document.location.href);location.RemoveQueryString("dst");me.ValidateKey(key);me.ValidateLocation(location);var data=me.Read();var entry={key:key,url:location.GetUrl()};data.push(entry);me.Write(data)},TryPeek:function(key){var me=D2L.LP.Web.UI.Html.ReturnPoints;me.ValidateKey(key);var data=me.Read();for(var i=data.length-1;i>-1;i--)if(data[i].key===key){var location=new D2L.LP.Web.Http.UrlLocation(data[i].url);return location}return null},Read:function(){var me=D2L.LP.Web.UI.Html.ReturnPoints;
var json=D2L.LP.Web.UI.Html.Dom.Storage.Session.Get(me.LocalStorageKey);if(json===null||json.length===0)return[];var data=D2L.LP.Web.Serialization.Json.Deserialize(json);return data},Reset:function(){var me=D2L.LP.Web.UI.Html.ReturnPoints;D2L.LP.Web.UI.Html.Dom.Storage.Session.Remove(me.LocalStorageKey)},ValidateKey:function(key){if(key===undefined||key===null||key.length===0)throw"Invalid key.";},ValidateLocation:function(location){if(location===undefined||location===null)throw"Invalid location.";
},Write:function(data){var me=D2L.LP.Web.UI.Html.ReturnPoints;if(data.length===0)me.Reset();var json=JSON.stringify(data);D2L.LP.Web.UI.Html.Dom.Storage.Session.Set(me.LocalStorageKey,json,false)}};D2L.LP.Web.UI.Html.Style={};D2L.LP.Web.UI.Html.Style.OverlayPosition={Top:1,Right:2,Bottom:3,Left:4,Mouse:5};
D2L.LP.Web.UI.Html.Style.IncludeStyleSheet=function(src,params){var head=document.getElementsByTagName("head");if(head.length!=1)return;var sep=src.indexOf("?")>-1?"&":"?";for(var key in params){src+=sep+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(key)+"="+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(params[key]);sep="&"}var styles=document.getElementsByTagName("style");if(styles.length>0){var reSrc=src.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");if(styles[0].innerHTML.search(new RegExp("@import url\\('.*"+
reSrc+"'\\);","gm"))>-1)return}var links=document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var href=links[i].href;if(href.length>=src.length){var end=href.substr(href.length-src.length);if(end==src)return}}var link=document.createElement("link");link.rel="stylesheet";link.type="text/css";link.href=src;head[0].appendChild(link)};
D2L.LP.Web.UI.Html.Style.IncludeStyleBlock=function(css){var head=document.getElementsByTagName("head");if(head.length!=1)return;var lastStyle=document.getElementById("d2l-style-block");if(lastStyle){css=lastStyle.innerHTML+css;lastStyle.parentNode.removeChild(lastStyle)}var style=document.createElement("style");style.id="d2l-style-block";style.type="text/css";try{style.appendChild(document.createTextNode(css))}catch(e){if(style.styleSheet)style.styleSheet.cssText=css}head[0].appendChild(style);return style};
D2L.Control.Button=D2L.Control.extend({Construct:function(text){arguments.callee.$.Construct.call(this);this.m_float=D2L.Style.Float.None;this.m_isEnabled=true;this.m_isDisplayed=true;this.m_isPrimary=false;this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Button","Constructor","text");this.m_title=null;this.m_onClick=null;this.m_clickTime=null},BuildDom:function(){if(this.IsRendered())return null;arguments.callee.$.BuildDom.call(this);var win=this.GetWindow();var b=win.D2L.LP.Web.UI.Common.Controls.Button;
var node=b.Build(win.document);this.SetDomNode(node);var me=this;this.OnDomInsertion.RegisterMethod(function(){b.Init(node);me.SetFloat(me.m_float);me.SetIsDisplayed(me.m_isDisplayed);me.SetIsEnabled(me.m_isEnabled);me.SetIsPrimary(me.m_isPrimary);me.SetText(me.m_text);if(me.m_title!==me)me.SetTitle(me.m_title);if(me.m_onClick!==null)b.SetOnClickNode(node,me.m_onClick)});return node},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var node=
this.GetDomNode();$(node).vui_button();this.m_isEnabled=this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.IsEnabledNode(node);this.m_isDisplayed=this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.IsVisibleNode(node);this.m_isPrimary=this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.IsPrimaryNode(node);this.m_text=new D2L.LP.Text.PlainText(this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.GetTextNode(node));this.m_title=new D2L.LP.Text.PlainText(this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.GetTitleNode(node));
if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-left",node))this.m_float=D2L.Style.Float.Left;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-right",node))this.m_float=D2L.Style.Float.Right;this.SetOnClick(new Function(deserializer.GetMember()))},Click:function(){if(!this.IsRendered())return;this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.ClickNode(this.GetDomNode())},Focus:function(){if(this.IsRendered()&&this.IsDisplayed())this.GetDomNode().focus()},GetFloat:function(){return this.m_float},GetName:function(){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Button.GetName() is obsolete. "+
"Use GetControlId() instead."),true);return this.GetControlId().ID()},GetText:function(){return this.m_text},Hide:function(){this.SetIsDisplayed(false)},IsDisplayed:function(){return this.m_isDisplayed},IsEnabled:function(){return this.m_isEnabled},IsPrimary:function(){return this.m_isPrimary},SetIsDisplayed:function(isDisplayed){if(isDisplayed===this.IsDisplayed())return;this.m_isDisplayed=isDisplayed;if(!this.IsRendered())return;this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.SetIsVisibleNode(this.GetDomNode(),
isDisplayed);var e=new D2L.TransformEvent(this.GetDomNode());e.Bubble()},SetFloat:function(val){this.m_float=val;if(!this.IsRendered())return;var node=this.GetDomNode();D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-left",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-right",node);if(this.m_float==D2L.Style.Float.Left)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-left",node);else if(this.m_float==D2L.Style.Float.Right)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-right",node)},SetIsEnabled:function(isEnabled){this.m_isEnabled=
isEnabled;if(this.IsRendered())this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabledNode(this.GetDomNode(),isEnabled)},SetIsPrimary:function(isPrimary){this.m_isPrimary=isPrimary;if(this.IsRendered())this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.SetIsPrimaryNode(this.GetDomNode(),isPrimary)},SetOnClick:function(onClick){if(!onClick)return;var navInfo=new D2L.NavInfo;navInfo.SetOnClick(onClick);this.SetNav(navInfo)},SetNav:function(navInfo){if(!navInfo)return;var navStruct=navInfo.SetupHrefOnClick(this,
false);var me=this;this.m_onClick=function(){navStruct.OnClick.call(me)};if(this.IsRendered())this.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(this.GetDomNode(),this.m_onClick)},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Button","SetText","text");if(!this.IsRendered())return;var me=this;this.m_text.GetText().Register(function(val){me.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(me.GetDomNode(),val)})},SetTitle:function(title){this.m_title=
D2L.LP.Text.IText.Normalize(title,"D2L.Control.Button","SetTitle","title");if(!this.IsRendered())return;var me=this;this.m_title.GetText().Register(function(val){me.GetWindow().D2L.LP.Web.UI.Common.Controls.Button.SetTitleNode(me.GetDomNode(),val)})},Show:function(){this.SetIsDisplayed(true)}});
D2L.Button=D2L.Control.Button.extend({Construct:function(name,text,onClick){arguments.callee.$.Construct.call(this,text);if(name!==undefined)this.SetControlId(name);if(onClick!==undefined)this.SetOnClick(onClick);UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("D2L.Button( name, text, onClick ) "+"constructor is obsolete. Use D2L.Control.Button( text ) "+"instead."),true)}});
D2L.Control.Button.Type={Custom:0,Cancel:1,Ok:2,Yes:3,No:4,Save:5,Create:6,Copy:7,Insert:8,Close:9,Add:10,Back:11,Next:12};
D2L.Control.Button.GetTermForType=function(type){var term=null;if(type==D2L.Control.Button.Type.Cancel)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnCancel");else if(type==D2L.Control.Button.Type.Ok)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk");else if(type==D2L.Control.Button.Type.Yes)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnYes");else if(type==D2L.Control.Button.Type.No)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnNo");else if(type==D2L.Control.Button.Type.Save)term=
new D2L.LP.Text.LangTerm("Standard.Buttons.btnSave");else if(type==D2L.Control.Button.Type.Create)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnCreate");else if(type==D2L.Control.Button.Type.Copy)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnCopy");else if(type==D2L.Control.Button.Type.Insert)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnInsert");else if(type==D2L.Control.Button.Type.Close)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnClose");else if(type==D2L.Control.Button.Type.Add)term=
new D2L.LP.Text.LangTerm("Standard.Buttons.btnAdd");else if(type==D2L.Control.Button.Type.Back)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnBack");else if(type==D2L.Control.Button.Type.Next)term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnNext");else term=new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk");return term};
D2L.Control.Container=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_height=null;this.m_hasTitle=false;this.m_isCollapsible=false;this.m_isCollapseAnimated=false;this.m_collapseAnimationSpeed="0.2";this.m_title=new D2L.LP.Text.PlainText;this.m_titleNode=null;this.m_collapseImg=null;this.m_isDisplayed=true;this.m_isExpanded=true;this.m_mergeTitleWithContent=true;this.m_border=new D2L.Style.BorderInfo;this.m_borderRadius=0;this.m_backgroundColour=null;this.m_float=
D2L.Style.Float.None;this.m_padding=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding);this.m_spacing=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing);this.m_ddObject=null;this.m_dragDropMode=D2L.DragDrop.Modes.None;this.m_dragDropInfo=null;this.m_contextMenuPlaceHolder=null;this.OnExpandCollapse=new D2L.EventHandler;this.m_isDisplayedChangeEvent=new D2L.EventHandler;this.m_width=null;this.m_widthType=D2L.Style.WidthType.None;this.m_widthTypeIsSet=false;this.InstallEvents()},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,
deserializer);if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<7)this.GetDomNode().style.zIndex=this.GetWindow()["UI"].GetRelativeZIndex();this.m_hasTitle=deserializer.GetBoolean();this.m_isCollapsible=deserializer.GetBoolean();this.m_isCollapseAnimated=deserializer.GetBoolean();this.m_isDisplayed=deserializer.GetBoolean();this.m_isExpanded=deserializer.GetBoolean();this.m_mergeTitleWithContent=deserializer.GetBoolean();this.m_border=deserializer.GetObjectMin(D2L.Style.BorderInfo);
this.m_borderRadius=deserializer.GetMember();this.m_float=deserializer.GetMember();this.m_dragDropMode=deserializer.GetMember();var hasDragDropInfo=deserializer.GetBoolean();if(hasDragDropInfo){var dragDropSettingsControlId=deserializer.GetObjectMin(D2L.Control.Id);if(dragDropSettingsControlId)this.m_dragDropInfo=UI.GetControl(dragDropSettingsControlId.ID(),dragDropSettingsControlId.SID()).GetDragDropInfo()}if(this.HasTitle()){this.m_titleNode=this.GetDomNode().firstChild;this.m_collapseImg=UI.GetControl(this.GetMappedId()+
"_imgCol")}this.m_title=new D2L.LP.Text.PlainText(deserializer.GetMember());this.m_contextMenuPlaceHolder=this.GetUI().GetControl(this.GetMappedId()+"_cmp");this.IChildrenDomNode=this.GetDomNode().childNodes[this.GetDomNode().childNodes.length-1];this.InstallEvents();if(this.m_dragDropMode!=D2L.DragDrop.Modes.None)this.InstallDragDrop()},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);this.BuildDom_Container();this.SetBorder(this.m_border);if(this.GetBorderRadius()>
0)this.SetBorderRadius(this.m_borderRadius);this.SetBackgroundColour(this.m_backgroundColour);this.RenderFloat();this.RenderPadding();this.RenderSpacing();this.RenderWidth();this.RenderHeight();if(this.m_dragDropMode!=D2L.DragDrop.Modes.None)this.SetDragDrop(this.m_dragDropMode,this.m_dragDropInfo)}},BuildDom_Container:function(){this.SetDomNode(this.CreateElement("div"));this.GetDomNode().style.zIndex=this.GetWindow()["UI"].GetZIndex();this.GetDomNode().className=this.GetClassName();this.IChildrenDomNode=
this.CreateElement("div");this.IChildrenDomNode.className="dco_c";this.GetDomNode().appendChild(this.IChildrenDomNode);this.SetHasTitle(this.HasTitle(),true)},InstallDragDrop:function(){var ddObject;var handle=this.GetDomNode();if(this.HasTitle())handle=this.m_titleNode;if(this.m_dragDropMode==D2L.DragDrop.Modes.DraggableDroppable)ddObject=new D2L.DragDrop.DraggableDroppable(this,handle);if(this.m_dragDropMode==D2L.DragDrop.Modes.Draggable)ddObject=new D2L.DragDrop.Draggable(this,handle);if(this.m_dragDropMode==
D2L.DragDrop.Modes.Droppable)ddObject=new D2L.DragDrop.Droppable(this,handle);if(this.m_dragDropMode==D2L.DragDrop.Modes.DraggableDroppable||this.m_dragDropMode==D2L.DragDrop.Modes.Draggable)this.IChildrenDomNode.className=this.IChildrenDomNode.className+" draggable ";this.SetDragDropObject(ddObject);if(this.GetDragDropObject()&&this.m_dragDropInfo)D2L.DragDrop.SetDragDropInfo(this.GetDragDropObject(),this.m_dragDropInfo)},InstallEvents:function(){var me=this;this.m_spacing.OnChange().RegisterMethod(function(){me.RenderSpacing()});
this.m_padding.OnChange().RegisterMethod(function(){me.RenderPadding()});if(this.m_isCollapsible){this.AttachObject(this.GetDomNode(),"ID2LOnExpand",new D2L.EventHandler);this.GetDomNode().ID2LOnExpand.RegisterMethod(function(evt){if(!me.IsExpanded())me.SetIsExpanded(true)})}},RenderFloat:function(){if(this.IsRendered())D2L.Util.Style.ApplyFloat(this.GetDomNode(),this.GetFloat())},RenderHeight:function(){if(this.IsRendered())if(this.m_height!==null)this.GetDomNode().style.height=this.m_height+"px";
else this.GetDomNode().style.height="auto"},RenderPadding:function(){if(this.IsRendered())this.IChildrenDomNode.style.padding=this.GetPadding().ToCss()},RenderSpacing:function(){if(this.IsRendered())this.GetDomNode().style.margin=this.GetSpacing().ToCss()},RenderWidth:function(){if(!this.IsRendered())return;var width="auto";if(this.m_width!==null)if(this.m_widthTypeIsSet)if(this.m_widthType==D2L.Style.WidthType.Em)width=this.m_width+"em";else if(this.m_widthType==D2L.Style.WidthType.Percent)width=
this.m_width+"%";else width=this.m_width+"px";else width=this.m_width+"px";this.GetDomNode().style.width=width},GetBackgroundColour:function(){if(this.IsRendered())return this.IChildrenDomNode.style.backgroundColor;return""},GetBorder:function(){return this.m_border},GetBorderRadius:function(){return this.m_borderRadius},GetClassName:function(){return"dco"},GetDragDropObject:function(){return this.m_ddObject},GetFloat:function(){return this.m_float},GetHeight:function(){return this.m_height},GetPadding:function(){return this.m_padding},
GetSpacing:function(){return this.m_spacing},GetTextAlignment:function(){if(this.IsRendered()&&this.IChildrenDomNode!=null){var cssTextAlign=this.IChildrenDomNode.style.textAlign;return D2L.Style.Utility.CssToTextAlign(cssTextAlign)}else return D2L.Style.TextAlignment.Left},GetTitle:function(){return this.m_title},GetTitleAlignment:function(){if(this.IsRendered()&&this.HasTitle())return this.m_titleNode.style.textAlign;return""},GetTitleBackgroundColour:function(){if(this.IsRendered()&&this.HasTitle())return this.m_titleNode.style.backgroundColor;
return""},GetTitleColour:function(){if(this.IsRendered()&&this.HasTitle())return this.m_titleNode.style.color;return""},GetWidth:function(){return this.m_width},GetWidthType:function(){return this.m_widthType},HasTitle:function(){return this.m_hasTitle},IsCollapsible:function(){return this.m_isCollapsible},IsCollapseAnimated:function(){return this.m_isCollapseAnimated},IsDisplayed:function(){return this.m_isDisplayed},IsDisplayedChangeEvent:function(){return this.m_isDisplayedChangeEvent},IsExpanded:function(){return this.m_isExpanded},
MergeTitleWithContent:function(){return this.m_mergeTitleWithContent},SetBackgroundColour:function(backgroundColour){this.m_backgroundColour=backgroundColour;if(this.IsRendered()&&backgroundColour!==null)this.IChildrenDomNode.style.backgroundColor=backgroundColour},SetBorder:function(borderInfo){this.m_border=borderInfo;if(this.IsRendered())this.IChildrenDomNode.style.border=this.m_border.ToCss()},SetBorderRadius:function(radius){this.m_borderRadius=radius;if(this.IsRendered())if(UI.GetBrowserInfo().Type==
D2L.UI.BrowserType.Safari||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Chrome)this.IChildrenDomNode.style.WebkitBorderRadius=radius+"px";else if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Firefox)this.IChildrenDomNode.style.MozBorderRadius=radius+"px"},SetDragDrop:function(dragDropMode,dragDropInfo){this.m_dragDropMode=dragDropMode;this.m_dragDropInfo=dragDropInfo;if(this.IsRendered()&&this.m_dragDropMode!=D2L.DragDrop.Modes.None)this.InstallDragDrop()},SetDragDropObject:function(ddObject){this.m_ddObject=
ddObject},SetFloat:function(val){this.m_float=val;this.RenderFloat()},SetHasTitle:function(hasTitle,firstTime){if(firstTime===undefined)firstTime=false;this.m_hasTitle=hasTitle;if(this.IsRendered()||firstTime)if(!hasTitle&&this.m_titleNode!==null){this.m_titleNode.parentNode.removeChild(this.m_titleNode);this.m_titleNode=null;if(this.m_collapseImg){this.m_collapseImg.Remove();this.m_collapseImg=null}}else if(hasTitle&&this.m_titleNode===null){this.m_titleNode=this.CreateElement("div");this.m_titleNode.className=
"dco_t";var me=this;this.m_collapseImg=new D2L.Image;this.m_collapseImg.AppendTo(this.m_titleNode);this.m_collapseImg.SetOnClick(function(){me.TC()});var h3=this.CreateElement("h3");this.m_titleNode.appendChild(h3);this.GetDomNode().insertBefore(this.m_titleNode,this.IChildrenDomNode)}this.SetTitle(this.GetTitle());this.SetIsCollapsible(this.IsCollapsible());this.SetIsExpanded(this.IsExpanded())},SetHeight:function(height){this.m_height=height;this.RenderHeight()},SetIsCollapsible:function(isCollapsible){if(this.IsRendered()&&
this.HasTitle())if(!isCollapsible){if(this.m_collapseImg!==null)this.m_collapseImg.SetIsDisplayed(false)}else this.m_collapseImg.SetIsDisplayed(true);if(!isCollapsible)this.SetIsExpanded(true);this.m_isCollapsible=isCollapsible;if(isCollapsible)this.SetIsExpanded(this.IsExpanded())},SetIsCollapseAnimated:function(isCollapseAnimated){this.m_isCollapseAnimated=isCollapseAnimated},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().style.display=isDisplayed?"block":"none";if(isDisplayed!=
this.m_isDisplayed){this.m_isDisplayed=isDisplayed;this.IsDisplayedChangeEvent().Trigger(isDisplayed)}},SetIsExpanded:function(isExpanded){if(this.IsCollapsible()&&this.m_isExpanded!=isExpanded)if(this.IsRendered()&&this.HasTitle()){var me=this;var DoExpandCollapse=function(){var altTerm="Framework.Container.alt";var imgTerm="Shared.Main.act";var hoverTerm="Shared.Main.hover";if(isExpanded){me.IChildrenDomNode.style.display="block";imgTerm+="Hide";altTerm+="Collapse";hoverTerm+="Hide"}else{me.IChildrenDomNode.style.display=
"none";imgTerm+="Show";altTerm+="Expand";hoverTerm+="Show"}var term=new D2L.LP.Text.LangTerm(altTerm);me.GetTitle().GetText().Register(function(title){me.m_collapseImg.SetImage(new D2L.Images.ImageTerm(imgTerm));me.m_collapseImg.SetHoverImage(new D2L.Images.ImageTerm(hoverTerm));term.SetSubject(title);me.m_collapseImg.SetAlt(term)});var border=me.GetBorder();if(border.GetStyle()!=D2L.Style.BorderStyle.None&&me.m_mergeTitleWithContent)if(isExpanded)me.m_titleNode.style.borderBottom="none";else me.m_titleNode.style.borderBottom=
border.ToCss();me.m_isExpanded=isExpanded;me.OnExpandCollapse.Trigger(me);if(isExpanded)(new D2L.DisplayVisibleEvent(me.GetDomNode())).Bubble()};if(this.m_isCollapseAnimated){var DoAnimate=function(height){var toOpt=1;var fromOpt=0.2;if(!isExpanded){toOpt=0.2;fromOpt=1}me.IChildrenDomNode.style.position="relative";var sizeAnim=new YAHOO.util.Anim(me.IChildrenDomNode,{height:{to:height}},me.m_collapseAnimationSpeed,YAHOO.util.Easing.easeNone);var fadeAnim=new YAHOO.util.ColorAnim(me.IChildrenDomNode,
{opacity:{from:fromOpt,to:toOpt}},me.m_collapseAnimationSpeed,YAHOO.util.Easing.easeNon);sizeAnim.onComplete.subscribe(function(){DoExpandCollapse();me.IChildrenDomNode.style.position="";me.IChildrenDomNode.style.overflow="visible";me.IChildrenDomNode.style.height="auto";if(isExpanded)if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)me.IChildrenDomNode.style.filter="";else me.IChildrenDomNode.style.opacity="";me.m_collapseImg.SetIsEnabled(true)});if(isExpanded)me.IChildrenDomNode.style.height="0px";
me.IChildrenDomNode.style.overflow="hidden";me.IChildrenDomNode.style.display="block";me.m_collapseImg.SetIsEnabled(false);sizeAnim.animate();fadeAnim.animate()};if(isExpanded)DoAnimate(D2L.Util.Dom.GetHeightHelper(this.IChildrenDomNode));else DoAnimate(0)}else DoExpandCollapse()}},SetSize:function(width,height){this.SetWidth(width);this.SetHeight(height)},SetTextAlignment:function(textAlign){if(this.IsRendered()&&this.IChildrenDomNode!=null){var cssTextAlign=D2L.Style.Utility.TextAlignToCss(textAlign);
this.IChildrenDomNode.style.textAlign=cssTextAlign}},SetTitle:function(title){this.m_title=D2L.LP.Text.IText.Normalize(title,"D2L.Control.Container","SetTitle","title");if(!this.IsRendered()||!this.HasTitle())return;var t=this.m_titleNode.firstChild.firstChild;if(t.firstChild)t.removeChild(t.firstChild);t.appendChild(this.CreateTextNode(this.m_title));if(this.m_contextMenuPlaceHolder!==null)this.m_contextMenuPlaceHolder.SetSubject(title)},SetWidth:function(width){this.m_width=width;this.RenderWidth()},
SetWidthType:function(widthType){this.m_widthType=widthType;this.m_widthTypeIsSet=true;this.RenderWidth()},TC:function(){if(this.IsCollapsible())this.SetIsExpanded(!this.IsExpanded());return false}});
D2L.Control.Container.InstallEvents=function(domNode,GetControl){var me=null;if(domNode.ID2LOnChange===undefined)UI.AttachObject(domNode,"ID2LOnChange",new D2L.EventHandler);domNode.ID2LOnChange.RegisterMethod(function(evt){if(!evt.hasChangeBeenShown){domNode.style.backgroundColor="#E6EFF2";evt.hasChangeBeenShown=true}});FormManager.OnChangeReset.RegisterMethod(function(){domNode.style.backgroundColor="#ffffff"})};
D2L.Control.Container.Floating=D2L.Control.Container.extend({Construct:function(name){arguments.callee.$.Construct.call(this,name);this.m_doIgnoreHide=false;this.m_hasAutoHide=false;this.m_posX=0;this.m_posY=0;this.m_isDisplayed=false;this.m_animationMode=D2L.Style.AnimationMode.None},IntegrateControlMin:function(deserializer){},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);this.GetDomNode().id=this.GetMappedId();if(this.m_hasAutoHide){var me=this;WindowEventManager.Click.RegisterMethod(function(evt){if(me.IsDisplayed()&&
!me.m_doIgnoreHide)me.Hide()});this.AttachObject(this.GetDomNode(),"onclick",function(evt){D2L.Util.Dom.CancelBubble(evt)})}},GetAnimationMode:function(){return this.m_animationMode},GetClassName:function(){return"dco_f"},GetPosX:function(){return this.m_posX},GetPosY:function(){return this.m_posY},Hide:function(){if(!this.IsDisplayed())return;if(this.IsRendered())this.IDomNode=this.GetDomNode().parentNode.removeChild(this.GetDomNode());this.m_isDisplayed=false;this.IsDisplayedChangeEvent().Trigger(false)},
RenderPosition:function(){if(!this.IsRendered()||!this.IsDisplayed())return;YAHOO.util.Dom.setXY(this.GetDomNode(),[this.m_posX,this.m_posY],true)},SetAnimationMode:function(mode){this.m_animationMode=mode},SetIsDisplayed:function(isDisplayed){if(isDisplayed)this.Show();else this.Hide()},SetHasAutoHide:function(hasAutoHide){this.m_hasAutoHide=hasAutoHide},SetPosition:function(posX,posY){this.m_posX=posX;this.m_posY=posY;this.RenderPosition()},SetPosX:function(posX){this.m_posX=posX;this.RenderPosition()},
SetPosY:function(posY){this.m_posY=posY;this.RenderPosition()},Show:function(insertAfter){if(this.IsDisplayed())return;this.m_isDisplayed=true;if(insertAfter===undefined)D2L.LP.Web.UI.Html.JavaScript.Console.Error("You must define the insertAfter parameter. For accessbility reasons it is important to put the container in the right DOM order. insertAfter could be a D2L.Control or a DOM node. For instance if you have an icon that opens a floating div, you must pass that image node as the insertBefore so floating container is inserted rigth after that node in DOM hierarchy.");
var insertAfterDom;if(!insertAfter.isD2LControl)insertAfterDom=insertAfter;else{if(!insertAfter.IsRendered())insertAfter.BuildDom();insertAfterDom=insertAfter.GetDomNode()}if(!this.IsRendered())this.BuildDom();this.GetDomNode().style.zIndex=this.GetWindow()["UI"].GetZIndex();var parent=insertAfterDom.parentNode;if(parent){var nextSibiling=insertAfterDom.nextSibling;if(nextSibiling)parent.insertBefore(this.GetDomNode(),nextSibiling);else parent.appendChild(this.GetDomNode())}this.RenderPosition();
var me=this;if(this.GetAnimationMode()===D2L.Style.AnimationMode.Slide){var size=D2L.Util.Dom.GetSizeHelper(this.GetDomNode());this.GetDomNode().style.display="none";var height=size.height;me.GetDomNode().style.overflow="hidden";me.GetDomNode().style.display="block";me.GetDomNode().style.height="1px";me.GetDomNode().style.width="1px";var width=this.GetWidth();if(width===null)width=size.width;var myAnim=new YAHOO.util.Anim(me.GetMappedId(),{height:{to:height},width:{to:width}},0.1,YAHOO.util.Easing.easeOut);
myAnim.onComplete.subscribe(function(){me.GetDomNode().style.overflow="visible";me.GetDomNode().style.height="auto";D2L.Util.Dom.ScrollTo(me.GetDomNode(),false,true)});myAnim.animate()}else me.GetDomNode().style.display="block";if(this.m_hasAutoHide){this.m_doIgnoreHide=true;setTimeout(function(){me.m_doIgnoreHide=false},0)}this.IsDisplayedChangeEvent().Trigger(true)}});
D2L.Control.Container.IFrame=D2L.Control.Container.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_autoResizeToContents=true;this.m_iframe=null;this.m_loadingDiv=null;this.m_iframeDiv=null;this.m_src=null;this.m_srcParams=[];this.m_iframeWindow=null;this.m_iframeTitle=null;this.OnLoad=new D2L.EventHandler;this.SetSrcParam("d2l_body_type",D2L.UI.BodyType.IFrame)},BuildDom:function(){if(!this.IsRendered())arguments.callee.$.BuildDom.call(this)},BuildDom_Container:function(){arguments.callee.$.BuildDom_Container.call(this);
this.m_loadingDiv=this.CreateElement("div");this.m_loadingDiv.className="d2l_loading";var img=this.CreateElement("img");img.alt="";D2L.Images.ImageTerm.Assign("Shared.Main.actLoadingLg",img,false);this.m_loadingDiv.appendChild(img);this.m_loadingDiv.appendChild(this.CreateTextNode(new D2L.LP.Text.LangTerm("Standard.Misc.txtLoading")));this.m_iframeDiv=this.CreateElement("div");this.GetDomNode().appendChild(this.m_loadingDiv);this.GetDomNode().appendChild(this.m_iframeDiv)},BuildDom_IFrame:function(){var me=
this;var name=this.GetWindow()["UI"].GetUniqueHtmlId();this.m_iframeDiv.innerHTML="<iframe name='"+name+"' id='"+name+"' style='width:100%;height:1px;border:none;' scrolling='no' frameBorder='0'></iframe><div class='d2l_loading' style='display:none;'><img src='/d2l/img/lp/loading_lg.gif' width='24' height='24' alt='' />";this.m_iframe=this.m_iframeDiv.firstChild;if(this.m_iframeTitle!==null)this.SetIFrameTitle(this.m_iframeTitle);var onload=function(){try{me.m_iframeWindow=me.GetWindow().frames[name]}catch(e){}if(me.m_autoResizeToContents){var ui=
undefined;try{ui=me.m_iframeWindow.UI}catch(e){}if(ui!==undefined)ui.GetWindowEventManager().Transform.RegisterMethod(function(){me.ResizeToContents()});me.ResizeToContents()}if(me.m_iframeTitle===null)try{me.m_iframe.title=me.m_iframeWindow.document.title}catch(e){}me.m_loadingDiv.style.display="none";me.OnLoad.Trigger()};if(this.m_iframe.attachEvent)this.m_iframe.attachEvent("onload",onload);else this.m_iframe.onload=onload},GetIFrameWindow:function(){return this.m_iframeWindow},GetSrc:function(){return this.m_src},
Load:function(){if(this.IsRendered()&&this.m_src!==null){var me=this;var AfterIFrame=function(isD2LFrame,xsrfToken){if(me.m_iframe===null)me.BuildDom_IFrame();if(isD2LFrame){var body=me.GetWindow()["UI"].GetById("d2l_body");var f=me.CreateElement("form");f.method="post";f.target=me.m_iframe.name;f.action=me.m_src;if(xsrfToken){var xsrfTokenInput=me.CreateElement("input");xsrfTokenInput.type="hidden";xsrfTokenInput.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();xsrfTokenInput.value=
xsrfToken;f.appendChild(xsrfTokenInput)}for(var name in me.m_srcParams){var input=me.CreateElement("input");input.type="hidden";input.name=name;input.value=me.m_srcParams[name];f.appendChild(input)}body.appendChild(f);f.submit();D2L.Util.Dom.Purge(f);body.removeChild(f)}else me.m_iframe.src=me.m_src;me.m_loadingDiv.style.display="block"};var isD2LFrame=me.m_src.indexOf(".d2l")>0;var isInternal=!D2L.Util.Url.IsExternal(me.m_src);if(isD2LFrame&&isInternal)AfterIFrame(isD2LFrame,D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());
else setTimeout(function(){AfterIFrame(isD2LFrame,null)},0)}},RenderHeight:function(){if(this.IsRendered()&&this.m_iframe)if(this.m_height!==null){this.GetDomNode().style.height=this.m_height+"px";this.m_iframe.style.height=this.m_height+"px"}else this.GetDomNode().style.height="auto"},ResizeToContents:function(){this.m_iframe.style.height="auto";var docHeight=this.GetWindow()["UI"].GetPageHeight(this.m_iframeWindow);if(docHeight>0)this.SetHeight(docHeight)},SetAutoResizeToContents:function(autoResizeToContents){this.m_autoResizeToContents=
autoResizeToContents},SetIFrameTitle:function(iframeTitle){this.m_iframeTitle=D2L.LP.Text.IText.Normalize(iframeTitle,"D2L.Control.Container.IFrame","SetIFrameTitle","iframeTitle");if(this.IsRendered()&&this.m_iframe)this.m_iframeTitle.AssignText(this.m_iframe,"title")},SetSrc:function(src){this.m_src=src;if(this.m_src.indexOf(".d2l")>0)if(this.m_src.indexOf("ou=")<0){this.m_src+=this.m_src.indexOf("?")<0?"?":"&";this.m_src+="ou="+Global.OrgUnitId}},SetSrcParam:function(name,value){this.m_srcParams[name]=
value}});
D2L.ControlMap=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.ID={};this.SID={}},DeserializeMin:function(deserializer){var me=this;this.ID=deserializer.GetMember();for(var id in this.ID){var iInfo=D2L.Serialization.JsonDeserializerMin.Deserialize(this.ID[id],D2L.ControlMap.IntegrateInfo);this.ID[id]=iInfo;if(iInfo.InstallEvents&&iInfo.JsClass!==undefined)iInfo.JsClass.InstallEvents(UI.GetById(iInfo.MappedId),new Function("return UI.GetControl('"+id+"');"));if(!iInfo.DelayClientSideIntegration)setTimeout(new Function("UI.GetControlMap().GetControl('"+
id+"');"))}this.SID=deserializer.GetMember();for(var id in this.SID)for(var sid in this.SID[id]){var iInfo=D2L.Serialization.JsonDeserializerMin.Deserialize(this.SID[id][sid],D2L.ControlMap.IntegrateInfo);this.SID[id][sid]=iInfo;if(iInfo.InstallEvents&&iInfo.JsClass!==undefined)iInfo.JsClass.InstallEvents(UI.GetById(iInfo.MappedId),new Function("return UI.GetControl('"+id+"','"+sid+"');"));if(!iInfo.DelayClientSideIntegration)setTimeout(new Function("UI.GetControlMap().GetControl('"+id+"','"+sid+
"');"))}},Serialize:function(serializer){var ids={};for(var id in this.ID)ids[id]=this.ID[id].MappedId;var sids={};for(var id in this.SID){sids[id]={};for(var sid in this.SID[id])sids[id][sid]=this.SID[id][sid].MappedId}serializer.AddMember("ID",ids);serializer.AddMember("SID",sids)},AddControlMapToForm:function(){UI.GetByName("d2l_controlMapPrev").value=D2L.Serialization.JsonSerializer.Serialize(this)},GetControl:function(ID,SID){if(SID===undefined||SID===null)SID="";if(!ID.isString)ID=ID.toString();
if(!SID.isString)SID=SID.toString();ID=ID.toLowerCase();SID=SID.toLowerCase();var integrateInfo=null;if(SID.length===0){if(this.ID[ID]!==undefined){if(this.ID[ID].Control!==null)return this.ID[ID].Control;integrateInfo=this.ID[ID]}}else if(this.SID[ID]!==undefined&&this.SID[ID][SID]!==undefined){if(this.SID[ID][SID].Control!==null)return this.SID[ID][SID].Control;integrateInfo=this.SID[ID][SID]}if(integrateInfo===null)return null;if(integrateInfo.JsClass===undefined)return null;var control=new integrateInfo.JsClass;
control.m_mappedId=integrateInfo.MappedId;control.m_controlId=new D2L.Control.Id(ID,SID);control.IntegrateControlMin(new D2L.Serialization.JsonDeserializerMin(integrateInfo.SerializedDataMin));control.IntegrateControl(new D2L.Serialization.JsonDeserializer(integrateInfo.SerializedData));if(SID.length===0)this.ID[ID].Control=control;else this.SID[ID][SID].Control=control;return control},GetControlByMappedId:function(mappedId){for(var id in this.ID)if(this.ID[id].MappedId==mappedId)return this.GetControl(id);
for(var id in this.SID)for(var sid in this.SID[id])if(this.SID[id][sid].MappedId==mappedId)return this.GetControl(id,sid);return null},GetMappedIdById:function(id,sid){if(id===undefined||id===null)return null;id=id.toLowerCase();if(this.ID[id]!==undefined)return this.ID[id].MappedId;if(sid!==undefined&&sid!==null&&sid.length>0){sid=sid.toLowerCase();if(this.SID[id]!==undefined)if(this.SID[id][sid]!==undefined)return this.SID[id][sid].MappedId}return null},GetControls:function(ID){if(ID===undefined||
ID===null)return[];ID=ID.toLowerCase();var controls=[];if(this.ID[ID]!==undefined)controls.push(this.GetControl(ID));for(var sid in this.SID[ID])controls.push(this.GetControl(ID,sid));return controls},RegisterControl:function(control){var id=control.GetControlId().ID();var sid=control.GetControlId().SID();if(id.length===0)return false;var mappedId=control.GetMappedId();if(sid.length===0){this.ID[id]=new D2L.ControlMap.IntegrateInfo(mappedId);this.ID[id].Control=control}else{if(this.SID[id]===undefined)this.SID[id]=
{};this.SID[id][sid]=new D2L.ControlMap.IntegrateInfo(mappedId);this.SID[id][sid].Control=control}return true},UnregisterControl:function(control){var id=control.GetControlId().ID();var sid=control.GetControlId().SID();if(id.length===0)return false;if(sid.length===0)this.ID[id]=undefined;else if(this.SID[id]!==undefined)this.SID[id][sid]=undefined}});
D2L.LP.Web.UI.Html.LegacyIdAdapter=D2L.Class.Create({Construct:function(id,sid){if(id===undefined||id===null)id="";this.m_value=id;if(sid===undefined||sid===null)sid="";this.m_sidValue=sid},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("Id");if(deserializer.HasMember("Sid"))this.m_sidValue=deserializer.GetMember("Sid")},_serialize:function(serializer){serializer.AddMember("Id",this.m_value);if(this.m_sidValue.length>0)serializer.AddMember("Sid",this.m_sidValue)},GetValue:function(){return UI.GetControlMap().GetMappedIdById(this.m_value,
this.m_sidValue)}});D2L.LP.Web.UI.Html.LegacyIdAdapter.Create=function(id,sid){return new D2L.LP.Web.UI.Html.LegacyIdAdapter(id,sid)};
D2L.ControlMap.IntegrateInfo=D2L.Class.extend({Construct:function(mappedId){if(mappedId===undefined)mappedId="";arguments.callee.$.Construct.call(this);this.MappedId=mappedId;this.JsClass=undefined;this.SerializedDataMin={};this.SerializedData={};this.InstallEvents=false;this.DelayClientSideIntegration=true;this.Control=null},DeserializeMin:function(deserializer){this.MappedId=deserializer.GetMember();var jsClassName=deserializer.GetMember();if(jsClassName.indexOf(".")>-1)try{this.JsClass=eval(jsClassName)}catch(e){throw"Class '"+
jsClassName+"' is undefined.";}else try{this.JsClass=D2L.Control[jsClassName]}catch(e){throw"Class 'D2L.Control."+jsClassName+"' is undefined.";}this.SerializedDataMin=deserializer.GetMember();this.SerializedData=deserializer.GetMember();this.InstallEvents=deserializer.GetBoolean();this.DelayClientSideIntegration=deserializer.GetBoolean()}});D2L.LP.Globalization.Calendars={};
D2L.LP.Globalization.Calendars.Calendar=D2L.Class.extend({Construct:function(calendarType){this.m_calendarType=calendarType;this.m_calendar=this.GetSpecificCalendar()},GetSpecificCalendar:function(){switch(this.m_calendarType){case D2L.LP.Globalization.Calendars.Calendar.Type.Gregorian:return new D2L.LP.Globalization.Calendars.Gregorian;case D2L.LP.Globalization.Calendars.Calendar.Type.Hijri:return new D2L.LP.Globalization.Calendars.Hijri;default:throw"Not supported calendar: "+this.m_calendarType;
}},GetCalendarType:function(){return this.m_calendarType},TryGetGregorianLocalDateTime:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){return this.m_calendar.TryGetGregorianLocalDateTime(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay)},GetCalendarSpecificLocalDateTime:function(localDateTime){return this.m_calendar.GetCalendarSpecificLocalDateTime(localDateTime)},Validate:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){return this.m_calendar.Validate(calendarSpecificYear,
calendarSpecificMonth,calendarSpecificDay)}});D2L.LP.Globalization.Calendars.Calendar.Type={Gregorian:0,Hijri:1};
D2L.LP.Globalization.Calendars.CalendarLocalDateTime=D2L.Class.extend({Construct:function(year,month,day,hour,minute,second){this.m_year=year;this.m_month=month;this.m_day=day;this.m_hour=hour!==undefined?hour:0;this.m_minute=minute!==undefined?minute:0;this.m_second=second!==undefined?second:0},_deserialize:function(deserializer){this.m_year=deserializer.GetMember("Year");this.m_month=deserializer.GetMember("Month");this.m_day=deserializer.GetMember("Day");this.m_hour=deserializer.GetMember("Hour");
this.m_minute=deserializer.GetMember("Minute");this.m_second=deserializer.GetMember("Second")},_serialize:function(serializer){serializer.AddMember("Year",this.m_year);serializer.AddMember("Month",this.m_month);serializer.AddMember("Day",this.m_day);serializer.AddMember("Hour",this.m_hour);serializer.AddMember("Minute",this.m_minute);serializer.AddMember("Second",this.m_second)},GetYear:function(){return this.m_year},GetMonth:function(){return this.m_month},GetDay:function(){return this.m_day},GetHour:function(){return this.m_hour},
GetMinute:function(){return this.m_minute},GetSecond:function(){return this.m_second}});
D2L.LP.Globalization.Calendars.Gregorian=D2L.Class.extend({Construct:function(){},TryGetGregorianLocalDateTime:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){if(!this.Validate(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay))return null;return new D2L.LocalDateTime(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay,0,0,0)},GetCalendarSpecificLocalDateTime:function(localDateTime){return localDateTime},Validate:function(calendarSpecificYear,calendarSpecificMonth,
calendarSpecificDay){var year=calendarSpecificYear;var month=calendarSpecificMonth;var day=calendarSpecificDay;if(isNaN(year)||year<1753||year>9999)return false;if(isNaN(month)||month<1||month>12)return false;if(isNaN(day)||day<1||day>31)return false;var allowedDays=31;if(month==2)if(year%4===0&&(!(year%100===0)||year%400===0))allowedDays=29;else allowedDays=28;else if(month==4||month==6||month==9||month==11)allowedDays=30;if(day>allowedDays)return false;return true}});
D2L.LP.Globalization.Calendars.Hijri=D2L.Class.extend({Construct:function(){},TryGetGregorianLocalDateTime:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){if(!this.Validate(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay))return null;var gDate=D2LMicrosoftAjax.UmAlQura.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);if(gDate==null)gDate=D2LMicrosoftAjax.Hijri.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);
if(gDate)return new D2L.LocalDateTime(gDate.getFullYear(),gDate.getMonth()+1,gDate.getDate(),0,0,0);else return null},GetCalendarSpecificLocalDateTime:function(localDateTime){var gDate=D2L.LocalDateTime.ToJavaScriptDate(localDateTime);var calendarDate=D2LMicrosoftAjax.UmAlQura.fromGregorian(gDate);if(calendarDate==null)calendarDate=D2LMicrosoftAjax.Hijri.fromGregorian(gDate);return new D2L.LocalDateTime(calendarDate[0],calendarDate[1]+1,calendarDate[2],0,0,0)},Validate:function(calendarSpecificYear,
calendarSpecificMonth,calendarSpecificDay){var gDate=D2LMicrosoftAjax.UmAlQura.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);if(gDate==null)gDate=D2LMicrosoftAjax.Hijri.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);if(gDate==null)return false;var calendarDate=D2LMicrosoftAjax.UmAlQura.fromGregorian(gDate);if(calendarDate==null)calendarDate=D2LMicrosoftAjax.Hijri.fromGregorian(gDate);if(calendarDate==null)return false;return calendarSpecificYear==
calendarDate[0]&&calendarSpecificMonth==calendarDate[1]+1&&calendarSpecificDay==calendarDate[2]}});D2L.LP.Globalization.Formatting.DateTime={};D2L.LP.Globalization.Formatting.DateTime.Exceptions={InvalidDateFormat:0,UnsupportedInputDateFormat:1};D2L.LP.Globalization.Formatting.DateTime.FormatPart=D2L.Class.extend({Construct:function(partType,partFormat){this.Type=partType;this.Format=partFormat}});D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type={Day:0,Month:1,Year:2,Hour:3,Minute:4,Second:5};
D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer=D2L.Class.extend({Construct:function(dateFormat){this.m_dateFormatSeparator=null;this.m_dateFormatParts=null;this.m_dateFormat=dateFormat},GetSeparator:function(){if(this.m_dateFormatSeparator==null){var re=new RegExp("\\W");var match=re.exec(this.m_dateFormat);if(match!=null)this.m_dateFormatSeparator=match[0]}return this.m_dateFormatSeparator},GetParts:function(){var result=[];var separator=this.GetSeparator();if(separator==null)return null;
var parts=this.m_dateFormat.split(separator);if(parts.length!=3)return null;var isNotSupported=false;for(var i=0;i<parts.length;i++){part=parts[i].trim();if(part=="dd"||part=="d")result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day,part));else if(part=="MM"||part=="M")result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month,part));else if(part=="yyyy")result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year,
part));else isNotSupported=true}if(isNotSupported)return null;else return result}});
D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatter=D2L.Class.extend({Construct:function(dateTimeFormatDescriptor,fuzzyDateTimeDescriptor){fuzzyDateTimeDescriptor.ClientNow=new Date;this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_fuzzyDateTimeDescriptor=fuzzyDateTimeDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_dateTimeFormatDescriptor.NativeDigits,this.m_dateTimeFormatDescriptor.UseNativeDigits)},FormatInputDate:function(gregorianLocalDateTime){var calendar=
D2L.LP.Globalization.Locale.GetCalendar();var date=calendar.GetCalendarSpecificLocalDateTime(gregorianLocalDateTime);var inputDateTimeFormatTokenizer=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer(this.m_dateTimeFormatDescriptor.InputDateFormat);var separator=inputDateTimeFormatTokenizer.GetSeparator();var dateParts=inputDateTimeFormatTokenizer.GetParts();if(separator!=null&&dateParts!=null){var formattedDate="";for(var i=0;i<dateParts.length;i++){var datePart=dateParts[i];if(datePart.Type==
D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day)formattedDate+=this.PrePadByZero(date.GetDay(),datePart.Format.length);else if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month)formattedDate+=this.PrePadByZero(date.GetMonth(),datePart.Format.length);else if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year)formattedDate+=date.GetYear().toString();if(i<dateParts.length-1)formattedDate+=separator}return this.m_nativeDigitConverter.Convert(formattedDate)}},
FormatDateTime:function(dateTime,format){var formats=D2L.LP.Globalization.Formatting.DateTime.Formats;var calendarDateTime=D2L.LP.Globalization.Locale.GetCalendar().GetCalendarSpecificLocalDateTime(dateTime);if(format===undefined)format=formats.LongDateTime;var dateTimeJs=D2L.LocalDateTime.ToJavaScriptDate(dateTime);switch(format){case formats.Time:var time=new D2L.LocalTime(dateTime.GetHour(),dateTime.GetMinute(),dateTime.GetSecond());return this.FormatTime(time);case formats.MonthAndDay:return this.FormatDateTime(dateTime,
formats.ShortMonthName)+" "+calendarDateTime.GetDay();case formats.ShortMonthName:return this.m_dateTimeFormatDescriptor.ShortMonthNames[calendarDateTime.GetMonth()-1];case formats.ShortDayOfWeek:var dayOfWeekIndex=dateTimeJs.getDay();return this.m_dateTimeFormatDescriptor.ShortDayOfWeekNames[dayOfWeekIndex];default:throw"Unsupported DateTime format: '"+format+"'.";}},FormatTime:function(time){var timeFormat=this.m_dateTimeFormatDescriptor.TimeFormat;var am=this.m_dateTimeFormatDescriptor.AmDesignator;
var pm=this.m_dateTimeFormatDescriptor.PmDesignator;var hour=time.GetHour();var hour24=hour;var hour24Pad=this.PrePadByZero(hour,2);var hour12=hour%12;if(hour12===0)hour12=12;var hour12Pad=this.PrePadByZero(hour12,2);var minute=this.PrePadByZero(time.GetMinute(),2);var replacements=[{key:"HH",value:hour24Pad},{key:"H",value:hour24},{key:"hh",value:hour12Pad},{key:"h",value:hour12},{key:"mm",value:minute},{key:"tt",value:hour>11?pm:am}];var doReplacements=function(buf){for(var i=0;i<replacements.length;i++){var rep=
replacements[i];buf=buf.replace(rep.key,rep.value)}return buf};var escape=false;var buffer="";var value="";for(var i=0;i<timeFormat.length;i++){var c=timeFormat.charAt(i);if(c=="'"){if(!escape){value+=doReplacements(buffer);buffer=""}escape=!escape}else if(escape)value+=c;else{buffer+=c;if(i==timeFormat.length-1)value+=doReplacements(buffer)}}return value},FormatFuzzyDateTime:function(inputDate,nowDate){var fuzzy=this.m_fuzzyDateTimeDescriptor;var formats=D2L.LP.Globalization.Formatting.DateTime.Formats;
var calendar=D2L.LP.Globalization.Locale.GetCalendar();if(nowDate===undefined)nowDate=fuzzy.Now;var thirtySec=30*1E3;var oneMin=60*1E3;var thirtyMin=30*oneMin;var fortyFiveMin=45*oneMin;var oneHour=60*oneMin;var sixHour=6*oneHour;var inputDateJs=D2L.LocalDateTime.ToJavaScriptDate(inputDate);var nowDateJs=D2L.LocalDateTime.ToJavaScriptDate(nowDate);var sameYear=calendar.GetCalendarSpecificLocalDateTime(inputDate).GetYear()===calendar.GetCalendarSpecificLocalDateTime(nowDate).GetYear();var sameDay=
sameYear&&inputDate.GetMonth()===nowDate.GetMonth()&&inputDate.GetDay()===nowDate.GetDay();var midnight=new Date(nowDateJs.getFullYear(),nowDateJs.getMonth(),nowDateJs.getDate());var tomorrow=new Date(midnight.getTime()+24*oneHour);var yesterday=new Date(midnight.getTime()-24*oneHour);var threeDaysAgo=new Date(midnight.getTime()-3*24*oneHour);var timespan=nowDateJs.getTime()-inputDateJs.getTime();var text=this.FormatDateTime(inputDate,formats.MonthAndDay);if(!sameYear)text+=", "+inputDate.GetYear();
text+=" "+this.FormatDateTime(inputDate,formats.Time);var timeout=-1;if(timespan<0)timeout=timespan*-1;else if(timespan<thirtySec){text=fuzzy.JustNow;timeout=thirtySec-timespan}else if(timespan<oneMin+thirtySec){text=fuzzy.OneMinuteAgo;timeout=oneMin+thirtySec-timespan}else if(timespan<2*oneMin+thirtySec){text=fuzzy.TwoMinutesAgo;timeout=2*oneMin+thirtySec-timespan}else if(timespan<fortyFiveMin){var seconds=timespan%oneMin;var nextMin=seconds<thirtySec?thirtySec-seconds:oneMin-(seconds-thirtySec);
var timeUntilFortyFiveMin=fortyFiveMin-timespan;var minutesRounded=Math.round(timespan%oneHour/oneMin);text=fuzzy.MinutesAgoMany.replace("[0]",minutesRounded);timeout=Math.min(nextMin,timeUntilFortyFiveMin)}else if(timespan<sixHour||sameDay){var minutes=timespan%oneHour;var nextHour=minutes<thirtyMin?thirtyMin-minutes:oneHour-(minutes-thirtyMin);var timeUntilSixHour=sixHour-timespan;if(timespan<oneHour+thirtyMin)text=fuzzy.OneHourAgo;else if(timespan<oneHour*2+thirtyMin)text=fuzzy.TwoHoursAgo;else{var hoursRounded=
Math.round(timespan%(oneHour*24)/oneHour);text=fuzzy.ManyHoursAgo.replace("[0]",hoursRounded)}timeout=!sameDay&&timeUntilSixHour>0?timeUntilSixHour:nextHour}else if(inputDateJs>threeDaysAgo){if(inputDateJs>yesterday)text=fuzzy.YesterdayTime.replace("[0]",this.FormatDateTime(inputDate,formats.Time));else text=fuzzy.DayOfWeekTime.replace("[0]",this.FormatDateTime(inputDate,formats.ShortDayOfWeek)).replace("[1]",this.FormatDateTime(inputDate,formats.Time));timeout=tomorrow.getTime()-nowDateJs.getTime()}else if(sameYear){var endOfYear=
new Date(nowDateJs.getFullYear()+1,0,1);var timeUntilEndOfYear=endOfYear.getTime()-nowDateJs.getTime();timeout=timeUntilEndOfYear;text=fuzzy.MonthDayTime.replace("[0]",this.FormatDateTime(inputDate,formats.MonthAndDay)).replace("[1]",this.FormatDateTime(inputDate,formats.Time))}if(timeout>0)timeout=Math.max(timeout,1E3);return{timeout:timeout,text:text}},PrePadByZero:function(input,maxNum){input=input.toString();var zero="0";while(zero.length>0&&input.length<maxNum)input=zero+input;return input}});
D2L.LP.Globalization.Formatting.DateTime.DateTimeParser=D2L.Class.extend({Construct:function(dateTimeFormatDescriptor,numberParser){this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_numberParser=numberParser},TryParseInputDate:function(dateString){var inputDateTimeFormatTokenizer=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer(this.m_dateTimeFormatDescriptor.InputDateFormat);var calendarSpecificYear=null;var calendarSpecificMonth=null;var calendarSpecificDay=null;
dateString=dateString.toString().trim();var separator=inputDateTimeFormatTokenizer.GetSeparator();var dateFormatParts=inputDateTimeFormatTokenizer.GetParts();if(separator!=null&&dateFormatParts!=null){var dateParts=dateString.split(separator);if(dateParts.length!=dateFormatParts.length)throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.InvalidDateFormat;for(var i=0;i<dateFormatParts.length;i++){var dateFormatPart=dateFormatParts[i];try{var partValue=this.m_numberParser.ParseInteger(dateParts[i])}catch(e){throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.InvalidDateFormat;
}if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year)calendarSpecificYear=partValue;else if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month)calendarSpecificMonth=partValue;else if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day)calendarSpecificDay=partValue}var calendar=D2L.LP.Globalization.Locale.GetCalendar();var gregorianLocalDateTime=calendar.TryGetGregorianLocalDateTime(calendarSpecificYear,
calendarSpecificMonth,calendarSpecificDay);return gregorianLocalDateTime}else throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.UnsupportedInputDateFormat;},TryParseTime:function(input){if(input===undefined||input===null||input=="")return null;var buildRe=function(part){var re="";var or="";for(var i=0;i<part.length;i++){re+=or+part.substr(0,i+1);or="|"}return new RegExp(re,"i")};var am=this.m_dateTimeFormatDescriptor.AmDesignator;var pm=this.m_dateTimeFormatDescriptor.PmDesignator;var is24HourClock=
this.m_dateTimeFormatDescriptor.Is24HourClock;var reAm=buildRe(am);var rePm=buildRe(pm);var isMorning=(new Date).getHours()<12;var reDigits=new RegExp("(\\d+)","g");var match=input.match(reDigits);if(match===null)return null;var digits=match.join("");var hour=0;var minute=0;if(digits.length===1)hour=digits.substr(0,1);else if(digits.length===2)hour=digits.substr(0,2);else if(digits.length===3){hour=digits.substr(0,1);minute=digits.substr(1,2)}else{hour=parseInt(digits.substr(0,2));minute=parseInt(digits.substr(2,
2))}hour=parseInt(hour,10);hour=Math.min(Math.max(hour,0),23);minute=parseInt(minute,10);minute=Math.min(Math.max(minute,0),59);if(!is24HourClock&&hour<13){var matchPm=input.match(rePm);var matchAm=input.match(reAm);var noAmPm=matchAm===null&&matchPm===null;if(matchPm!==null||noAmPm&&!isMorning){hour+=12;if(hour==24)hour=12}else if(hour==12)hour=0}var time=new D2L.LocalTime(hour,minute,0);return time}});
D2L.LP.Globalization.Formatting.DateTime.Formats={LongDate:"LongDate",StandardDate:"StandardDate",ShortDate:"ShortDate",LongDateTime:"LongDateTime",StandardDateTime:"StandardDateTime",ShortDateTime:"ShortDateTime",Time:"Time",MonthAndYear:"MonthAndYear",MonthAndDay:"MonthAndDay",LongMonthName:"LongMonthName",ShortMonthName:"ShortMonthName",LongDayOfWeek:"LongDayOfWeek",ShortDayOfWeek:"ShortDayOfWeek",InputDate:"InputDate"};D2L.LP.Globalization.Formatting.Number={};
D2L.LP.Globalization.Formatting.Number.DecimalFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_numberFormatDescriptor.NativeDigits,this.m_numberFormatDescriptor.UseNativeDigits)},FormatSimple:function(value){value=value+"";var ret="";var negative=false;var processedDecimal=true;if(value.indexOf(".",0)>=0)processedDecimal=false;
var groupSizes=this.m_numberFormatDescriptor.GroupSizes;var currentGroupSize=0;var digitsInCurrentGroup=0;for(var i=value.length-1;i>=0;i--){var c=value.charAt(i);if(c=="."){if(!processedDecimal)ret=this.m_numberFormatDescriptor.DecimalSeparator+ret;processedDecimal=true}else if(c=="-")negative=true;else{c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)if(!processedDecimal)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==0)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==
digitsInCurrentGroup){ret=this.m_numberFormatDescriptor.GroupSeparator+ret;ret=this.m_nativeDigitConverter.Convert(c)+ret;currentGroupSize++;if(currentGroupSize>=groupSizes.length)currentGroupSize=groupSizes.length-1;digitsInCurrentGroup=1}else{ret=this.m_nativeDigitConverter.Convert(c)+ret;digitsInCurrentGroup++}else throw"Invalid Integer 3";}}if(negative)switch(this.m_numberFormatDescriptor.NumberNegativePattern){case 0:ret="("+ret+")";break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+
ret;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+" "+ret;break;case 3:ret+=this.m_numberFormatDescriptor.NegativeSign;break;case 4:ret+=" "+this.m_numberFormatDescriptor.NegativeSign;break}return ret},Format:function(value,numOfDecimalPoints,trailingZeroes){if(isNaN(numOfDecimalPoints))return this.FormatSimple(value);else{value=Math.round(value*Math.pow(10,numOfDecimalPoints))/Math.pow(10,numOfDecimalPoints);value=value+"";var ret="";var negative=false;var hasDecimal=false;var currDecimalPoints=
0;var decimalRound=0;var processedDecimal=true;if(value.indexOf(".",0)>=0)processedDecimal=false;var groupSizes=this.m_numberFormatDescriptor.GroupSizes;var currentGroupSize=0;var digitsInCurrentGroup=0;for(var i=value.length-1;i>=0;i--){var c=value.charAt(i);if(c=="."){if(!processedDecimal)ret=this.m_numberFormatDescriptor.DecimalSeparator+ret;processedDecimal=true}else if(c=="-")negative=true;else{c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)if(!processedDecimal){ret=this.m_nativeDigitConverter.Convert(c)+
ret;currDecimalPoints++}else if(groupSizes[currentGroupSize]==0)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==digitsInCurrentGroup){ret=this.m_numberFormatDescriptor.GroupSeparator+ret;ret=this.m_nativeDigitConverter.Convert(c)+ret;currentGroupSize++;if(currentGroupSize>=groupSizes.length)currentGroupSize=groupSizes.length-1;digitsInCurrentGroup=1}else{ret=this.m_nativeDigitConverter.Convert(c)+ret;digitsInCurrentGroup++}else throw"Invalid Integer 3";}}if(trailingZeroes)for(var j=
currDecimalPoints;j<numOfDecimalPoints;j++){if(j==0)ret+=this.m_numberFormatDescriptor.DecimalSeparator;ret+=this.m_nativeDigitConverter.Convert(0)}if(currDecimalPoints>numOfDecimalPoints){var difference=numOfDecimalPoints-currDecimalPoints;ret=ret.substring(0,ret.length-difference)}if(negative)switch(this.m_numberFormatDescriptor.NumberNegativePattern){case 0:ret="("+ret+")";break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+
" "+ret;break;case 3:ret+=this.m_numberFormatDescriptor.NegativeSign;break;case 4:ret+=" "+this.m_numberFormatDescriptor.NegativeSign;break}return ret}}});
D2L.LP.Globalization.Formatting.Number.DecimalParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor},Parse:function(value){var ret="";var negative=false;var hasDecimal=false;if(value===undefined||value===null)return 0;value=value.trim();if(value=="")return 0;if(this.m_numberFormatDescriptor.GroupSeparator!=" ")value=value.replace(" ","");else value=value.replace(/^\s*|\s(?=\s)|\s*$/g,"");var re=new RegExp(this.m_numberFormatDescriptor.DecimalRegex);
if(!re.test(value))throw"Invalid Decimal (re)";value=value.replace(new RegExp("["+this.m_numberFormatDescriptor.GroupSeparator+"]","g"),"");for(var i=0;i<value.length;i++){var c=value.charAt(i);if(c==this.m_numberFormatDescriptor.DecimalSeparator){if(!hasDecimal)ret+=".";hasDecimal=true}else if(c==this.m_numberFormatDescriptor.NegativeSign||c=="("||c==")")negative=true;else{for(var j=0;j<10;j++)if(c==this.m_numberFormatDescriptor.NativeDigits[j]){c=j;break}c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)ret+=
c;else throw"Invalid Decimal 2";}}ret=parseFloat(ret);if(negative)ret=ret*-1;return ret}});
D2L.LP.Globalization.Formatting.Number.IntegerFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_numberFormatDescriptor.NativeDigits,this.m_numberFormatDescriptor.UseNativeDigits)},Format:function(value){value=value+"";var ret="";var negative=false;var groupSizes=this.m_numberFormatDescriptor.GroupSizes;var currentGroupSize=0;var digitsInCurrentGroup=
0;for(var i=value.length-1;i>=0;i--){var c=value.charAt(i);if(c==".")throw"Invalid Integer 2";else if(c=="-")negative=true;else{c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)if(groupSizes[currentGroupSize]==0)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==digitsInCurrentGroup){ret=this.m_numberFormatDescriptor.GroupSeparator+ret;ret=this.m_nativeDigitConverter.Convert(c)+ret;currentGroupSize++;if(currentGroupSize>=groupSizes.length)currentGroupSize=groupSizes.length-
1;digitsInCurrentGroup=1}else{ret=this.m_nativeDigitConverter.Convert(c)+ret;digitsInCurrentGroup++}else throw"Invalid Integer 3";}}if(negative)switch(this.m_numberFormatDescriptor.NumberNegativePattern){case 0:ret="("+ret+")";break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+" "+ret;break;case 3:ret+=this.m_numberFormatDescriptor.NegativeSign;break;case 4:ret+=" "+this.m_numberFormatDescriptor.NegativeSign;break}return ret}});
D2L.LP.Globalization.Formatting.Number.IntegerParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor},Parse:function(value){var ret="";var negative=false;if(value===undefined||value===null)return 0;value=value.trim();if(value==""||value=="-")return 0;if(this.m_numberFormatDescriptor.GroupSeparator!=" ")value=value.replace(" ","");else value=value.replace(/^\s*|\s(?=\s)|\s*$/g,"");var re=new RegExp(this.m_numberFormatDescriptor.IntegerRegex);
if(!re.test(value))throw"Invalid Integer (re)";value=value.replace(new RegExp("["+this.m_numberFormatDescriptor.GroupSeparator+"]","g"),"");for(var i=0;i<value.length;i++){var c=value.charAt(i);if(c==this.m_numberFormatDescriptor.DecimalSeparator)throw"Invalid Integer 2";else if(c==this.m_numberFormatDescriptor.NegativeSign||c=="("||c==")")negative=true;else{for(var j=0;j<10;j++)if(c==this.m_numberFormatDescriptor.NativeDigits[j]){c=j;break}c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)ret+=c;else throw"Invalid Integer 3";
}}ret=parseInt(ret,10);if(negative)ret=ret*-1;return ret}});
D2L.LP.Globalization.Formatting.Number.NativeDigitConverter=D2L.Class.extend({Construct:function(nativeDigits,useNativeDigits){this.m_nativeDigits=nativeDigits;this.m_useNativeDigits=useNativeDigits},Convert:function(value){if(this.m_useNativeDigits){value=value.toString();var toRet=new D2L.Util.StringBuilder;for(var i=0;i<value.length;i++){var x=parseInt(value.substr(i,1));if(!isNaN(x)&&x>=0&&x<=9)toRet.Append(this.m_nativeDigits[x]);else toRet.Append(value.substr(i,1))}return toRet.ToString()}else return value}});
D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor=D2L.Class.extend({Construct:function(decimalSeparator,groupSeparator,numberNegativePattern,percentPositivePattern,percentNegativePattern,percentSymbol,negativeSign,nativeDigits,useNativeDigits,groupSizes,integerRegex,decimalRegex){this.DecimalSeparator=decimalSeparator;this.GroupSeparator=groupSeparator;this.NumberNegativePattern=numberNegativePattern;this.PercentPositivePattern=percentPositivePattern;this.PercentNegativePattern=percentNegativePattern;
this.PercentSymbol=percentSymbol;this.NegativeSign=negativeSign;this.NativeDigits=nativeDigits;this.UseNativeDigits=useNativeDigits;this.GroupSizes=groupSizes;this.IntegerRegex=integerRegex;this.DecimalRegex=decimalRegex},_deserialize:function(deserializer){this.DecimalSeparator=deserializer.GetMember("DecimalSeparator");this.GroupSeparator=deserializer.GetMember("GroupSeparator");this.NumberNegativePattern=deserializer.GetMember("NumberNegativePattern");this.PercentPositivePattern=deserializer.GetMember("PercentPositivePattern");
this.PercentNegativePattern=deserializer.GetMember("PercentNegativePattern");this.PercentSymbol=deserializer.GetMember("PercentSymbol");this.NegativeSign=deserializer.GetMember("NegativeSign");this.NativeDigits=deserializer.GetMember("NativeDigits");this.UseNativeDigits=deserializer.GetMember("UseNativeDigits");this.GroupSizes=deserializer.GetMember("GroupSizes");this.IntegerRegex=deserializer.GetMember("IntegerRegex");this.DecimalRegex=deserializer.GetMember("DecimalRegex")}});
D2L.LP.Globalization.Formatting.Domain.Default.NumberFormatDescriptor=D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor;
D2L.LP.Globalization.Formatting.Number.NumberFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_numberFormatDescriptor.NativeDigits,this.m_numberFormatDescriptor.UseNativeDigits);this.m_integerFormatter=null;this.m_decimalFormatter=null;this.m_percentageFormatter=null},FormatInteger:function(value){if(this.m_integerFormatter===
null)this.m_integerFormatter=new D2L.LP.Globalization.Formatting.Number.IntegerFormatter(this.m_numberFormatDescriptor);return this.m_integerFormatter.Format(value)},FormatDecimalSimple:function(value){if(this.m_decimalFormatter===null)this.m_decimalFormatter=new D2L.LP.Globalization.Formatting.Number.DecimalFormatter(this.m_numberFormatDescriptor);return this.m_decimalFormatter.FormatSimple(value)},FormatDecimal:function(value,numOfDecimalPoints,trailingZeroes){if(this.m_decimalFormatter===null)this.m_decimalFormatter=
new D2L.LP.Globalization.Formatting.Number.DecimalFormatter(this.m_numberFormatDescriptor);return this.m_decimalFormatter.Format(value,numOfDecimalPoints,trailingZeroes)},FormatPercentageSimple:function(value,outOf){if(this.m_percentageFormatter===null)this.m_percentageFormatter=new D2L.LP.Globalization.Formatting.Number.PercentageFormatter(this.m_numberFormatDescriptor);return this.m_percentageFormatter.FormatSimple(value,outOf)},FormatPercentage:function(value,outOf,numOfDecimalPoints,trailingZeroes){if(this.m_percentageFormatter===
null)this.m_percentageFormatter=new D2L.LP.Globalization.Formatting.Number.PercentageFormatter(this.m_numberFormatDescriptor);return this.m_percentageFormatter.FormatSimple(value,outOf,numOfDecimalPoints,trailingZeroes)}});
D2L.LP.Globalization.Formatting.Number.NumberParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_integerParser=null;this.m_decimalParser=null},ParseInteger:function(value){if(this.m_integerParser===null)this.m_integerParser=new D2L.LP.Globalization.Formatting.Number.IntegerParser(this.m_numberFormatDescriptor);return this.m_integerParser.Parse(value)},ParseDecimal:function(value){if(this.m_decimalParser===null)this.m_decimalParser=
new D2L.LP.Globalization.Formatting.Number.DecimalParser(this.m_numberFormatDescriptor);return this.m_decimalParser.Parse(value)}});
D2L.LP.Globalization.Formatting.Number.PercentageFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_decimalFormatter=new D2L.LP.Globalization.Formatting.Number.DecimalFormatter(this.m_numberFormatDescriptor)},FormatSimple:function(value,outOf){var negative=false;value=parseFloat(value)/parseFloat(outOf);value=value*100;if(value<0){negative=true;value=value*-1}var ret=this.m_decimalFormatter.Format(value);if(negative)switch(this.m_numberFormatDescriptor.PercentNegativePattern){case 0:ret=
this.m_numberFormatDescriptor.NegativeSign+ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 4:ret=this.m_numberFormatDescriptor.PercentSymbol+ret+this.m_numberFormatDescriptor.NegativeSign;
break;case 5:ret=ret+this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol;break;case 6:ret=ret+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 7:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break;case 8:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 9:ret=this.m_numberFormatDescriptor.PercentSymbol+
" "+ret+this.m_numberFormatDescriptor.NegativeSign;break;case 10:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 11:ret=ret+this.m_numberFormatDescriptor.NegativeSign+" "+this.m_numberFormatDescriptor.PercentSymbol;break}else switch(this.m_numberFormatDescriptor.PercentPositivePattern){case 0:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.PercentSymbol+
ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break}return ret},Format:function(value,outOf,numOfDecimalPoints,trailingZeroes){if(isNaN(numOfDecimalPoints))return this.FormatSimple(value,outOf);else{var negative=false;value=parseFloat(value)/parseFloat(outOf);value=value*100;if(value<0){negative=true;value=value*-1}var ret=this.m_decimalFormatter.Format(value,numOfDecimalPoints,trailingZeroes);if(negative)switch(this.m_numberFormatDescriptor.PercentNegativePattern){case 0:ret=
this.m_numberFormatDescriptor.NegativeSign+ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 4:ret=this.m_numberFormatDescriptor.PercentSymbol+ret+this.m_numberFormatDescriptor.NegativeSign;
break;case 5:ret=ret+this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol;break;case 6:ret=ret+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 7:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break;case 8:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 9:ret=this.m_numberFormatDescriptor.PercentSymbol+
" "+ret+this.m_numberFormatDescriptor.NegativeSign;break;case 10:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 11:ret=ret+this.m_numberFormatDescriptor.NegativeSign+" "+this.m_numberFormatDescriptor.PercentSymbol;break}else switch(this.m_numberFormatDescriptor.PercentPositivePattern){case 0:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.PercentSymbol+
ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break}return ret}}});D2L.LP.Globalization.Formatting.Text={};D2L.LP.Globalization.Formatting.Text.TextDirection={LeftToRight:1,RightToLeft:2};D2L.LP.Globalization.Locale={};
D2L.LP.Globalization.Locale.Init=function(calendarType,numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor){D2L.LP.Globalization.Locale=new D2L.LP.Globalization.LocaleObject(calendarType,numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor)};
D2L.LP.Globalization.LocaleObject=D2L.Class.extend({Construct:function(calendarType,numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor){this.m_calendarType=calendarType;this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_textFormatDescriptor=textFormatDescriptor;this.m_culture=cultureCode;this.m_fuzzyDateTimeDescriptor=fuzzyDateTimeDescriptor;this.m_numberParser=null;this.m_numberFormatter=
null;this.m_dateTimeParser=null;this.m_dateTimeFormatter=null;this.m_calendar=null},GetNumberFormatDescriptor:function(){return this.m_numberFormatDescriptor},GetNumberParser:function(){if(this.m_numberParser===null)this.m_numberParser=new D2L.LP.Globalization.Formatting.Number.NumberParser(this.GetNumberFormatDescriptor());return this.m_numberParser},GetNumberFormatter:function(){if(this.m_numberFormatter===null)this.m_numberFormatter=new D2L.LP.Globalization.Formatting.Number.NumberFormatter(this.GetNumberFormatDescriptor());
return this.m_numberFormatter},GetDateTimeFormatDescriptor:function(){return this.m_dateTimeFormatDescriptor},GetFuzzyDateTimeDescriptor:function(){return this.m_fuzzyDateTimeDescriptor},GetDateTimeParser:function(){if(this.m_dateTimeParser===null)this.m_dateTimeParser=new D2L.LP.Globalization.Formatting.DateTime.DateTimeParser(this.GetDateTimeFormatDescriptor(),this.GetNumberParser());return this.m_dateTimeParser},GetDateTimeFormatter:function(){if(this.m_dateTimeFormatter===null)this.m_dateTimeFormatter=
new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatter(this.GetDateTimeFormatDescriptor(),this.GetFuzzyDateTimeDescriptor());return this.m_dateTimeFormatter},GetTextFormatDescriptor:function(){return this.m_textFormatDescriptor},GetCultureCode:function(){return this.m_culture},GetCalendar:function(){if(this.m_calendar===null)this.m_calendar=new D2L.LP.Globalization.Calendars.Calendar(this.m_calendarType);return this.m_calendar}});
D2L.Culture=D2L.Class.extend({Construct:function(){this.decimalRegex="";this.integerRegex="";this.m_isRightToLeft=false;this.m_decimalSeparator=".";this.m_negativeFormat=1;this.m_negativeSign="-";this.m_groupSeparator=",";this.m_nativeDigits=["0","1","2","3","4","5","6","7","8","9"];this.m_percentSymbol="%";this.m_percentPositivePattern=0;this.m_percentNegativePattern=0;this.m_hasNativeDigitsSupport=false;this.m_groupSizes=[];this.m_numberFormatDescriptor=null;this.m_numberParser=null;this.m_numberFormatter=
null},DeserializeMin:function(deserializer){this.decimalRegex=deserializer.GetMember();this.integerRegex=deserializer.GetMember();this.m_isRightToLeft=deserializer.GetBoolean();this.m_decimalSeparator=deserializer.GetMember();this.m_negativeFormat=deserializer.GetMember();this.m_negativeSign=deserializer.GetMember();this.m_groupSeparator=deserializer.GetMember();this.m_nativeDigits=deserializer.GetMember();this.m_percentSymbol=deserializer.GetMember();this.m_percentPositivePattern=deserializer.GetMember();
this.m_percentNegativePattern=deserializer.GetMember();this.m_hasNativeDigitsSupport=deserializer.GetBoolean();this.m_groupSizes=deserializer.GetMember()},GetNumberFormatDescriptor:function(){if(this.m_numberFormatDescriptor===null)this.m_numberFormatDescriptor=new D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor(this.m_decimalSeparator,this.m_groupSeparator,this.m_negativeFormat,this.m_percentPositivePattern,this.m_percentNegativePattern,this.m_percentSymbol,this.m_negativeSign,this.m_nativeDigits,
this.m_hasNativeDigitsSupport,this.m_groupSizes,this.integerRegex,this.decimalRegex);return this.m_numberFormatDescriptor},GetNumberParser:function(){if(this.m_numberParser===null)this.m_numberParser=new D2L.LP.Globalization.Formatting.Number.NumberParser(this.GetNumberFormatDescriptor());return this.m_numberParser},GetNumberFormatter:function(){if(this.m_numberFormatter===null)this.m_numberFormatter=new D2L.LP.Globalization.Formatting.Number.NumberFormatter(this.GetNumberFormatDescriptor());return this.m_numberFormatter},
FormatFileSize:function(size){var bytesPerKilo=1024;var bytesPerMega=bytesPerKilo*1024;var bytesPerGiga=bytesPerMega*1024;if(size>=bytesPerGiga)return new D2L.LP.Text.LangTerm("Standard.FileSizeUnitShort.txtGigaBytesString",D2L.Util.Decimal.Format(Math.round(size/bytesPerGiga*100)/100));else if(size>=bytesPerMega)return new D2L.LP.Text.LangTerm("Standard.FileSizeUnitShort.txtMegaBytesString",D2L.Util.Decimal.Format(Math.round(size/bytesPerMega*100)/100));else if(size>=bytesPerKilo)return new D2L.LP.Text.LangTerm("Standard.FileSizeUnitShort.txtKiloBytesString",
D2L.Util.Decimal.Format(Math.round(size/bytesPerKilo*100)/100));else if(size==1)return new D2L.LP.Text.LangTerm("Standard.FileSizeUnitShort.txtByteString",D2L.Util.Integer.Format(size));else return new D2L.LP.Text.LangTerm("Standard.FileSizeUnitShort.txtBytesString",D2L.Util.Integer.Format(size))},PluralizeText:function(num,singular,plural){return num==1?singular:plural},Pluralize:function(num,singular,plural){return num+" "+this.PluralizeText(num,singular,plural)},GetMarginPaddingPosition:function(marginPaddingPosition){if(marginPaddingPosition==
D2L.Culture.MarginPaddingPosition.First)if(this.IsRightToLeft())return"Right";else return"Left";else if(this.IsRightToLeft())return"Left";else return"Right"},GetFloat:function(val){if(this.IsRightToLeft())if(val==D2L.Style.Float.Left)return D2L.Style.Float.Right;else if(val==D2L.Style.Float.Right)return D2L.Style.Float.Left;else return val;else return val},IsRightToLeft:function(){return this.m_isRightToLeft},DecimalSeparator:function(){return this.m_decimalSeparator},NegativeFormat:function(){return this.m_negativeFormat},
NegativeSign:function(){return this.m_negativeSign},GroupSeparator:function(){return this.m_groupSeparator},PercentSymbol:function(){return this.m_percentSymbol},PercentPositivePattern:function(){return this.m_percentPositivePattern},PercentNegativePattern:function(){return this.m_percentPositivePattern},GroupSizes:function(){return this.m_groupSizes},NativeDigits:function(){return this.m_nativeDigits},ConvertToNativeDigit:function(value){value=value.toString();if(this.m_hasNativeDigitsSupport){var toRet=
new D2L.Util.StringBuilder;for(var i=0;i<value.length;i++){var x=parseInt(value.substr(i,1));if(!isNaN(x)&&x>=0&&x<=9)toRet.Append(this.m_nativeDigits[x]);else toRet.Append(value.substr(i,1))}return toRet.ToString()}else return value},LimitChars:function(value,numChars){if(numChars<1||value.length<=numChars)return value;if(value.length>=3)value=value.substr(0,numChars-3)+"...";return value}});
function d2l_TimeSpan(days,hours,minutes,seconds){this.Days=days;this.Hours=hours;this.Minutes=minutes;this.Seconds=seconds}D2L.Culture.MarginPaddingPosition={First:0,Last:1};
function FindEventController(){if(window.EventController)return window.EventController;else if(window.parent!=window)try{if(window.parent.window.EventController)return window.parent.window.EventController;else if(window.parent.window.FindEventController)return window.parent.window.FindEventController()}catch(e){}else try{if(window.opener&&!window.opener.closed)if(window.opener.window.EventController)return window.opener.window.EventController;else if(window.opener.window.FindEventController)return window.opener.window.FindEventController()}catch(e){}return null}
function RaiseEvent(evtName,args){if(Events!==undefined&&Events[evtName]!==undefined)Events[evtName].Raise(args)}
D2L.WindowEventManager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.Click=new D2L.EventHandler;this.KeyPress=new D2L.EventHandler;this.Resize=new D2L.EventHandler;this.Transform=new D2L.EventHandler;this.BC=this.BubbleChangeEvent;this.BE=this.BubbleExpandEvent;this.HideContextMenus=new D2L.EventHandler;this.m_iframes=new Array;var me=this;var clickFunc=function(evt){WindowEventManager.Click.Trigger(new D2L.Event("click",evt));D2L.LP.Web.UI.Events.OnClick.Trigger(evt)};
var handleResize=function(evt){try{me.Resize.Trigger(new D2L.Event("resize",evt));D2L.LP.Web.UI.Events.OnResize.Trigger()}catch(e){}};var onResizeTimer=function(evt){if(me.resizeTimer)clearTimeout(me.resizeTimer);me.resizeTimer=setTimeout(handleResize,100)};var handleMove=function(e){D2L.LP.Web.UI.Events.OnMouseMove.Trigger(e)};var handleUp=function(e){D2L.LP.Web.UI.Events.OnMouseUp.Trigger(e)};var handleDown=function(e){D2L.LP.Web.UI.Events.m_lastMouseDownPosition=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,
e)};D2L.LP.Web.UI.Html.Dom.AddEventListener("mousemove",document,handleMove);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseup",document,handleUp);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",document,handleDown);D2L.LP.Web.UI.Html.Dom.AddEventListener("storage",window,function(e){D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:e.key,NewValue:e.newValue,OldValue:e.oldValue})});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(document,function(keyPressEventArg){D2L.LP.Web.UI.Events.OnKeyPress.Trigger(keyPressEventArg)});
if(document.addEventListener){document.addEventListener("click",clickFunc,false);window.addEventListener("resize",handleResize,false)}else if(document.attachEvent){document.attachEvent("onclick",clickFunc);window.attachEvent("onresize",onResizeTimer)}this.InstallKpel(document,function(obj,evt){return WindowEventManager.KeyPress.Trigger(evt)});UI.OnPageLoad().RegisterMethod(function(){me.Transform.Trigger()})},InstallKpel:function(obj,callback){if(obj===undefined||obj===null)return;if(obj.addEventListener){obj.addEventListener("keypress",
function(evt){var key=0;var character="";if(evt.charCode&&evt.charCode!==0){key=parseInt(evt.charCode);character=String.fromCharCode(evt.charCode)}else if(evt.keyCode&&evt.keyCode!==0)key=parseInt(evt.keyCode);return callback.call(obj,obj,new D2L.KeyPressEvent(key,character,evt,null))},false);if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Safari||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Chrome||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)obj.addEventListener("keydown",function(evt){var key=
parseInt(evt.keyCode);if(D2L.KeyPressEvent.IsCharacter(key))key=0;if(key!==0)return callback.call(obj,obj,new D2L.KeyPressEvent(key,"",evt,null));else return false},false)}else if(obj.attachEvent){var smush=0;obj.attachEvent("onkeydown",function(){if(window.event.keyCode==D2L.KeyPressEvent.Key.Backspace)return callback.call(obj,obj,new D2L.KeyPressEvent(window.event.keyCode,"",window.event,null));else smush=window.event.keyCode;return true});obj.attachEvent("onkeypress",function(){if(window.event&&
window.event.keyCode)if(window.event.keyCode==D2L.KeyPressEvent.Key.Enter||window.event.keyCode>=32&&window.event.keyCode<=126){smush=0;return callback.call(obj,obj,new D2L.KeyPressEvent(window.event.keyCode,String.fromCharCode(window.event.keyCode),window.event,null))}return true});obj.attachEvent("onkeyup",function(){if(window.event&&window.event.keyCode==smush)return callback.call(obj,obj,new D2L.KeyPressEvent(window.event.keyCode,"",window.event,null));return true})}},BubbleChangeEvent:function(source,
eventObj){var event=new D2L.ChangeEvent(source,eventObj);event.Bubble()},BubbleExpandEvent:function(source,eventObj){var event=new D2L.ExpandEvent(source,eventObj);event.Bubble()},BubbleRemoveEvent:function(source){var e=new D2L.RemoveEvent(source);e.Bubble(false)}});
D2L.Event=D2L.Class.extend({Construct:function(type,source,eventObj){arguments.callee.$.Construct.call(this);this.type=type;this.source=source;this.m_doBubble=true;this.eventObj=eventObj},BubbleDownByClassName:function(className){if(D2L.Util.Html.IsDomNode(this.source)){var nodesCollection=D2L.Util.Dom.GetElementsByClassName(this.source,className);var nodes=[];for(var i=0;i<nodesCollection.length;i++)nodes.push(nodesCollection[i]);if(D2L.Util.Dom.HasClassName(className,this.source)>=0)nodes.push(this.source);
if(nodes.length>0){var typeName="Default";for(var tn in D2L.Event.Type)if(D2L.Event.Type[tn]==this.type){typeName=tn;break}for(var i=0;i<nodes.length;i++){var node=nodes[i];var eventHandlerName="ID2LOn"+typeName;if(node[eventHandlerName])node[eventHandlerName].Trigger(this)}}}},Bubble:function(doBubbleUp){if(doBubbleUp===undefined)doBubbleUp=true;var typeName="Default";for(var tn in D2L.Event.Type)if(D2L.Event.Type[tn]==this.type){typeName=tn;break}var eventHandlerName="ID2LOn"+typeName;var me=this;
var Up=function(node){if(node){if(node[eventHandlerName])node[eventHandlerName].Trigger(me);if(node.parentNode&&me.DoBubble())Up(node.parentNode)}};var Down=function(node){if(node[eventHandlerName]!==undefined)node[eventHandlerName].Trigger(me);if(me.DoBubble()){if(node.cells!==undefined)for(var i=0;i<node.cells.length;i++)Down(node.cells[i]);if(node.rows!==undefined)for(var i=0;i<node.rows.length;i++)Down(node.rows[i]);for(var i=0;i<node.childNodes.length;i++)Down(node.childNodes[i])}};if(doBubbleUp)Up(this.source);
else Down(this.source)},GetDomEvent:function(){return this.eventObj},CancelBubbling:function(){this.m_doBubble=false},DoBubble:function(){return this.m_doBubble},ResumeBubbling:function(){this.m_doBubble=true}});D2L.Event.Type={Default:1,Change:2,KeyPress:3,Expand:4,Transform:5,Remove:7,Scroll:8,DisplayVisible:9};D2L.ChangeEvent=D2L.Event.extend({Construct:function(source,eventObj){arguments.callee.$.Construct.call(this,D2L.Event.Type.Change,source,eventObj);this.hasChangeBeenShown=false}});
D2L.KeyPressEvent=D2L.Event.extend({Construct:function(keyCode,character,evt,source){arguments.callee.$.Construct.call(this,D2L.Event.Type.KeyPress,source,evt);this.m_keyCode=keyCode;this.m_character=character},IsNumber:function(){var key=this.GetKey();return key>=48&&key<=57},GetKey:function(){return this.m_keyCode},GetCharacter:function(){return this.m_character},Cancel:function(){if(this.eventObj.preventDefault)this.eventObj.preventDefault()},StopPropagation:function(){if(this.eventObj.stopPropagation)this.eventObj.stopPropagation();
else if(this.eventObj.cancelBubble!==undefined)this.eventObj.cancelBubble=true}});D2L.KeyPressEvent.Key={Backspace:8,Enter:13,Escape:27,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.KeyPressEvent.IsCharacter=function(key){return key!=D2L.KeyPressEvent.Key.Backspace&&key!=D2L.KeyPressEvent.Key.Escape&&key!=D2L.KeyPressEvent.Key.ArrowLeft&&key!=D2L.KeyPressEvent.Key.ArrowUp&&key!=D2L.KeyPressEvent.Key.ArrowRight&&key!=D2L.KeyPressEvent.Key.ArrowDown&&key!=D2L.KeyPressEvent.Key.Delete};
D2L.DisplayVisibleEvent=D2L.Event.extend({Construct:function(source){arguments.callee.$.Construct.call(this,D2L.Event.Type.DisplayVisible,source)},Bubble:function(){this.BubbleDownByClassName("D2LEventDV")}});D2L.ExpandEvent=D2L.Event.extend({Construct:function(source,eventObj){arguments.callee.$.Construct.call(this,D2L.Event.Type.Expand,source,eventObj)},Bubble:function(doBubbleUp){UI.GetDisplayGroupManager().Init();arguments.callee.$.Bubble.call(this,doBubbleUp)}});
D2L.RemoveEvent=D2L.Event.extend({Construct:function(source){arguments.callee.$.Construct.call(this,D2L.Event.Type.Remove,source)}});D2L.TransformEvent=D2L.Event.extend({Construct:function(source){arguments.callee.$.Construct.call(this,D2L.Event.Type.Transform,source)}});
D2L.EventHandler=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.methodListeners=new Array;this.objectListeners=new Array;this.jsListeners=new Array;this.ignoreEvents=false},RegisterJs:function(js){this.jsListeners.push(js)},RegisterMethod:function(method){var found=false;for(var i=0;i<this.methodListeners.length;i++)if(this.methodListeners[i]==method){found=true;break}if(!found)this.methodListeners.push(method)},Register:function(obj,method){var found=false;for(var i=
0;i<this.objectListeners.length;i++)if(this.objectListeners[i].object==obj&&this.objectListeners[i].method==method){found=true;break}if(!found){var pair=new Object;pair.object=obj;pair.method=method;this.objectListeners.push(pair)}},SetIgnoreEvents:function(bool){this.ignoreEvents=bool},Trigger:function(){if(this.ignoreEvents)return false;var result=true;var i;for(i=0;i<this.methodListeners.length;i++)try{result=this.methodListeners[i].apply(this.methodListeners[i],arguments);if(result===false)return false}catch(e){if(D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled())throw e;
}var pair,object,method;for(i=0;i<this.objectListeners.length;i++){method=null;object=null;try{pair=this.objectListeners[i];object=pair.object;method=object[pair.method]}catch(e){}if(method!==undefined&&method!==null&&object!==undefined&&object!==null){result=method.apply(object,arguments);if(result===false)return false}}for(i=0;i<this.jsListeners.length;i++)eval(this.jsListeners[i]);return true}});
D2L.Files.FilterType={All:0,WordProcessing:6,Archive:2,Images:1,Web:3,Spreadsheet:7,Presentation:8,Media:4,LiveRoom:5,Pdf:9,Executable:10,QuickTime:11,Xml:12,Text:13};D2L.Files.Area={MyComputer:"mycomputer",OuFiles:"oufiles",SharedFiles:"sharedfiles",MyLocker:"mylocker",GroupLocker:"grouplocker",LearningPortfolio:"learningportfolio"};D2L.Files.MaxDirectoryNameCharacters=50;D2L.Files.MaxFileNameCharacters=128;
D2L.Files.ValidDirectoryNameRegex='^([^\\\\/:*?"<>|]{0,'+(D2L.Files.MaxDirectoryNameCharacters-1)+'}[^\\\\./:*?"<>|])?$';D2L.Files.ValidFileNameRegex='^([^\\\\/:*?"<>|]{0,'+(D2L.Files.MaxFileNameCharacters-1)+'}[^\\./:*?"<>|])?$';D2L.Files.ValidFileNameNoMaxCharactersRegex='^([^\\\\/:*?"<>|]*[^\\\\./:*?"<>|])?$';D2L.Files.InvalidFileNameCharactersRegex='[\\\\/:*?"<>|]';D2L.Files.InvalidDirectoryNameCharacters='\\ / : * ? " < > |';D2L.Files.InvalidFileNameCharacters='\\ / : * ? " < > |';
D2L.Files.FileTypeInfo=D2L.Class.extend({Construct:function(image,description){arguments.callee.$.Construct.call(this);this.m_image=image;this.m_description=description},GetImageInfo:function(){return this.GetImage()},GetImage:function(){return this.m_image},GetDescription:function(){return this.m_description}});
D2L.Files.FileInfo=D2L.Class.extend({Construct:function(fileSystemType,fileId,fileName,size,description){arguments.callee.$.Construct.call(this);if(fileSystemType===undefined)fileSystemType="";if(fileId===undefined)fileId="";if(fileName===undefined)fileName="";if(size===undefined)size=0;size=parseInt(size);if(description===undefined)description="";this.FileSystemType=fileSystemType;this.FileId=fileId;this.FileName=fileName;this.Size=size;this.LastModified=0;this.m_description=description},Deserialize:function(deserializer){this.FileSystemType=
deserializer.GetMember("FileSystemType");this.FileId=deserializer.GetMember("FileId");this.FileName=deserializer.GetMember("FileName");this.Size=deserializer.GetMember("Size");this.LastModified=deserializer.GetMember("LastModified");this.m_description=deserializer.GetMember("Description")},DeserializeMin:function(deserializer){this.FileId=deserializer.GetMember();this.FileSystemType=deserializer.GetMember();this.FileName=deserializer.GetMember();this.Size=deserializer.GetMember();this.LastModified=
deserializer.GetMember();this.m_description=deserializer.GetMember()},Serialize:function(serializer){serializer.AddMember("FileSystemType",this.GetFileSystemType());serializer.AddMember("FileId",this.GetFileId());serializer.AddMember("FileName",this.GetFileName());serializer.AddMember("Size",this.GetSize());serializer.AddMember("LastModified",this.GetLastModified());serializer.AddMember("Description",this.GetDescription())},Equals:function(fileInfo){if(fileInfo===null||fileInfo===undefined)return false;
return this.GetFileSystemType()!=fileInfo.GetFileSystemType()||this.GetFileId()!=fileInfo.GetFileId()||this.GetFileName()!=fileInfo.GetFileName()||this.GetSize()!=fileInfo.GetSize()||this.GetLastModified()!=fileInfo.GetLastModified()||this.GetDescription()!=fileInfo.GetDescription()},GetFileSystemType:function(){return this.FileSystemType},GetFileId:function(){return this.FileId},GetFileName:function(){return this.FileName},GetSize:function(){return this.Size},GetLastModified:function(){return this.LastModified},
GetDescription:function(){return this.m_description},Rename:function(newFileName){this.FileName=newFileName}});
D2L.Files.HandleFileNameDuplicates=function(control,path,vFiles,vFile,showOverwrite){var dr=new D2L.Util.DelayedReturn;D2L.Files.HandleFileNameDuplicates.InProgress=true;if(showOverwrite===undefined)showOverwrite=true;var Finish=function(result){D2L.Files.HandleFileNameDuplicates.InProgress=false;dr.Trigger(result)};var fileNames=[];for(var i=0;i<control.Children().length;i++){var file=control.Children()[i].GetFile();if(file)fileNames.push(file.GetFileName());else if(control.Children()[i].GetFileName){var fileNameRaw=
control.Children()[i].GetFileName(false);if(fileNameRaw!=null&&fileNameRaw.trim()!="")fileNames.push(fileNameRaw)}}var vFilesCallback=function(duplicateFileNames){var ShowDuplicateDialog=function(index){if(index>=duplicateFileNames.length)Finish(true);else{var fileName=duplicateFileNames[index];var item=null;for(var i=0;i<control.Children().length;i++){var fileD=control.Children()[i].GetFile();var fileNameD;if(fileD)fileNameD=fileD.GetFileName();else if(control.Children()[i].GetFileName){var fileNameRaw=
control.Children()[i].GetFileName(false);if(fileNameRaw!=null&&fileNameRaw.trim()!="")fileNameD=fileNameRaw}if(fileNameD==fileName){item=control.Children()[i];break}}var DuplicateDialogCallback=function(dupDialogResponse){if(dupDialogResponse.GetType()==D2L.Dialog.ResponseType.Positive){if(item)item.m_overwriteFileName=true;dupDialogResponse.GetDialog().Close();ShowDuplicateDialog(++index)}else{dupDialogResponse.GetDialog().Close();Finish(false)}};if(!item.m_overwriteFileName)if(!showOverwrite){UI.Error(new D2L.LP.Text.LangTerm("FrameworkWebPages.DuplicateFileNameDialog.lblErrorPrimary",
fileName,path));Finish(false)}else UI.Confirm(DuplicateDialogCallback,new D2L.LP.Text.LangTerm("FrameworkWebPages.DuplicateFileNameDialog.lblPrimary",fileName,path),new D2L.LP.Text.LangTerm("FrameworkWebPages.DuplicateFileNameDialog.lblSecondary"));else ShowDuplicateDialog(++index)}};if(duplicateFileNames.length===0)Finish(true);else ShowDuplicateDialog(0)};if(fileNames.length===0)Finish(true);else vFiles(fileNames,path).Register(vFilesCallback);return dr};
D2L.Files.HandleFileNameDuplicates.InProgress=false;D2L.Files.CleanFileName=function(fileName){var regExp=new RegExp(D2L.Files.InvalidFileNameCharactersRegex,"g");return fileName.replace(regExp,"")};
D2L.Files.GetFileTypeInfo=function(fileName){var dr=new D2L.Util.DelayedReturn;var Handle=function(){var ext=fileName.substr(fileName.lastIndexOf(".")).toLowerCase();if(D2L.Files.TypeInfos[ext])dr.Trigger(D2L.Files.TypeInfos[ext]);else{var oldDef=D2L.Files.TypeInfos["*"];dr.Trigger(new D2L.Files.FileTypeInfo(oldDef.GetImageInfo(),oldDef.GetDescription().replace("[0]",ext.substr(1).toUpperCase())))}};if(D2L.Files.TypeInfos===null){D2L.Files.TypeInfosDr=new D2L.Util.DelayedReturn;D2L.Files.TypeInfosDr.Register(Handle);
D2L.LP.Web.UI.Html.JavaScript.IncludeScript("/d2l/common/language/fileTypeInfo.d2l",{"ou":Global.OrgUnitId})}else Handle();return dr};D2L.Images={};
D2L.Images.Image=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.ClassName="D2L.Images.Image";this.m_width=0;this.m_height=0;this.m_path=""},Assign:function(image,makeSizeRelative){this.GetSrc().Register(function(src){image.src=src});var width=this.GetWidth();var height=this.GetHeight();if(width>0&&height>0){image.style.width=width+"px";image.style.height=height+"px"}},Deserialize:function(deserializer){this.m_height=deserializer.GetMember("H");this.m_width=deserializer.GetMember("W");
var path=deserializer.GetMember("F");if(path.substr(0,1)!="/"&&!D2L.Util.Url.IsExternal(path))this.m_path="/d2l/img/"+path;else this.m_path=path},DeserializeMin:function(deserializer){this.m_path=deserializer.GetMember();if(this.m_path.substr(0,1)!="/"&&!D2L.Util.Url.IsExternal(this.m_path))this.m_path="/d2l/img/"+this.m_path+"?v="+Global.ImageVersion;if(deserializer.HasMember()){this.m_height=deserializer.GetMember();if(deserializer.HasMember())this.m_width=deserializer.GetMember();else this.m_width=
this.m_height}else{this.m_height=16;this.m_width=16}},GetHeight:function(){return this.m_height},GetSrc:function(){if(this.m_path.length>0)return new D2L.Util.DelayedReturn(this.m_path);else return new D2L.Util.DelayedReturn("/d2l/img/lp/pixel.gif")},GetWidth:function(){return this.m_width},Serialize:function(serializer){serializer.AddMember("ClassName",this.ClassName);serializer.AddMember("W",this.m_width);serializer.AddMember("H",this.m_height);serializer.AddMember("F",this.m_path)}});
D2L.Images.ImageInfo=D2L.Images.Image.extend({Construct:function(imageFile,width,height){arguments.callee.$.Construct.call(this);if(imageFile===undefined)imageFile="";if(width===undefined)width=0;if(height===undefined)height=0;this.m_path=imageFile;this.m_width=width;this.m_height=height},GetImageFile:function(){return this.m_path}});
D2L.Images.ImageTerm=D2L.Images.Image.extend({Construct:function(termName){arguments.callee.$.Construct.call(this);if(termName===undefined)termName="";this.m_termName=termName.toLowerCase();this.m_image=null},GetSrc:function(){if(D2L.Images.ImageTerm.SrcCache[this.m_termName]!==undefined)return new D2L.Util.DelayedReturn(D2L.Images.ImageTerm.SrcCache[this.m_termName]);if(this.m_image!==null)return this.m_image.GetSrc();var dr=new D2L.Util.DelayedReturn;var me=this;UI.GetLanguageManager().GetImageTerm(this.m_termName).Register(function(image){me.m_image=
image;image.GetSrc().Register(function(src){D2L.Images.ImageTerm.SrcCache[me.m_termName]=src;dr.Trigger(src)})});return dr},GetTermName:function(){return this.m_name}});D2L.Images.ImageTerm.SrcCache={};D2L.Images.ImageTerm.Assign=function(termName,image,makeSizeRelative){var term=new D2L.Images.ImageTerm(termName);term.Assign(image,makeSizeRelative)};D2L.LP.Web.ISF={};D2L.LP.Web.ISF.UploadValidationResults={Invalid:0,Valid:1,Exists:2};
D2L.Language={Collections:{},ImageCollections:{},PrefetchedTerms:{},PrefetchedImageTerms:{},ImageTerm:D2L.Images.ImageTerm,InitImg:function(collections,images){for(var collectionName in collections)D2L.Language.InitImgCol(collectionName,collections[collectionName]);for(var termName in images)D2L.Language.PrefetchedImageTerms[termName]=D2L.Serialization.JsonDeserializerMin.Deserialize(images[termName],D2L.Images.Image)},InitImgCol:function(collectionName,collection){var newCollection={};for(var termName in collection)newCollection[termName]=
D2L.Serialization.JsonDeserializerMin.Deserialize(collection[termName],D2L.Images.Image);D2L.Language.ImageCollections[collectionName]=newCollection},InitLang:function(collections,terms){D2L.Language.Collections=collections;D2L.Language.PrefetchedTerms=terms}};
D2L.Language.LanguageManager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_cachedImageObjects={};this.m_waitingCollections={};this.m_waitingImageCollections={};this.SmlProcessor=new D2L.Sml.SmlProcessor;var me=this;this.OnCollectionLoad=new D2L.EventHandler;this.OnCollectionLoad.RegisterMethod(function(collectionName){if(me.m_waitingCollections[collectionName])me.m_waitingCollections[collectionName].Trigger()});this.OnImageCollectionLoad=new D2L.EventHandler;
this.OnImageCollectionLoad.RegisterMethod(function(collectionName){if(me.m_waitingImageCollections[collectionName])me.m_waitingImageCollections[collectionName].Trigger()})},GetCollection:function(collection){collection=collection.toLowerCase();if(D2L.Language.Collections[collection]!==undefined)return new D2L.Util.DelayedReturn(D2L.Language.Collections[collection]);var dr=new D2L.Util.DelayedReturn;if(this.m_waitingCollections[collection]===undefined){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("Client-side fetch of language collection: '"+
collection+"'.");this.m_waitingCollections[collection]=new D2L.Util.DelayedReturn;D2L.LP.Web.UI.Html.JavaScript.IncludeScript("/d2l/common/language/language.d2l",{"ou":Global.OrgUnitId,"collection":collection,"lid":Global.Language.LanguageId,"v":Global.Language.LanguageVersion})}this.m_waitingCollections[collection].Register(function(){dr.Trigger(D2L.Language.Collections[collection])});return dr},GetCollectionName:function(term){return term.substring(0,term.lastIndexOf(".")).toLowerCase()},GetImageCollection:function(collection){collection=
collection.toLowerCase();if(D2L.Language.ImageCollections[collection]!==undefined)return new D2L.Util.DelayedReturn(D2L.Language.ImageCollections[collection]);var dr=new D2L.Util.DelayedReturn;if(this.m_waitingImageCollections[collection]===undefined){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("Client-side fetch of image collection: '"+collection+"'.");this.m_waitingImageCollections[collection]=new D2L.Util.DelayedReturn;D2L.LP.Web.UI.Html.JavaScript.IncludeScript("/d2l/common/language/image.d2l",
{"ou":Global.OrgUnitId,"isi":Global.ImageSetId,"iv":Global.ImageVersion,"collection":collection})}this.m_waitingImageCollections[collection].Register(function(){dr.Trigger(D2L.Language.ImageCollections[collection])});return dr},GetPrefetchedTerm:function(term){term=term.toLowerCase();if(D2L.Language.PrefetchedTerms[term]!==undefined)return D2L.Language.PrefetchedTerms[term];else{var collectionName=this.GetCollectionName(term);var termName=this.GetTermName(term,collectionName);if(D2L.Language.Collections[collectionName]!==
undefined&&D2L.Language.Collections[collectionName][termName]!==undefined)return D2L.Language.Collections[collectionName][termName]}return""},GetTerm:function(term){term=term.toLowerCase();var dr=new D2L.Util.DelayedReturn;var collectionName=this.GetCollectionName(term);var termName=this.GetTermName(term,collectionName);if(D2L.Language.PrefetchedTerms[term]!==undefined)dr.Trigger(D2L.Language.PrefetchedTerms[term]);else this.GetCollection(collectionName).Register(function(collection){if(collection[termName])dr.Trigger(collection[termName])});
return dr},GetTermName:function(term,collectionName){return term.substr(collectionName.length+1)},GetImageTerm:function(term){var dr=new D2L.Util.DelayedReturn;term=term.toLowerCase();var collectionName=this.GetCollectionName(term);var termName=this.GetTermName(term,collectionName);var me=this;if(this.m_cachedImageObjects[term]!==undefined)dr.Trigger(this.m_cachedImageObjects[term]);else if(D2L.Language.PrefetchedImageTerms[term]!==undefined){this.m_cachedImageObjects[term]=D2L.Language.PrefetchedImageTerms[term];
dr.Trigger(D2L.Language.PrefetchedImageTerms[term])}else this.GetImageCollection(collectionName).Register(function(collection){if(collection[termName]){me.m_cachedImageObjects[termName]=collection[termName];dr.Trigger(collection[termName])}});return dr},GetPrefetchedImageTerm:function(term){term=term.toLowerCase();var image=null;if(D2L.Language.PrefetchedImageTerms[term]!==undefined)image=D2L.Language.PrefetchedImageTerms[term];else{var collectionName=this.GetCollectionName(term);var termName=this.GetTermName(term,
collectionName);if(D2L.Language.ImageCollections[collectionName]!==undefined)image=D2L.Language.ImageCollections[collectionName][termName]}if(image!==undefined&&image!==null)return new D2L.Images.ImageInfo(image.m_path);else return new D2L.Images.ImageInfo("/d2l/common/img/failed_cache_image.gif",16,16)},HasTerm:function(term){term=term.toLowerCase();var collectionName=this.GetCollectionName(term);var termName=this.GetTermName(term,collectionName);return D2L.Language.PrefetchedTerms[term]!==undefined||
D2L.Language.Collections[collectionName]!==undefined&&D2L.Language.Collections[collectionName][termName]!==undefined}});D2L.LP.LayeredArch={};
D2L.LP.LayeredArch.PagingInfo=D2L.Class.extend({Construct:function(pageSize,pageNumber){if(pageSize===undefined)pageSize=20;if(pageNumber===undefined)pageNumber=1;arguments.callee.$.Construct.call(this);this.m_pageSize=pageSize;this.m_pageNumber=pageNumber},Deserialize:function(deserializer){this.m_pageSize=deserializer.GetMember("PageSize");this.m_pageNumber=deserializer.GetMember("PageNumber")},GetPageSize:function(){return this.m_pageSize},GetPageNumber:function(){return this.m_pageNumber},Serialize:function(serializer){serializer.AddMember("PageSize",
this.GetPageSize());serializer.AddMember("PageNumber",this.GetPageNumber())},SetPageSize:function(pageSize){this.m_pageSize=pageSize},SetPageNumber:function(pageNumber){this.m_pageNumber=pageNumber}});D2L.LP.LayeredArch.SelectionFilterTypes={None:0,All:1,AllExcept:2,Some:3};
D2L.LP.LayeredArch.SortingInfo=D2L.Class.extend({Construct:function(sortField,isAscending,collationCultureCode){if(sortField===undefined)sortField="";if(isAscending===undefined)isAscending=true;if(collationCultureCode===undefined)collationCultureCode=null;arguments.callee.$.Construct.call(this);this.m_collationCultureCode=null;this.m_isAscending=isAscending;this.m_sortField=sortField},Deserialize:function(deserializer){this.m_isAscending=deserializer.GetMember("IsAscending");this.m_sortField=deserializer.GetMember("SortField");
if(deserializer.HasMember("CollationCultureCode"))this.m_collationCultureCode=deserializer.GetMember("CollationCultureCode")},GetCollationCultureCode:function(){return this.m_collationCultureCode},GetSortField:function(){return this.m_sortField},IsAscending:function(){return this.m_isAscending},Serialize:function(serializer){serializer.AddMember("SortField",this.GetSortField());serializer.AddMember("IsAscending",this.IsAscending());serializer.AddMember("CollationCultureCode",this.GetCollationCultureCode())},
SetIsAscending:function(isAscending){this.m_isAscending=isAscending},SetSortField:function(sortField){this.m_sortField=sortField}});D2L.Layouts={};
D2L.Layouts.ViewModeIntegration=function(domNodeId){var tableNode=UI.GetById(domNodeId);var Transform=function(){setTimeout(function(){for(var i=0;i<tableNode.rows.length;i++){var row=tableNode.rows[i];for(var j=0;j<row.cells.length;j++){var cell=row.cells[j];for(var k=0;k<cell.childNodes.length;k++){var child=cell.childNodes[k];if(child.className&&child.className.indexOf("dlay_autofill")!=-1)child.style.height="auto";else if(child.firstChild&&child.firstChild.className&&child.firstChild.className.indexOf("dlay_autofill")!=
-1)child.firstChild.style.height="auto"}}}D2L.Layouts.Adjustautofill(tableNode)},0)};WindowEventManager.Transform.RegisterMethod(function(){try{Transform()}catch(e){}});try{Transform()}catch(e){}};
D2L.Layouts.Adjustautofill=function(tableNode){for(var i=0;i<tableNode.rows.length;i++){var row=tableNode.rows[i];for(var j=0;j<row.cells.length;j++){var cell=row.cells[j];var panelsWithautofill=[];for(var k=0;k<cell.childNodes.length;k++){var child=cell.childNodes[k];if(child.className&&child.className.indexOf("dlay_autofill")!=-1)panelsWithautofill.push(child);else if(child.firstChild&&child.firstChild.className&&child.firstChild.className.indexOf("dlay_autofill")!=-1)panelsWithautofill.push(child.firstChild)}for(var k=
0;k<panelsWithautofill.length;k++)panelsWithautofill[k].style.height="auto";var originalCellHeight=cell.offsetHeight;if(panelsWithautofill.length>0){var originalHeight=panelsWithautofill[panelsWithautofill.length-1].offsetHeight;var increase=originalCellHeight+1;panelsWithautofill[panelsWithautofill.length-1].style.height=panelsWithautofill[panelsWithautofill.length-1].offsetHeight+increase+"px";var diff=increase-(cell.offsetHeight-originalCellHeight);var indDiff=diff/panelsWithautofill.length;for(var k=
0;k<panelsWithautofill.length-1;k++)panelsWithautofill[k].style.height=panelsWithautofill[k].offsetHeight+indDiff+"px";panelsWithautofill[panelsWithautofill.length-1].style.height=originalHeight+indDiff+"px"}}}};D2L.MultiEdit={};
D2L.MultiEdit.Manager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_controls=[];this.m_includeUnchanged=false;var me=this;UI.GetFormManager().OnChangeReset.RegisterMethod(function(){for(var i=0;i<me.m_controls.length;i++)me.m_controls[i].Reset()})},DeserializeMin:function(deserializer){this.m_controls=deserializer.GetObjectArrayMin(D2L.MultiEdit.MultiEditControl);this.m_includeUnchanged=deserializer.GetBoolean()},Serialize:function(serializer){var controls=
[];for(var i=0;i<this.m_controls.length;i++)if(this.m_controls[i].IsInDom()&&(this.m_controls[i].HasChanged()||this.m_includeUnchanged))controls.push(this.m_controls[i]);serializer.AddMember("Controls",controls)},AddMultiEditToForm:function(){var form=UI.GetForm();var hdn=UI.GetById("d2l_multiedit");if(!hdn){hdn=document.createElement("input");hdn.type="hidden";hdn.name="d2l_multiedit";hdn.id="d2l_multiedit";form.appendChild(hdn)}hdn.value=D2L.Serialization.JsonSerializer.Serialize(this)},GetMultiEditObject:function(key,
fieldName){fieldName=fieldName.toLowerCase();for(var i=0;i<this.m_controls.length;i++)if(this.m_controls[i].GetKey()==key&&this.m_controls[i].GetField().toLowerCase()==fieldName)return this.m_controls[i];return null},GetMultiEditObjectsByField:function(fieldName){fieldName=fieldName.toLowerCase();var ret={};for(var i=0;i<this.m_controls.length;i++)if(this.m_controls[i].GetField().toLowerCase()==fieldName)ret[this.m_controls[i].GetKey()]=this.m_controls[i];return ret},GetMultiEditObjectsByKey:function(key){var ret=
{};for(var i=0;i<this.m_controls.length;i++)if(this.m_controls[i].GetKey()==key)ret[this.m_controls[i].GetField()]=this.m_controls[i];return ret}});D2L.MultiEdit.GetManager=function(){return UI.GetMultiEditManager()};
D2L.MultiEdit.MultiEditControl=D2L.Class.extend({Construct:function(obj){arguments.callee.$.Construct.call(this);this.m_controlId=null;this.m_key="";this.m_originalValue="";this.m_field="";this.m_includeWhenUnchanged=false},DeserializeMin:function(deserializer){this.m_controlId=deserializer.GetObjectMin(D2L.Control.Id);this.m_key=deserializer.GetMember();this.m_originalValue=deserializer.GetMember();this.m_field=deserializer.GetMember();this.m_includeWhenUnchanged=deserializer.GetBoolean()},Serialize:function(serializer){serializer.AddMember("Key",
this.GetKey());serializer.AddMember("Field",this.GetField());serializer.AddMember("Value",this.GetValue())},GetControl:function(){return UI.GetControl(this.m_controlId.ID(),this.m_controlId.SID())},GetField:function(){return this.m_field},GetKey:function(){return this.m_key},GetObject:function(){return this.GetControl()},GetValue:function(){return this.GetControl().GetMultiEditValue()},GetOriginalValue:function(){return this.m_originalValue},HasChanged:function(){return this.IncludeWhenUnchanged()||
this.GetOriginalValue()!=this.GetValue()},IncludeWhenUnchanged:function(){return this.m_includeWhenUnchanged},IsInDom:function(){var domNode=this.GetControl().GetDomNode();if(domNode!==null){while(domNode.parentNode!==null)domNode=domNode.parentNode;return domNode==document}return false},Reset:function(){this.m_originalValue=this.GetValue()},SetIncludeWhenUnchanged:function(includeWhenUnchanged){this.m_includeWhenUnchanged=includeWhenUnchanged}});D2L.Rpc={};
D2L.Rpc.Create=function(serverFunc,callback,src){return new D2L.RpcMethodProxy(D2L.Rpc.Type.Ajax,serverFunc,callback,src)};D2L.Rpc.CreatePost=function(serverFunc,callback,src){return new D2L.RpcMethodProxy(D2L.Rpc.Type.Post,serverFunc,callback,src)};D2L.Rpc.CreateSynchronous=function(serverFunc,src){return new D2L.RpcMethodProxy(D2L.Rpc.Type.Synchronous,serverFunc,undefined,src)};D2L.Rpc.ResponseType={Success:0,Error:1};D2L.Rpc.Type={Ajax:0,Post:1,Synchronous:2};
D2L.Rpc.Manager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_xhrNum=0},Send:function(type,serverFunc,src,params){var me=this;me.m_xhrNum++;var obj={"Type":type,"ServerFunc":serverFunc,"Src":src,"Params":params,"Num":new Number(me.m_xhrNum)};if(type==D2L.Rpc.Type.Synchronous){var xhr=me.SendAjax(obj,D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());if(xhr.responseText.substr(0,13)=="while(true){}"){D2L.LP.Web.UI.Html.JavaScript.Console.Log("Rpc "+obj.Num+": Received positive response '"+
xhr.responseText+"'.");return D2L.Serialization.JsonDeserializer.Deserialize(xhr.responseText.substr(13),D2L.Rpc.Response)}}else{obj.DR=new D2L.Util.DelayedReturn;me.SendAjax(obj,D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());return obj.DR}},SendAjax:function(obj,xsrfToken){var extIndex=obj.Src.lastIndexOf(".d2l");if(extIndex>-1)obj.Src=obj.Src.substring(0,extIndex)+".d2lfile"+obj.Src.substr(extIndex+4);var xhr=this.GetXhr(obj,obj.Type==D2L.Rpc.Type.Ajax);UI.GenerateHitCode();obj.Params+="&"+D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName()+
"="+xsrfToken+"&d2l_hitcode="+UI.GetHitCode()+"&d2l_action=rpc";xhr.open("POST",obj.Src+"&d2l_rh=rpc&d2l_rt=call",obj.Type==D2L.Rpc.Type.Ajax);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(obj.Params);return xhr},GetXhr:function(obj,isAsynchronous){var xhr=function createXMLHttpRequest(){var ex;try{return new XMLHttpRequest}catch(ex){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(ex){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(ex){}D2L.LP.Web.UI.Html.JavaScript.Console.Error("Rpc "+
obj.Num+": Could not initialize D2L.Rpc object.");return null}();if(isAsynchronous){var me=this;var timer=new Date;var response=new D2L.Rpc.Response;response.SetType(D2L.Rpc.ResponseType.Error);xhr.onreadystatechange=function(){var readyState=null;var d2l=null;try{var readyState=xhr.readyState;var d2l=D2L}catch(e){}if(readyState&&d2l){D2L.LP.Web.UI.Html.JavaScript.Console.Log("Rpc "+obj.Num+": Ready State:"+readyState);if(readyState==4){var status;try{status=xhr.status}catch(e){}if(status){D2L.LP.Web.UI.Html.JavaScript.Console.Log("Rpc "+
obj.Num+": Status is '"+status+"'.");if(status==200){try{if(xhr.responseText.substr(0,13)=="while(true){}"){response=D2L.Serialization.JsonDeserializer.Deserialize(xhr.responseText.substr(13),D2L.Rpc.Response);D2L.LP.Web.UI.Html.JavaScript.Console.Log("Rpc "+obj.Num+": Received positive response '"+xhr.responseText+"'.")}}catch(e){D2L.LP.Web.UI.Html.JavaScript.Console.Error("Rpc "+obj.Num+": Error evaluating response '"+xhr.responseText+"'.")}if(response.GetRedirectUrl().length>0)document.location.href=
response.GetRedirectUrl();else{var messages=response.GetMessages();if(messages)if(messages.GetStatusType()!=D2L.Control.MessageArea.Status.None||messages.HasCustomStatus()||messages.HasErrors()){UI.GetMessageArea().SetMessages(messages);if(messages.GetStatusType()==D2L.Control.MessageArea.Status.Saved)FormManager.ResetChanges()}response.SetDuration((new Date).valueOf()-timer.valueOf());obj.DR.Trigger(response)}}else{D2L.LP.Web.UI.Html.JavaScript.Console.Error(xhr.responseText);obj.DR.Trigger(response)}}delete xhr.onreadystatechange}}}}return xhr}});
D2L.RpcMethodProxy=D2L.Util.MethodProxy.extend({Construct:function(type,serverFunc,callback,src){this.m_skipValidation=true;if(type==D2L.Rpc.Type.Post)this.m_skipValidation=false;this.m_sessionKeepAlive=true;if(src===undefined||src.length===0)src=document.location.href;src=src.split("#")[0];if(src.indexOf("ou=")==-1){if(src.indexOf("?")==-1)src+="?";else src+="&";src+="ou="+Global.OrgUnitId}var me=this;var CallAjax=function(){var args={Arguments:arguments,Serialize:function(serializer){for(var i=
0;i<this.Arguments.length;i++)serializer.AddMember("param"+(i+1),this.Arguments[i])}};var params="d2l_rf="+serverFunc+"&params="+D2L.Util.Url.Encode(D2L.Serialization.JsonSerializer.Serialize(args));if(!me.m_sessionKeepAlive)params+="&d2l_nokeepalive=1&X-D2L-Session=";if(me.m_includeState!==null){params+="&d2l_stateGroups="+D2L.Util.Url.Encode(me.m_includeState.Groups);params+="&d2l_stateScopes="+D2L.Util.Url.Encode(me.m_includeState.Scopes);params+="&d2l_statePageId="+D2L.Util.Url.Encode(UI.pageId);
for(var currStateGroup in me.m_includeState.State)params+="&d2l_state_"+currStateGroup+"="+D2L.Util.Url.Encode(me.m_includeState.State[currStateGroup])}return RpcManager.Send(type,serverFunc,src,params)};var CallPost=function(){var dr=new D2L.Util.DelayedReturn;var iframeName=UI.GetUniqueHtmlId();if(document.body.insertAdjacentHTML)document.body.insertAdjacentHTML("beforeEnd","<iframe id='"+iframeName+"' name='"+iframeName+"' style='display:none'></iframe>");else{var iframe=document.createElement("iframe");
iframe.id=iframeName;iframe.name=iframeName;iframe.style.position="absolute";iframe.style.left="-200px";iframe.style.top="-200px";iframe.style.width="1px";iframe.style.height="1px";document.body.appendChild(iframe)}var cbName=UI.GetUniqueHtmlId();window[cbName]=function(responseText){var response=D2L.Serialization.JsonDeserializer.Deserialize(responseText,D2L.Rpc.Response);if(response.GetRedirectUrl().length>0)document.location.href=response.GetRedirectUrl();else{if(!me.m_skipValidation){var messages=
response.GetMessages();if(messages!==null){UI.GetMessageArea().SetMessages(messages);if(messages.GetStatusType()==D2L.Control.MessageArea.Status.Saved)FormManager.ResetChanges()}}D2L.LP.Web.UI.Html.JavaScript.Console.Log("Post-Rpc: Received positive response '"+responseText+"'.");dr.Trigger(response)}};arguments.Serialize=function(serializer){for(var i=0;i<this.length;i++)serializer.AddMember("param"+(i+1),this[i])};var ni=new D2L.NavInfo;ni.navigation=src;ni.target=iframeName;ni.action="RPC";ni.SetParam("d2l_rh",
"rpc");ni.SetParam("d2l_rt","post");ni.SetParam("d2l_rcb",cbName);ni.SetParam("d2l_rf",serverFunc);ni.SetParam("params",D2L.Serialization.JsonSerializer.Serialize(arguments));D2L.LP.Web.UI.Html.JavaScript.Console.Log("Post-Rpc: posting to function '"+serverFunc+"' on Src '"+src+"'...");Nav.Go(ni,me.m_skipValidation);return dr};var beginFunc=type==D2L.Rpc.Type.Post?CallPost:CallAjax;arguments.callee.$.Construct.call(this,beginFunc,callback,type!=D2L.Rpc.Type.Synchronous);this.m_includeState=null},
SetSessionKeepAlive:function(keepAlive){this.m_sessionKeepAlive=keepAlive},SetSkipValidation:function(skipValidation){this.m_skipValidation=skipValidation},SetIncludeState:function(state){this.m_includeState=state}});
D2L.Rpc.Response=D2L.Class.extend({Construct:function(duration){if(duration===undefined)duration=0;this.m_duration=duration;this.m_isResultMin=false;this.m_messages=null;this.m_redirectUrl="";this.m_responseType=D2L.Rpc.ResponseType.Success;this.m_result=null},Deserialize:function(deserializer){if(deserializer.HasMember("MessageArea"))this.m_messages=deserializer.GetObject("MessageArea",D2L.Control.MessageArea.Messages);this.m_isResultMin=deserializer.GetMember("IsResultMin");this.m_responseType=
deserializer.GetMember("ResponseType");this.m_redirectUrl=deserializer.GetMember("RedirectUrl");this.m_result=deserializer.GetMember("Result")},GetDuration:function(){return this.m_duration},GetMessages:function(){return this.m_messages},GetRedirectUrl:function(){return this.m_redirectUrl},GetResponseType:function(){return this.GetType()},GetType:function(){return this.m_responseType},GetResult:function(type){if(this.m_isResultMin)return D2L.Serialization.JsonDeserializerMin.Deserialize(this.m_result,
type);else{var hasType=type!==undefined||this.m_result instanceof Array&&this.m_result.length>0&&this.m_result[0]!==null&&this.m_result[0].ClassName!==undefined||this.m_result!==undefined&&this.m_result!==null&&this.m_result.ClassName!==undefined;if(hasType)return D2L.Serialization.JsonDeserializer.Deserialize(this.m_result,type);else return this.m_result}},SetDuration:function(duration){this.m_duration=duration},SetType:function(type){this.m_responseType=type}});D2L.Rpc.Response.Timeout="timeout";
D2L.Serialization={};
D2L.Serialization.JsonDeserializer=D2L.Class.extend({Construct:function(json){arguments.callee.$.Construct.call(this);if(json!==undefined){this.m_data=json;if(json!==null&&json.isString)this.m_data=eval("("+json+")")}this.m_keys=[];for(var key in this.m_data)this.m_keys.push(key)},Keys:function(){return this.m_keys},GetDictionary:function(name,keyType,valueType){var ret={};if(this.m_data!==undefined&&this.m_data!==null&&this.m_data[name]!==undefined){var dic=this.m_data[name];for(var key in dic){var dKey=
key;if(typeof key=="object")dKey=D2L.Serialization.JsonDeserializerMin.Deserialize(key,keyType);else if(keyType=="number")dKey=parseFloat(key);if(typeof dic[key]=="object")ret[dKey]=D2L.Serialization.JsonDeserializerMin.Deserialize(dic[key],valueType);else ret[dKey]=dic[key]}}return ret},GetMember:function(name,defaultValue){if(this.m_data!==undefined&&this.m_data!==null){if(this.m_data[name]===undefined)return defaultValue;return this.m_data[name]}return defaultValue},GetObject:function(name,type){if(this.m_data[name]!==
undefined)return D2L.Serialization.JsonDeserializer.Deserialize(this.m_data[name],type);return undefined},GetObjectArray:function(name,type){var ret=[];if(this.m_data[name]!==undefined)for(var i=0;i<this.m_data[name].length;i++)ret.push(D2L.Serialization.JsonDeserializer.Deserialize(this.m_data[name][i],type));return ret},HasMember:function(name){return this.m_data!==undefined&&this.m_data!==null&&this.m_data[name]!==undefined},IsArray:function(name){return D2L.Util.JavaScript.IsArray(this.m_data[name])}});
D2L.Serialization.JsonDeserializer.Deserialize=function(json,type){var obj=json;if(json!==undefined&&json!==null&&json.isString)obj=eval("("+json+")");if(obj===null)return null;if(obj instanceof Array){var l=obj.length;for(var i=0;i<l;i++)obj[i]=D2L.Serialization.JsonDeserializer.Deserialize(obj[i],type)}else{var deserializer=new D2L.Serialization.JsonDeserializer(json);if(type===undefined&&deserializer.HasMember("ClassName")){type=deserializer.GetMember("ClassName");if(type.isString)type=eval(type)}if(type!==
undefined){obj=new type;if(obj.Deserialize!==undefined)obj.Deserialize(deserializer)}}return obj};
D2L.Serialization.JsonDeserializerMin=D2L.Class.extend({Construct:function(json){arguments.callee.$.Construct.call(this);this.m_data=[];this.m_index=-1;if(json!==undefined){this.m_data=json;if(json!==undefined&&json!==null&&json.isString)this.m_data=eval("("+json+")")}},GetBoolean:function(){if(this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1){this.m_index++;return this.m_data[this.m_index]==1}return false},GetMember:function(){if(this.m_data!==undefined&&this.m_data!==
null&&this.m_data.length>this.m_index+1){this.m_index++;return this.m_data[this.m_index]}return undefined},GetObject:function(type){if(this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1){this.m_index++;return D2L.Serialization.JsonDeserializer.Deserialize(this.m_data[this.m_index],type)}return undefined},GetObjectMin:function(type){if(this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1){this.m_index++;return D2L.Serialization.JsonDeserializerMin.Deserialize(this.m_data[this.m_index],
type)}return undefined},GetObjectArray:function(type){var ret=[];if(this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1){this.m_index++;for(var i=0;i<this.m_data[this.m_index].length;i++)ret.push(D2L.Serialization.JsonDeserializer.Deserialize(this.m_data[this.m_index][i],type))}return ret},GetObjectArrayMin:function(type){var ret=[];if(this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1){this.m_index++;for(var i=0;i<this.m_data[this.m_index].length;i++)ret.push(D2L.Serialization.JsonDeserializerMin.Deserialize(this.m_data[this.m_index][i],
type))}return ret},GetDictionaryMin:function(keyType,valueType){var ret={};if(this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1){this.m_index++;var dic=this.m_data[this.m_index];for(var key in dic){var dKey=key;if(typeof key=="object")dKey=D2L.Serialization.JsonDeserializerMin.Deserialize(key,keyType);else if(keyType=="number")dKey=parseFloat(key);if(typeof dic[key]=="object")ret[dKey]=D2L.Serialization.JsonDeserializerMin.Deserialize(dic[key],valueType);else ret[dKey]=
dic[key]}}return ret},HasMember:function(){return this.m_data!==undefined&&this.m_data!==null&&this.m_data.length>this.m_index+1}});
D2L.Serialization.JsonDeserializerMin.Deserialize=function(json,type){var obj=json;if(json!==undefined&&json!==null&&json.isString)obj=eval("("+json+")");if(obj===null)return null;var deserializer=new D2L.Serialization.JsonDeserializerMin(obj);if(type!==undefined){var t=typeof type;if(t!="string")obj=new type}if(obj.DeserializeMin!==undefined)obj.DeserializeMin(deserializer);return obj};
D2L.Serialization.JsonSerializer=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_text=new D2L.Util.StringBuilder;this.m_comma=""},DoSerialize:function(obj,serializeMethod,noStringEncode,param1,param2){if(serializeMethod===undefined){serializeMethod="Serialize";if(obj&&obj[serializeMethod]===undefined&&obj["_serialize"]!==undefined)serializeMethod="_serialize"}if(noStringEncode===undefined)noStringEncode=false;if(obj===undefined||obj===null)this.m_text.Append("null");
else if(typeof obj=="boolean")this.m_text.Append(obj);else if(typeof obj=="string")if(noStringEncode)this.m_text.Append(obj);else this.m_text.Append("'"+obj.jsString()+"'");else if(typeof obj=="number")this.m_text.Append(obj);else if(typeof obj=="object")if(D2L.Util.JavaScript.IsArray(obj)){this.m_text.Append("[");var l=obj.length;var comma="";for(var i=0;i<l;i++){this.m_text.Append(comma);this.DoSerialize(obj[i],serializeMethod);comma=","}this.m_text.Append("]")}else if(obj[serializeMethod]){this.m_text.Append("{");
var oldComma=this.m_comma;this.m_comma="";obj[serializeMethod](this,param1,param2);this.m_text.Append("}");this.m_comma=oldComma}else{this.m_text.Append("{");var comma="";var i=0;for(var key in obj){this.m_text.Append(comma);this.m_text.Append(key+":");this.DoSerialize(obj[key],serializeMethod);comma=","}this.m_text.Append("}")}else this.m_text.Append("null")},AddMember:function(name,member,serializeMethod,noStringEncode,param1,param2){if(name===undefined||name===null||name.length===0)return;this.m_text.Append(this.m_comma+
"'"+name.jsString()+"':"+D2L.Serialization.JsonSerializer.Serialize(member,serializeMethod,noStringEncode,param1,param2));this.m_comma=","},ToString:function(){return this.m_text.ToString()}});D2L.Serialization.JsonSerializer.Serialize=function(obj,serializeMethod,noStringEncode,param1,param2){var serializer=new D2L.Serialization.JsonSerializer;serializer.DoSerialize(obj,serializeMethod,noStringEncode,param1,param2);return serializer.ToString()};D2L.Sml={};
D2L.Sml.SmlProcessor=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this)},Encode:function(input){if(!input)return"";return input.replace(/(\\|\[|\])/g,"\\$1")},Process:function(input,type){if(input===undefined||input===null)return"";var st=new D2L.Sml.SmlTokenizer(input);var stack=new Array;var ret="";var isEmpty=true;while(!st.IsDone()){var token=st.GetToken();if(token.m_type==D2L.Sml.SmlTokenType.Text){isEmpty=false;if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=D2L.Util.Html.Encode(token.m_text);
else ret+=token.m_text}else if(token.m_type==D2L.Sml.SmlTokenType.Unknown){isEmpty=false;ret+="["+token.m_text+"]"}else if(token.m_isOpen)if(token.m_isContainer){stack.push(token);if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=this.WriteOpenTag(token);else if(type==D2L.Sml.SmlProcessor.Mode.PlainText&&token.m_type==D2L.Sml.SmlTokenType.Abbr)ret+=token.m_text.substring(5,token.m_text.length)+" ("}else if(token.m_type==D2L.Sml.SmlTokenType.Break){isEmpty=false;if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=
"<br/>";else ret+="\n"}else{if(token.m_type==D2L.Sml.SmlTokenType.Space){isEmpty=false;if(token.m_text.indexOf(":")>0){var spaces=token.m_text.substring(token.m_text.indexOf(":")+1,token.m_text.length);for(var i=0;i<spaces;i++)if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+="&nbsp;";else ret+=" "}else if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+="&nbsp;";else ret+=" "}}else if(stack.length!=0)if(stack[stack.length-1].m_type!=token.m_type){var contained=false;for(x in stack)if(stack[x].m_type==token.m_type){contained=
true;break}if(contained){while(stack[stack.length-1].m_type!=token.m_type)if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=this.WriteCloseTag(stack.pop());else{stack.pop();if(type==D2L.Sml.SmlProcessor.Mode.PlainText&&token.m_type==D2L.Sml.SmlTokenType.Abbr)ret+=")"}if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=this.WriteCloseTag(stack.pop());else{stack.pop();if(type==D2L.Sml.SmlProcessor.Mode.PlainText&&token.m_type==D2L.Sml.SmlTokenType.Abbr)ret+=")"}}}else if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=
this.WriteCloseTag(stack.pop());else{stack.pop();if(type==D2L.Sml.SmlProcessor.Mode.PlainText&&token.m_type==D2L.Sml.SmlTokenType.Abbr)ret+=")"}}while(stack.length!=0)if(type==D2L.Sml.SmlProcessor.Mode.Html)ret+=this.WriteCloseTag(stack.pop());else stack.pop();if(isEmpty)return"";else return ret},WriteOpenTag:function(token){var ret="";switch(token.m_type){case D2L.Sml.SmlTokenType.Abbr:var title=token.m_text.substring(5,token.m_text.length);ret='<abbr title="'+title+'">';break;case D2L.Sml.SmlTokenType.Alert:ret=
'<span class="ds_a">';break;case D2L.Sml.SmlTokenType.Bold:ret="<strong>";break;case D2L.Sml.SmlTokenType.Help:var value=token.m_text.substring(5,token.m_text.length);var titleTerm="";var descTerm="";var commaIndex=value.indexOf(",");if(commaIndex>-1){titleTerm=value.substring(0,commaIndex);descTerm=value.substring(commaIndex+1)}else{titleTerm="Framework.PopupHelp."+value;descTerm="Framework.PopupHelpDesc."+value}titleTerm=D2L.Util.Html.JsString(titleTerm.trim());descTerm=D2L.Util.Html.JsString(descTerm.trim());
ret='<a href="javascript://" onclick="D2L.LP.Web.UI.Desktop.Controls.InlineHelp.PopupHelp(\''+titleTerm+"','"+descTerm+'\');" class="vui-link d2l-link" >';break;case D2L.Sml.SmlTokenType.Italic:ret="<em>";break;case D2L.Sml.SmlTokenType.Light:ret='<span class="ds_b">';break;case D2L.Sml.SmlTokenType.Info:ret='<span class="ds_c">';break;case D2L.Sml.SmlTokenType.Colour:var clr=token.m_text.substring(4,token.m_text.length);ret='<span style="color:'+clr+'">';break;case D2L.Sml.SmlTokenType.Underline:ret=
'<span class="ds_d">';break;case D2L.Sml.SmlTokenType.Large:ret='<span class="ds_e">';break;case D2L.Sml.SmlTokenType.Larger:ret='<span class="ds_f">';break;case D2L.Sml.SmlTokenType.Small:ret='<span class="ds_g">';break;case D2L.Sml.SmlTokenType.Smaller:ret='<span class="ds_h">';break;case D2L.Sml.SmlTokenType.Medium:ret='<span class="ds_m">';break;case D2L.Sml.SmlTokenType.Normal:ret='<span class="ds_i">';break;case D2L.Sml.SmlTokenType.Link:var tagValue=token.m_text.substr(5,token.m_text.length-
5);var linkUrl="";var linkTitle="";var linkTarget="";var firstIndex=tagValue.indexOf(" ");if(firstIndex>=0){linkUrl=tagValue.substr(0,firstIndex);var titleOrTarget;var afterFirstIndex=tagValue.substr(firstIndex,tagValue.length-firstIndex).trim();var secondIndex=afterFirstIndex.indexOf(" ");if(secondIndex>=0)titleOrTarget=afterFirstIndex.substr(0,secondIndex).trim();else titleOrTarget=afterFirstIndex.trim();if(titleOrTarget.toLowerCase()=="_top"||titleOrTarget.toLowerCase()=="_blank"||titleOrTarget.toLowerCase()==
"_self"||titleOrTarget.toLowerCase()=="_parent"){linkTarget=titleOrTarget;linkTitle=afterFirstIndex.substr(titleOrTarget.length,afterFirstIndex.length-titleOrTarget.length).trim()}else linkTitle=afterFirstIndex}else linkUrl=tagValue;if(linkTitle.length>0)linkTitle=' title="'+D2L.Util.Html.Encode(linkTitle)+'"';if(linkTarget.length>0)linkTarget=' target="'+linkTarget+'"';ret='<a href="'+linkUrl+'" '+linkTarget+linkTitle+" >";break}return ret},WriteCloseTag:function(token){var ret="";switch(token.m_type){case D2L.Sml.SmlTokenType.Abbr:ret=
"</abbr>";break;case D2L.Sml.SmlTokenType.Bold:ret="</strong>";break;case D2L.Sml.SmlTokenType.Italic:ret="</em>";break;case D2L.Sml.SmlTokenType.Help:ret="</a>";break;case D2L.Sml.SmlTokenType.Link:ret="</a>";break;default:ret="</span>";break}return ret}});D2L.Sml.SmlProcessor.Mode={PlainText:0,Html:1};D2L.Sml.SmlToken=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_type=D2L.Sml.SmlTokenType.Text;this.m_isOpen=true;this.m_isContainer=true;this.m_text=""}});
D2L.Sml.SmlTokenizer=D2L.Class.extend({Construct:function(input){this.m_input=input?input:"";this.m_length=input?input.length:0;this.m_pos=0},GetText:function(start,end){var ret=this.m_input.substring(start,end);return ret.replace(/\\(\\|\[|\])/g,"$1")},GetToken:function(){var ret=new D2L.Sml.SmlToken;var returnstart=this.m_pos;var returnend=0;if(this.m_pos>=this.m_length)ret.m_type=D2L.Sml.SmlTokenType.EndOfInput;else if(this.m_input.charAt(this.m_pos)=="["){this.m_pos++;if(this.m_pos<this.m_length){if(this.m_input.charAt(this.m_pos)==
"/"){ret.m_isOpen=false;this.m_pos++}var contentstart=this.m_pos;var openTags=1;while(this.m_pos<this.m_length)switch(this.m_input.charAt(this.m_pos)){case "[":openTags++;this.m_pos++;break;case "]":openTags--;if(openTags==0){ret.m_text=this.GetText(contentstart,this.m_pos);this.ParseTag(ret,ret.m_text);this.m_pos++;return ret}else{this.m_pos++;break}case "\\":this.m_pos+=2;break;default:this.m_pos++;break}}}else while(this.m_pos<this.m_length){var c=this.m_input.charAt(this.m_pos);if(c=="[")break;
else if(c=="\\")this.m_pos+=2;else this.m_pos++}returnend=this.m_pos>this.m_length?this.m_length:this.m_pos;ret.m_text=this.GetText(returnstart,returnend);return ret},IsDone:function(){return this.m_pos>=this.m_input.length},ParseTag:function(token,tag){switch(tag.charAt(0)){case "b":if(tag=="b")token.m_type=D2L.Sml.SmlTokenType.Bold;else if(tag=="br"){token.m_type=D2L.Sml.SmlTokenType.Break;token.m_isContainer=false}break;case "h":if(tag.substring(0,4)=="help")token.m_type=D2L.Sml.SmlTokenType.Help;
break;case "i":if(tag=="i")token.m_type=D2L.Sml.SmlTokenType.Italic;else if(tag=="info")token.m_type=D2L.Sml.SmlTokenType.Info;break;case "a":if(tag=="alert")token.m_type=D2L.Sml.SmlTokenType.Alert;else if(tag.substring(0,4)=="abbr")token.m_type=D2L.Sml.SmlTokenType.Abbr;break;case "l":if(tag=="light")token.m_type=D2L.Sml.SmlTokenType.Light;else if(tag=="large")token.m_type=D2L.Sml.SmlTokenType.Large;else if(tag=="larger")token.m_type=D2L.Sml.SmlTokenType.Larger;else if(tag.substring(0,4)=="link")token.m_type=
D2L.Sml.SmlTokenType.Link;break;case "c":if(tag.substring(0,3)=="clr")token.m_type=D2L.Sml.SmlTokenType.Colour;break;case "u":if(tag=="u")token.m_type=D2L.Sml.SmlTokenType.Underline;break;case "s":if(tag=="small")token.m_type=D2L.Sml.SmlTokenType.Small;else if(tag=="smaller")token.m_type=D2L.Sml.SmlTokenType.Smaller;else if(tag.substring(0,2)=="sp"){token.m_type=D2L.Sml.SmlTokenType.Space;token.m_isContainer=false}break;case "n":if(tag=="normal")token.m_type=D2L.Sml.SmlTokenType.Normal;break;case "m":if(tag==
"medium")token.m_type=D2L.Sml.SmlTokenType.Medium;break;default:token.m_type=D2L.Sml.SmlTokenType.Unknown;token.m_isContainer=false;break}}});D2L.Sml.SmlTokenType={Text:1,Bold:2,Italic:3,Underline:4,Light:5,Normal:6,Info:7,Alert:8,Break:9,Colour:10,Large:11,Larger:12,Small:13,Smaller:14,Space:15,Unknown:16,EndOfInput:17,Abbr:18,Medium:19,Help:20,Link:21};D2L.State={};D2L.State.StateScopeTypes={NoPersistence:0,OrgUnitSession:1,OrgUnitUser:2,User:3};
D2L.State.StateManager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_stateScopes={};this.m_stateGroups=[];this.m_saveStateOnUnload=true;var me=this;UI.OnPageUnload().RegisterMethod(function(){me.SaveState()});UI.OnPageLoad().RegisterMethod(function(){var searchStateGroup=me.GetStateGroup("Search");if(searchStateGroup!==null)searchStateGroup.SetIsActive(false)})},DeserializeMin:function(deserializer){this.m_stateScopes=deserializer.GetDictionaryMin();this.m_stateGroups=
deserializer.GetObjectArrayMin(D2L.State.StateGroup)},AddStateToNavInfo:function(navInfo){if(!navInfo.IgnoreState()){var state=this.GenerateState(true,true);navInfo.SetParam("d2l_stateScopes",state.Scopes);navInfo.SetParam("d2l_stateGroups",state.Groups);navInfo.SetParam("d2l_statePageId",UI.pageId);for(var stateGroup in state.State)navInfo.SetParam("d2l_state_"+stateGroup,state.State[stateGroup])}},AddStateToForm:function(){var state=this.GenerateState(true,true);var form=UI.GetForm();var CreateHidden=
function(name,value,parent){var hdn=UI.GetById(name);if(!hdn){hdn=document.createElement("input");hdn.type="hidden";hdn.name=name;hdn.id=name;parent.appendChild(hdn)}hdn.value=value};CreateHidden("d2l_stateScopes",state.Scopes,form);CreateHidden("d2l_stateGroups",state.Groups,form);CreateHidden("d2l_statePageId",UI.pageId,form);for(var i=0;i<form.childNodes.length;i++)if(form.childNodes[i].name!==undefined&&form.childNodes[i].name.indexOf("d2l_state_")==0){D2L.Util.Dom.Purge(form.childNodes[i]);form.removeChild(form.childNodes[i])}for(var stateGroup in state.State)CreateHidden("d2l_state_"+
stateGroup,state.State[stateGroup],form)},CreateStateGroup:function(name){var stateGroup=this.GetStateGroup(name);if(stateGroup===null){stateGroup=new D2L.State.StateGroup(name);this.m_stateGroups.push(stateGroup)}return stateGroup},GetStateGroup:function(name){name=name.toLowerCase();for(var i=0;i<this.m_stateGroups.length;i++)if(this.m_stateGroups[i].GetName()==name)return this.m_stateGroups[i];return null},GenerateState:function(includeDbState,includePostState){var ret={Scopes:D2L.Serialization.JsonSerializer.Serialize(this.m_stateScopes),
Groups:"",State:{}};var groups=[];for(var i=0;i<this.m_stateGroups.length;i++){var inDbScope=false;if(includeDbState)for(var scopeType in this.m_stateScopes){for(var j=0;j<this.m_stateScopes[scopeType].length;j++)if(this.m_stateScopes[scopeType][j]==this.m_stateGroups[i].GetName()){inDbScope=true;break}if(inDbScope)break}if(includeDbState&&inDbScope||includePostState){groups.push(this.m_stateGroups[i].GetName());ret.State[this.m_stateGroups[i].GetName()]=D2L.Serialization.JsonSerializer.Serialize(this.m_stateGroups[i])}}if(groups.length>
0)ret.Groups=D2L.Serialization.JsonSerializer.Serialize(groups);return ret},SaveState:function(){if(this.m_saveStateOnUnload){var state=this.GenerateState(true,false);if(state.Groups.length>0){var rpc=D2L.Rpc.CreateSynchronous("Save","/d2l/common/rpc/state/saveState.d2l");rpc.SetIncludeState(state);rpc.Call()}}},SetSaveStateOnUnload:function(saveStateOnUnload){this.m_saveStateOnUnload=saveStateOnUnload}});
D2L.State.StateGroup=D2L.Class.extend({Construct:function(name){arguments.callee.$.Construct.call(this);if(name===undefined)name="";this.m_controls=[];this.m_isActive=true;this.m_isCleared=false;this.m_inactiveState="";this.m_name=name.toLowerCase()},DeserializeMin:function(deserializer){this.m_name=deserializer.GetMember().toLowerCase();this.m_controls=deserializer.GetObjectArrayMin(D2L.State.StateControlInfo)},Serialize:function(serializer){serializer.AddMember("Name",this.GetName());if(!this.m_isCleared)if(!this.IsActive())serializer.AddMember("Controls",
this.m_inactiveState,undefined,true);else serializer.AddMember("Controls",this.m_controls)},Clear:function(){this.m_isCleared=true},GetName:function(){return this.m_name},IsActive:function(){return this.m_isActive},SetIsActive:function(isActive){if(isActive!=this.m_isActive){if(isActive)this.m_inactiveState="";else this.m_inactiveState=D2L.Serialization.JsonSerializer.Serialize(this.m_controls);this.m_isActive=isActive}}});
D2L.State.StateControlInfo=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.ControlId=null;this.Name="";this.StateType="";this.Key=""},DeserializeMin:function(deserializer){this.ControlId=deserializer.GetObjectMin(D2L.Control.Id);this.StateType=deserializer.GetMember();this.Key=deserializer.GetMember();if(deserializer.HasMember())this.Name=deserializer.GetMember()},Serialize:function(serializer){serializer.AddMember("ControlId",this.ControlId);serializer.AddMember("StateType",
this.StateType);serializer.AddMember("Key",this.Key);if(this.Name.length>0)serializer.AddMember("Name",this.Name);var control=UI.GetControl(this.ControlId.ID(),this.ControlId.SID());if(control!==undefined&&control!==null&&control.GetState)serializer.AddMember("State",control,"GetState",false,this.StateType,this.Key)}});D2L.Style={};
D2L.Style.BorderInfo=D2L.Class.extend({Construct:function(style,colour,width){if(style===undefined)style=D2L.Style.BorderStyle.None;if(colour===undefined)colour="#000000";if(width===undefined)width=0;this.m_style=style;this.m_colour=colour;this.m_width=width},DeserializeMin:function(deserializer){this.m_style=deserializer.GetMember();this.m_colour=deserializer.GetMember();this.m_width=deserializer.GetMember()},GetColour:function(){return this.m_colour},GetStyle:function(){return this.m_style},GetWidth:function(){return this.m_width},
SetColour:function(colour){this.m_colour=colour},SetStyle:function(style){this.m_style=style},SetWidth:function(width){this.m_width=width},ToCss:function(){if(this.m_style==D2L.Style.BorderStyle.None||this.m_width<1||this.m_colour.length===0)return"none";else{var style="none";switch(this.m_style){case D2L.Style.BorderStyle.Hidden:style="hidden";break;case D2L.Style.BorderStyle.Dotted:style="dotted";break;case D2L.Style.BorderStyle.Dashed:style="dashed";break;case D2L.Style.BorderStyle.Solid:style=
"solid";break;case D2L.Style.BorderStyle.Double:style="double";break;case D2L.Style.BorderStyle.Groove:style="groove";break;case D2L.Style.BorderStyle.Ridge:style="ridge";break;case D2L.Style.BorderStyle.Inset:style="inset";break;case D2L.Style.BorderStyle.Outset:style="outset";break;default:style="none"}return this.m_width+"px "+style+" "+this.m_colour}}});D2L.Style.FontFace={Arial:1,Courier:2,Georgia:3,Times:4,Trebuchet:5,Verdana:6,Comic:7,Tahoma:8,UserPreference:9};
D2L.Style.FontSize={XXLarge:5,XLarge:10,Large:20,Medium:30,Small:40,XSmall:50};D2L.Style.TextAlignment={Left:1,Middle:2,Right:3,Justify:4};D2L.Style.ImageRepeat={NoRepeat:1,RepeatY:2,RepeatX:3,RepeatBoth:4};D2L.Style.ImagePosition={TopLeft:1,Top:2,TopRight:3,Left:4,Center:5,Right:6,BottomLeft:7,Bottom:8,BottomRight:9};D2L.Style.BorderPosition={All:1,Top:2,Right:3,Bottom:4,Left:5};D2L.Style.BorderStyle={None:1,Hidden:2,Dotted:3,Dashed:4,Solid:5,Double:6,Groove:7,Ridge:8,Inset:9,Outset:10};
D2L.Style.BorderWidth={Thin:1,Medium:2,Thick:3};D2L.Style.PointFontSize={pt30:1,pt28:2,pt26:3,pt24:4,pt22:5,pt20:7,pt18:10,pt16:15,pt14:20,pt12:25,pt10:30,pt9:40,pt8:50};D2L.Style.Float={None:0,Left:1,Right:2};D2L.Style.HorizontalAlignment={Left:0,Middle:1,Right:2};D2L.Style.AnimationMode={None:0,Slide:1,Fade:2};D2L.Style.WidthType={None:0,Em:1,Percent:2,Pixels:3};D2L.Animation={};D2L.Animation.Mode=D2L.Style.AnimationMode;
D2L.Style.RelativeFontSizeManager=D2L.Class.extend({Construct:function(data){arguments.callee.$.Construct.call(this);this.m_fontSizes=data},ToDictionary:function(){return this.m_fontSizes},GetBaseFontSize:function(){return this.m_fontSizes["d2l_body"]}});D2L.Style.Measurement={};
D2L.Style.Measurement.Unit=D2L.Class.extend({Construct:function(unitType,value){arguments.callee.$.Construct.call(this);if(unitType===undefined)unitType=D2L.Style.Measurement.UnitType.Pixel;if(value===undefined)value=0;this.m_unitType=unitType;this.m_value=value;this.m_onChange=new D2L.EventHandler},Deserialize:function(deserializer){this.m_unitType=deserializer.GetMember("Type",D2L.Style.Measurement.UnitType.Pixel);this.m_value=deserializer.GetMember("Val",0)},DeserializeMin:function(deserializer){this.m_unitType=
deserializer.GetMember();this.m_value=deserializer.GetMember()},Serialize:function(serializer){serializer.AddMember("Val",this.m_value);serializer.AddMember("Type",this.m_unitType)},GetUnitType:function(){return this.m_unitType},GetValue:function(){return this.m_value},OnChange:function(){return this.m_onChange},SetUnitType:function(unitType){if(unitType!==this.m_unitType){this.m_unitType=unitType;this.OnChange().Trigger()}},SetValue:function(value){if(value!==this.m_value){this.m_value=value;this.OnChange().Trigger()}},
ToCss:function(){var value="";var unit="";if(this.m_unitType==D2L.Style.Measurement.UnitType.Pixel){value=this.m_value.toString();unit="px"}else if(this.m_unitType==D2L.Style.Measurement.UnitType.Em){value=this.m_value.toString();unit="em"}else if(this.m_unitType==D2L.Style.Measurement.UnitType.Percentage){value=this.m_value.toString();unit="%"}else if(this.m_unitType==D2L.Style.Measurement.UnitType.Auto)unit="auto";return value+unit}});
D2L.Style.Measurement.UnitType={Pixel:0,Em:1,Percentage:2,Wildcard:3,Auto:4};
D2L.Style.Spacing=D2L.Class.extend({Construct:function(spacingType,defaultUnitType,defaultUnitValue){arguments.callee.$.Construct.call(this);if(spacingType===undefined)spacingType=D2L.Style.Spacing.Type.Padding;if(defaultUnitType===undefined)defaultUnitType=D2L.Style.Spacing.UnitType.Pixel;if(defaultUnitValue===undefined)defaultUnitValue=0;this.m_spacingType=spacingType;this.m_top=new D2L.Style.Spacing.Unit(defaultUnitType,defaultUnitValue);this.m_right=new D2L.Style.Spacing.Unit(defaultUnitType,
defaultUnitValue);this.m_bottom=new D2L.Style.Spacing.Unit(defaultUnitType,defaultUnitValue);this.m_left=new D2L.Style.Spacing.Unit(defaultUnitType,defaultUnitValue);this.m_onChange=new D2L.EventHandler;this.m_ignoreChange=false;this.SetupOnChange()},Deserialize:function(deserializer){this.m_spacingType=deserializer.GetMember("Type",D2L.Style.Spacing.Type.Padding);this.m_top=deserializer.GetObject("Top",D2L.Style.Spacing.Unit);this.m_right=deserializer.GetObject("Right",D2L.Style.Spacing.Unit);this.m_bottom=
deserializer.GetObject("Bottom",D2L.Style.Spacing.Unit);this.m_left=deserializer.GetObject("Left",D2L.Style.Spacing.Unit);this.SetupOnChange()},DeserializeMin:function(deserializer){this.m_spacingType=deserializer.GetMember();this.m_top=deserializer.GetObjectMin(D2L.Style.Spacing.Unit);this.m_right=deserializer.GetObjectMin(D2L.Style.Spacing.Unit);this.m_bottom=deserializer.GetObjectMin(D2L.Style.Spacing.Unit);this.m_left=deserializer.GetObjectMin(D2L.Style.Spacing.Unit);this.SetupOnChange()},Serialize:function(serializer){serializer.AddMember("Type",
this.m_spacingType);serializer.AddMember("Top",this.m_top);serializer.AddMember("Right",this.m_right);serializer.AddMember("Bottom",this.m_bottom);serializer.AddMember("Left",this.m_left)},SetupOnChange:function(){var me=this;var HandleChange=function(){if(!me.m_ignoreChange)me.m_onChange.Trigger()};this.m_top.OnChange().RegisterMethod(HandleChange);this.m_right.OnChange().RegisterMethod(HandleChange);this.m_bottom.OnChange().RegisterMethod(HandleChange);this.m_left.OnChange().RegisterMethod(HandleChange)},
GetTop:function(){return this.m_top},GetRight:function(){return this.m_right},GetBottom:function(){return this.m_bottom},GetLeft:function(){return this.m_left},GetType:function(){return this.m_spacingType},OnChange:function(){return this.m_onChange},SetAllValues:function(val){this.m_ignoreChange=true;this.GetTop().SetValue(val);this.GetRight().SetValue(val);this.GetBottom().SetValue(val);this.GetLeft().SetValue(val);this.m_ignoreChange=false;this.OnChange().Trigger()},SetAllUnitTypes:function(unitType){this.m_ignoreChange=
true;this.GetTop().SetUnitType(unitType);this.GetRight().SetUnitType(unitType);this.GetBottom().SetUnitType(unitType);this.GetLeft().SetUnitType(unitType);this.m_ignoreChange=false;this.OnChange().Trigger()},ToCss:function(){return this.m_top.ToCss()+" "+this.m_right.ToCss()+" "+this.m_bottom.ToCss()+" "+this.m_left.ToCss()},ApplyToDomNode:function(domNode){if(this.m_spacingType==D2L.Style.Spacing.Type.Spacing)domNode.style.margin=this.ToCss();else domNode.style.padding=this.ToCss()}});
D2L.Style.Spacing.Unit=D2L.Style.Measurement.Unit;D2L.Style.Spacing.UnitType=D2L.Style.Measurement.UnitType;D2L.Style.Spacing.Type={Spacing:0,Padding:1};D2L.Style.Utility={};D2L.Style.Utility.PixelToEm=function(base,pixel){var em=pixel/base;return Math.round(em*1E4)/1E4};D2L.Style.Utility.EmToPixel=function(base,em){return base*em};
D2L.Style.Utility.FontFaceToCss=function(fontFace){var strFace="verdana, sans-serif";switch(fontFace){case D2L.Style.FontFace.UserPreference:strFace="inherit";break;case D2L.Style.FontFace.Arial:strFace="arial, sans-serif";break;case D2L.Style.FontFace.Courier:strFace="'courier new', sans-serif";break;case D2L.Style.FontFace.Georgia:strFace="georgia, serif";break;case D2L.Style.FontFace.Times:strFace="'times new roman', serif";break;case D2L.Style.FontFace.Trebuchet:strFace="'trebuchet ms', sans-serif";
break;case D2L.Style.FontFace.Comic:strFace="'comic sans ms', sans-serif";break;case D2L.Style.FontFace.Verdana:strFace="verdana, sans-serif";break;case D2L.Style.FontFace.Tahoma:strFace="tahoma, sans-serif";break}return strFace};D2L.Style.Utility.ImageRepeatToCss=function(imageRepeat){if(imageRepeat==D2L.Style.ImageRepeat.NoRepeat)return"no-repeat";else if(imageRepeat==D2L.Style.ImageRepeat.RepeatY)return"repeat-y";else if(imageRepeat==D2L.Style.ImageRepeat.RepeatX)return"repeat-x";else return"repeat"};
D2L.Style.Utility.BorderToCss=function(style,width,colour){var sStyle="solid";if(style==D2L.Style.BorderStyle.None)return"none";else if(style==D2L.Style.BorderStyle.Dashed)sStyle="dashed";else if(style==D2L.Style.BorderStyle.Dotted)sStyle="dotted";else if(style==D2L.Style.BorderStyle.Double)sStyle="double";var sWidth="1px";if(width==D2L.Style.BorderWidth.Thick)sWidth="3px";else if(width==D2L.Style.BorderWidth.Medium)sWidth="2px";if(colour!="transparent")colour="#"+colour;return sWidth+" "+sStyle+
" "+colour};D2L.Style.Utility.TextAlignToCss=function(align){var style="left";if(align==D2L.Style.TextAlignment.Middle)style="center";else if(align==D2L.Style.TextAlignment.Right)style="right";else if(align==D2L.Style.TextAlignment.Justify)style="justify";return style};
D2L.Style.Utility.CssToTextAlign=function(style){var align=D2L.Style.TextAlignment.Left;if(style=="center")align=D2L.Style.TextAlignment.Middle;else if(style=="right")align=D2L.Style.TextAlignment.Right;else if(style=="justify")align=D2L.Style.TextAlignment.Justify;return align};
D2L.Style.Utility.ParseMeasurementUnit=function(sVal){sVal=sVal.toLowerCase();var unitValue;var unitType;var unitIndex;var tempUnitIndex=sVal.indexOf("%");if(tempUnitIndex>-1){unitType=D2L.Style.Measurement.UnitType.Percentage;unitIndex=tempUnitIndex}tempUnitIndex=sVal.indexOf("px");if(tempUnitIndex>-1){unitType=D2L.Style.Measurement.UnitType.Px;unitIndex=tempUnitIndex}tempUnitIndex=sVal.indexOf("em");if(tempUnitIndex>-1){unitType=D2L.Style.Measurement.UnitType.Em;unitIndex=tempUnitIndex}tempUnitIndex=
sVal.indexOf("*");if(tempUnitIndex>-1){unitType=D2L.Style.Measurement.UnitType.Wildcard;unitIndex=tempUnitIndex}tempUnitIndex=sVal.indexOf("auto");if(tempUnitIndex>-1){unitType=D2L.Style.Measurement.UnitType.Auto;unitIndex=tempUnitIndex}if(unitIndex>-1){unitValue=sVal.substring(0,unitIndex);if(unitValue!="")unitValue=parseFloat(unitValue);else if(unitType==D2L.Style.Measurement.UnitType.Wildcard)unitValue=1}var mUnit=new D2L.Style.Measurement.Unit(unitType,unitValue);return mUnit};D2L.LP.Text={};
D2L.LP.Text.IText=D2L.Class.extend({Construct:function(val){if(val===undefined||val===null)val="";if(typeof val=="number")val=val.toString();arguments.callee.$.Construct.call(this);this.ClassName="D2L.LP.Text.IText";this.m_characterLimit=-1;this.m_value=val;this.m_cleanedValue=null;this.m_subject="";this.m_subjectTwo="";this.m_isHtml=false;this.m_isLangTerm=false;this.m_isTrusted=true;this.m_isLegacy=false;this.m_replace=[];for(var i=1;i<arguments.length;i++)this.m_replace.push(arguments[i])},AssignHtml:function(obj,
attrName){this.GetHtml().Register(function(val){obj[attrName]=val})},AssignText:function(obj,attrName,doHtmlEncode){if(doHtmlEncode===undefined)doHtmlEncode=false;this.GetText().Register(function(val){if(doHtmlEncode)val=D2L.Util.Html.Encode(val);obj[attrName]=val})},DoReplacements:function(val,doEncodeHtml){var dr=new D2L.Util.DelayedReturn;var me=this;var Replace=function(i){if(i<me.m_replace.length){var rtm="";if(Culture.IsRightToLeft())rtm="\u200f";if(me.m_replace[i]!==undefined&&me.m_replace[i]!==
null&&me.m_replace[i].GetHtml)me.m_replace[i].GetHtml().Register(function(rep){val=val.replace("["+i+"]",rtm+rep);Replace(++i)});else{if(doEncodeHtml)val=val.replace("["+i+"]",rtm+D2L.Util.Html.Encode(me.m_replace[i]));else val=val.replace("["+i+"]",rtm+me.m_replace[i]);Replace(++i)}}else dr.Trigger(val)};Replace(0);return dr},GetValueHelper:function(mode,callback,doEncodeHtml){var dr=new D2L.Util.DelayedReturn;var me=this;var Finish=function(val){if(me.m_isLegacy){if(mode==D2L.Sml.SmlProcessor.Mode.PlainText)val=
D2L.Util.Html.Decode(val)}else if(me.m_isTrusted&&val.indexOf("[")!=-1)val=UI.LanguageManager.SmlProcessor.Process(val,mode);else if(mode==D2L.Sml.SmlProcessor.Mode.Html&&!me.m_isHtml)val=D2L.Util.Html.Encode(val);else if(mode==D2L.Sml.SmlProcessor.Mode.PlainText&&me.m_isHtml)val=val.stripHtml();if(!this.m_isHtml&&me.m_characterLimit>-1){if(mode==D2L.Sml.SmlProcessor.Mode.Html)val=val.stripHtml();val=UI.GetCulture().LimitChars(val,me.m_characterLimit)}var ReturnResult=function(result){if(me.m_isLangTerm&&
me.m_replace.length==0&&UI.GetD2LTextCacheManager().Get(me,mode)===null)UI.GetD2LTextCacheManager().Add(me,mode,result);if(me.m_isTrusted){if(me.m_subject.length>0){if(result.indexOf("{subject}")!=-1)result=result.replace("{subject}",me.m_subject);if(result.indexOf("{subjectone}")!=-1)result=result.replace("{subjectone}",me.m_subject)}if(me.m_subjectTwo.length>0&&result.indexOf("{subjecttwo}")!=-1)result=result.replace("{subjecttwo}",me.m_subjectTwo);result=result.replace("{subject}","");result=result.replace("{subjectone}",
"");result=result.replace("{subjecttwo}","")}dr.Trigger(result);if(callback!==undefined)callback.call(callback,result)};if(me.m_isTrusted&&me.m_replace.length>0)me.DoReplacements(val,!doEncodeHtml).Register(function(repVal){ReturnResult(repVal)});else ReturnResult(val)};if(this.m_isLangTerm)if(this.m_value!==undefined)Finish(this.m_value);else UI.LanguageManager.GetTerm(this.m_name).Register(function(val){me.m_value=val;Finish(val)});else if(this.m_isHtml)if(this.m_cleanedValue!==null)Finish(this.m_cleanedValue);
else D2L.LP.Text.HtmlText.Filter(this.m_value).Register(function(val){me.m_cleanedValue=val.m_cleanedValue;Finish(val.m_cleanedValue)});else Finish(this.m_value);return dr},GetHtml:function(){var cacheResult=UI.GetD2LTextCacheManager().Get(this,D2L.Sml.SmlProcessor.Mode.Html);if(cacheResult===null)return this.GetValueHelper(D2L.Sml.SmlProcessor.Mode.Html,undefined,false);else return new D2L.Util.DelayedReturn(cacheResult)},GetPlainText:function(callback){var cacheResult=UI.GetD2LTextCacheManager().Get(this,
D2L.Sml.SmlProcessor.Mode.PlainText);if(cacheResult===null)return this.GetValueHelper(D2L.Sml.SmlProcessor.Mode.PlainText,callback,true);else{if(callback!==undefined)callback.call(callback,cacheResult);return new D2L.Util.DelayedReturn(cacheResult)}},GetSubject:function(){return this.m_subject},GetSubjectTwo:function(){return this.m_subject},GetText:function(callback){return this.GetPlainText(callback)},Deserialize:function(deserializer){this.m_isHtml=deserializer.GetMember("IsHtml",false);this.m_isTrusted=
deserializer.GetMember("IsTrusted",true);this.m_isLangTerm=deserializer.GetMember("IsLangTerm",false);this.m_name=deserializer.GetMember("TermName","");this.m_value=deserializer.GetMember("Value","");if(this.m_isHtml)this.m_cleanedValue=this.m_value;this.m_subject=deserializer.GetMember("Subject","");this.m_replace=deserializer.GetMember("Replace",[])},DeserializeMin:function(deserializer){this.m_isHtml=deserializer.GetBoolean();this.m_isTrusted=deserializer.GetBoolean();this.m_isLangTerm=deserializer.GetBoolean();
this.m_value=deserializer.GetMember();if(this.m_isHtml)this.m_cleanedValue=this.m_value;this.m_subject=deserializer.GetMember();this.m_replace=deserializer.GetMember()},Serialize:function(serializer){serializer.AddMember("ClassName",this.ClassName);serializer.AddMember("IsHtml",this.m_isHtml);serializer.AddMember("IsTrusted",this.m_isTrusted);serializer.AddMember("IsLangTerm",this.m_isLangTerm);if(this.m_isLangTerm)serializer.AddMember("Value",this.m_name);else serializer.AddMember("Value",this.m_value);
serializer.AddMember("Subject",this.GetSubject());serializer.AddMember("Replace",this.m_replace)},SetCharacterLimit:function(numChars){this.m_characterLimit=numChars},SetReplace:function(){this.m_replace=[];for(var i=0;i<arguments.length;i++)this.m_replace.push(arguments[i])},SetSubject:function(subject){this.m_subject=subject},SetSubjectTwo:function(subjectTwo){this.m_subjectTwo=subjectTwo}});
D2L.LP.Text.IText.Normalize=function(text,objectName,methodName,paramName){if(text!==undefined&&text!==null){if(typeof text=="number")text=text.toString();if(typeof text=="string"){if(objectName!==undefined)UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.SmlText("[0].[1]() expects parameter "+'"[2]" to be of type D2L.LP.Text.IText.',objectName,methodName,paramName),true);var itext=new D2L.LP.Text.IText(text);itext.m_isLegacy=true;return itext}}else return new D2L.LP.Text.PlainText("");return text};
D2L.Text=D2L.LP.Text.IText;
D2L.LP.Text.Cache=D2L.Class.extend({Construct:function(val){arguments.callee.$.Construct.call(this);this.m_cacheArray=[];this.m_cacheMaxSize=100},Add:function(textObj,mode,cValue){var cacheToken=new D2L.LP.Text.CacheToken(textObj,mode,cValue);if(this.m_cacheArray.length<this.m_cacheMaxSize)this.m_cacheArray.push(cacheToken)},Get:function(textObj,mode){for(var i=0;i<this.m_cacheArray.length;i++){var cacheToken=this.m_cacheArray[i];if(cacheToken.GetTextObject().m_isLangTerm==textObj.m_isLangTerm&&cacheToken.GetMode()==
mode)if(textObj.m_isLangTerm&&textObj.m_name!==undefined&&cacheToken.GetTextObject().m_name===textObj.m_name)if(cacheToken.GetTextObject().m_replace.length==textObj.m_replace.length){var replaceMatches=true;for(var j=0;j<cacheToken.GetTextObject().m_replace.length;j++)if(cacheToken.GetTextObject().m_replace[j]!=textObj.m_replace[j]){replaceMatches=false;break}if(replaceMatches){var cachedVal=cacheToken.GetCachedValue();if(textObj.m_subject.length>0)cachedVal=cachedVal.replace("{subject}",textObj.m_subject);
else cachedVal=cachedVal.replace("{subject}","");return cachedVal}}}return null}});D2L.LP.Text.CacheToken=D2L.Class.extend({Construct:function(textObj,mode,cValue){arguments.callee.$.Construct.call(this);this.m_textObj=textObj;this.m_mode=mode;this.m_cachedValue=cValue},GetMode:function(){return this.m_mode},GetTextObject:function(){return this.m_textObj},GetCachedValue:function(){return this.m_cachedValue}});
D2L.LP.Text.HtmlText=D2L.LP.Text.IText.extend({Construct:function(value,doFilter){if(doFilter==undefined)doFilter=true;arguments.callee.$.Construct.call(this,value);this.m_isTrusted=false;this.m_isHtml=true;if(!doFilter)this.m_cleanedValue=value}});
D2L.LP.Text.HtmlText.Filter=function(val){var result=new D2L.Util.DelayedReturn;var HandleRpc=function(rpcResponse){if(rpcResponse.GetType()==D2L.Rpc.ResponseType.Success)result.Trigger(rpcResponse.GetResult(D2L.LP.Text.HtmlText));else result.Trigger(new D2L.LP.Text.HtmlText(""))};D2L.Rpc.Create("Filter",HandleRpc,"/d2l/common/rpc/text/text.d2l").Call(val);return result};
D2L.LP.Text.LangTerm=D2L.LP.Text.IText.extend({Construct:function(termName){arguments.callee.$.Construct.call(this,undefined);this.m_name=termName.toLowerCase();this.m_isLangTerm=true;this.m_value=undefined;for(var i=1;i<arguments.length;i++)this.m_replace.push(arguments[i])}});D2L.LP.Text.LangTerm.AssignHtml=function(name,obj,attrName){var term=new D2L.LP.Text.LangTerm(name);term.AssignHtml(obj,attrName)};
D2L.LP.Text.LangTerm.AssignText=function(name,obj,attrName,doHtmlEncode){var term=new D2L.LP.Text.LangTerm(name);term.AssignText(obj,attrName,doHtmlEncode)};D2L.Language.Term=D2L.LP.Text.LangTerm;D2L.LP.Text.PlainText=D2L.LP.Text.IText.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value);this.m_isTrusted=false}});D2L.LP.Text.SmlText=D2L.LP.Text.IText.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value);for(var i=1;i<arguments.length;i++)this.m_replace.push(arguments[i])}});
D2L_Control_ActionButtons_Navigate=function(item){var itemKey=item.GetKey();if(itemKey==null||itemKey.indexOf(";")==-1)return;var location=itemKey.substr(itemKey.indexOf(";")+1);if(location.length==0)return;var ni=new D2L.NavInfo;ni.SetNavigation(location);Nav.Go(ni)};
D2L.Control.Band=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_text=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_text=new D2L.LP.Text.PlainText(YAHOO.util.Dom.getFirstChild(this.GetDomNode()).innerHTML)},SetText:function(text){if(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Band","SetText","text");if(this.GetDomNode()&&YAHOO.util.Dom.getFirstChild(this.GetDomNode())){var me=
this;this.m_text.GetText().Register(function(val){if(val.length>0)if(YAHOO.util.Dom.getFirstChild(me.GetDomNode()).firstChild)YAHOO.util.Dom.getFirstChild(me.GetDomNode()).firstChild.nodeValue=val;else YAHOO.util.Dom.getFirstChild(me.GetDomNode()).appendChild(me.CreateTextNode(val))})}}}});D2L.Control.Behaviour={};
D2L.Control.Behaviour.GetContainer=function(control){var container=control.CreateElement("div");container.className="dbvr";if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)container.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=50)";else container.style.opacity="0.5";container.style.left=D2L.Util.Dom.FindPosX(control.IDomNode)+"px";container.style.top=D2L.Util.Dom.FindPosY(control.IDomNode)+"px";container.style.width=control.IDomNode.offsetWidth+"px";container.style.height=control.IDomNode.offsetHeight+
"px";container.style.zIndex=control.GetWindow()["UI"].GetZIndex();control.GetWindow()["UI"].GetById("d2l_body").appendChild(container);return container};
D2L.Control.Behaviour.Drag=function(evt,control){var theW=control.GetWindow();var theUI=theW["UI"];var cursorStartX=theUI.GetCursorX(theW,evt);var cursorStartY=theUI.GetCursorY(theW,evt);var nodeStartL=control.GetPosX();var nodeStartT=control.GetPosY();var newL=nodeStartL;var newT=nodeStartT;var minX=0;var maxX=Math.max(theUI.GetPageWidth(theW),theUI.GetWindowWidth(theW))-control.GetWidth()-10;var minY=0;var maxY=Math.max(theUI.GetPageHeight(theW),theUI.GetWindowHeight(theW))-control.GetHeight()-
10;var container=D2L.Control.Behaviour.GetContainer(control);container.style.cursor="move";control.SetPos(control.GetWidth()*-1-100,control.GetHeight()*-1-100);var start=function(evt){var newX=theUI.GetCursorX(theW,evt);var newY=theUI.GetCursorY(theW,evt);newL=nodeStartL+newX-cursorStartX;newT=nodeStartT+newY-cursorStartY;if(newL<=minX)newL=minX;if(newL>maxX)newL=maxX;if(newT<=minY)newT=minY;if(newT>maxY)newT=maxY;container.style.left=newL+"px";container.style.top=newT+"px";if(theW.event){theW.event.cancelBubble=
true;theW.event.returnValue=false}else evt.preventDefault()};var stop=function(evt){D2L.Util.Dom.Purge(container);container.parentNode.removeChild(container);control.SetPos(newL,newT);if(theW.document.detachEvent){theW.document.detachEvent("onmousemove",start);theW.document.detachEvent("onmouseup",stop)}else if(theW.document.removeEventListener){theW.document.removeEventListener("mousemove",start,true);theW.document.removeEventListener("mouseup",stop,true)}};if(theW.document.attachEvent){theW.document.attachEvent("onmousemove",
start);theW.document.attachEvent("onmouseup",stop);theW.event.cancelBubble=true;theW.event.returnValue=false}else if(theW.document.addEventListener){theW.document.addEventListener("mousemove",start,true);theW.document.addEventListener("mouseup",stop,true);evt.preventDefault()}};D2L.Control.Behaviour.Drag.Install=function(control,domNode){control.AttachObject(domNode,"onmousedown",function(e){control.GetWindow()["D2L"].Control.Behaviour.Drag(e,control)})};
D2L.Control.Behaviour.Drag.InstallMvc=function(dialogNode,nodeWin,win,titleNode,closeNode){var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;dragSettings.SetHandle(titleNode);dragSettings.SetIsDelayed(false);dragSettings.SetDragDropEffect(D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move);if(closeNode)dragSettings.AddHandleException(closeNode);dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow);dragSettings.SetIsAutoScroll(false);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(dialogNode,
dragSettings,nodeWin,win)};
D2L.Control.Behaviour.Resize=function(evt,control,minWidth,minHeight){var theW=control.GetWindow();var theUI=theW["UI"];var cursorStartX=theUI.GetCursorX(theW,evt);var cursorStartY=theUI.GetCursorY(theW,evt);var startW=control.GetWidth();var startH=control.GetHeight();var startX=control.GetPosX();var startY=control.GetPosY();var newW=startW;var newH=startH;var maxWidth=theUI.GetScrollLeft()+theUI.GetWindowWidth()-control.GetPosX();var maxHeight=theUI.GetScrollTop()+theUI.GetWindowHeight()-control.GetPosY();
if(Culture.IsRightToLeft())maxWidth=control.GetPosX()+startW;var container=D2L.Control.Behaviour.GetContainer(control);if(Culture.IsRightToLeft()){container.style.cursor="ne-resize";container.style.left=startX+"px"}else container.style.cursor="nw-resize";control.SetPos(control.GetWidth()*-1-100,control.GetHeight()*-1-100);var start=function(evt){var newX=theUI.GetCursorX(theW,evt);var newY=theUI.GetCursorY(theW,evt);if(Culture.IsRightToLeft()){newW=startW-newX+cursorStartX;if(newW>maxWidth)newW=maxWidth;
if(newW<minWidth)newW=minWidth;newH=startH+(newY-cursorStartY);if(newH>maxHeight)newH=maxHeight;if(newH<minHeight)newH=minHeight;container.style.left=startX-(newW-startW)+"px"}else{newW=startW+newX-cursorStartX;if(newW>maxWidth)newW=maxWidth;if(newW<minWidth)newW=minWidth;newH=startH+(newY-cursorStartY);if(newH>maxHeight)newH=maxHeight;if(newH<minHeight)newH=minHeight}container.style.width=newW+"px";container.style.height=newH+"px";if(theW.event){theW.event.cancelBubble=true;theW.event.returnValue=
false}else evt.preventDefault()};var stop=function(evt){D2L.Util.Dom.Purge(container);container.parentNode.removeChild(container);control.SetSize(newW,newH);if(Culture.IsRightToLeft())control.SetPos(startX-(newW-startW),startY);else control.SetPos(startX,startY);if(theW.document.detachEvent){theW.document.detachEvent("onmousemove",start);theW.document.detachEvent("onmouseup",stop)}else if(theW.document.removeEventListener){theW.document.removeEventListener("mousemove",start,true);theW.document.removeEventListener("mouseup",
stop,true)}};if(theW.document.attachEvent){theW.document.attachEvent("onmousemove",start);theW.document.attachEvent("onmouseup",stop);theW.event.cancelBubble=true;theW.event.returnValue=false}else if(theW.document.addEventListener){theW.document.addEventListener("mousemove",start,true);theW.document.addEventListener("mouseup",stop,true);evt.preventDefault()}};
D2L.Control.Behaviour.Resize.Install=function(control,domNode,minWidth,minHeight){control.AttachObject(domNode,"onmousedown",function(e){control.GetWindow()["D2L"].Control.Behaviour.Resize(e,control,minWidth,minHeight)})};
D2L.Control.Behaviour.Resize.InstallMvc=function(that,dialogNode,resizeImg,nodeWin,win){var settings={Handle:resizeImg,DisplayType:"none",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var evt=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(dialogNode,settings,nodeWin,win);evt.AddListener(function(size){that.SetSize(size.width,size.height)})};
D2L.Control.Checkbox=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isChecked=false;this.m_isEnabled=true;this.m_value="True";this.m_text=null;this.m_showText=true;this.m_textLabel=null;this.m_fieldName="";this.m_onClick=function(){};var me=this;this.OnDomInsertion.RegisterMethod(function(){me.SetText(me.GetText())})},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);if(this.m_text===null)UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Checkbox control missing "+
"associated label. Use SetText() and SetShowText()."),true);this.SetDomNode(this.CreateElement("input"));this.AttachObject(this.IDomNode,"ID2L",this);this.GetDomNode().id=this.GetMappedId();if(this.GetFieldName().length>0)this.GetDomNode().name=this.GetFieldName();else this.GetDomNode().name=this.GetMappedId();this.GetDomNode().type="checkbox";this.GetDomNode().className="d_chb";var me=this;this.AttachObject(this.GetDomNode(),"onclick",function(evt){if(me.IsEnabled())me.m_onClick.call(me);D2L.Util.Dom.CancelBubble(evt)});
this.SetValue(this.m_value);this.SetIsChecked(this.m_isChecked);this.SetIsEnabled(this.IsEnabled());this.SetText(this.GetText())}},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var hasText=deserializer.GetBoolean();this.m_showText=deserializer.GetBoolean();if(deserializer.HasMember())this.GetDomNode().ID2L=null;if(hasText)if(this.m_showText){this.m_textLabel=this.GetDomNode().nextSibling;this.m_text=new D2L.LP.Text.PlainText(this.m_textLabel.innerHTML)}else this.m_text=
new D2L.LP.Text.PlainText(this.GetDomNode().title);this.m_isChecked=this.GetDomNode().checked;this.m_isEnabled=!this.GetDomNode().disabled;this.m_value=this.GetDomNode().value},Focus:function(){if(this.IsRendered())this.GetDomNode().focus()},GetFieldName:function(){return this.m_fieldName},GetMultiEditValue:function(){return this.IsChecked()?"1":"0"},GetText:function(){return this.m_text},GetValue:function(){if(this.IsRendered())return this.GetDomNode().value;else return this.m_value},GetState:function(serializer){serializer.AddMember("IsChecked",
this.IsChecked());serializer.AddMember("Val",this.GetValue())},IsChecked:function(){if(this.IsRendered())return this.GetDomNode().checked;else return this.m_isChecked},IsEnabled:function(){return this.m_isEnabled},SetFieldName:function(fieldName){this.m_fieldName=fieldName},SetIsChecked:function(isChecked){this.m_isChecked=isChecked;if(this.IsRendered()){if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<8)this.GetDomNode().defaultChecked=isChecked;this.GetDomNode().checked=
isChecked}},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(this.IsRendered()){if(this.m_textLabel!==null)this.m_textLabel.className=this.m_isEnabled?"":"d_rdo_d";this.GetDomNode().disabled=!this.m_isEnabled}},SetOnClick:function(onClick){this.m_onClick=onClick},SetShowText:function(showText){if(showText!=this.m_showText&&this.IsRendered()){if(this.m_textLabel!==null){D2L.Util.Dom.Purge(this.m_textLabel);this.m_textLabel.parentNode.removeChild(this.m_textLabel);this.m_textLabel=null}this.GetDomNode().title=
""}this.m_showText=showText;this.SetText(this.GetText())},SetText:function(text){this.m_text=text;if(this.IsRendered()&&this.m_text!==null)if(this.ShowText()){if(this.m_textLabel===null&&this.GetDomNode().parentNode){this.m_textLabel=this.CreateElement("label");this.m_textLabel.className=this.m_isEnabled?"":"d_rdo_d";this.m_textLabel.htmlFor=this.GetMappedId();if(this.GetDomNode().nextSibling)this.GetDomNode().parentNode.insertBefore(this.m_textLabel,this.GetDomNode().nextSibling);else this.GetDomNode().parentNode.appendChild(this.m_textLabel)}else if(this.m_textLabel!==
null)while(this.m_textLabel.childNodes.length>0)this.m_textLabel.removeChild(this.m_textLabel.firstChild);if(this.m_textLabel!==null)this.m_textLabel.appendChild(this.CreateTextNode(this.m_text))}else this.m_text.AssignText(this.GetDomNode(),"title")},SetValue:function(value){this.m_value=value;if(this.IsRendered())this.GetDomNode().value=value},ShowText:function(){return this.m_showText}});
D2L.Control.ClearFloat=D2L.Control.extend({Construct:function(text){arguments.callee.$.Construct.call(this)},BuildDom:function(){if(this.IsRendered())return;var domNode=this.SetDomNode(this.GetUI().CreateElement("div"));domNode.className="clear"}});
D2L.Control.ContextMenuItemList=D2L.Control.Container.Floating.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_domDrop=null;this.m_selectedItemIndex=-1;this.m_expandedItemIndex=-1;this.m_isRendered=false;var border=new D2L.Style.BorderInfo;border.SetWidth(1);border.SetStyle(D2L.Style.BorderStyle.Solid);border.SetColour("#aaaaaa");this.SetWidth(D2L.Control.ContextMenuItemList.WIDTH);this.SetBorder(border);this.SetHasAutoHide(true);this.SetAnimationMode(D2L.Style.AnimationMode.Slide);
var me=this;this.IsDisplayedChangeEvent().RegisterMethod(function(isDisplayed){if(!isDisplayed)me.SelectItemIndex(-1,false)})},Deserialize:function(deserializer){var items=deserializer.GetObjectArray("Items",D2L.Control.ContextMenuItem);for(var i=0;i<items.length;i++)this.AppendChild(items[i])},DeserializeMin:function(deserializer){var items=deserializer.GetObjectArrayMin(D2L.Control.ContextMenuItem);for(var i=0;i<items.length;i++)items[i].IntegrateChild(this)},GetParent:function(){var parent=this;
while(parent.Parent()!==null)parent=parent.Parent();return parent},IntegrateControl:function(deserializer){},IntegrateControlMin:function(deserializer){this.DeserializeMin(deserializer)},Show:function(insertAfter){this.BuildDom_Helper();if(insertAfter.id!==undefined&&insertAfter.id.length>0)D2L.Util.Aria.SetAttribute(this.GetDomNode(),"labelledby",insertAfter.id);arguments.callee.$.Show.call(this,insertAfter)},BuildDom_Helper:function(){if(this.m_isRendered)return;this.BuildDom();var domNode=this.GetDomNode();
domNode.tabIndex=-1;D2L.Util.Aria.SetRole(domNode,"menu");this.m_domDrop=this.CreateElement("ul");this.m_domDrop.className="dcm";D2L.Util.Aria.SetRole(this.m_domDrop,"presentation");this.ChildrenDomNode().appendChild(this.m_domDrop);for(var i=0;i<this.Children().length;i++)if(i>0&&this.Children().length>i&&this.Children()[i-1].HasSeparator())this.Children()[i-1].SetShowSeparator(true);for(var i=0;i<this.Children().length;i++)this.BuildDom_Item(this.Children()[i]);this.m_isRendered=true},BuildDom_Item:function(item){var me=
this;var labelId=UI.GetUniqueHtmlId();var li=this.CreateElement("li");D2L.Util.Aria.SetRole(li,"presentation");if(item.Children().length>0)li.className="dcm_c";else li.className="dcm_i";var domAnchor=this.CreateElement("a");domAnchor.tabIndex=-1;D2L.Util.Aria.SetRole(domAnchor,"menuitem");D2L.Util.Aria.SetAttribute(domAnchor,"labelledby",labelId);if(item.Children().length>0)D2L.Util.Aria.SetAttribute(domAnchor,"haspopup","true");domAnchor.id=UI.GetUniqueHtmlId();li.appendChild(domAnchor);if(this.GetWidth()!==
null)domAnchor.style.width=this.GetWidth()-11+"px";var s1=this.CreateElement("span");s1.className="dcm_i1";domAnchor.appendChild(s1);var domText=this.CreateElement("span");domText.id=labelId;domText.className="dcm_i2";domAnchor.appendChild(domText);var domImg=null;var clr=this.CreateElement("div");clr.className="clear";domAnchor.appendChild(clr);if(item.HasSeparator()){var domSeparator=this.CreateElement("div");D2L.Util.Aria.SetRole(domSeparator,"separator");domSeparator.className="dcm_s";li.appendChild(domSeparator);
domSeparator.style.display=item.m_showSeparator?"block":"none"}var renderImage=function(image){if(image===null)return;if(domImg===null){domImg=me.CreateElement("img");li.firstChild.firstChild.appendChild(domImg)}if(domImg!==null)image.Assign(domImg)};var renderEnabled=function(isEnabled){var className="dcm_a";if(!isEnabled){className+=" dcm_ad";D2L.Util.Aria.SetAttribute(domAnchor,"disabled","true")}else D2L.Util.Aria.SetAttribute(domAnchor,"disabled","false");domAnchor.className=className;var img=
item.m_img;if(!isEnabled&&item.m_imgDisabled!==null)img=item.m_imgDisabled;renderImage(img)};var renderText=function(text){if(text!==null){while(domText.firstChild)domText.removeChild(domText.firstChild);domText.appendChild(me.GetUI().CreateTextNode(text))}};var renderVisibility=function(isDisplayed){li.style.display=isDisplayed?"list-item":"none"};renderEnabled(item.IsEnabled());renderText(item.m_text);renderVisibility(item.ItemIsDisplayed());var over=function(evt,doExpand){D2L.Util.Dom.CancelBubble(evt);
me.SelectItemIndex(me.GetItemIndex(item),doExpand)};var out=function(evt){D2L.Util.Dom.CancelBubble(evt);if(me.m_expandedItemIndex!==me.GetItemIndex(item))me.SelectItemIndex(-1,true)};item.ItemIsDisplayedChangeEvent().RegisterMethod(function(isDisplayed){renderVisibility(isDisplayed)});item.TextChangeEvent().RegisterMethod(function(text){renderText(text)});item.ImageChangeEvent().RegisterMethod(function(image){renderImage(image)});item.IsEnabledChangeEvent().RegisterMethod(function(isEnabled){renderEnabled(isEnabled)});
this.AttachObject(domAnchor,"onmouseover",function(evt){over(evt,true)});this.AttachObject(domAnchor,"onmouseout",function(evt){out(evt)});this.AttachObject(domAnchor,"onfocus",function(evt){over(evt,false)});this.AttachObject(domAnchor,"onblur",function(evt){out(evt)});this.AttachObject(domAnchor,"onclick",function(evt){D2L.Util.Dom.CancelBubble(evt);if(item.IsEnabled())if(item.Children().length===0)me.ClickItemIndex(me.GetItemIndex(item));else me.ExpandItemIndex(me.GetItemIndex(item),false);return false});
this.m_domDrop.appendChild(li)},AddItem:function(item){this.AppendChild(item);if(this.m_isRendered==true)this.BuildDom_Item(item)},AddItemAtIndex:function(item,index){this.m_children.splice(index,0,item);if(this.m_isRendered){this.BuildDom_Item(item);this.m_domDrop.insertBefore(this.m_domDrop.childNodes[this.Children().length-1],this.m_domDrop.childNodes[index])}},AddSeparator:function(){if(this.Children().length>0)this.Children()[this.Children().length-1].SetHasSeparator(true)},Focus:function(){if(this.m_expandedItemIndex>
0)this.SelectItemIndex(this.m_expandedItemIndex,false)},GetExpandedStructure:function(){var structure=this;while(true){for(var i=0;i<structure.Children().length;i++)if(structure.Children()[i].IsDisplayed()){structure=structure.Children()[i];break}if(i===structure.Children().length)break}return structure},GetItem:function(key){for(var i=0;i<this.Children().length;i++)if(this.Children()[i].GetKey()==key)return this.Children()[i];return null},GetSelectedItem:function(){if(this.m_selectedItemIndex>-1)return this.Children()[this.m_selectedItemIndex];
return null},GetItemIndex:function(item){for(var i=0;i<this.Children().length;i++)if(this.Children()[i]==item)return i;return-1},ClickItemIndex:function(index){var parent=this.GetParent();var Hide=function(list){for(var i=0;i<list.Children().length;i++)Hide(list.Children()[i]);list.Hide()};Hide(parent);if(parent.m_opener!==null)parent.m_opener.Focus();if(index>-1){var item=this.Children()[index];item.ClickEvent().Trigger(item);parent.SelectItemEvent().Trigger(item)}},ExpandItemIndex:function(index,
doSelect){var item=this.Children()[index];if(!item.IsEnabled()||!item.ItemIsDisplayed())return;this.m_expandedItemIndex=index;if(item.IsDisplayed())return;var xy=D2L.Util.Dom.FindPosXY(this.m_domDrop);var winWidth=this.GetUI().GetWindowWidth();var left=xy[0]+this.m_domDrop.offsetWidth-2;var top=xy[1]+this.m_domDrop.childNodes[index].offsetTop-1;var mode=D2L.Style.AnimationMode.Slide;if(winWidth-left<D2L.Control.ContextMenuItemList.WIDTH){left=xy[0]-D2L.Control.ContextMenuItemList.WIDTH;mode=D2L.Style.AnimationMode.None}item.SetAnimationMode(mode);
item.SetPosition(left,top);item.Show(this.m_domDrop.childNodes[index].firstChild);if(doSelect)setTimeout(function(){item.SelectItemIndex(0,false)})},RemoveItem:function(item){var index=this.GetItemIndex(item);if(item&&index>=0){this.Children().splice(index,1);if(this.m_isRendered==true)this.m_domDrop.removeChild(this.m_domDrop.childNodes[index])}},SelectItemIndex:function(index,doExpand){if(index>=this.Children().length)return;var item=this.Children()[index];var selectedItem=this.GetSelectedItem();
if(index!=this.m_selectedItemIndex&&selectedItem!==null){this.m_domDrop.childNodes[this.m_selectedItemIndex].firstChild.className=selectedItem.IsEnabled()?"dcm_a":"dcm_a dcm_ad";this.m_selectedItemIndex=-1}var me=this;if(index!=this.m_expandedItemIndex&&this.m_expandedItemIndex>-1){var expIndex=this.m_expandedItemIndex;setTimeout(function(){me.Children()[expIndex].Hide()},300);this.m_expandedItemIndex=-1}if(index>-1){var anchor=this.m_domDrop.childNodes[index].firstChild;anchor.className=item.IsEnabled()?
"dcm_a dcm_ah":"dcm_a dcm_adh";anchor.focus();if(doExpand&&item.Children().length>0)setTimeout(function(){if(me.m_selectedItemIndex==index)me.ExpandItemIndex(index,false)},400)}this.m_selectedItemIndex=index}});D2L.Control.ContextMenuItemList.WIDTH=190;
D2L.Control.ContextMenu=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_structure=null;this.m_placeHolder=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var structureId=deserializer.GetObjectMin(D2L.Control.Id);var placeHolderId=deserializer.GetObjectMin(D2L.Control.Id);this.m_structure=UI.GetControl(structureId.ID(),structureId.SID());this.m_placeHolder=UI.GetControl(placeHolderId.ID(),placeHolderId.SID())},
AppendChild:function(child){return this.m_structure.AppendChild(child)},AppendSeparator:function(){this.m_structure.AppendSeparator()},Expand:function(){},Collapse:function(){},IsExpanded:function(){return false},SetAlt:function(alt){this.m_placeHolder.SetAlt(alt)},SetSubject:function(subject){this.m_placeHolder.SetSubject(new D2L.LP.Text.PlainText(subject))},ToggleExpanded:function(){}});
D2L.Control.ContextMenuItem=D2L.Control.ContextMenuItemList.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_hasSeparator=false;this.m_img=null;this.m_imgDisabled=null;this.m_text=null;this.m_onClick=function(){};this.m_navInfo=null;this.m_showSeparator=false;this.m_itemIsDisplayed=true;this.m_isEnabled=true;this.m_key="";this.m_structure=null;this.m_itemIsDisplayedChangeEvent=new D2L.EventHandler;this.m_imageChangeEvent=new D2L.EventHandler;this.m_isEnabledChangeEvent=
new D2L.EventHandler;this.m_textChangeEvent=new D2L.EventHandler;this.m_clickEvent=new D2L.EventHandler;var me=this;this.ClickEvent().RegisterMethod(function(){me.m_onClick.call(me)})},ClickEvent:function(){return this.m_clickEvent},DeserializeMin:function(deserializer){arguments.callee.$.DeserializeMin.call(this,deserializer);this.m_key=deserializer.GetMember();this.m_img=deserializer.GetObjectMin(D2L.Images.Image);if(this.m_img===undefined)this.m_img=null;this.m_imgDisabled=deserializer.GetObjectMin(D2L.Images.Image);
if(this.m_imgDisabled===undefined)this.m_imgDisabled=null;this.m_itemIsDisplayed=deserializer.GetBoolean();this.m_isEnabled=deserializer.GetBoolean();this.m_hasSeparator=deserializer.GetBoolean();this.m_text=deserializer.GetObjectMin(D2L.LP.Text.IText);if(this.Children().length===0)this.m_onClick=new Function(deserializer.GetMember())},Deserialize:function(deserializer){arguments.callee.$.Deserialize.call(this,deserializer);this.m_key=deserializer.GetMember("Key");if(deserializer.HasMember("Img"))this.m_img=
deserializer.GetObject("Img",D2L.Images.Image);if(deserializer.HasMember("ImgDisabled"))this.m_imgDisabled=deserializer.GetObject("ImgDisabled",D2L.Images.Image);this.m_itemIsDisplayed=deserializer.GetMember("IsDisplayed");this.m_isEnabled=deserializer.GetMember("IsEnabled");this.m_hasSeparator=deserializer.GetMember("HasSeparator");this.m_text=deserializer.GetObject("Text",D2L.LP.Text.IText);if(deserializer.HasMember("OnClick"))this.m_onClick=new Function(deserializer.GetMember("OnClick"))},GetKey:function(){return this.m_key},
GetStructure:function(){if(this.m_structure===null){var parent=this;while(parent.Parent()!==null)parent=parent.Parent();this.m_structure=parent}return this.m_structure},GetText:function(){return this.m_text},HasSeparator:function(){return this.m_hasSeparator},ImageChangeEvent:function(){return this.m_imageChangeEvent},ItemIsDisplayed:function(){return this.m_itemIsDisplayed},ItemIsDisplayedChangeEvent:function(){return this.m_itemIsDisplayedChangeEvent},IsEnabled:function(){return this.m_isEnabled},
IsEnabledChangeEvent:function(){return this.m_isEnabledChangeEvent},SetKey:function(key){this.m_key=key},SetImage:function(img,imgDisabled){if(imgDisabled===undefined)imgDisabled=null;if(img!==null){this.m_img=img;this.ImageChangeEvent().Trigger(img)}if(imgDisabled!==null)this.SetImageDisabled(imgDisabled)},SetImageDisabled:function(imgDisabled){if(imgDisabled!==null)this.m_imgDisabled=imgDisabled},SetImageInfo:function(imgInfo){this.SetImage(imgInfo)},SetImageInfoDisabled:function(imgInfoDisabled){this.SetImageDisabled(imgInfoDisabled)},
SetItemIsDisplayed:function(itemIsDisplayed){if(itemIsDisplayed==this.m_itemIsDisplayed)return;this.m_itemIsDisplayed=itemIsDisplayed;this.ItemIsDisplayedChangeEvent().Trigger(itemIsDisplayed)},SetIsEnabled:function(isEnabled){if(isEnabled==this.IsEnabled())return;this.m_isEnabled=isEnabled;this.IsEnabledChangeEvent().Trigger(isEnabled)},SetOnClick:function(onClick){if(onClick){if(this.m_navInfo===null)this.m_navInfo=new D2L.NavInfo;this.m_navInfo.SetOnClick(onClick);this.SetNav(this.m_navInfo)}},
SetNav:function(navInfo){if(navInfo){this.m_navInfo=navInfo;var navStruct=this.m_navInfo.SetupHrefOnClick(this,false);this.m_onClick=navStruct.OnClick}},SetHasSeparator:function(hasSeparator){this.m_hasSeparator=hasSeparator},SetShowSeparator:function(showSeparator){this.m_showSeparator=showSeparator},SetText:function(text){this.m_text=text;this.TextChangeEvent().Trigger(text)},TextChangeEvent:function(){return this.m_textChangeEvent}});
D2L.Control.ContextMenuPlaceHolder=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_text=null;this.m_alt=null;this.m_hoverEvent=new D2L.EventHandler;this.m_isOffScreen=false;this.m_subject=null;this.m_hasText=false;this.m_hasImage=false;this.m_img=null;this.m_imgDrop=null;this.m_posDomNode=null;this.m_structure=null;this.m_key="";this.m_float=D2L.Style.Float.None;this.m_params=new D2L.Util.Dictionary;this.m_showEvent=new D2L.EventHandler;this.m_text=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,
deserializer);var structureId=deserializer.GetObjectMin(D2L.Control.Id);this.SetStructure(UI.GetControl(structureId.ID(),structureId.SID()));var me=this;this.m_hasText=deserializer.GetBoolean();this.m_hasImage=deserializer.GetBoolean();this.m_key=deserializer.GetMember();this.m_float=deserializer.GetMember();this.m_params=deserializer.GetObject(D2L.Util.Dictionary);var onShow=deserializer.GetMember();if(onShow.length>0&&window[onShow]!==undefined)this.ShowEvent().RegisterMethod(function(){window[onShow].call(onShow,
me)});var domNode=this.GetDomNode();if(domNode===null){this.m_hasDomBeenBuilt=false;return}this.m_imgDrop=this.GetDomNode().childNodes[this.GetDomNode().childNodes.length-1];if(this.m_hasImage)this.m_img=this.GetDomNode().firstChild},HoverEvent:function(){return this.m_hoverEvent},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);var domNode=this.SetDomNode(this.GetUI().CreateElement("a"));domNode.className="dcm";if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Firefox&&
UI.GetBrowserInfo().MajorVersion<=2)domNode.style.fontSize="7px";domNode.tabIndex=0;if(this.m_isOffScreen)D2L.LP.Web.UI.Html.Dom.AddClassName("dcm_handle_hidden",domNode);if(this.m_text!==null){var domText=this.GetUI().CreateElement("span");domNode.appendChild(domText);this.m_text.AssignHtml(domText,"innerHTML",true)}else D2L.LP.Web.UI.Html.Dom.AddClassName("dcm_handle",domNode);this.m_imgDrop=this.GetUI().CreateElement("img");this.m_imgDrop.className="dcm_d";D2L.Images.ImageTerm.Assign("Framework.ContextMenu.dropArrow",
this.m_imgDrop,false);domNode.appendChild(this.m_imgDrop);this.RenderAlt();this.RenderFloat();var me=this;D2L.Control.ContextMenuPlaceHolder.InstallEvents(domNode,function(){return me})},Click:function(){if(this.m_structure===null)return;var me=this;if(this.m_structure.GetOpener()!==null&&this.m_structure.GetOpener()!=this)this.m_structure.Hide();if(!this.m_structure.IsDisplayed())this.Show().Register(function(){setTimeout(function(){me.m_structure.GetDomNode().focus()})});else this.m_structure.Hide()},
Focus:function(){if(this.IsRendered())try{this.GetDomNode().focus()}catch(e){}},GetDropHeight:function(){var dr=new D2L.Util.DelayedReturn;this.m_structure.SetPosition(-1E3,-1E3);this.m_structure.SetAnimationMode(D2L.Style.AnimationMode.None);var me=this;this.m_structure.Show(this,this.GetUI().GetBodyElement().lastChild).Register(function(){var height=D2L.Util.Dom.GetHeightHelper(me.m_structure.GetDomNode());me.m_structure.Hide();me.m_structure.SetPosition(0,0);me.m_structure.SetAnimationMode(D2L.Style.AnimationMode.Slide);
dr.Trigger(height)});return dr},GetFloat:function(){return this.m_float},GetKey:function(){return this.m_key},GetParam:function(name,defaultValue){var result=this.m_params.Get(name);if(result===undefined)result=defaultValue;return result},GetPositionInfo:function(){var dr=new D2L.Util.DelayedReturn;var downOffset=1;var upOffset=1;var leftOffset=0;if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Firefox){upOffset=2;downOffset=0;if(this.m_hasText||this.m_isOffScreen){upOffset=1;downOffset=1}if(!this.m_hasText&&
this.GetFloat()!=D2L.Style.Float.None)leftOffset=1}var domNode=this.m_posDomNode!==null?this.m_posDomNode:this.GetDomNode();var dropWidth=D2L.Control.ContextMenuItemList.WIDTH;var xy=D2L.Util.Dom.FindPosXY(domNode);var me=this;var GetPosition=function(width,height,dropHeight){var left=xy[0];var right=width-xy[0];var top=xy[1];var bottom=height-xy[1]-domNode.offsetHeight;var x=xy[0]+leftOffset;var y=xy[1]+domNode.offsetHeight-downOffset;var mode=D2L.Style.AnimationMode.None;var success=true;if(bottom-
dropHeight>0&&right-dropWidth>0)mode=D2L.Style.AnimationMode.Slide;else if(bottom-dropHeight>0&&left-dropWidth>0)x=xy[0]-dropWidth+domNode.offsetWidth+leftOffset;else if(top-dropHeight>0&&right-dropWidth>0)y=xy[1]-dropHeight+upOffset;else if(top-dropHeight>0&&left-dropWidth>0){x=xy[0]-dropWidth+domNode.offsetWidth+leftOffset;y=xy[1]-dropHeight+upOffset}else success=false;return{x:x,y:y,mode:mode,success:success,originalHeight:dropHeight,firstClick:true}};this.GetDropHeight().Register(function(dropHeight){var position=
GetPosition(me.GetUI().GetWindowWidth(),me.GetUI().GetWindowHeight(),dropHeight);if(!position.success)position=GetPosition(me.GetUI().GetPageWidth(),me.GetUI().GetPageHeight(),dropHeight);dr.Trigger(position)});return dr},GetStructure:function(){return this.m_structure},GetText:function(){return this.m_text},HasParam:function(name){return this.m_params.ContainsKey(name)},RenderAlt:function(){if(!this.IsRendered())return;var alt=this.m_alt;if(alt===null)alt=new D2L.LP.Text.LangTerm("Framework.ContextMenu.altDefaultTitleSubject");
var me=this;var DoAssign=function(){alt.AssignText(me.GetDomNode(),"title");alt.AssignText(me.m_imgDrop,"alt")};if(this.m_subject!==null)this.m_subject.GetText().Register(function(subject){alt.SetSubject(subject);DoAssign()});else DoAssign()},RenderFloat:function(){if(!this.IsRendered())return;var f="none";if(this.GetFloat()==D2L.Style.Float.Left)f="left";else if(this.GetFloat()==D2L.Style.Float.Right)f="right";if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.GetDomNode().style.styleFloat=
f;else this.GetDomNode().style.cssFloat=f},SetParam:function(name,value){this.m_params.Add(name,value)},SetStructure:function(structure){this.m_structure=structure},SetText:function(text){this.m_text=text},Show:function(){if(this.m_structure===null)return;var dr=new D2L.Util.DelayedReturn;var me=this;this.GetPositionInfo().Register(function(posInfo){me.m_structure.SetAnimationMode(posInfo.mode);me.ShowEvent().Trigger(me);var dr2=null;if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion==
6)dr2=me.m_structure.Show(me,UI.GetBodyElement().lastChild);else dr2=me.m_structure.Show(me,me.GetDomNode());if(posInfo.firstClick){var height=D2L.Util.Dom.GetHeightHelper(me.m_structure.GetDomNode());if(height!=1){var heightChange=posInfo.originalHeight-height;posInfo.y+=heightChange}posInfo.firstClick=false}me.m_structure.SetPosition(posInfo.x,posInfo.y);dr2.Register(function(){dr.Trigger()})});return dr},ShowEvent:function(){return this.m_showEvent},SetAlt:function(alt){this.m_alt=alt;this.RenderAlt()},
SetFloat:function(floatVal){this.m_float=floatVal;this.RenderFloat()},SetKey:function(key){this.m_key=key},SetSubject:function(subject){this.m_subject=D2L.LP.Text.IText.Normalize(subject);this.RenderAlt()}});
D2L.Control.ContextMenuPlaceHolder.InstallEvents=function(domNode,GetControl){var hasRegistered=false;var isStructureDisplayed=false;var isOver=false;var hasFocus=false;var over=function(evt){if(!hasRegistered){hasRegistered=true;var me=GetControl();var structure=me.GetStructure();var handleDisplayChange=function(isDisplayed){if(structure.GetOpener()==me)isStructureDisplayed=isDisplayed;else isStructureDisplayed=false;var isHover=isOver||hasFocus;if(isHover)D2L.LP.Web.UI.Html.Dom.AddClassName("dcm_h",
domNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("dcm_h",domNode);me.HoverEvent().Trigger(isHover)};structure.IsDisplayedChangeEvent().RegisterMethod(handleDisplayChange);handleDisplayChange(structure.IsDisplayed())}D2L.LP.Web.UI.Html.Dom.AddClassName("dcm_h",domNode);GetControl().HoverEvent().Trigger(true);isOver=true};var out=function(evt){isOver=false;if(!isStructureDisplayed&&!hasFocus){D2L.LP.Web.UI.Html.Dom.RemoveClassName("dcm_h",domNode);GetControl().HoverEvent().Trigger(false)}};UI.AttachObject(domNode,
"onmouseover",over);UI.AttachObject(domNode,"onfocus",function(evt){hasFocus=true;over(evt)});UI.AttachObject(domNode,"onmouseout",out);UI.AttachObject(domNode,"onblur",function(evt){hasFocus=false;out(evt)});UI.AttachObject(domNode,"onclick",function(evt){D2L.Util.Dom.CancelBubble(evt);WindowEventManager.Click.Trigger(evt);GetControl().Click();return false});UI.GetWindowEventManager().HideContextMenus.RegisterMethod(function(evt){if(isStructureDisplayed)GetControl().Click()});UI.GetWindowEventManager().InstallKpel(domNode,
function(obj,evt){if(evt.GetKey()==D2L.KeyPressEvent.Key.Enter){WindowEventManager.Click.Trigger(evt);GetControl().Click()}});D2L.Util.Aria.SetRole(domNode,"link")};
D2L.Control.ContextMenuStructure=D2L.Control.ContextMenuItemList.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_opener=null;this.m_loadCallback=null;this.m_isLoaded=true;this.m_key="";this.m_selectItemEvent=new D2L.EventHandler},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var loadCallback=deserializer.GetMember();if(loadCallback.length>0&&window[loadCallback]!==undefined)this.SetLoadCallback(window[loadCallback]);
this.m_key=deserializer.GetMember();var onSelectItem=deserializer.GetMember();if(onSelectItem.length>0&&window[onSelectItem]!==undefined)this.SelectItemEvent().RegisterMethod(function(item){window[onSelectItem](item)})},BuildDom:function(){if(this.IsRendered())return;var me=this;WindowEventManager.KeyPress.RegisterMethod(function(evt){return me.HandleKeyPress(evt)});arguments.callee.$.BuildDom.call(this)},GetOpener:function(){return this.m_opener},GetKey:function(){return this.m_key},HandleKeyPress:function(evt){if(!this.IsDisplayed())return;
var structure=this.GetExpandedStructure();if(evt.GetKey()==D2L.KeyPressEvent.Key.ArrowDown||evt.GetKey()==D2L.KeyPressEvent.Key.ArrowUp){var direction=evt.GetKey()==D2L.KeyPressEvent.Key.ArrowDown?1:-1;var originalIndex=structure.m_selectedItemIndex;var newIndex=originalIndex;var maxTries=structure.Children().length;var numTries=0;while(true){if(numTries==maxTries)break;newIndex=newIndex+direction;if(newIndex<0)newIndex=structure.Children().length-1;else if(newIndex==structure.Children().length)newIndex=
0;if(structure.Children()[newIndex].ItemIsDisplayed())break;numTries++}if(newIndex!=originalIndex)structure.SelectItemIndex(newIndex,false);evt.Cancel();return false}else if(evt.GetKey()==D2L.KeyPressEvent.Key.ArrowRight){var selectedItem=structure.GetSelectedItem();if(selectedItem!==null&&selectedItem.IsEnabled()&&selectedItem.Children().length>0){structure.ExpandItemIndex(structure.m_selectedItemIndex,true);evt.Cancel()}}else if(evt.GetKey()==D2L.KeyPressEvent.Key.ArrowLeft){if(structure.Parent()!==
null){structure.Hide();structure.Parent().Focus();evt.Cancel()}}else if(evt.GetKey()==D2L.KeyPressEvent.Key.Escape){structure.Hide();if(structure.Parent()!==null)structure.Parent().Focus();else if(this.m_opener!==null)this.m_opener.Focus()}else if(evt.GetKey()==D2L.KeyPressEvent.Key.Enter){var item=structure.GetSelectedItem();if(item!==null&&item.IsEnabled())if(item.Children().length===0)structure.ClickItemIndex(structure.m_selectedItemIndex);else structure.ExpandItemIndex(structure.m_selectedItemIndex,
true)}},SelectItemEvent:function(){return this.m_selectItemEvent},SetKey:function(key){this.m_key=key},SetLoadCallback:function(callback){this.m_loadCallback=callback;this.m_isLoaded=false},Show:function(opener,insertAfter){var dr=new D2L.Util.DelayedReturn;this.m_opener=opener;if(this.m_isLoaded){arguments.callee.$.Show.call(this,insertAfter);dr.Trigger()}else{var me=this;var args=arguments;var result=this.m_loadCallback(this);if(result!==undefined)result.Register(function(items){for(var i=0;i<items.length;i++)me.AppendChild(items[i]);
me.m_isLoaded=true;me.Show(opener,insertAfter);dr.Trigger()});else{me.m_isLoaded=true;dr=me.Show(opener,insertAfter)}}return dr}});
D2L.Control.DateRange=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isEnabled=true;this.sd=null;this.ed=null;this.cb_sd=null;this.cb_ed=null;this.cb_se=null;this.cb_ih=null;this.m_validationFailureSource=0},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.sd=UI.GetControl(this.GetMappedId()+"_dts_sd");this.ed=UI.GetControl(this.GetMappedId()+"_dts_ed");this.cb_sd=UI.GetControl(this.GetMappedId()+
"_cb_sd");this.cb_ed=UI.GetControl(this.GetMappedId()+"_cb_ed");this.cb_se=UI.GetControl(this.GetMappedId()+"_cb_se");this.cb_ih=UI.GetControl(this.GetMappedId()+"_cb_ih")},HasTime:function(){return this.sd.HasTime()},Focus:function(){if(this.m_validationFailureSource==0||this.m_validationFailureSource==1)this.sd.Focus();else if(this.m_validationFailureSource==2)this.ed.Focus()},GetValidationBalloonDomNode:function(){if(this.m_validationFailureSource==0||this.m_validationFailureSource==1)return this.sd.GetDomNode();
else if(this.m_validationFailureSource==2)return this.ed.GetDomNode()},GetStartDate:function(){if(this.HasStartDate())return this.sd.GetDate();else return null},GetStartDateSelector:function(){return this.sd},GetStartYear:function(){return this.sd.GetYear()},GetStartMonth:function(){return this.sd.GetMonth()},GetStartDay:function(){return this.sd.GetDay()},GetStartHour:function(){return this.sd.GetHour()},GetStartMinute:function(){return this.sd.GetMinute()},GetEndYear:function(){return this.ed.GetYear()},
GetEndMonth:function(){return this.ed.GetMonth()},GetEndDay:function(){return this.ed.GetDay()},GetEndHour:function(){return this.ed.GetHour()},GetEndMinute:function(){return this.ed.GetMinute()},GetEndDate:function(){if(this.HasEndDate())return this.ed.GetDate();else return null},GetEndDateSelector:function(){return this.ed},HasStartDate:function(){if(this.cb_sd!==null)return this.cb_sd.IsChecked();return true},HasEndDate:function(){if(this.cb_ed!==null)return this.cb_ed.IsChecked();return true},
IsScheduleEventCreated:function(){if(this.cb_se!=null)return this.cb_se.IsChecked();else return false},HasEvent:function(){return this.IsScheduleEventCreated()},IsHidden:function(){if(this.cb_ih)return this.cb_ih.IsChecked();else return false},GetState:function(serializer){serializer.AddMember("HasStartDate",this.HasStartDate());serializer.AddMember("HasEndDate",this.HasEndDate());serializer.AddMember("HasEvent",this.IsScheduleEventCreated());serializer.AddMember("IsHidden",this.IsHidden());serializer.AddMember("StartDate",
this.GetStartDateSelector(),"GetState");serializer.AddMember("EndDate",this.GetEndDateSelector(),"GetState")},SetHasStartDate:function(hasStartDate){if(this.HasStartDate()!=hasStartDate&&this.cb_sd!==null){this.cb_sd.SetIsChecked(hasStartDate);this.cb_sd.GetDomNode().IEnabler.ResetState()}},SetHasEndDate:function(hasEndDate){if(this.HasEndDate()!=hasEndDate&&this.cb_ed!==null){this.cb_ed.SetIsChecked(hasEndDate);this.cb_ed.GetDomNode().IEnabler.ResetState()}}});D2L.DateRange=D2L.Control.DateRange;
var d2l_DateRange=D2L.Control.DateRange;
D2L.DateTime=D2L.Class.extend({Construct:function(dateString){arguments.callee.$.Construct.call(this);this.m_date=new Date;if(dateString)this.SetDateString(dateString)},SetDateString:function(dateString){this.SetMonth(0);this.SetDay(1);this.SetYear(parseInt(substr(0,4)));this.SetMonth(parseInt(substr(4,2)));this.SetDay(parseInt(substr(6,2)));this.SetHour(parseInt(substr(8,2)));this.SetMinute(parseInt(substr(10,2)))},GetDateString:function(){var ret;ret=this.GetYear();ret+=this.PadInt(this.GetMonth(),
2);ret+=this.PadInt(this.GetDay(),2);ret+=this.PadInt(this.GetHour(),2);ret+=this.PadInt(this.GetMinute(),2);return ret},PadInt:function(val,digits){var ret=val.toString();while(ret.length<digits)ret="0"+ret;return ret},GetYear:function(){return this.m_date.getFullYear()},SetYear:function(year){this.m_date.setFullYear(year)},GetMonth:function(){return this.m_date.getMonth()},SetMonth:function(month){this.m_date.setMonth(month)},GetDay:function(){return this.m_date.getDate()},SetDay:function(day){this.m_date.setDate(day)},
GetHour:function(){return this.m_date.getHours()},SetHour:function(hour){this.m_date.setHours(hour)},GetMinute:function(){return this.m_date.getMinutes()},SetMinute:function(minute){this.m_date.setMinutes(minute)},GetTimestamp:function(){return this.m_date.getTime()}});
D2L.Control.DateTimeSelector=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isEnabled=true;this.m_type=null;this.m_inputDate=null;this.m_onChangeEvent=new D2L.EventHandler;this.m_isTimeOnly=true;this.m_name=""},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_name=deserializer.GetMember();this.name=this.m_name;var node;if(this.m_name!="")node=UI.GetByName(this.m_name);else node=this.GetDomNode();
this.SetDomNode(node);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datetime-selector-date-input",node)){this.m_isTimeOnly=false;this.m_inputDate=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datetime-selector-date-input",node)}var me=this.m_isTimeOnly?D2L.LP.Web.UI.Desktop.Controls.TimeSelector:D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);var nodes=me.GetNodes(id);this.m_isEnabled=me.IsEnabledNodes(nodes);if(this.m_isTimeOnly)this.m_type=
D2L.Control.DateTimeSelector.Type.TimeOnly;else if(me.GetHasTimeNodes(nodes))this.m_type=D2L.Control.DateTimeSelector.Type.DateTime;else this.m_type=D2L.Control.DateTimeSelector.Type.DateOnly},GetMultiEditValue:function(){var padInt=function(val,digits){var padIntRet=val.toString();while(padIntRet.length<digits)padIntRet="0"+padIntRet;return padIntRet};var ret="0001-01-01T00:00:00";if(this.IsEnabled()){ret=this.GetYear()?this.GetYear():"0001";ret+="-";ret+=this.GetMonth()?padInt(this.GetMonth(),2):
"01";ret+="-";ret+=this.GetDay()?padInt(this.GetDay(),2):"01";ret+="T";if(this.GetHour()!==null)ret+=padInt(this.GetHour(),2);else ret+="00";ret+=":";ret+=this.GetMinute()?padInt(this.GetMinute(),2):"00";ret+=":00"}return ret},GetState:function(serializer){var dt=new Date;var year=this.GetYear();if(year===null)year=dt.getFullYear();var month=this.GetMonth();if(month===null)month=dt.getMonth()+1;var day=this.GetDay();if(day===null)day=dt.getDay();var hour=this.GetHour();if(hour===null)hour=-1;var minute=
this.GetMinute();if(minute===null)minute=-1;serializer.AddMember("Year",year);serializer.AddMember("Month",month);serializer.AddMember("Day",day);serializer.AddMember("Hour",hour);serializer.AddMember("Minute",minute)},GetNodes:function(){var node=this.GetDomNode();var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);var nodes;if(this.m_isTimeOnly)nodes=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(id);else nodes=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetNodes(id);return nodes},Focus:function(){this.GetNodes().edit.focus()},
HasTime:function(){if(this.m_isTimeOnly)return true;var nodes=this.GetNodes();return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetHasTimeNodes(nodes)},GetDate:function(){var dts;var nodes=this.GetNodes();if(this.m_isTimeOnly)dts=null;else{dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTimeNodes(nodes);dts=D2L.Util.DateTime.ConvertToD2LDateTime(dts)}return dts},GetDay:function(){if(!this.m_isTimeOnly){var nodes=this.GetNodes();return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTimeNodes(nodes).m_day}return null},
GetHour:function(){var nodes=this.GetNodes();if(!this.m_isTimeOnly)return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTimeNodes(nodes).m_hour;return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes).m_hour},GetHour24:function(){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("DateTimeSelector.GetHour24() is "+"obsolete. Use GetHour() instead."),true);return this.GetHour()},GetMinute:function(){var nodes=this.GetNodes();if(!this.m_isTimeOnly)return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTimeNodes(nodes).m_minute;
return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes).m_minute},GetMonth:function(){if(!this.m_isTimeOnly){var nodes=this.GetNodes();return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTimeNodes(nodes).m_month}return null},GetYear:function(){if(!this.m_isTimeOnly){var nodes=this.GetNodes();return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTimeNodes(nodes).m_year}return null},IsDateValid:function(){if(!this.m_isTimeOnly){var dts=this.GetDate();
return D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.IsValidDate(dts.m_year,dts.m_month,dts.m_day)}return null},IsEnabled:function(){return this.m_isEnabled},IsTimeOnly:function(){return this.m_isTimeOnly},Now:function(leaveTimeAlone){var now=D2L.Util.DateTime.Now();var adjustedNow=new D2L.LocalDateTime(now.GetYear(),now.GetMonth()-1,now.GetDay(),now.GetHour(),now.GetMinute(),0);this.SetDate(adjustedNow,leaveTimeAlone)},SetDate:function(dt,leaveTimeAlone){var localDt=D2L.Util.DateTime.ConvertToLocalDateTime(dt);
if(leaveTimeAlone===undefined)leaveTimeAlone=false;if(this.m_isTimeOnly)if(leaveTimeAlone)return;else{this.SetHour(localDt.GetHour());this.SetMinute(localDt.GetMinute());return}var nodes=this.GetNodes();if(leaveTimeAlone){var dts=new D2L.LocalDateTime(localDt.GetYear(),localDt.GetMonth()+1,localDt.GetDay(),this.GetHour(),this.GetMinute(),0);D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.SetSelectedDateTimeByNode(nodes,dts)}else{localDt.m_month+=1;D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.SetSelectedDateTimeByNode(nodes,
localDt)}},SetHour:function(hour){var dt;var nodes=this.GetNodes();if(this.m_isTimeOnly){dt=new D2L.LocalTime(hour,this.GetMinute());D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetTimeNodes(nodes,dt)}else{dt=new D2L.LocalDateTime(this.GetYear(),this.GetMonth(),this.GetDay(),hour,this.GetMinute(),0);D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.SetSelectedDateTimeByNode(nodes,dt)}},SetHour24:function(hour){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("DateTimeSelector.SetHour24() is "+
"obsolete. Use SetHour() instead."),true);this.SetHour(hour)},SetMinute:function(min){var dt;var nodes=this.GetNodes();if(this.m_isTimeOnly){dt=new D2L.LocalTime(this.GetHour(),min);D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetTimeNodes(nodes,dt)}else{dt=new D2L.LocalDateTime(this.GetYear(),this.GetMonth(),this.GetDay(),this.GetHour(),min,0);D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.SetSelectedDateTimeByNode(nodes,dt)}},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;var nodes=
this.GetNodes();if(this.m_isTimeOnly)D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetIsEnabledNodes(nodes,isEnabled);else D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.SetIsEnabledNodes(nodes,isEnabled)},OnChangeEvent:function(){return this.m_onChangeEvent}});D2L.Control.DateTimeSelector.Type={DateTime:1,DateOnly:2,TimeOnly:3};
D2L.DialogBase=D2L.Control.extend({Construct:function(name,callback){arguments.callee.$.Construct.call(this,true);if(name!==undefined)try{var oldDialog=UI.GetByName(name);if(oldDialog!=null&&oldDialog!=this){if(oldDialog.IsShown())D2L.Dialog.BC(name,D2L.Dialog.ResponseType.Abort);oldDialog.Close()}}catch(e){}if(name===undefined||!name.isString){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Dialogs should always have a name"),true);name=UI.GetUniqueHtmlId()}if(!UI.IsValidJsVariableName(name))UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.SmlText('Dialog Name "[0]" is not a valid '+
"JavaScript name. Names can only contain letters, numbers "+"and underscore and must start with a letter",name),true);if(callback===undefined)callback=function(dr){dr.GetDialog().Close()};this.m_topOffset=10;this.m_bottomOffset=10;this.m_maxDialogHeight=UI.GetWindowHeight(window)*0.8;this.m_buttons=[];this.m_buttonTable=null;this.m_callback=null;this.m_callbackArguments=[];this.m_closeIconResponseType=D2L.Dialog.ResponseType.Abort;this.m_footerText=new D2L.LP.Text.PlainText("");this.m_footerTextNode=
null;this.m_height=null;this.m_icon=null;this.m_iconTerm=null;this.m_iframe=null;this.m_iframeWindow=null;this.m_ignoreMaxMinSizeOnResize=false;this.m_isLoaded=false;this.m_isShown=false;this.m_minHeight=200;this.m_minWidth=200;this.m_name=name;this.m_positiveButton=null;this.m_src="";this.m_srcCallbackName="";this.m_srcParams=[];this.m_srcWindow=null;this.m_title=new D2L.LP.Text.LangTerm("Standard.Misc.txtLoading");this.m_titleIsSet=false;this.m_width=400;this.m_opener=undefined;this.OnOpen=new D2L.EventHandler;
this.OnResize=new D2L.EventHandler;this.m_firstLoadEvent=new D2L.LP.Web.UI.Events.Event;this.SetCallback(callback)},BuildDom_Buttons:function(){this.m_buttonTable=this.CreateElement("table");if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Safari||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Chrome)this.m_buttonTable.style.width="auto";this.m_buttonTable.className="ddial_b";this.m_buttonTable.style.display=this.m_buttons.length>0?"block":"none";var r=this.m_buttonTable.insertRow(-1);var c1=this.CreateCell(r);
var c2=this.CreateCell(r);c2.align="center";c2.width="100%";var c3=this.CreateCell(r);c3.align="right";for(var i=0;i<this.m_buttons.length;i++){this.m_buttons[i].b.m_hasDomBeenBuilt=false;this.m_buttons[i].b.AppendTo(r.cells[this.m_buttons[i].p])}},BuildDom_Frame:function(){this.m_loading=this.CreateElement("div");this.m_loading.className="ddial_l";var img=this.CreateElement("img");img.src="/d2l/img/LP/dialog/loading.gif";this.m_loading.appendChild(img);this.m_loading.appendChild(this.CreateTextNode(new D2L.LP.Text.LangTerm("Standard.Misc.txtLoading")));
this.IChildrenDomNode.appendChild(this.m_loading);var name=this.GetWindow()["UI"].GetUniqueHtmlId();if(this.IChildrenDomNode.insertAdjacentHTML){this.IChildrenDomNode.insertAdjacentHTML("beforeEnd","<iframe name='"+name+"' style='width:1px;height:1px;border:none;' border='0' frameborder='0' src='/d2l/tools/blank.html'></iframe>");this.m_iframe=this.IChildrenDomNode.childNodes[this.IChildrenDomNode.childNodes.length-1]}else{this.m_iframe=this.CreateElement("iframe");this.m_iframe.name=name;this.m_iframe.style.width=
"1px";this.m_iframe.style.height="1px";this.m_iframe.border=0;this.m_iframe.frameBorder=0;this.m_iframe.style.border="none";this.m_iframe.src="/d2l/tools/blank.html";this.IChildrenDomNode.appendChild(this.m_iframe)}var loadedOnce=false;var me=this;var onIFrameLoad=function(){if(!loadedOnce){loadedOnce=true;me.m_firstLoadEvent.Trigger();return}me.m_iframeWindow=me.m_iframe.contentWindow;var doLoad=false;try{if(me.m_iframeWindow&&me.m_iframeWindow.location.href.indexOf("/d2l/tools/blank.html")==-1)doLoad=
true}catch(e){doLoad=false}var resizeFrame=function(){me.FitContents()};if(D2L.Util.Url.IsExternal(me.m_src)||doLoad){me.HandleOnload();setTimeout(resizeFrame,0)}};if(this.m_iframe.attachEvent)this.m_iframe.attachEvent("onload",onIFrameLoad);else if(this.m_iframe.addEventListener)this.m_iframe.addEventListener("load",onIFrameLoad,false);this.m_iframeOnloadFunc=onIFrameLoad;this.GetTitle().AssignText(this.m_iframe,"title")},AddPrimaryButton:function(type,responseParam,name){if(responseParam===undefined)responseParam=
"";return this.AddButtonHelper(D2L.Control.Button.GetTermForType(type),D2L.Dialog.ButtonPosition.Left,type,this.GetResponseTypeFromButtonType(type),responseParam,name,true)},AddSecondaryButton:function(type,responseParam,name){if(responseParam===undefined)responseParam="";return this.AddButtonHelper(D2L.Control.Button.GetTermForType(type),D2L.Dialog.ButtonPosition.Left,type,this.GetResponseTypeFromButtonType(type),responseParam,name,false)},AddButton:function(type,responseParam,name,isPrimary){if(responseParam===
undefined)responseParam="";if(isPrimary===undefined)isPrimary=false;var position;if(type==D2L.Control.Button.Type.Close||type==D2L.Control.Button.Type.Cancel)position=D2L.Dialog.ButtonPosition.Left;else if(type==D2L.Control.Button.Type.Ok)position=D2L.Dialog.ButtonPosition.Middle;else position=D2L.Dialog.ButtonPosition.Right;var responseType=this.GetResponseTypeFromButtonType(type);return this.AddButtonHelper(D2L.Control.Button.GetTermForType(type),position,type,responseType,responseParam,name,isPrimary)},
AddCustomButton:function(text,position,responseType,responseParam,id,isPrimary){return this.AddButtonHelper(text,position,D2L.Control.Button.Type.Custom,responseType,responseParam,id,isPrimary)},GetResponseTypeFromButtonType:function(type){if(type==D2L.Control.Button.Type.Cancel||type==D2L.Control.Button.Type.Close)return D2L.Dialog.ResponseType.Abort;else if(type==D2L.Control.Button.Type.No)return D2L.Dialog.ResponseType.Negative;else return D2L.Dialog.ResponseType.Positive},AddButtonHelper:function(text,
position,type,responseType,responseParam,id,isPrimary){var b=this.GetButton(id);if(b!==null)this.RemoveButton(b);text=D2L.LP.Text.IText.Normalize(text,"D2L.DialogBase","AddButtonHelper","text");if(position===undefined)position=D2L.Dialog.ButtonPosition.Left;if(responseType===undefined)responseType=D2L.Dialog.ResponseType.Positive;if(responseParam===undefined)responseParam="";if(isPrimary===undefined)isPrimary=false;var dialog=this;var button=new D2L.Control.Button(text);button.SetIsPrimary(isPrimary);
button.SetOnClick(function(){D2L.Dialog.BC(dialog.m_name,responseType,type,responseParam)});if(id!==undefined)button.SetControlId(id);if(responseType==D2L.Dialog.ResponseType.Positive&&this.m_positiveButton===null)this.m_positiveButton=button;this.m_buttons.push({"p":position,"b":button,"t":type,"d":false});if(this.m_hasDomBeenBuilt){button.AppendTo(this.m_buttonTable.rows[0].cells[position]);if(this.m_buttons.length==1){this.m_buttonTable.style.display="block";this.SetHeight(this.m_height)}}return button},
CallCallback:function(response){if(this.IsClosed()&&response!=null&&response.GetType()!=D2L.Dialog.ResponseType.Abort)UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Calling CallCallback on a closed "+"dialog can cause unexpected errors in IE. Please make sure "+"you are closing the dialog inside your outer callback "+"function instead of SrcCallback."),true);var cb=this.GetCallback();var ret=response;if(cb){var cbRet=cb.apply(cb,[response].concat(this.m_callbackArguments));if(cbRet!==
undefined)ret=cbRet}if(this.m_delayedReturn)this.m_delayedReturn.Trigger(ret)},CallSrcMethod:function(methodName,val){if(this.m_srcWindow&&!this.m_srcWindow.closed&&this.m_srcWindow[methodName])return this.m_srcWindow[methodName](val);else return null},Close:function(){},FitContents:function(){if(this.m_fitted==true)return;var iframe=this.m_iframe;var iframeBody=null;try{iframeBody=iframe.contentWindow.document.body}catch(e){}if(iframeBody===null)return;var topOffset=this.m_topOffset;var bottomOffset=
this.m_bottomOffset;var frameContentsHeight=iframeBody.offsetHeight;var heightDiff=parseInt(this.IDomNode.offsetHeight,10)-parseInt(this.GetContentHeight(),10);var currentHeight=this.m_height;var heightToAdd=frameContentsHeight+heightDiff+topOffset+bottomOffset-currentHeight;if(heightToAdd<=0)return;var newHeight=Math.round(Math.min(this.m_maxDialogHeight,currentHeight+heightToAdd));this.SetHeight(newHeight);this.m_fitted=true},GetButton:function(id){if(id!==undefined){id=id.toLowerCase();for(var i=
0;i<this.m_buttons.length;i++)if(this.m_buttons[i].b.GetControlId().ID()==id)return this.m_buttons[i].b}return null},GetButtonCount:function(){if(this.m_buttons!=null)return this.m_buttons.length;else return 0},GetCallback:function(){return this.m_callback},GetContentHeight:function(){var h=0;if(this.IChildrenDomNode)h=this.IChildrenDomNode.offsetHeight;if(this.m_icon!=null&&this.m_icon.offsetHeight)if(this.m_icon.offsetHeight>h)h=this.m_icon.offsetHeight;return h},GetHeight:function(){if(this.IsShown())return this.IDomNode.offsetHeight;
else return this.m_height},GetWidth:function(){return this.m_width},GetFooterText:function(){return this.m_footerText},GetOpenerWindow:function(){},GetPositiveButton:function(){return this.m_positiveButton},GetTitle:function(){return this.m_title},HandleOnload:function(){if(!D2L.Util.Url.IsExternal(this.m_src))if(this.m_iframeWindow){if(this.m_iframeWindow["UI"])this.m_iframeWindow["UI"].SetParentDialog(this);if(this.m_iframeWindow["d2l_Onload"])this.m_iframeWindow.d2l_Onload();if(!this.m_titleIsSet){var title=
this.m_iframeWindow.document.title;this.m_iframe.title=title;this.SetTitle(new D2L.LP.Text.PlainText(title))}this.AttachObject(this,"m_srcWindow",this.m_iframeWindow)}if(!this.m_isLoaded&&this.IsShown()){if(this.m_loading)this.m_loading.style.display="none";if(this.m_src.length>0)for(var i=0;i<this.m_buttons.length;i++)if(this.m_buttons[i].d)this.m_buttons[i].b.SetIsEnabled(true);this.m_isLoaded=true;this.SetHeight(this.m_height);if(this.m_iframe!=null)this.m_iframe.style.width="100%";this.OnOpen.Trigger()}if(this.m_focusAnchor2)this.m_focusAnchor2.focus()},
HasCloseIcon:function(hasCloseIcon){},Hide:function(){},IsClosed:function(){return!this.IsShown()},IsResizable:function(){},IsShown:function(){return this.m_isShown},Open:function(opener){if(opener!==undefined)this.SetOpener(opener)},RemoveButton:function(button){for(var i=0;i<this.m_buttons.length;i++)if(this.m_buttons[i].b==button){if(button.GetDomNode()&&button.IsRendered()){D2L.Util.Dom.Purge(button.GetDomNode());button.IDomNode.parentNode.removeChild(button.GetDomNode())}this.m_buttons.splice(i,
1)}},RemoveButtons:function(){for(var i=0;i<this.m_buttons.length;i++){var button=this.m_buttons[i].b;if(button.GetDomNode()&&button.IsRendered()){D2L.Util.Dom.Purge(button.GetDomNode());button.IDomNode.parentNode.removeChild(button.GetDomNode())}}this.m_buttons=[]},SetCallback:function(callback){this.m_callback=null;this.m_callbackArguments=[];if(callback&&callback.apply){this.m_callback=callback;for(var i=1;i<arguments.length;i++)this.m_callbackArguments.push(arguments[i])}},SetFooterText:function(footerText){},
SetHasCloseIcon:function(hasCloseIcon){},SetHeight:function(height){if(height===undefined||height===null)return;var windowHeight=this.GetViewportHeight();if(height.isString)if(height.charAt(height.length-1)=="%"){height=parseInt(height.substr(0,height.length-1),10)/100;if(height>1)height=1;else if(height<0)height=0;height=Math.round(height*windowHeight)}else if(height.substr(height.length-2,2)=="px")height=parseInt(height.substr(0,height.length-2));else height=parseInt(height);if(!this.IsShown()||
!this.IDomNode||!this.IChildrenDomNode){this.m_height=Math.max(this.m_minHeight,height);return}var topOffset=this.m_topOffset;var bottomOffset=this.m_bottomOffset;var headerFooterHeight=parseInt(this.IDomNode.offsetHeight,10)-parseInt(this.GetContentHeight(),10);this.IChildrenDomNode.style.overflow="auto";height=height-headerFooterHeight;if(height<1)height=1;if(!this.m_ignoreMaxMinSizeOnResize)if(height+headerFooterHeight<this.m_minHeight)height=this.m_minHeight-headerFooterHeight;if(!this.m_ignoreMaxMinSizeOnResize)if(height+
headerFooterHeight+topOffset+bottomOffset>windowHeight)height=windowHeight-headerFooterHeight-topOffset-bottomOffset;if(this.IChildrenDomNode!=null&&this.IChildrenDomNode.offsetHeight&&parseInt(this.GetContentHeight(),10)!=height)this.IChildrenDomNode.style.height=height+"px";if(this.m_iframe){this.IChildrenDomNode.childNodes[0].style.marginTop=Math.round((height-32)/2)+"px";if(this.m_isLoaded)this.m_iframe.style.height=height+"px"}height=height+headerFooterHeight;this.m_height=height},SetIcon:function(image){this.m_iconTerm=
image;if(this.m_iconTerm!==null&&this.IsRendered()){if(this.m_icon==null){var table=this.CreateElement("table");table.width="100%";table.height="100%";var r1=table.insertRow(-1);var c1=this.CreateCell(r1);c1.style.width="1%";c1.vAlign="top";this.m_icon=this.CreateElement("img");c1.appendChild(this.m_icon);var c2=this.CreateCell(r1);c2.vAlign="top";if(this.IChildrenDomNode&&this.IChildrenDomNode.parentNode){this.IChildrenDomNode.parentNode.insertBefore(table,this.IChildrenDomNode);c2.appendChild(this.IChildrenDomNode)}}this.m_iconTerm.Assign(this.m_icon);
this.m_icon.style.padding="7px";var paddingPosition=UI.GetCulture().GetMarginPaddingPosition(D2L.Culture.MarginPaddingPosition.Last);this.m_icon.style["padding"+paddingPosition]="0px"}},SetIsResizable:function(isResizable){},SetOpener:function(opener){this.m_opener=opener},SetSize:function(width,height){this.SetWidth(width,false);this.SetHeight(height,false);this.OnResize.Trigger(this.GetWidth(),this.GetContentHeight())},SetSrc:function(src,callbackName){if(callbackName===undefined)callbackName="";
if(src.indexOf("/d2l/")==-1&&!D2L.Util.Url.IsExternal(src)){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("'Src' of dialogs must be an "+"absolute path (e.g. /d2l/myProduct/myComponent/myPage.d2l), "+"not relative (e.g. myPage.d2l)"),true);var href=window.location.href;var start=href.indexOf("/d2l/");var end=href.lastIndexOf("/");var absolute=href.substring(start,end+1);src=absolute+src}this.m_src=src;this.m_srcCallbackName=callbackName;if(!D2L.Util.Url.IsExternal(this.m_src)){this.m_src+=
this.m_src.indexOf("?")<0?"?":"&";this.m_src+="d2l_body_type="+D2L.UI.BodyType.Dialog;if(this.m_src.indexOf("ou=")<0)this.m_src+="&ou="+Global.OrgUnitId}},SetSrcParam:function(name,value){this.m_srcParams[name]=value},SetTitle:function(title){this.m_titleIsSet=true},SetWidth:function(width){var windowWidth=this.GetOpenerWindow()["UI"].GetWindowWidth();if(width.isString)if(width.charAt(width.length-1)=="%"){width=parseInt(width.substr(0,width.length-1),10)/100;if(width>1)width=1;else if(width<0)width=
0;width=Math.round(width*windowWidth)}else if(width.substr(width.length-2,2)=="px")width=parseInt(width.substr(0,width.length-2));else width=parseInt(width);if(!this.m_ignoreMaxMinSizeOnResize)if(width>windowWidth)width=windowWidth-10;if(!this.m_ignoreMaxMinSizeOnResize)if(width<this.m_minWidth)width=this.m_minWidth;this.m_width=width;if(this.IDomNode)this.IDomNode.style.width=width+"px"},SubmitToIFrame:function(body){var me=this;if(me.m_iframe&&!me.m_isLoaded){for(var i=0;i<me.m_buttons.length;i++)if(me.m_buttons[i].b.IsEnabled()&&
me.m_buttons[i].t!=D2L.Control.Button.Type.Cancel&&me.m_buttons[i].t!=D2L.Control.Button.Type.Close){me.m_buttons[i].d=true;me.m_buttons[i].b.SetIsEnabled(false)}if(!D2L.Util.Url.IsExternal(me.m_src)){var f=me.CreateElement("form");f.method="post";f.target=me.m_iframe.name;f.action=me.m_src;for(var name in me.m_srcParams){var input=me.CreateElement("input");input.type="hidden";input.name=name;input.value=me.m_srcParams[name];f.appendChild(input)}var xsrfTokenInput=me.CreateElement("input");xsrfTokenInput.type=
"hidden";xsrfTokenInput.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();xsrfTokenInput.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();f.appendChild(xsrfTokenInput);body.appendChild(f);f.submit();D2L.Util.Dom.Purge(f);body.removeChild(f)}else me.m_iframe.src=me.m_src}}});
D2L.NonModalDialog=D2L.DialogBase.extend({Construct:function(name,callback){arguments.callee.$.Construct.call(this,name,callback);this.m_maxDialogHeight=Math.round(window.screen.availHeight*0.8);this.m_topOffset=10;this.m_bottomOffset=10;this.m_fitted=false;this.m_ignoreMaxMinSizeOnResize=true;this.m_ignoreResizeEvents=true;this.m_hasResizeEvents=true;this.m_isCloseFunctionCalled=false;this.m_popupWindow=null;this.m_resizeWindowOnSetSize=true;var win=window;while(win.parent!=win&&win.parent.UI){var frames=
win.parent.document.getElementsByTagName("frame");if(frames&&frames.length>0)if(win.parent["UI"].GetBodyType()!=D2L.UI.BodyType.Dialog)break;win=win.parent}this.m_openerWindow=win;this.SetWindow(null);window[this.m_name]=this;this.m_ignoreClose=false},BuildDom_Footer:function(){var me=this;this.m_resizeBar=this.CreateElement("div");this.m_resizeBar.className="ddial_f";this.m_resizeBar.style.display="none";this.m_resizeBar.style.marginLeft="-10px";this.m_resizeBar.style.marginRight="-10px";this.m_resizeBar.style.minHeight=
"1.2em";this.m_resizeBar.appendChild(this.CreateTextNode(this.m_footerText));D2L.Util.Aria.MakeLiveRegion(this.m_resizeBar);var me=this;this.GetFooterText().GetText().Register(function(txt){me.m_resizeBar.style.display=txt.length>0?"block":"none";me.SetHeight(me.m_height)})},BuildDom:function(){if(!this.m_hasDomBeenBuilt){arguments.callee.$.BuildDom.call(this);this.IDomNode=this.CreateElement("div");var inner=this.CreateElement("div");this.BuildDom_Buttons();this.BuildDom_Footer();this.IChildrenDomNode=
this.CreateElement("div");this.IChildrenDomNode.className="ddial_c";if(this.m_src.length>0)this.BuildDom_Frame();else{this.IChildrenDomNode.style.overflowY="auto";this.IChildrenDomNode.style.padding="10px"}inner.appendChild(this.IChildrenDomNode);inner.appendChild(this.m_buttonTable);this.IDomNode.appendChild(inner);this.IDomNode.appendChild(this.m_resizeBar);this.SetIcon(this.m_iconTerm);this.InstallEvents()}},Close:function(doClose){if(this.m_ignoreClose||this.m_isCloseFunctionCalled)return;if(doClose===
undefined)doClose=true;var me=this;var iframeObj=this.m_iframe;this.ResetState();this.m_isCloseFunctionCalled=true;setTimeout(function(){var ClosePopupWindow=function(){if(doClose&&me.m_popupWindow&&!me.m_popupWindow.closed)me.m_popupWindow.close();me.m_popupWindow=null;me.SetWindow(null)};try{if(iframeObj&&me.m_iframeOnloadFunc&&iframeObj.detachEvent){iframeObj.detachEvent("onload",me.m_iframeOnloadFunc);iframeObj.attachEvent("onload",ClosePopupWindow);iframeObj.src="/d2l/tools/blank.html";setTimeout(function(){try{iframeObj.detachEvent("onload",
ClosePopupWindow);iframeObj.parentNode.removeChild(iframeObj);iframeObj=null}catch(e){}},1E3)}else ClosePopupWindow()}catch(e){}},0)},Dispose:function(){if(this.m_popupWindow&&!this.m_popupWindow.closed)this.m_popupWindow.close();this.ResetState();this.m_srcWindow=null;window[this.m_name]=null;this.m_popupWindow=null;arguments.callee.$.Dispose.call(this)},GetOpenerWindow:function(){return this.m_openerWindow},GetViewportHeight:function(){return screen.availHeight},HandlePopupOnLoad:function(){if(this.m_popupWindow===
null)return;var me=this;var win=this.m_popupWindow;this.SetWindow(win);this.m_delayedReturn=new D2L.Util.DelayedReturn;var onFirstLoad=function(){me.m_firstLoadEvent.RemoveListener(onFirstLoad);me.SubmitToIFrame(body);me.m_isShown=true;if(me.m_titleIsSet)me.SetTitle(me.m_title);me.SetSize(me.m_width,me.m_height);setTimeout(function(){me.SetSize(me.m_width,me.m_height);me.m_ignoreResizeEvents=false},0);if(!me.m_iframe)me.OnOpen.Trigger();else setTimeout(function(){if(me.IsShown()&&!me.m_isLoaded)me.HandleOnload()},
2E4)};this.m_firstLoadEvent.AddListener(onFirstLoad);this.BuildDom();var body=this.m_popupWindow["UI"].GetById("d2l_body");var form=this.m_popupWindow["UI"].GetById("d2l_form");body.style.margin=0;this.AppendTo(form);return this.m_delayedReturn},HandlePopupOnUnload:function(){var win=this.m_popupWindow;if(win&&win.location.href.indexOf("blank.d2l")>=0){if(!this.m_isCloseFunctionCalled){this.m_ignoreClose=true;D2L.Dialog.BC(this.m_name,this.m_closeIconResponseType);this.m_ignoreClose=false}this.Close(false)}},
ResetState:function(){this.m_buttonTable=null;this.m_iframe=null;this.m_iframeWindow=null;this.m_srcWindow=null;this.IDomNode=null;this.IChildrenDomNode=null;this.m_resizeBar=null;this.m_hasDomBeenBuilt=false;for(var i=0;i<this.m_buttons.length;i++)this.m_buttons[i].b.m_hasDomBeenBuilt=false;this.m_isLoaded=false;this.m_isCloseFunctionCalled=false;this.m_isShown=false},HasCloseIcon:function(hasCloseIcon){return true},InstallEvents:function(){var me=this;var handleResizeEvent=function(){try{if(!me.m_ignoreResizeEvents&&
!me.m_popupWindow.closed&&me.m_popupWindow["UI"]&&me.m_hasResizeEvents){var newWidth=me.m_popupWindow["UI"].GetWindowWidth();var newHeight=me.m_popupWindow["UI"].GetWindowHeight();me.m_resizeWindowOnSetSize=false;me.SetSize(newWidth,newHeight);me.m_resizeWindowOnSetSize=true}}catch(e){}};var onResizeTimer=function(){if(me.resizeTimer)clearTimeout(me.resizeTimer);me.resizeTimer=setTimeout(handleResizeEvent,100)};if(this.GetWindow().document.addEventListener)this.GetWindow().addEventListener("resize",
onResizeTimer,false);else if(this.GetWindow().document.attachEvent)this.GetWindow().attachEvent("onresize",onResizeTimer)},Open:function(opener){arguments.callee.$.Open.call(this,opener);if(this.m_popupWindow!=null&&!this.m_popupWindow.closed){this.m_popupWindow.focus();return}var winHeight=this.GetHeight();var winWidth=this.GetWidth();if(winHeight==null)winHeight=this.m_minHeight;var openerWin=this.GetOpenerWindow();var sx=null;if(openerWin.screenX)sx=openerWin.screenX;else if(openerWin.screenLeft)sx=
openerWin.screenLeft;var sy=null;if(openerWin.screenY)sy=openerWin.screenY+80;else if(openerWin.screenTop)sy=openerWin.screenTop;var left=(openerWin["UI"].GetWindowWidth()-winWidth)/2+sx;var top=(openerWin["UI"].GetWindowHeight()-winHeight)/2+sy;var winFeatures="top="+top+", left="+left+", height="+winHeight+", width="+winWidth+", directories=no, toolbar=no, status=no, resizable=yes, location=no, scrollbars=no";var winQueryString="?d2l_body_type="+D2L.UI.BodyType.Frame+"&d2l_nonModalDialog_cb="+this.m_name+
"&d2l_nonModalDialog_cbwin="+UI.windowId;this.m_popupWindow=window.open("/d2l/common/dialogs/nonModal/blank.d2l"+winQueryString,"_blank",winFeatures);var me=this;if(this.m_popupWindow)setTimeout(function(){me.m_popupWindow.focus()})},SetFooterText:function(footerText){this.m_footerText=D2L.LP.Text.IText.Normalize(footerText,"D2L.NonModalDialog","SetFooterText","footerText");if(this.m_resizeBar&&this.IsShown()){if(this.m_resizeBar.firstChild){D2L.Util.Dom.Purge(this.m_resizeBar.firstChild);this.m_resizeBar.removeChild(this.m_resizeBar.firstChild)}this.m_resizeBar.appendChild(this.CreateTextNode(this.m_footerText));
var me=this;this.m_footerText.GetText().Register(function(txt){me.m_resizeBar.style.display=txt.length>0?"block":"none";me.SetHeight(me.m_height)})}},SetHeight:function(height){this.m_ignoreResizeEvents=true;if(height!==undefined&&height!==null)if(height.isString)if(height.length>1&&height.substr(height.length-2,2)=="px")height=parseInt(height.substr(0,height.length-2));arguments.callee.$.SetHeight.call(this,height-10);var newHeight=this.GetHeight();if(this.IsShown()&&this.m_resizeWindowOnSetSize)try{var heightDiff=
newHeight-this.GetWindow()["UI"].GetWindowHeight()+this.m_topOffset+this.m_bottomOffset+10;if(heightDiff>0)this.GetWindow().resizeBy(0,heightDiff)}catch(ex){}this.m_ignoreResizeEvents=false},SetTitle:function(title){arguments.callee.$.SetTitle.call(this,title);this.m_title=D2L.LP.Text.IText.Normalize(title,"D2L.NonModalDialog","SetTitle","title");var me=this;if(this.IsShown())this.m_title.GetText().Register(function(val){if(me.IsShown())me.GetWindow().document.title=val})},SetWidth:function(width){this.m_ignoreResizeEvents=
true;arguments.callee.$.SetWidth.call(this,width);var newWidth=this.GetWidth();if(this.IsShown()){this.IDomNode.style.width="100%";if(this.m_resizeWindowOnSetSize)try{var widthDiff=newWidth-this.GetWindow()["UI"].GetWindowWidth();this.GetWindow().resizeBy(widthDiff,0)}catch(ex){}}this.m_ignoreResizeEvents=false},AddButtonHelper:function(text,position,type,responseType,responseParam,id,isPrimary){var button=arguments.callee.$.AddButtonHelper.call(this,text,position,type,responseType,responseParam,
id,isPrimary);if(this.m_hasDomBeenBuilt)if(this.m_buttons.length==1){var me=this;setTimeout(function(){me.SetHeight(me.m_height)})}return button}});
D2L.ModalDialog=D2L.DialogBase.extend({Construct:function(name,callback){arguments.callee.$.Construct.call(this,name,callback);this.m_topOffset=70;this.m_bottomOffset=20;this.m_hasCloseIcon=true;this.m_left=0;this.m_titleNode=null;this.m_top=0;this.m_shimHandle=null;var win=window;var lastGoodWindow=win;while(true){if(win.UI&&win.UI.isMvc!==true){var frames=win.document.getElementsByTagName("frame");if(frames.length==0&&win["UI"].GetBodyType()==D2L.UI.BodyType.Normal)lastGoodWindow=win}if(win.document.body&&
D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-body",win.document.body)){win.UI=window.UI;win["UI"].isMvc=true;lastGoodWindow=win}if(win.parent==win)break;win=win.parent}win=lastGoodWindow;this.SetWindow(win);this.m_maxDialogHeight=UI.GetWindowHeight(win);window[this.m_name]=this},Dispose:function(){this.Close();window[this.m_name]=null;arguments.callee.$.Dispose.call(this)},BuildDom:function(){if(this.m_hasDomBeenBuilt)return;arguments.callee.$.BuildDom.call(this);this.IDomNode=this.CreateElement("div");
this.IDomNode.className="ddial_o";this.IDomNode.style.zIndex=this.GetWindow()["UI"].GetZIndex();var outer2=this.CreateElement("div");outer2.className="ddial_o2";var inner=this.CreateElement("div");inner.className="ddial_i";var titleBar=this.BuildDom_TitleBar();this.BuildDom_Buttons();var resizeBar=this.BuildDom_Footer();this.IChildrenDomNode=this.CreateElement("div");this.IChildrenDomNode.className="ddial_c";if(this.m_src.length>0)this.BuildDom_Frame();else{this.IChildrenDomNode.style.overflow="auto";
this.IChildrenDomNode.style.margin="10px"}var replace="";if(this.GetTitle())replace=this.GetTitle();var topAnchorTitle=new D2L.LP.Text.LangTerm("Framework.Dialog.altJumpBottom",replace);var bottomAnchorTitle=new D2L.LP.Text.LangTerm("Framework.Dialog.altJumpTop",replace);this.m_focusAnchor1=this.CreateElement("a");this.m_focusAnchor1.href="javascript://";this.m_focusAnchor1.appendChild(this.CreateTextNode(topAnchorTitle));this.m_focusAnchor1.className="d2l-offscreen";this.m_focusAnchor1.style.outline=
"none";inner.appendChild(this.m_focusAnchor1);inner.appendChild(titleBar);inner.appendChild(this.IChildrenDomNode);inner.appendChild(this.m_buttonTable);this.m_focusAnchor3=this.CreateElement("a");this.m_focusAnchor3.tabIndex=-1;this.m_focusAnchor3.appendChild(this.CreateTextNode(" "));this.m_focusAnchor3.title=" ";this.m_focusAnchor3.style.outline="none";inner.appendChild(this.m_focusAnchor3);this.m_focusAnchor4=this.CreateElement("a");this.m_focusAnchor4.href="javascript://";this.m_focusAnchor4.appendChild(this.CreateTextNode(bottomAnchorTitle));
this.m_focusAnchor4.className="d2l-offscreen";this.m_focusAnchor4.style.outline="none";inner.appendChild(this.m_focusAnchor4);outer2.appendChild(inner);outer2.appendChild(resizeBar);this.IDomNode.appendChild(outer2);this.SetIcon(this.m_iconTerm);this.InstallEvents()},BuildDom_TitleBar:function(){var titleBar=this.CreateElement("div");titleBar.className="ddial_t";var table=this.CreateElement("table");table.width="100%";var row=table.insertRow(-1);var c0=this.CreateCell(row);c0.appendChild(this.CreateTextNode(""));
var c1=this.CreateCell(row);c1.className="ddial_h";this.m_focusAnchor2=this.CreateElement("a");this.m_focusAnchor2.tabIndex=-1;this.m_focusAnchor2.style.outline="none";this.m_titleNode=this.CreateElement("h1");this.m_titleNode.appendChild(this.CreateTextNode(this.m_title));this.m_focusAnchor2.appendChild(this.m_titleNode);c1.appendChild(this.m_focusAnchor2);var c2=this.CreateCell(row);c2.className="ddial_close";this.m_closeAnchor=this.CreateElement("a");this.m_closeAnchor.href="javascript://";this.m_closeAnchor.style.display=
this.HasCloseIcon()?"block":"none";D2L.LP.Text.LangTerm.AssignText("Framework.Dialog.altCloseDialog",this.m_closeAnchor,"title");var closeImg=this.CreateElement("span");var closeText=this.CreateElement("span");closeText.className="d2l-offscreen";closeText.appendChild(this.CreateTextNode(new D2L.LP.Text.LangTerm("Framework.Dialog.altCloseDialog")));closeImg.appendChild(closeText);this.m_closeAnchor.appendChild(closeImg);c2.appendChild(this.m_closeAnchor);titleBar.appendChild(table);D2L.Control.Behaviour.Drag.InstallMvc(this.IDomNode,
this.GetWindow(),this.GetWindow(),titleBar,closeImg);return titleBar},BuildDom_Footer:function(){var me=this;var resizeBar=this.GetUI().CreateElement("div");resizeBar.className="ddial_f";this.m_footerTextNode=this.GetUI().CreateElement("span");this.m_footerTextNode.appendChild(this.CreateTextNode(this.m_footerText));resizeBar.appendChild(this.m_footerTextNode);D2L.Util.Aria.MakeLiveRegion(this.m_footerTextNode);var resizeImg=this.GetUI().CreateElement("div");resizeImg.className="ddial_fr";D2L.LP.Text.LangTerm.AssignText("Framework.Dialog.altResizeDialog",
resizeImg,"title");resizeBar.appendChild(resizeImg);D2L.Control.Behaviour.Resize.InstallMvc(this,this.IDomNode,resizeImg,this.GetWindow(),this.GetWindow());var clear=new D2L.Control.ClearFloat;clear.AppendTo(resizeBar);return resizeBar},InstallEvents:function(){var me=this;if(this.m_closeAnchor)this.AttachObject(this.m_closeAnchor,"onclick",function(){me.Close(new D2L.Dialog.Response(me.m_closeIconResponseType));D2L.Dialog.BC(me.m_name,me.m_closeIconResponseType)});if(this.m_focusAnchor1&&this.m_focusAnchor2&&
this.m_focusAnchor3&&this.m_focusAnchor4){this.AttachObject(this.m_focusAnchor1,"onfocus",function(){setTimeout(function(){me.m_focusAnchor3.focus()})});this.AttachObject(this.m_focusAnchor1,"onclick",function(){setTimeout(function(){me.m_focusAnchor3.focus()})});this.AttachObject(this.m_focusAnchor4,"onfocus",function(){setTimeout(function(){me.m_focusAnchor2.focus()})});this.AttachObject(this.m_focusAnchor4,"onclick",function(){setTimeout(function(){me.m_focusAnchor2.focus()})})}},Close:function(){if(this.IsClosed())return;
this.Hide();var me=this;var placeFocus=function(){if(me.m_opener!==undefined&&me.m_opener!==null){try{if(me.m_opener.Focus!==undefined)me.m_opener.Focus();else if(me.m_opener.focus!==undefined)me.m_opener.focus()}catch(e){}me.m_opener=undefined}};if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)try{var IEinput=this.CreateElement("input");var body=UI.GetById("d2l_body");IEinput.style.position="absolute";IEinput.style.height="0px";IEinput.style.width="0px";IEinput.style.top=this.GetWindow()["UI"].GetScrollTop()+
"px";IEinput.style.left=this.GetWindow()["UI"].GetScrollLeft()+"px";body.appendChild(IEinput);var focusAndRemove=function(){IEinput.focus();D2L.Util.Dom.Purge(IEinput);body.removeChild(IEinput)};setTimeout(function(){try{focusAndRemove()}catch(e){}});IEinput.focus()}catch(e){}var remove=function(){if(me.m_iframe)me.m_isLoaded=false;D2L.Util.Dom.Purge(me.GetDomNode());me.Remove();me.m_hasDomBeenBuilt=false;setTimeout(placeFocus,100)};setTimeout(remove,0)},GetOpenerWindow:function(){return this.GetWindow()},
GetPosX:function(){if(this.IDomNode)return D2L.Util.Dom.FindPosX(this.IDomNode);else return 0},GetViewportHeight:function(){return UI.GetWindowHeight(window.top)},GetPosY:function(){if(this.IDomNode)return D2L.Util.Dom.FindPosY(this.IDomNode);else return 0},HasCloseIcon:function(){return this.m_hasCloseIcon},Hide:function(){this.GetDomNode().style.left="-2000px";this.GetDomNode().style.top="-2000px";this.m_isShown=false;D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(this.m_shimHandle);this.m_shimHandle=
null},IsResizable:function(){return true},SetHasCloseIcon:function(hasCloseIcon){this.m_hasCloseIcon=hasCloseIcon;if(this.m_closeImg)this.m_closeImg.style.display=hasCloseIcon?"block":"none"},SetIsResizable:function(isResizable){},SetPos:function(x,y){this.SetPosX(x);this.SetPosY(y)},SetPosX:function(x){if(this.IDomNode)this.IDomNode.style.left=x+"px";this.m_left=x},SetPosY:function(y){if(this.IDomNode)this.IDomNode.style.top=y+"px";this.m_top=y},SetFooterText:function(footerText){this.m_footerText=
D2L.LP.Text.IText.Normalize(footerText,"D2L.ModalDialog","SetFooterText");if(this.m_footerTextNode){if(this.m_footerTextNode.firstChild){D2L.Util.Dom.Purge(this.m_footerTextNode.firstChild);this.m_footerTextNode.removeChild(this.m_footerTextNode.firstChild)}this.m_footerTextNode.appendChild(this.CreateTextNode(this.m_footerText));var me=this;this.m_footerText.GetText().Register(function(txt){me.SetHeight(me.m_height)})}},SetTitle:function(title){arguments.callee.$.SetTitle.call(this,title);this.m_title=
D2L.LP.Text.IText.Normalize(title,"D2L.ModalDialog","SetTitle","title");if(this.m_titleNode){if(this.m_titleNode.firstChild){D2L.Util.Dom.Purge(this.m_titleNode.firstChild);this.m_titleNode.removeChild(this.m_titleNode.firstChild)}this.m_titleNode.appendChild(this.CreateTextNode(this.m_title))}},Show:function(){this.m_isShown=true;var win=this.GetWindow().top;var ui=this.GetWindow()["UI"];this.SetSize(this.m_width,this.m_height);var left=ui.GetScrollLeft(win)+(ui.GetWindowWidth(win)-this.IDomNode.offsetWidth)/
2;var top=ui.GetScrollTop(win)+this.m_topOffset;this.SetPos(left,top);this.m_shimHandle=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(this.IDomNode);this.IDomNode.style.zIndex=ui.GetZIndex(win)},Open:function(opener){var me=this;arguments.callee.$.Open.call(this,opener);this.m_delayedReturn=new D2L.Util.DelayedReturn;var onFirstLoad=function(){me.m_firstLoadEvent.RemoveListener(onFirstLoad);me.SubmitToIFrame(body);me.Show();if(!me.m_iframe){if(me.m_focusAnchor2)me.m_focusAnchor2.focus();me.OnOpen.Trigger()}else setTimeout(function(){if(me.IsShown()&&
!me.m_isLoaded)me.HandleOnload()},2E4)};this.m_firstLoadEvent.AddListener(onFirstLoad);this.BuildDom();var body=this.GetWindow().document.body;this.AppendTo(body);return this.m_delayedReturn}});D2L.Dialog=D2L.ModalDialog;if(Global.Preferences.UseNonModalDialogs)D2L.Dialog=D2L.NonModalDialog;
D2L.Dialog.BC=function(dialogName,responseType,buttonType,param){var dialog=UI.GetByName(dialogName);var r=new D2L.Dialog.Response(dialog,responseType,param);if(dialog.m_srcWindow&&!dialog.m_srcWindow.closed&&dialog.m_srcCallbackName.length>0&&dialog.m_srcWindow[dialog.m_srcCallbackName])dialog.m_srcWindow[dialog.m_srcCallbackName](r);else dialog.CallCallback(r)};D2L.Dialog.GetParent=function(){return UI.GetParentDialog()};D2L.Dialog.GetParentDialog=function(){return UI.GetParentDialogDelayed()};
D2L.Dialog.Prompt=D2L.Dialog.extend({Construct:function(name,callback,primaryMessage,secondaryMessage,autoClose){arguments.callee.$.Construct.call(this,name,callback);if(autoClose===undefined)autoClose=true;if(autoClose){var me=this;this.OnOpen.RegisterMethod(function(){me.m_delayedReturn.Register(function(){me.Close()})})}this.m_primaryMessage=null;this.m_primaryMessageNode=null;this.m_primaryMessageSpan=null;this.m_secondaryMessage=null;this.m_secondaryMessageNode=null;this.m_secondaryMessageSpan=
null;this.m_closeOnEnter=true;this.SetPrimaryMessage(primaryMessage);this.SetSecondaryMessage(secondaryMessage);this.SetHasCloseIcon(false)},BuildDom:function(){if(!this.m_hasDomBeenBuilt){arguments.callee.$.BuildDom.call(this);var c2=this.CreateElement("div");this.m_primaryMessageSpan=this.CreateElement("p");this.m_primaryMessageSpan.style.marginTop="0";this.m_primaryMessageSpan.style.fontWeight="bold";this.SetPrimaryMessage(this.m_primaryMessage);c2.appendChild(this.m_primaryMessageSpan);this.m_secondaryMessageSpan=
this.CreateElement("p");this.m_secondaryMessageSpan.style.marginBottom="0";this.SetSecondaryMessage(this.m_secondaryMessage);c2.appendChild(this.m_secondaryMessageSpan);this.AppendChild(c2);var me=this;setTimeout(function(){me.m_firstLoadEvent.Trigger()},0)}},InstallEvents:function(){arguments.callee.$.InstallEvents.call(this);if(this.m_focusAnchor2&&this.m_positiveButton&&this.m_closeOnEnter){var me=this;var handleKey=0;this.AttachObject(this.m_focusAnchor2,"onfocus",function(){if(handleKey==0)handleKey=
1});this.AttachObject(this.m_focusAnchor2,"onblur",function(){handleKey=2});UI.GetWindowEventManager().InstallKpel(this.m_focusAnchor2,function(obj,keyPressEvent){if(me.IsShown()&&me.m_closeOnEnter&&handleKey==1&&(keyPressEvent.GetKey()==D2L.KeyPressEvent.Key.Enter||keyPressEvent.GetCharacter()==" "))me.m_positiveButton.Click()})}},SetCloseOnEnter:function(closeOnEnter){this.m_closeOnEnter=closeOnEnter},SetSrc:function(src,callbackName){arguments.callee.$.SetSrc.call(this,src,callbackName);if(D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled())alert("You can not set the source of a Prompt Dialog")},
SetPositiveButtonText:function(text){if(!this.m_positiveButton)this.m_positiveButton=this.AddCustomButton(text,D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Positive,undefined,undefined,true);this.m_positiveButton.SetText(text)},SetPrimaryMessage:function(primaryMessage){this.m_primaryMessage=D2L.LP.Text.IText.Normalize(primaryMessage,"D2L.Dialog.Prompt","SetPrimaryMessage","primaryMessage");if(this.m_primaryMessageSpan){D2L.Util.Dom.Purge(this.m_primaryMessageSpan);this.m_primaryMessage.AssignHtml(this.m_primaryMessageSpan,
"innerHTML");var me=this;this.m_primaryMessage.GetHtml().Register(function(val){me.m_primaryMessageSpan.style.display=val.length>0?"block":"none"})}},SetSecondaryMessage:function(secondaryMessage){this.m_secondaryMessage=D2L.LP.Text.IText.Normalize(secondaryMessage,"D2L.Dialog.Prompt","SetSecondaryMessage","secondaryMessage");if(this.m_secondaryMessageSpan){D2L.Util.Dom.Purge(this.m_secondaryMessageSpan);this.m_secondaryMessage.AssignHtml(this.m_secondaryMessageSpan,"innerHTML");var me=this;this.m_secondaryMessage.GetHtml().Register(function(val){me.m_secondaryMessageSpan.style.display=
val.length>0?"block":"none"})}}});
D2L.Dialog.AudioCapture=D2L.Dialog.extend({Construct:function(src,callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.AddPrimaryButton(D2L.Control.Button.Type.Add,"add","BTN_addAudioCapture");this.AddButton(D2L.Control.Button.Type.Cancel);this.SetSrc("/d2l/common/dialogs/audiocapture/main.d2l","DialogCallback");this.SetSize(600,400);var me=this;this.OnOpen.RegisterMethod(function(){me.SetAddButtonIsEnabled(false)})},Close:function(){this.SetFooterText(new D2L.LP.Text.PlainText(""));arguments.callee.$.Close.call(this)},
Open:function(opener){return arguments.callee.$.Open.call(this,opener)},SetAddButtonIsEnabled:function(isEnabled){var button=this.GetButton("BTN_addAudioCapture");if(button)button.SetIsEnabled(isEnabled)}});
D2L.Dialog.Confirm=D2L.Dialog.Prompt.extend({Construct:function(name,callback,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,callback,primaryMessage,secondaryMessage);this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnYes"));this.m_closeIconResponseType=D2L.Dialog.ResponseType.Negative;this.m_negativeButton=this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnNo"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Negative);this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/confirm.gif",
48,48));this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titConfirmation"))},SetNegativeButtonText:function(text){this.m_negativeButton.SetText(text)}});D2L.Dialog.ButtonType=D2L.Control.Button.Type;D2L.Dialog.ButtonPosition={Left:0,Middle:1,Right:2};D2L.Dialog.ResponseType={Abort:0,Positive:1,Negative:2};
D2L.Dialog.EquationEditor=D2L.Dialog.extend({Construct:function(callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.SetSize("690","455");this.SetSrc("/d2l/common/dialogs/equation/equationEditor.d2l","GetMath");this.AddPrimaryButton(D2L.Control.Button.Type.Insert);this.AddSecondaryButton(D2L.Control.Button.Type.Cancel)}});
D2L.Dialog.Error=D2L.Dialog.Prompt.extend({Construct:function(name,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,undefined,primaryMessage,secondaryMessage);this.m_closeIconResponseType=D2L.Dialog.ResponseType.Positive;this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk"));this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/error.gif",48,48));this.SetHasCloseIcon(false);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titError"))}});
D2L.Dialog.Prompt.ImageTextAlternative=D2L.Dialog.Prompt.extend({Construct:function(callback){var me=this;var ourCallback=function(response){if(me.m_input.value==""&&!me.m_decorativeInput.checked&&response.GetType()!=D2L.Dialog.ResponseType.Abort)me.GetWindow().UI.Error(new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.errPrimarySpecifyTextAlternative"),new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.errSecondarySpecifyTextAlternative"));else{me.SetCallback(callback);me.CallCallback(response)}};arguments.callee.$.Construct.call(this,
UI.GetUniqueHtmlId(),ourCallback,new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.hdrTextAlternative"),new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.lblTextAlternativeDescription"),false);this.m_input=null;this.m_decorativeInput=null;this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk"));this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/info.gif",48,48));this.SetHasCloseIcon(false);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.titProvideTextAlternative"));
this.SetWidth(450);this.m_hasResizeEvents=false},BuildDom:function(){arguments.callee.$.BuildDom.call(this);var forId=this.GetWindow().UI.GetUniqueHtmlId();var label=this.CreateElement("label");label.htmlFor=forId;label.appendChild(this.CreateTextNode(new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.lblTextAlternative")));label.appendChild(this.CreateTextNode(" "));this.m_input=this.CreateElement("input");this.m_input.type="text";this.m_input.id=forId;this.m_input.className="d_edt";this.m_input.maxLength=
200;this.m_input.style.width="50%";var decorativeForId=this.GetWindow().UI.GetUniqueHtmlId();var decorativeLabel=this.CreateElement("label");decorativeLabel.htmlFor=decorativeForId;decorativeLabel.appendChild(this.CreateTextNode(new D2L.LP.Text.LangTerm("Framework.HtmlEditor2.lblImageDecorative")));this.m_decorativeInput=this.CreateElement("input");this.m_decorativeInput.type="checkbox";this.m_decorativeInput.id=decorativeForId;this.m_decorativeInput.className="d_chb";var me=this;var decorativeInputOnClick=
function(){if(me.m_decorativeInput.checked){me.m_input.disabled=true;me.m_input.className="d_edt"}else{me.m_input.disabled=false;me.m_input.className="d_edt"}return true};this.AttachObject(this.m_decorativeInput,"onclick",decorativeInputOnClick);this.AppendChild(this.CreateElement("br"));this.AppendChild(label);this.AppendChild(this.m_input);this.AppendChild(this.CreateElement("br"));this.AppendChild(this.m_decorativeInput);this.AppendChild(this.CreateTextNode("&nbsp;"));this.AppendChild(decorativeLabel);
setTimeout(function(){me.m_firstLoadEvent.Trigger()},0)},GetTextAlternative:function(){if(this.m_input)return this.m_input.value;else return""},IsDecorative:function(){if(this.m_decorativeInput)return this.m_decorativeInput.checked;else return false}});
D2L.Dialog.Info=D2L.Dialog.Prompt.extend({Construct:function(name,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,undefined,primaryMessage,secondaryMessage);this.m_closeIconResponseType=D2L.Dialog.ResponseType.Positive;this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk"));this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/info.gif",48,48));this.SetHasCloseIcon(false);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titInformation"))}});
D2L.Dialog.Prompt.Input=D2L.Dialog.Prompt.extend({Construct:function(callback,primaryMessage,secondaryMessage,fieldName){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback,primaryMessage,secondaryMessage);this.m_fieldName=fieldName;this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk"));this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnCancel"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Abort);this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/info.gif",
48,48));this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titInputRequested"))},BuildDom:function(){arguments.callee.$.BuildDom.call(this);var forId=this.GetWindow().UI.GetUniqueHtmlId();var table=this.CreateElement("table");table.align="center";var tr=table.insertRow(-1);var td=tr.insertCell(-1);td.style.padding="3px";var label=this.CreateElement("label");label.htmlFor=forId;label.appendChild(this.CreateTextNode(this.m_fieldName));label.appendChild(this.CreateTextNode(":"));td.appendChild(label);
td=tr.insertCell(-1);td.style.padding="3px";this.m_input=this.CreateElement("input");this.m_input.type="text";this.m_input.id=forId;this.m_input.className="d_edt";td.appendChild(this.m_input);this.AppendChild(table);var me=this;setTimeout(function(){me.m_firstLoadEvent.Trigger()},0)},GetInputValue:function(){if(this.m_input)return this.m_input.value;else return""}});D2L.Dialog.Native={};
D2L.Dialog.Native.Prompt=D2L.DialogBase.extend({Construct:function(name,callback,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,callback);var win=window;while(win.parent!=win&&win.parent.UI){var frames=win.parent.document.getElementsByTagName("frame");if(frames&&frames.length>0)break;win=win.parent}this.m_openerWindow=win;this.m_primaryMessage=null;this.m_secondaryMessage=null;this.SetPrimaryMessage(primaryMessage);this.SetSecondaryMessage(secondaryMessage);window[this.m_name]=
this},AddButton:function(type,responseParam,name){return null},AddCustomButton:function(text,position,responseType,responseParam,id){return null},CallCallback:function(response){if(this.IsClosed()&&response!=null&&response.GetType()!=D2L.Dialog.ResponseType.Abort)UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Calling CallCallback on a closed "+"dialog can cause unexpected errors in IE. Please make sure "+"you are closing the dialog inside your outer callback "+"function instead of SrcCallback."),
true);var cb=this.GetCallback();var ret=response;if(cb){var cbRet=cb.apply(cb,[response].concat(this.m_callbackArguments));if(cbRet!==undefined)ret=cbRet}if(this.m_delayedReturn)this.m_delayedReturn.Trigger(ret)},Close:function(){},GetButton:function(id){var b=new D2L.Control.Button(new D2L.LP.Text.PlainText(" "));return b},GetCallback:function(){return this.m_callback},GetContentHeight:function(){return 0},GetHeight:function(){return 0},GetWidth:function(){return 0},GetFooterText:function(){var f=
new D2L.LP.Text.PlainText("");return f},GetOpenerWindow:function(){return this.m_openerWindow},GetPositiveButton:function(){var b=new D2L.Control.Button(new D2L.LP.Text.PlainText(" "));return b},GetTitle:function(){var t=new D2L.LP.Text.PlainText("");return t},HasCloseIcon:function(hasCloseIcon){return true},Hide:function(){},IsClosed:function(){return!this.IsShown()},IsResizable:function(){return false},IsShown:function(){return this.m_isShown},Open:function(){},RemoveButton:function(button){},SetCallback:function(callback){this.m_callback=
null;this.m_callbackArguments=[];if(callback&&callback.apply){this.m_callback=callback;for(var i=1;i<arguments.length;i++)this.m_callbackArguments.push(arguments[i])}},SetCloseOnEnter:function(closeOnEnter){},SetFooterText:function(footerText){},SetHasCloseIcon:function(hasCloseIcon){},SetHeight:function(height){},SetIcon:function(imageTerm){},SetIsResizable:function(isResizable){},SetPositiveButtonText:function(text){},SetPrimaryMessage:function(primaryMessage){this.m_primaryMessage=D2L.LP.Text.IText.Normalize(primaryMessage,
"D2L.Dialog.Native.Prompt","SetPrimaryMessage","primaryMessage")},SetSecondaryMessage:function(secondaryMessage){this.m_secondaryMessage=D2L.LP.Text.IText.Normalize(secondaryMessage,"D2L.Dialog.Native.Prompt","SetSecondaryMessage","secondaryMessage")},SetSize:function(width,height){},SetSrc:function(src,callbackName){if(D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled())alert("You can not set the source of a Prompt Dialog")},SetSrcParam:function(name,value){},SetTitle:function(title){},SetWidth:function(width){}});
D2L.Dialog.Native.Alert=D2L.Dialog.Native.Prompt.extend({Construct:function(name,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,undefined,primaryMessage,secondaryMessage);this.m_closeIconResponseType=D2L.Dialog.ResponseType.Positive},Open:function(){var me=this;this.m_isShown=true;this.m_primaryMessage.GetHtml().Register(function(primaryMessage){me.m_secondaryMessage.GetHtml().Register(function(secondaryMessage){var win=me.GetOpenerWindow();if(win){win.alert(primaryMessage+
"\n\n"+secondaryMessage);var response=new D2L.Dialog.Response(me,D2L.Dialog.ResponseType.Positive);me.CallCallback(response)}me.m_isShown=false})})}});D2L.Dialog.Native.Error=D2L.Dialog.Native.Alert;D2L.Dialog.Native.Info=D2L.Dialog.Native.Alert;D2L.Dialog.Native.Warning=D2L.Dialog.Native.Alert;
D2L.Dialog.Native.Confirm=D2L.Dialog.Native.Prompt.extend({Construct:function(name,callback,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,callback,primaryMessage,secondaryMessage);this.m_closeIconResponseType=D2L.Dialog.ResponseType.Negative},Open:function(){var me=this;this.m_isShown=true;this.m_primaryMessage.GetHtml().Register(function(primaryMessage){me.m_secondaryMessage.GetHtml().Register(function(secondaryMessage){var win=me.GetOpenerWindow();if(win){var response=
null;var ret=win.confirm(primaryMessage+"\n\n"+secondaryMessage);if(ret)response=new D2L.Dialog.Response(me,D2L.Dialog.ResponseType.Positive);else response=new D2L.Dialog.Response(me,D2L.Dialog.ResponseType.Negative);me.CallCallback(response)}me.m_isShown=false})})},SetNegativeButtonText:function(text){}});if(Global.Preferences.UseNonModalDialogs){D2L.Dialog.Error=D2L.Dialog.Native.Error;D2L.Dialog.Info=D2L.Dialog.Native.Info;D2L.Dialog.Warning=D2L.Dialog.Native.Warning;D2L.Dialog.Confirm=D2L.Dialog.Native.Confirm}
D2L.Dialog.OrgUnitSelector=D2L.Dialog.extend({Construct:function(callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.OrgUnitSelector.btnAddOrgUnits"));this.SetSize("650px","450px");this.SetSrc("/d2l/common/dialogs/orgUnitSelector/orgUnitSelector.d2l","SrcCallback");this.SetSrcParam("d","1");var b=this.AddPrimaryButton(D2L.Control.Button.Type.Insert);b.SetIsEnabled(false);this.AddSecondaryButton(D2L.Control.Button.Type.Cancel);
this.SetAllowMultiple(true);this.SetDescendantOptions(D2L.OrgUnitSelector.DescendantOptions.UserChoice);this.SetOrgUnitOptions(D2L.OrgUnitSelector.OrgUnitOptions.DescendantsOnly);this.SetDescendantOptionsIncludeCurrent(true)},SetAllowMultiple:function(allowMultiple){this.SetSrcParam("am",allowMultiple);if(!allowMultiple)this.SetTitle(new D2L.LP.Text.LangTerm("Framework.OrgUnitSelector.btnAddOrgUnit"));else this.SetTitle(new D2L.LP.Text.LangTerm("Framework.OrgUnitSelector.btnAddOrgUnits"))},SetAllowOrg:function(allowOrg){this.SetSrcParam("ao",
allowOrg)},SetDescendantOptions:function(descendantOptions){this.SetSrcParam("dopts",descendantOptions)},SetDescendantOptionsIncludeCurrent:function(descendantOptionsIncludeCurrent){this.SetSrcParam("doptsic",descendantOptionsIncludeCurrent)},SetOrgUnitOptions:function(orgUnitOptions){this.SetSrcParam("ouopts",orgUnitOptions)},SetDataSplit:function(ds){this.SetSrcParam("ds",ds)}});
D2L.Popup=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this,true);this.winName="";this.bodySource="";this.queryString="";this.footerMsg="";this.height=400;this.width=400;this.title=new D2L.LP.Text.PlainText("");this.hasStatusBar=false;this.hasAutoScroll=true;this.buttons=new Array;this.m_window=null;this.m_autoCloseWindow=true;this.m_name=UI.GetUniqueHtmlId();window[this.m_name]=this;this.m_isClone=false},Dispose:function(){arguments.callee.$.Dispose.call(this);if(this.m_window&&
!this.m_isClone&&this.m_autoCloseWindow&&UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<7&&!this.m_window.closed)this.m_window.close();this.m_window=null},AddButton:function(text,jsFunctionName,location,isPrimary){if(isPrimary===undefined)isPrimary=false;var me=this;var doAddition=function(){if(text.isString)me.RemoveButton(text);me.buttons.push(new Array(text,jsFunctionName,location,isPrimary))};var pWindow=this.GetWindow();if(pWindow!==null&&pWindow.OnLoadComplete&&
pWindow.isLoadComplete!==undefined)if(!pWindow.isLoadComplete)pWindow.OnLoadComplete.RegisterMethod(doAddition);else doAddition();else doAddition()},RemoveButton:function(text){var me=this;var doRemoval=function(){for(var i=0;i<me.buttons.length;i++)if(me.buttons[i][0].isString)if(me.buttons[i][0]==text)if(me.buttons[i]==me.buttons[me.buttons.length-1])me.buttons.pop();else me.buttons[i]=me.buttons.pop()};var pWindow=this.GetWindow();if(pWindow!==null&&pWindow.OnLoadComplete&&pWindow.isLoadComplete!==
undefined)if(!pWindow.isLoadComplete)pWindow.OnLoadComplete.RegisterMethod(doRemoval);else doRemoval();else doRemoval()},AddCancelButton:function(){this.AddButton("Cancel","Cancel","Left",false)},AddCloseButton:function(isPrimary){this.AddButton("Close","Close","Left",isPrimary)},AddCreateButton:function(isPrimary){this.AddButton("Create","Create","Left",isPrimary)},AddSaveButton:function(isPrimary){this.AddButton("Save","Save","Left",isPrimary)},ClearButtons:function(){var me=this;var doRemoval=
function(){me.buttons=new Array};var pWindow=this.GetWindow();if(pWindow!==null&&pWindow.OnLoadComplete&&pWindow.isLoadComplete!==undefined)if(!pWindow.isLoadComplete)pWindow.OnLoadComplete.RegisterMethod(doRemoval);else doRemoval();else doRemoval()},Open:function(){if(this.m_window)if(this.m_window.closed)this.m_window=null;if(!this.m_window){var statusBar,windowFeatures;if(this.hasStatusBar)statusBar="yes";windowFeatures="height="+this.height+",width="+this.width+",status="+statusBar;windowFeatures+=
",location=0,menubar=0,toolbar=0,directories=0,resizable=1";this.m_window=window.open(this.GetUrl(),this.winName,windowFeatures)}if(this.m_window)this.m_window.focus()},Load:function(){var pWindow=this.GetWindow();if(pWindow!==null){pWindow.resizeTo(this.width,this.height);if(this.bodySource.length>0)if(this.queryString.length>0)pWindow.frames["Body"].location.href=this.bodySource+"?"+this.queryString;else pWindow.frames["Body"].location.href=this.bodySource;else pWindow.frames["Body"].location.href=
"/d2l/common/popup/empty.html";this.LoadFooter();this.LoadHeader()}},LoadFooter:function(){var pWindow=this.GetWindow();if(pWindow!==null){var footer=pWindow.frames["Footer"];var me=this;var reloadFooter=function(){var buttons=me.GetButtonString().Register(function(buttonString){var ni=new footer["D2L"].NavInfo;ni.SetParam("footerMsg",me.footerMsg);ni.SetParam("buttons",buttonString);footer["Nav"].Go(ni)})};if(pWindow.OnLoadComplete&&pWindow.isLoadComplete!==undefined)if(!pWindow.isLoadComplete)pWindow.OnLoadComplete.RegisterMethod(reloadFooter);
else reloadFooter()}},LoadHeader:function(){var win=this.GetWindow();if(win!==null&&win.SetTitle)this.GetTitle().GetText().Register(function(t){win.SetTitle(t)})},GetButtonString:function(){var dr=new D2L.Util.DelayedReturn;var encoder=new d2l_Encoder("|",",","$","*");var me=this;var BuildButton=function(i){if(i==me.buttons.length)dr.Trigger(encoder.Serialize());else{var data=new Array;var text=me.buttons[i][0];if(text.isString)text=new D2L.LP.Text.PlainText(me.buttons[i][0].decodeHtml());text.GetText().Register(function(text){data[0]=
text;data[1]=me.buttons[i][1];data[2]=me.buttons[i][2];data[3]=me.buttons[i][3];encoder.AddRow(data);BuildButton(++i)})}};BuildButton(0);return dr},GetTitle:function(){if(this.title.isString)this.title=new D2L.LP.Text.PlainText(this.title);return this.title},FetchTitle:function(Callback){this.GetTitle().GetText().Register(function(title){Callback.call(Callback,title)})},GetUrl:function(){var page="/d2l/common/popup/popup.d2l?ou="+Global.OrgUnitId;page+="&queryString="+D2L.Util.Url.Encode(this.queryString);
page+="&footerMsg="+D2L.Util.Url.Encode(this.footerMsg.decodeHtml());page+="&popBodySrc="+D2L.Util.Url.Encode(this.bodySource);page+="&width="+this.width;page+="&height="+this.height;page+="&hasStatusBar="+this.hasStatusBar;page+="&hasAutoScroll="+this.hasAutoScroll;page+="&p="+D2L.Util.Url.Encode(this.m_name);return page},GetWindow:function(){return this.m_window},SetAutoCloseWindow:function(autoClose){this.m_autoCloseWindow=autoClose},SetTitle:function(title){this.title=D2L.LP.Text.IText.Normalize(title,
"D2L.Popup","SetTitle","title");this.LoadHeader()}});var d2l_Popup=D2L.Popup;
D2L.Popup.InsertFile=D2L.Popup.extend({Construct:function(callback,type,allowCourse,allowUpload,allowUrl,storageLocation,maxFileSize){arguments.callee.$.Construct.call(this);this.bodySource="/d2l/common/insert/insert.d2l";this.queryString="ou="+Global.OrgUnitId+"&type="+type+"&aco="+(allowCourse?"1":"0")+"&aup="+(allowUpload?"1":"0")+"&aur="+(allowUrl?"1":"0")+"&sloc="+storageLocation+"&mfs="+maxFileSize+"&cb="+callback;this.height=350;this.width=550;this.AddCloseButton()}});
D2L.Popup.Email=D2L.Popup.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_body="";this.m_emails=[];this.m_groups=[];this.m_groupLocations=[];this.m_users=[];this.m_userLocations=[];this.m_subject="";this.SetAutoCloseWindow(false);var id=UI.GetUniqueHtmlId();window[id]=this;this.bodySource="/d2l/lms/email/integration/AdaptLegacyPopupData.d2l";this.queryString="ou="+Global.OrgUnitId+"&p=1&ext=1&cb="+id;this.width=960;this.height=900},Open:function(){var loc=new D2L.LP.Web.Http.UrlLocation(this.bodySource+
"?"+this.queryString);D2L.LP.Web.UI.Html.Dom.OpenWindow("ComposeEmail",loc,960,900,false,false)},AddEmails:function(emails,location){if(location===undefined)location=D2L.Popup.Email.Location.To;if(!D2L.Util.JavaScript.IsArray(emails))emails=[emails];for(var i=0;i<emails.length;i++){var emailId=new String(emails[i]);if(this.m_emails[emailId]===undefined)this.m_emails[emailId]=[];this.m_emails[emailId].push(location)}},AddUsers:function(users,location){if(location===undefined)location=D2L.Popup.Email.Location.To;
if(!D2L.Util.JavaScript.IsArray(users))users=[users];for(var i=0;i<users.length;i++){var userId=new String("u"+users[i]);if(this.m_users[userId]===undefined)this.m_users[userId]=[];this.m_users[userId].push(location)}},AddGroups:function(groups,location){if(location===undefined)location=D2L.Popup.Email.Location.To;if(!D2L.Util.JavaScript.IsArray(groups))groups=[groups];for(var i=0;i<groups.length;i++){var groupId=new String("g"+groups[i]);if(this.m_groups[groupId]===undefined)this.m_groups[groupId]=
[];this.m_groups[groupId].push(location)}},GetBody:function(){return this.m_body},GetEmails:function(){return this.m_emails},GetGroupIds:function(){var groupIds=[];for(var groupId in this.m_groups)groupIds.push(groupId.substr(1));return groupIds},GetGroups:function(){return this.m_groups},GetSubject:function(){return this.m_subject},GetUsers:function(){return this.m_users},GetUserIds:function(){var userIds=[];for(var userId in this.m_users)userIds.push(userId.substr(1));return userIds},SetBody:function(body){this.m_body=
body},SetSubject:function(subject){this.m_subject=subject}});D2L.Popup.Email.Location={To:0,Cc:1,Bcc:2};
D2L.Dialog.Processing=D2L.ModalDialog.extend({Construct:function(message){var callback=function(r){r.GetDialog().Close()};arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.m_divProcessing=null;this.m_message=null;this.m_processBarVisibility=true;this.SetMessage(message);this.SetHeight("140px");this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titProcessing"));this.SetHasCloseIcon(false)},BuildDom:function(){arguments.callee.$.BuildDom.call(this);this.m_divMessage=this.CreateElement("div");
this.m_divMessage.appendChild(this.CreateTextNode(""));this.AppendChild(this.m_divMessage);this.m_divProcessing=this.CreateElement("div");this.m_divProcessing.style.padding="1em";this.m_divProcessing.style.textAlign="center";this.m_divProcessing.style.display=this.m_processBarVisibility?"block":"none";var imgProcessing=new D2L.Control.Image;imgProcessing.SetImage(new D2L.Images.ImageTerm("Framework.Dialog.imgProcessing"));imgProcessing.AppendTo(this.m_divProcessing);this.AppendChild(this.m_divProcessing);
var me=this;setTimeout(function(){me.m_firstLoadEvent.Trigger()},0);this.SetMessage(this.m_message)},SetMessage:function(message){this.m_message=D2L.LP.Text.IText.Normalize(message,"D2L.Dialog.Processing","SetMessage","message");if(this.m_divMessage)this.m_message.AssignText(this.m_divMessage.firstChild,"data")},SetProcessBarVisibility:function(isVisible){this.m_processBarVisibility=isVisible;if(this.m_divProcessing)this.m_divProcessing.style.display=isVisible?"block":"none"}});
D2L.Dialog.ProgressBar=D2L.Dialog.extend({Construct:function(progressBar){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId());this.m_progressBar=progressBar;this.m_message=new D2L.LP.Text.PlainText("");this.m_domMessage=null;this.SetHasCloseIcon(false);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titProcessing"))},BuildDom:function(){if(!this.m_hasDomBeenBuilt){arguments.callee.$.BuildDom.call(this);this.m_domMessage=this.CreateElement("p");this.m_domMessage.style.marginTop="0";
this.AppendChild(this.m_domMessage);this.AppendChild(this.m_progressBar);var me=this;setTimeout(function(){me.m_firstLoadEvent.Trigger()},0);this.Render_Message()}},GetProgressBar:function(){return this.m_progressBar},SetMessage:function(message){this.m_message=D2L.LP.Text.IText.Normalize(message,"D2L.Dialog.ProgressBar","SetMessage","message");this.Render_Message()},Render_Message:function(){if(this.m_domMessage!==null){var me=this;this.m_message.GetText().Register(function(text){if(text.length>
0){D2L.Util.Dom.Purge(me.m_domMessage);me.m_domMessage.innerHTML=D2L.Util.Html.Encode(text);me.m_domMessage.style.display="block"}else me.m_domMessage.style.display="none"})}}});
D2L.Dialog.QuickLink=D2L.Dialog.extend({Construct:function(callback,hasLinkOptions,quicklinkType){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.m_callback=callback;this.m_hasLinkOptions=hasLinkOptions;this.m_quicklinkType=quicklinkType},Open:function(openerId){if(openerId===undefined){console.log("openerId is requried.");return}openerId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(openerId);var typeKey="";if(this.m_quicklinkType!==undefined)typeKey=this.m_quicklinkType;var initialViewType=
"Default";if(this.m_quicklinkType!==undefined)initialViewType="Items";var outputFormat="";if(this.m_hasLinkOptions)outputFormat="html";var url="/d2l/lp/quicklinks/manage/"+Global.OrgUnitId+"/createdialog?typeKey="+typeKey+"&initialViewType="+initialViewType+"&outputFormat="+outputFormat;var url=new D2L.LP.Web.Http.UrlLocation(url);var settings={Window:this.GetWindow()};var dialogEvt=D2L.LP.Web.UI.Common.MasterPages.Dialog.Open(openerId,url,settings);var me=this;var callback=this.m_callback;dialogEvt.AddListener(function(item){if(callback===
undefined)return;var items=[];items.push(item);var responseHandler=function(response){if(response==null)return;var target="_self";if(response.target=="WholeWindow")target="_top";else if(response.target=="NewWindow")target="_blank";var link={Navigation:response.location,Html:response.html,Target:target,Text:response.title,ObjectName:response.title};var legacyResponse=new D2L.Dialog.Response(me,D2L.Dialog.ResponseType.Positive);legacyResponse.SetData("QuickLink",link);me.m_callback.call(me.m_callback,
legacyResponse)};D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,new D2L.LP.Web.Http.UrlLocation("/d2l/lp/quicklinks/manage/"+Global.OrgUnitId+"/create"),{items:items},{success:responseHandler})})}});
D2L.Dialog.Response=D2L.Class.extend({Construct:function(dialog,type,param){arguments.callee.$.Construct.call(this);if(param===undefined)param="";this.m_type=type;this.m_param=param;this.m_dialog=dialog;this.m_data=[]},CallCallback:function(){this.GetDialog().CallCallback(this)},GetData:function(key){if(this.m_data[key]!==undefined){var Copy=function(val){var ret=val;if(D2L.Util.JavaScript.IsArray(val)){ret=[];for(var i=0;i<val.length;i++)ret.push(Copy(val[i]))}else if(val!==undefined&&val!==null&&
val.Serialize!==undefined&&val.Deserialize!==undefined&&val.ClassName!==undefined)ret=D2L.Serialization.JsonDeserializer.Deserialize(D2L.Serialization.JsonSerializer.Serialize(val));return ret};return Copy(this.m_data[key])}else return null},GetDialog:function(){return this.m_dialog},GetType:function(){return this.m_type},GetParam:function(){return this.m_param},SetData:function(key,value){this.m_data[key]=value}});
D2L.Dialog.SaveConfirmation=D2L.Dialog.Prompt.extend({Construct:function(callback,primaryMessage,secondaryMessage){if(primaryMessage===undefined)primaryMessage=new D2L.LP.Text.LangTerm("Framework.Dialog.lblSaveConfirmationPrimary");if(secondaryMessage===undefined)secondaryMessage=new D2L.LP.Text.LangTerm("Framework.Dialog.lblSaveConfirmationSecondary");arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback,primaryMessage,secondaryMessage);this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnSave"));
this.m_dontSaveButton=this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnDontSave"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Negative);this.m_cancelButton=this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnCancel"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Abort);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titSaveChanges"));this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/save.gif",48,48));this.SetCloseOnEnter(false)},
GetSaveButton:function(){return this.m_positiveButton},GetDontSaveButton:function(){return this.m_dontSaveButton},GetCancelButton:function(){return this.m_cancelButton}});
D2L.Dialog.SelectFile=D2L.Dialog.extend({Construct:function(callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.m_areaFilters=["MyComputer","OuFiles"];this.m_selectedArea="";this.m_selectedAreaParam="";this.m_allowMultiple=true;this.m_askForImageDesc=false;this.m_forceSaveToCourseFiles=false;this.m_allowSaveToCourseFiles=false;this.m_uploadInlineHelpLangTerm="";this.m_maxFileSize=0;this.SetSrc("/d2l/common/dialogs/file/main.d2l","DialogCallback");this.SetSize(660,
520);var me=this;this.OnResize.RegisterMethod(function(width,height){me.CallSrcMethod("HandleResize",height)})},AddAreaFilter:function(area){area=area.toLowerCase();var found=false;for(var i=0;i<this.m_areaFilters.length;i++)if(this.m_areaFilters[i]==area){found=true;break}if(!found)this.m_areaFilters.push(area)},Close:function(){this.SetFooterText(new D2L.LP.Text.PlainText(""));if(this.m_positiveButton!==null){this.RemoveButton(this.m_positiveButton);this.m_positiveButton=null}arguments.callee.$.Close.call(this)},
Open:function(opener){this.RemoveButtons();this.SetSrcParam("am",this.m_allowMultiple?"1":"0");this.SetSrcParam("fsc",this.m_forceSaveToCourseFiles?"1":"0");this.SetSrcParam("asc",this.m_allowSaveToCourseFiles?"1":"0");this.SetSrcParam("mfs",this.m_maxFileSize);this.SetSrcParam("afid",this.m_askForImageDesc);this.SetSrcParam("uih",this.m_uploadInlineHelpLangTerm);if(this.m_selectedArea.length>0){this.SetSrcParam("area",this.m_selectedArea);if(this.m_selectedAreaParam.length>0)this.SetSrcParam("sap",
this.m_selectedAreaParam)}var paramVal="";var comma="";for(var i=0;i<this.m_areaFilters.length;i++){paramVal+=comma+this.m_areaFilters[i];comma=","}this.SetSrcParam("af",paramVal);return arguments.callee.$.Open.call(this,opener)},RemoveAreaFilter:function(area){area=area.toLowerCase();for(var i=0;i<this.m_areaFilters.length;i++)if(this.m_areaFilters[i]==area){this.m_areaFilters=this.m_areaFilters.splice(i);break}if(area==this.m_selectedArea)this.m_selectedArea=""},SetAllowMultiple:function(allowMultiple){this.m_allowMultiple=
allowMultiple},SetAreaFilters:function(areaFilters){this.m_areaFilters=areaFilters},SetAskForImageDescription:function(askForImageDescription){this.m_askForImageDesc=askForImageDescription},SetMaxFileSize:function(maxFileSize){this.m_maxFileSize=maxFileSize},SetForceSaveToCourseFiles:function(bool){this.m_forceSaveToCourseFiles=bool},SetAllowSaveToCourseFiles:function(bool){this.m_allowSaveToCourseFiles=bool},SetUploadInlineHelpLangTerm:function(langTerm){this.m_uploadInlineHelpLangTerm=langTerm},
SetSelectedArea:function(selectedArea,param){if(selectedArea.length>0)this.AddAreaFilter(selectedArea);this.m_selectedArea=selectedArea;if(param!==undefined)this.m_selectedAreaParam=param},SetFileFilters:function(filters){if(!D2L.Util.JavaScript.IsArray(filters))filters=[filters];var paramVal="";var comma="";for(var i=0;i<filters.length;i++){paramVal+=comma+filters[i];comma=","}this.SetSrcParam("f",paramVal)}});
D2L.Dialog.SelectItem=D2L.Dialog.extend({Construct:function(callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.m_subject="";this.m_extensionPoint="";this.SetSize("975","650");this.AddPrimaryButton(D2L.Control.Button.Type.Next,"next","BTN_next");this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnBack"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Positive,"back","BTN_back");this.AddSecondaryButton(D2L.Control.Button.Type.Cancel,"","BTN_cancel")},
GetSubject:function(){return this.m_subject},Open:function(opener){if(this.m_extensionPoint!="")this.SetSrc("/d2l/common/dialogs/isf/selectItem.d2l?extensionPoint="+this.m_extensionPoint,"GetSelectedItem");else this.SetSrc("/d2l/common/dialogs/isf/selectItem.d2l","GetSelectedItem");this.SetSrcParam("subject",this.m_subject);this.SetSrcParam("extensionPoint",this.m_extensionPoint);return arguments.callee.$.Open.call(this,opener)},SetDialogBackButtonIsDisplayed:function(isDisplayed){var button=this.GetButton("BTN_back");
if(button)button.SetIsDisplayed(isDisplayed)},SetDialogNextButtonText:function(text){var button=this.GetButton("BTN_next");if(button){button.SetText(new D2L.LP.Text.PlainText(text));button.SetIsDisplayed(true)}},SetDialogNextButtonIsEnabled:function(isEnabled){var button=this.GetButton("BTN_next");if(button)button.SetIsEnabled(isEnabled)},SetSubject:function(subject){this.m_subject=subject},SetExtensionPoint:function(ExtensionPoint){this.m_extensionPoint=ExtensionPoint}});
D2L.Dialog.SelectPath=D2L.Dialog.extend({Construct:function(callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.m_allowSharedFilesPaths=true;this.m_initialPath="";this.m_restrictToCurrentOrgUnit=true;this.AddCustomButton(new D2L.LP.Text.LangTerm("FrameworkWebPages.SelectPathDialog.titSelectPath"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Positive,undefined,undefined,true);this.AddSecondaryButton(D2L.Control.Button.Type.Cancel);this.SetSize(400,400);this.SetTitle(new D2L.LP.Text.LangTerm("FrameworkWebPages.SelectPathDialog.titSelectPath"));
this.SetFooterText(new D2L.LP.Text.LangTerm("FrameworkWebPages.SelectPathDialog.lblPleaseSelectPath"));this.SetSrc("/d2l/common/dialogs/selectPath/selectPath.d2l","SrcCallback");this.SetAllowSharedFilesPaths(true);this.SetRestrctToCurrentOrgUnit(true)},SetAllowSharedFilesPaths:function(allowSharedFilesPaths){this.m_allowSharedFilesPaths=allowSharedFilesPaths;this.SetSrcParam("asfp",allowSharedFilesPaths?"1":"0")},SetInitialPath:function(initialPath){this.m_initialPath=initialPath;this.SetSrcParam("initialPath",
this.m_initialPath)},SetInstructions:function(instructions){this.m_instructions=instructions;this.SetSrcParam("instructions",this.m_instructions)},SetRestrctToCurrentOrgUnit:function(restrictToCurrentOrgUnit){this.m_restrictToCurrentOrgUnit=restrictToCurrentOrgUnit;this.SetSrcParam("r",this.m_restrictToCurrentOrgUnit?"1":"0")}});
D2L.Dialog.SpellChecker=D2L.Dialog.extend({Construct:function(callback,text,isTextHtml){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.SetSize(500,450);this.SetSrc("/d2l/common/dialogs/spellChecker/spellChecker.d2l","SrcCallback");if(text!==undefined)this.SetSrcParam("text",text);if(isTextHtml!==undefined)this.SetSrcParam("isTextHtml",isTextHtml);this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnApply"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Positive,
undefined,undefined,true);this.AddCustomButton(new D2L.LP.Text.LangTerm("Standard.Buttons.btnCancel"),D2L.Dialog.ButtonPosition.Left,D2L.Dialog.ResponseType.Negative,undefined,undefined,false)},SetText:function(text){this.SetSrcParam("text",text)},SetIsTextHtml:function(isTextHtml){this.SetSrcParam("isTextHtml",isTextHtml)},SetPreviewText:function(perviewText){this.SetSrcParam("hasDiffPreviewText",true);this.SetSrcParam("previewText",perviewText)},SetIsPreviewTextHtml:function(isPreviewTextHtml){this.SetSrcParam("isPreviewTextHtml",
isPreviewTextHtml)}});
D2L.Dialog.VideoCapture=D2L.Dialog.extend({Construct:function(src,callback){arguments.callee.$.Construct.call(this,UI.GetUniqueHtmlId(),callback);this.AddPrimaryButton(D2L.Control.Button.Type.Add,"add","BTN_addVideoCapture");this.AddSecondaryButton(D2L.Control.Button.Type.Cancel);this.SetSrc(src,"VideoCaptureDialogCallback");this.SetSize(600,400);var me=this;this.OnOpen.RegisterMethod(function(){me.SetAddButtonIsEnabled(false)})},Close:function(){this.SetFooterText(new D2L.LP.Text.PlainText(""));arguments.callee.$.Close.call(this)},
Open:function(opener){return arguments.callee.$.Open.call(this,opener)},SetAddButtonIsEnabled:function(isEnabled){var button=this.GetButton("BTN_addVideoCapture");if(button)button.SetIsEnabled(isEnabled)}});
D2L.Dialog.Warning=D2L.Dialog.Prompt.extend({Construct:function(name,primaryMessage,secondaryMessage){arguments.callee.$.Construct.call(this,name,undefined,primaryMessage,secondaryMessage);this.m_closeIconResponseType=D2L.Dialog.ResponseType.Positive;this.SetPositiveButtonText(new D2L.LP.Text.LangTerm("Standard.Buttons.btnOk"));this.SetIcon(new D2L.Images.ImageInfo("/d2l/img/lp/dialog/warning.gif",48,48));this.SetHasCloseIcon(false);this.SetTitle(new D2L.LP.Text.LangTerm("Framework.Dialog.titWarning"))}});
D2L.DisplayGroups={};
D2L.DisplayGroups.DisplayGroupManager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_groups={}},DeserializeMin:function(deserializer){this.m_groups=deserializer.GetDictionaryMin("string",D2L.DisplayGroups.DisplayGroupData)},GetGroup:function(groupName){groupName=groupName.toLowerCase();if(this.m_groups[groupName])return UI.GetControl(this.m_groups[groupName].ControlId.ID(),this.m_groups[groupName].ControlId.SID());else return null},GetGroupControls:function(groupControlId){var controls=[];
for(var name in this.m_groups){var data=this.m_groups[name];if(data.ControlId.ID()==groupControlId.ID()&&data.ControlId.SID()==groupControlId.SID())return data.Controls}return controls},Init:function(){for(var name in this.m_groups){var group=this.GetGroup(name);if(group!==null)group.Init()}},SetControlDisplayGroup:function(controlId,groupControlId){}});
D2L.DisplayGroups.DisplayGroupData=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.ControlId=null;this.Controls=[]},DeserializeMin:function(deserializer){this.ControlId=deserializer.GetObjectMin(D2L.Control.Id);this.Controls=deserializer.GetObjectArrayMin(D2L.DisplayGroups.DisplayGroupControl)}});
D2L.Control.DisplayGroup=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.isDisplayed=true;this.m_controls=[]},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.isDisplayed=deserializer.GetBoolean();this.m_controls=UI.GetDisplayGroupManager().GetGroupControls(this.GetControlId())},Init:function(){for(var i=0;i<this.m_controls.length;i++)this.m_controls[i].Init()},GetState:function(serializer){serializer.AddMember("IsDisplayed",
this.IsDisplayed())},IsDisplayed:function(){return this.isDisplayed},Show:function(){this.SetIsDisplayed(true)},Hide:function(){this.SetIsDisplayed(false)},SetIsDisplayed:function(isDisplayed){UI.GetDisplayGroupManager();for(var i=0;i<this.m_controls.length;i++)this.m_controls[i].SetIsDisplayed(isDisplayed);this.isDisplayed=isDisplayed}});D2L.DisplayGroups.DisplayGroup=D2L.Control.DisplayGroup;D2L.DisplayGroup=D2L.Control.DisplayGroup;
D2L.DisplayGroups.DisplayGroupControl=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_type=D2L.DisplayGroups.DisplayGroupType.Object;this.m_mappedId="";this.m_control=null},DeserializeMin:function(deserializer){this.m_type=deserializer.GetMember();this.m_mappedId=deserializer.GetMember()},Init:function(){var me=this;var InstallExpand=function(domNode){if(domNode!==null){me.AttachObject(domNode,"ID2LOnExpand",new D2L.EventHandler);domNode.ID2LOnExpand.RegisterMethod(function(){me.SetIsDisplayed(true)})}};
if(this.m_control===null)if(this.m_type==D2L.DisplayGroups.DisplayGroupType.Object){this.m_control=UI.GetControlMap().GetControlByMappedId(this.m_mappedId);InstallExpand(this.m_control.GetDomNode())}else{this.m_control=UI.GetById(this.m_mappedId);InstallExpand(this.m_control)}},SetIsDisplayed:function(isDisplayed){this.Init();if(this.m_control!==null){if(this.m_type==D2L.DisplayGroups.DisplayGroupType.Object)this.m_control.SetIsDisplayed(isDisplayed);else if(isDisplayed)if(this.m_type==D2L.DisplayGroups.DisplayGroupType.Block)this.m_control.style.display=
"block";else if(this.m_type==D2L.DisplayGroups.DisplayGroupType.Inline)this.m_control.style.display="inline";else{if(this.m_type==D2L.DisplayGroups.DisplayGroupType.TableRow)if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.m_control.style.display="inline";else this.m_control.style.display="table-row"}else this.m_control.style.display="none";if(this.m_type!=D2L.DisplayGroups.DisplayGroupType.Object){var tEvent=new D2L.TransformEvent(this.m_control);tEvent.Bubble();if(isDisplayed)(new D2L.DisplayVisibleEvent(this.m_control)).Bubble()}}}});
D2L.DisplayGroups.DisplayGroupType={Block:0,Inline:1,Object:2,TableRow:3};D2L.DragDrop={m_manager:null,GetManager:function(){if(D2L.DragDrop.m_manager===null)D2L.DragDrop.m_manager=new D2L.DragDrop.Manager;return D2L.DragDrop.m_manager}};D2L.DragDrop.Modes={None:0,DraggableDroppable:1,Draggable:2,Droppable:3};
D2L.Control.Edit=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_blurEvent=new D2L.EventHandler;this.m_isDisplayed=true;this.m_isEnabled=true;this.m_keyPressEvent=new D2L.EventHandler;this.m_text=new D2L.LP.Text.PlainText;this.m_title=new D2L.LP.Text.PlainText;this.m_width=-1},BlurEvent:function(){return this.m_blurEvent},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);var domNode=this.SetDomNode(this.GetUI().CreateElement("input"));
domNode.type="text";domNode.name=this.GetMappedId();domNode.className="d_edt";if(this.m_width>0)domNode.style.width=this.m_width+"px";else domNode.size=50;if(this.m_text)this.SetText(this.m_text);if(this.m_title)this.SetTitle(this.m_title);this.SetIsEnabled(this.IsEnabled());this.SetIsDisplayed(this.IsDisplayed());this.AttachObject(this.GetDomNode(),"onchange",function(evt){WindowEventManager.BC(this,evt)});this.InstallEvents()},Clear:function(triggerChange){if(triggerChange===undefined)triggerChange=
false;this.m_text=new D2L.LP.Text.PlainText;if(this.IsRendered()){this.GetDomNode().value="";if(triggerChange)WindowEventManager.BC(this.GetDomNode())}},Focus:function(){if(this.IsRendered())this.GetDomNode().focus()},GetMultiEditValue:function(){if(this.IsEnabled()&&this.IsRendered())return this.GetDomNode().value;return""},GetState:function(serializer){if(this.IsRendered())serializer.AddMember("Text",this.GetDomNode().value)},GetText:function(){if(this.IsRendered())return new D2L.LP.Text.PlainText(this.GetDomNode().value);
else return this.m_text},GetTextAsString:function(){if(this.IsRendered())return this.GetDomNode().value;return""},GetTitle:function(){return this.m_title},GetValue:function(){return this.GetText().GetText()},GetValueNoDelay:function(){return this.GetTextAsString()},GetWidth:function(){return this.m_width},HasValue:function(){var dr=new D2L.Util.DelayedReturn;this.GetText().GetText().Register(function(text){dr.Trigger(text.trim().length>0)});return dr},HasValueNoDelay:function(){return this.GetTextAsString().trim().length>
0},InstallEvents:function(){var domNode=this.GetDomNode();var me=this;this.AttachObject(domNode,"onblur",function(evt){me.BlurEvent().Trigger(evt||window.event)});this.GetUI().GetWindowEventManager().InstallKpel(domNode,function(obj,evt){me.KeyPressEvent().Trigger(evt)})},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var domNode=this.GetDomNode();if(domNode!==null){if(deserializer.HasMember())domNode.ID2L=null;this.m_isDisplayed=domNode.style.display!=
"none";this.m_isEnabled=!domNode.disabled;this.m_text=new D2L.LP.Text.PlainText(domNode.value);this.m_title=new D2L.LP.Text.PlainText(domNode.getAttribute("title"));this.InstallEvents()}else{this.m_hasDomBeenBuilt=false;this.m_isEnabled=false}},IsDisplayed:function(){return this.m_isDisplayed},IsEnabled:function(){if(this.IsRendered())return!this.GetDomNode().disabled;else return this.m_isEnabled},KeyPressEvent:function(){return this.m_keyPressEvent},OpenSpellChecker:function(){var me=this;D2L.Util.SpellChecker.OpenSpellChecker(this.GetTextAsString(),
false).Register(function(result){me.SetText(new D2L.LP.Text.PlainText(result))})},Select:function(){if(this.IsRendered())this.GetDomNode().select()},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().style.display=isDisplayed?"inline":"none";this.m_isDisplayed=isDisplayed},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(this.IsRendered())this.GetDomNode().disabled=!isEnabled},SetText:function(text,triggerChange){if(triggerChange===undefined)triggerChange=false;
this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Edit","SetText","text");if(this.IsRendered()){this.m_text.AssignText(this.GetDomNode(),"value");if(triggerChange)WindowEventManager.BC(this.GetDomNode())}},SetTitle:function(title){this.m_title=title;if(this.IsRendered())this.m_title.AssignText(this.GetDomNode(),"title")},SetWidth:function(width){this.m_width=width;if(this.IsRendered())if(width>0)this.GetDomNode().style.width=width+"px";else this.GetDomNode().style.width="auto"}});
D2L.Control.EditNumber=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_edit=null;this.m_validatorControlId=null},Clear:function(triggerChange){this.m_edit.Clear(triggerChange)},Focus:function(){this.m_edit.Focus()},GetStringValue:function(){return this.m_edit.GetTextAsString()},GetValidator:function(){return UI.GetControl(this.m_validatorControlId)},GetWidth:function(){return this.m_edit.GetWidth()},HasValue:function(){return this.m_edit.HasValue()},HasValueNoDelay:function(){return this.m_edit.HasValueNoDelay()},
IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_edit=UI.GetControl(this.GetMappedId()+"_edt");this.m_validatorControlId=deserializer.GetMember();this.SetDomNode(this.m_edit.GetDomNode())},IsDisplayed:function(){return this.m_edit.IsDisplayed()},IsEnabled:function(){return this.m_edit.IsEnabled()},IsEmpty:function(){return this.GetStringValue()==""},SetIsDisplayed:function(isDisplayed){this.m_edit.SetIsDisplayed(isDisplayed)},SetIsEnabled:function(isEnabled){this.m_edit.SetIsEnabled(isEnabled)},
SetStringValue:function(strValue,triggerChange){return this.m_edit.SetText(new D2L.LP.Text.PlainText(strValue),triggerChange)},SetWidth:function(width){this.m_edit.SetWidth(width)}});
D2L.Control.EditInteger=D2L.Control.EditNumber.extend({Construct:function(){arguments.callee.$.Construct.call(this)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer)},GetInteger:function(){try{return D2L.Util.Integer.Parse(this.GetStringValue())}catch(e){return 0}},GetMultiEditValue:function(){if(this.IsEnabled()&&this.IsRendered())if(this.IsEmpty())return"";else if(this.IsValidInteger())return this.GetInteger().toString();else return this.GetStringValue();
return""},GetState:function(serializer){if(this.IsRendered())if(this.IsEmpty())serializer.AddMember("Text","");else if(this.IsValidInteger())serializer.AddMember("Text",this.GetInteger());else serializer.AddMember("Text",this.GetStringValue())},GetValidator:function(){return arguments.callee.$.GetValidator.call(this)},IsValidInteger:function(){try{D2L.Util.Integer.Parse(this.GetStringValue());return true}catch(e){return false}},SetInteger:function(integer,triggerChange){this.SetStringValue(D2L.Util.Integer.Format(integer),
triggerChange)}});
D2L.Control.EditDecimal=D2L.Control.EditNumber.extend({Construct:function(){arguments.callee.$.Construct.call(this)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer)},GetDecimal:function(){try{return D2L.Util.Decimal.Parse(this.GetStringValue())}catch(e){return 0}},GetMultiEditValue:function(){if(this.IsEnabled()&&this.IsRendered())if(this.IsEmpty())return"";else if(this.IsValidDecimal())return this.GetDecimal().toString();else return this.GetStringValue();
return""},GetState:function(serializer){if(this.IsRendered())if(this.IsEmpty())serializer.AddMember("Text","");else if(this.IsValidDecimal())serializer.AddMember("Text",this.GetDecimal());else serializer.AddMember("Text",this.GetStringValue())},GetValidator:function(){return arguments.callee.$.GetValidator.call(this)},IsValidDecimal:function(){try{D2L.Util.Decimal.Parse(this.GetStringValue());return true}catch(e){return false}},SetDecimal:function(decimalVal,triggerChange){this.SetStringValue(D2L.Util.Decimal.Format(decimalVal),
triggerChange)}});D2L.Enablers={};
function d2l_EnablerManager(){this.enablerTargetLists=new Object;this.enablers=new Object;this.enablerTargetStack=new Array;this.enablerTargets=new Array;this.enablerTargetStackIndex=-1;this.radioGroups=new Object;this.OpenEnablerTarget=function(key,keyOp){var keyList=key.split(",");var et=new d2l_EnablerTarget(keyList,keyOp);for(var i=0;i<keyList.length;i++){var etList=this.enablerTargetLists[keyList[i]];if(etList)etList[etList.length]=et;else{etList=new Array;etList[0]=et;this.enablerTargetLists[keyList[i]]=
etList}}this.enablerTargetStackIndex++;this.enablerTargetStack[this.enablerTargetStackIndex]=et;this.enablerTargets[this.enablerTargets.length]=et};this.CloseEnablerTarget=function(){this.enablerTargetStackIndex--};this.AddEnabler=function(key,e){this.enablers[key]=e};this.AddEnablerTargetItem=function(eti){this.enablerTargetStack[this.enablerTargetStackIndex].AddEnablerTargetItem(eti)};this.ResetState=function(key){for(var i=0;i<this.enablerTargets.length;i++)this.enablerTargets[i].ResetState()};
this.SetInitialState=function(){this.ResetState();var radioGroup;var currRb;var oldOnClick;for(radioGroup in this.radioGroups){currRb=UI.GetByName(radioGroup);if(currRb.length)for(var i=0;i<currRb.length;i++)this.AddRadioOnClick(currRb[i]);else this.AddRadioOnClick(currRb)}};this.AddRadioOnClick=function(rb){if(rb.onclick)rb.onclick=new Function("EnablerManager.ResetState();this.oldOnClick="+rb.onclick+";this.oldOnClick();");else rb.onclick=new Function("EnablerManager.ResetState();")};this.AddRadioGroup=
function(name){this.radioGroups[name]=0}}function Base_IEnablerTargetItem(obj){obj.IEnablerTargetItem=new IEnablerTargetItem(obj)}function Base_IEnabler(key,obj){obj.IEnabler=new IEnabler(key,obj)}function Object_IEnablerTargetItem(c){c.IEnablerTargetItem=new Object;c.IEnablerTargetItem.Enable=function(){c.SetIsEnabled(true)};c.IEnablerTargetItem.Disable=function(){c.SetIsEnabled(false)}}
function d2l_EnablerTarget(keyList,keyOp){this.keyList=keyList;if(keyOp.toLowerCase()=="and")this.useAndLogic=true;else this.useAndLogic=false;this.enablerTargetItems=new Array;this.AddEnablerTargetItem=function(eti){this.enablerTargetItems[this.enablerTargetItems.length]=eti};this.ResetState=function(){var isStateEnabled=this.useAndLogic;var numEnablers=0;var currEnabler;for(var i=0;i<this.keyList.length;i++){currEnabler=EnablerManager.enablers[this.keyList[i]];if(currEnabler){numEnablers++;if(currEnabler.IEnabler.IsEnabled()!=
this.useAndLogic){isStateEnabled=!this.useAndLogic;break}}}if(numEnablers===0)isStateEnabled=true;var currTargetItem;for(var x=0;x<this.enablerTargetItems.length;x++){currTargetItem=this.enablerTargetItems[x];if(isStateEnabled)currTargetItem.IEnablerTargetItem.Enable();else currTargetItem.IEnablerTargetItem.Disable()}}}
var IEnablerTargetItem=D2L.Class.extend({Construct:function(obj){arguments.callee.$.Construct.call(this);this.obj=obj},Dispose:function(){arguments.callee.$.Dispose.call(this);if(this.obj)this.obj.IEnablerTargetItem=null},Enable:function(){this.obj.disabled=false},Disable:function(){this.obj.disabled=true}});
var IEnabler=D2L.Class.extend({Construct:function(key,obj){arguments.callee.$.Construct.call(this);this.key=key;this.obj=obj},Dispose:function(){arguments.callee.$.Dispose.call(this);if(this.obj)this.obj.IEnabler=null},IsEnabled:function(){return!this.obj.disabled&&this.obj.checked},ResetState:function(){EnablerManager.ResetState()}});
function d2l_SelectListEnabler(key,selectList,optKey){this.obj=selectList;this.key=key;this.optKey=optKey;this.IEnabler=this;this.IsEnabled=function(){var isEnabled=false;var selectedOption=this.obj.GetSelectedOption();if(selectedOption)isEnabled=this.obj.IsEnabled()&&selectedOption.key==this.optKey;return isEnabled};this.ResetState=function(){EnablerManager.ResetState()}}
function SelectList_IEnabler(key,selectList,optKey){var enabler=new d2l_SelectListEnabler(key,selectList,optKey);if(!selectList.Enablers||selectList.Enablers&&selectList.Enablers===null)CreateEnablerCollection(selectList);selectList.Enablers.Add(enabler);return enabler}
function CreateEnablerCollection(obj){var enbColl=new Object;enbColl._collection=new Array;enbColl.Add=function(enabler){this._collection.push(enabler)};enbColl.ResetEnablers=function(){for(var index in this._collection){var enabler=this._collection[index];enabler.ResetState()}};obj.Enablers=enbColl}
D2L.Control.Enabler=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isEnabled=true;var me=this;this.IEnabler={key:"",IsEnabled:function(){return me.IsEnabled()},ResetState:function(){EnablerManager.ResetState()}};this.IEnablerTargetItem={Enable:function(){me.Enable()},Disable:function(){me.Disable()}}},IntegrateControlMin:function(deserializer){this.m_isEnabled=deserializer.GetBoolean();this.IEnabler.key=deserializer.GetMember()},Enable:function(){this.SetIsEnabled(true)},
Disable:function(){this.SetIsEnabled(false)},IsEnabled:function(){return this.m_isEnabled},SetIsEnabled:function(isEnabled){if(isEnabled!=this.m_isEnabled){this.m_isEnabled=isEnabled;this.IEnabler.ResetState()}},ToggleEnabled:function(){this.SetIsEnabled(!this.IsEnabled())}});
D2L.Control.Field=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_fieldRow1=null;this.m_fieldRow2=null;this.m_hasChanged=false;this.m_showChanges=false;this.m_isFieldSet=false;this.m_textLocation=D2L.Control.Field.TextLocation.Left;this.OnShowChange=new D2L.EventHandler},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_isFieldSet=deserializer.GetBoolean();this.m_hasChanged=deserializer.GetBoolean();
this.m_textLocation=deserializer.GetMember();this.m_showChanges=deserializer.GetBoolean();if(this.m_textLocation==D2L.Control.Field.TextLocation.Top){this.m_fieldRow1=this.GetDomNode().previousSibling;this.m_fieldRow2=this.GetDomNode()}else this.m_fieldRow1=this.GetDomNode()},GetState:function(serializer){serializer.AddMember("HasChanged",this.m_hasChanged)},HandleOnChange:function(event){if(!event.hasChangeBeenShown&&this.m_showChanges){if(!this.m_hasChanged)this.SetHasChanged(true);this.OnShowChange.Trigger();
event.hasChangeBeenShown=true}},HandleOnChangeReset:function(){if(this.m_showChanges){this.m_hasChanged=false;if(this.m_fieldRow1!==null)this.m_fieldRow1.style.backgroundColor="";if(this.m_fieldRow2!==null)this.m_fieldRow2.style.backgroundColor=""}},HandleOnTransform:function(event){if(this.m_fieldRow1.cells.length==2)this.m_fieldRow1.cells[0].style.paddingTop="0.3em";var me=this;setTimeout(function(){D2L.Control.Field.DoAlignment(me.GetDomNode());D2L.Control.Field.AdjustForFieldSet(me.GetDomNode())},
0)},HandleOnDisplayVisible:function(event){var me=this;setTimeout(function(){D2L.Control.Field.AdjustForFieldSet(me.GetDomNode())},0)},HasChanged:function(){return this.m_hasChanged},SetHasChanged:function(hasChanged){this.m_hasChanged=hasChanged;var colour=hasChanged?"#E6EFF2":"#ffffff";if(this.m_fieldRow1!==null)this.m_fieldRow1.style.backgroundColor=colour;if(this.m_fieldRow2!==null)this.m_fieldRow2.style.backgroundColor=colour},Hide:function(){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Field.Hide() is obsolete. Please use "+
"SetIsDisplayed() instead."),true);this.SetIsDisplayed(false)},SetIsDisplayed:function(isDisplayed){var display="none";if(isDisplayed)if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)display="inline";else display="table-row";if(this.m_fieldRow1!==null)this.m_fieldRow1.style.display=display;if(this.m_fieldRow2!==null)this.m_fieldRow2.style.display=display;var tEvent=new D2L.TransformEvent(this.GetDomNode());tEvent.Bubble()},SetText:function(text){text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Field",
"SetText","text");if(this.IsRendered()){var span=this.m_fieldRow1.cells[0].firstChild.firstChild;if(span.firstChild){D2L.Util.Dom.Purge(span.firstChild);span.removeChild(span.firstChild)}var me=this;text.GetText().Register(function(val){span.appendChild(me.CreateTextNode(val+":"))})}},Show:function(){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Field.Show() is obsolete. Please use "+"SetIsDisplayed() instead."),true);this.SetIsDisplayed(true)}});
D2L.Control.Field.TextLocation={Left:0,Top:1,None:2};
D2L.Control.Field.InstallEvents=function(domNode,GetControl){var me=null;if(domNode.ID2LOnChange===undefined)UI.AttachObject(domNode,"ID2LOnChange",new D2L.EventHandler);domNode.ID2LOnChange.RegisterMethod(function(evt){if(me===null)me=GetControl();me.HandleOnChange(evt)});if(domNode.ID2LOnTransform===undefined)UI.AttachObject(domNode,"ID2LOnTransform",new D2L.EventHandler);if(domNode.ID2LOnDisplayVisible===undefined)UI.AttachObject(domNode,"ID2LOnDisplayVisible",new D2L.EventHandler);domNode.ID2LOnDisplayVisible.RegisterMethod(function(evt){if(me===
null)me=GetControl();me.HandleOnDisplayVisible()});domNode.ID2LOnTransform.RegisterMethod(function(evt){if(me===null)me=GetControl();me.HandleOnTransform()});FormManager.OnChangeReset.RegisterMethod(function(){if(me===null)me=GetControl();me.HandleOnChangeReset()});D2L.Control.Field.DoAlignment(domNode);D2L.Control.Field.AdjustForFieldSet(domNode)};
D2L.Control.Field.AdjustForFieldSet=function(domNode){if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<=7||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Firefox&&UI.GetBrowserInfo().MajorVersion<3||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Firefox&&UI.GetBrowserInfo().MajorVersion==3&&UI.GetBrowserInfo().MinorVersion<=5)return;try{if(D2L.Util.Dom.HasClassName("D2LIFS",domNode)||D2L.Util.Dom.HasClassName("D2LIFS_TOP",domNode)){var textLocation=D2L.Control.Field.TextLocation.Left;
if(domNode.childNodes.length==1)textLocation=D2L.Control.Field.TextLocation.None;if(D2L.Util.Dom.HasClassName("D2LIFS_TOP",domNode))textLocation=D2L.Control.Field.TextLocation.Top;var labelCell=null;var contentCell=null;if(textLocation==D2L.Control.Field.TextLocation.Left){labelCell=domNode.cells[0];contentCell=domNode.cells[1]}else if(textLocation==D2L.Control.Field.TextLocation.Top){labelCell=domNode.previousSibling.cells[0];contentCell=domNode.cells[0]}else if(textLocation==D2L.Control.Field.TextLocation.None){labelCell=
null;contentCell=domNode.cells[0]}if(labelCell!=null&&textLocation!=D2L.Control.Field.TextLocation.Top){var legendNode=contentCell.firstChild.firstChild;var labelNode=labelCell.firstChild;var width=labelNode.offsetWidth;if(width>0&&legendNode.className=="dsr"){var leftPosition=UI.GetCulture().GetMarginPaddingPosition(D2L.Culture.MarginPaddingPosition.First);var rightPosition=UI.GetCulture().GetMarginPaddingPosition(D2L.Culture.MarginPaddingPosition.Second);legendNode.style.width=width+"px";legendNode.style["margin"+
leftPosition]=-width+"px";legendNode.style[leftPosition.toLowerCase()]="-0.2em";if(labelCell.d2lLegendPaddingTop!==undefined)legendNode.style.paddingTop=labelCell.d2lLegendPaddingTop+"em";legendNode.className="dfs_l_f";labelCell.style.visibility="hidden"}}}}catch(e){}};
D2L.Control.Field.DoAlignment=function(domNode){if(domNode.cells.length==2){var field,content,fieldY,contentY,fieldMid,contentMid;var field=domNode.cells[0];var content=domNode.cells[1];var FindElem=function(node){var className=node.className!==undefined?node.className:"";var tagName=node.tagName!==undefined?node.tagName.toLowerCase():"";var isDisplayed=node.style&&node.style.display=="none"?false:true;if(node.nodeType==1)if(className=="dsr"||className=="fgskip"||!isDisplayed||tagName=="input"&&node.type.toLowerCase()==
"hidden")return null;else{if(tagName=="select"||tagName=="applet"||tagName=="object")return node}else if(node.nodeType==3)if(node.data.trim().length==0)return null;else return node;if(tagName=="table"){for(var i=0;i<node.rows.length;i++)if(node.rows[i].style.display!="none")for(var j=0;j<node.rows[i].cells.length;j++)for(var k=0;k<node.rows[i].cells[j].childNodes.length;k++){var elem=FindElem(node.rows[i].cells[j].childNodes[k]);if(elem!==null)return elem}return null}else{for(var i=0;i<node.childNodes.length;i++){var elem=
FindElem(node.childNodes[i]);if(elem!==null)return elem}return node}};var content=FindElem(content);if(content&&content.parentNode){var space=document.createElement("span");if(field.firstChild)space=field.insertBefore(space,field.firstChild);else space=field.appendChild(space);space.appendChild(document.createTextNode("\ufeff"));fieldY=D2L.Util.Dom.FindPosY(space);fieldMid=Math.round((fieldY+(fieldY+space.offsetHeight))/2);var space2=document.createElement("span");space2=content.parentNode.insertBefore(space2,
content);space2.appendChild(document.createTextNode("\ufeff"));contentY=D2L.Util.Dom.FindPosY(space2);contentMid=Math.round((contentY+(contentY+space2.offsetHeight))/2);if(contentMid>fieldMid){var cellTopPadding=(contentMid-fieldMid)/Global.Preferences.FontSize+0.3;field.style.paddingTop=cellTopPadding+"em";if(field.parentNode&&(D2L.Util.Dom.HasClassName("D2LIFS",field.parentNode)||D2L.Util.Dom.HasClassName("D2LIFS_TOP",field.parentNode)))field.d2lLegendPaddingTop=cellTopPadding-0.3}D2L.Util.Dom.Purge(space);
space.parentNode.removeChild(space);space=null;D2L.Util.Dom.Purge(space2);space2.parentNode.removeChild(space2);space2=null}}};
D2L.Control.Field.GetFieldParentText=function(control){var domNode=control.GetDomNode();if(domNode!==null&&domNode.parentNode&&domNode.parentNode.className){var span=null;if(domNode.parentNode.className=="fcl_w")span=domNode.parentNode.previousSibling.firstChild.lastChild;else if(domNode.parentNode.className=="fct_w")span=domNode.parentNode.parentNode.previousSibling.firstChild.firstChild.lastChild;if(span!==null){var text=span.innerHTML;if(text.endsWith(":"))text=text.substr(0,text.length-1);return new D2L.LP.Text.PlainText(text)}}return null};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fieldgroup-track-changes",function(node){var fields=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-tracker",node);for(var i=0;i<fields.length;i++){var childNode=fields[i];if(childNode.ID2LOnChange===undefined)UI.AttachObject(childNode,"ID2LOnChange",new D2L.EventHandler);(function(index){childNode.ID2LOnChange.RegisterMethod(function(evt){if(!evt.hasChangeBeenShown){fields[index].style.backgroundColor="#E6EFF2";evt.hasChangeBeenShown=true}})})(i)}});
D2L.Control.HiddenPropertyGroup=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isModified=false;this.m_infoIsDisplayed=false;this.m_infoText=new D2L.LP.Text.PlainText("");this.m_isFieldGroup=false;this.m_isOpened=true;this.m_openedText=new D2L.LP.Text.PlainText("");this.m_text=new D2L.LP.Text.PlainText("");this.m_header=null;this.m_icon=null;this.m_infoBar=null;this.m_contents=null;this.m_fields=[];this.m_showChanges=true},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,
deserializer);this.m_isOpened=deserializer.GetBoolean();this.m_isFieldGroup=deserializer.GetBoolean();this.m_text=new D2L.LP.Text.PlainText(deserializer.GetMember());this.m_openedText=new D2L.LP.Text.PlainText(deserializer.GetMember());this.m_infoText=new D2L.LP.Text.PlainText(deserializer.GetMember());this.m_infoIsDisplayed=deserializer.GetBoolean();this.m_isModified=deserializer.GetBoolean();this.m_fields=deserializer.GetMember();this.m_showChanges=deserializer.GetBoolean();this.m_icon=UI.GetControl(this.GetMappedId()+
"_icon");if(this.m_isFieldGroup)this.m_header=this.GetDomNode().cells[0].firstChild;else{this.m_header=this.GetDomNode();this.m_contents=this.m_header.nextSibling}this.m_infoBar=this.m_header.childNodes[this.m_header.childNodes.length-1];var me=this;var Attach=function(container){me.AttachObject(container,"ID2LOnExpand",new D2L.EventHandler);container.ID2LOnExpand.Register(me,"Open");if(container.ID2LOnChange===undefined)me.AttachObject(container,"ID2LOnChange",new D2L.EventHandler);container.ID2LOnChange.RegisterMethod(function(){me.m_isModified=
true})};if(!this.m_isFieldGroup)Attach(this.m_contents);else{var rowIndex=this.GetDomNode().rowIndex+1;var row=null;for(var i=0;i<this.m_fields.length;i++){Attach(this.GetDomNode().parentNode.rows[rowIndex]);rowIndex++;if(this.m_fields[i]==D2L.Control.Field.TextLocation.Top){Attach(this.GetDomNode().parentNode.rows[rowIndex]);rowIndex++}}}},Close:function(){if(this.m_isFieldGroup){var rowIndex=this.GetDomNode().rowIndex+1;var row=null;for(var i=0;i<this.m_fields.length;i++){row=this.GetDomNode().parentNode.rows[rowIndex];
row.style.display="none";rowIndex++;if(this.m_fields[i]==D2L.Control.Field.TextLocation.Top){row=this.GetDomNode().parentNode.rows[rowIndex];row.style.display="none";rowIndex++}}}else this.m_contents.style.display="none";this.m_icon.SetImage(new D2L.Images.ImageTerm("Shared.Main.actShow"));this.m_icon.SetText(this.m_text);if(this.m_isModified&&this.m_showChanges)this.m_header.className="D2LModified";if(this.m_infoIsDisplayed)this.ShowInfo();this.m_isOpened=false;var tEvent=new D2L.TransformEvent(this.m_header);
tEvent.Bubble()},GetState:function(serializer,stateType){if(stateType=="showchanges")serializer.AddMember("IsModified",this.m_isModified);else serializer.AddMember("IsOpened",this.m_isOpened)},HideInfo:function(){this.m_infoBar.style.display="none"},IsOpen:function(){return this.m_isOpened},Open:function(){if(this.m_isFieldGroup){var rowIndex=this.GetDomNode().rowIndex+1;var row=null;for(var i=0;i<this.m_fields.length;i++){row=this.GetDomNode().parentNode.rows[rowIndex];row.style.display="table-row";
(new D2L.DisplayVisibleEvent(row)).Bubble();rowIndex++;if(this.m_fields[i]==D2L.Control.Field.TextLocation.Top){row=this.GetDomNode().parentNode.rows[rowIndex];row.style.display="table-row";(new D2L.DisplayVisibleEvent(row)).Bubble();rowIndex++}}}else{this.m_contents.style.display="block";(new D2L.DisplayVisibleEvent(this.m_contents)).Bubble()}this.m_icon.SetImage(new D2L.Images.ImageTerm("Shared.Main.actHide"));this.m_icon.SetText(this.m_openedText);if(this.m_isModified)this.m_header.className="";
if(this.m_infoIsDisplayed)this.HideInfo();this.m_isOpened=true;var tEvent=new D2L.TransformEvent(this.m_header);tEvent.Bubble();D2L.LP.Web.UI.Events.OnVisibilityChange.Trigger(document.body,true)},ShowInfo:function(){this.m_infoBar.style.display="block"},SetInfoIsDisplayed:function(infoIsDisplayed){this.m_infoIsDisplayed=infoIsDisplayed;if(!this.m_isOpened)if(infoIsDisplayed)this.ShowInfo();else this.HideInfo()},Toggle:function(){if(this.IsOpen())this.Close();else this.Open()}});
D2L.Control.MultiFileInput=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.input_id=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_input_id=deserializer.GetMember()},Focus:function(){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(this.input_id);var uploadButtonId=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetUploadButtonId(id);var uploadButton=D2L.LP.Web.UI.Html.Dom.GetElementById(uploadButtonId);
uploadButton.focus()},Children:function(){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(this.input_id);var fileParam=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetParam(id);var files=fileParam.GetFiles();var fileList=[];for(var i=0;i<files.length;i++)if(files[i].GetActionType()=="Add"){var fileWrapper=new Object;fileWrapper.m_fileObj=files[i];fileWrapper.GetFile=function(){return this.m_fileObj};fileList.push(fileWrapper)}return fileList}});
D2L.Control.MultiFileInput.ValidateRequired=function(obj,id){id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var fileParam=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetParam(id);var files=fileParam.GetFiles();for(var i=0;i<files.length;i++)if(files[i].GetActionType()=="Add")return true;return false};
D2L.Control.SingleFileInput=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.input_id=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_input_id=deserializer.GetMember()},Focus:function(){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(this.input_id);var uploadButtonId=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetUploadButtonId(id);var uploadButton=D2L.LP.Web.UI.Html.Dom.GetElementById(uploadButtonId);
uploadButton.focus()}});D2L.Control.SingleFileInput.ValidateRequired=function(obj,id){id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var fileParam=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetParam(id);var files=fileParam.GetFiles();for(var i=0;i<files.length;i++)if(files[i].GetActionType()=="Add")return true;return false};
D2L.Control.FileLink=D2L.Control.extend({Construct:function(file,source){if(file===undefined)file=null;if(source===undefined)source=null;arguments.callee.$.Construct.call(this);this.m_displayInBrowser=false;this.m_iconIsDisplayed=true;this.m_img=null;this.m_link=null;this.m_name="";this.m_navigation="";this.m_size=0;this.m_sizeIsDisplayed=true;this.m_sizeNode=null;this.m_text=new D2L.LP.Text.PlainText("");this.m_fileName="";this.m_textIsOveridden=false;this.m_altIsOveridden=false;this.m_textNode=
null;this.m_textFormat=D2L.Control.TextFormat.Normal;this.m_alt=new D2L.LP.Text.PlainText("");this.m_limitChars=50;this.m_hasLink=true;this.m_source=source;if(file)this.SetFile(file,false)},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);if(!this.GetDomNode()){this.SetDomNode(this.CreateElement("span"));this.GetDomNode().className=this.GetTextFormat()==D2L.Control.TextFormat.Bold?"dfl dfl_b":"dfl"}var parent=this.GetDomNode();if(this.m_hasLink){this.m_link=this.CreateElement("a");
this.GetDomNode().appendChild(this.m_link);parent=this.m_link;var dotIndex=this.m_fileName.lastIndexOf(".");if(dotIndex>-1){var extension=this.m_fileName.substr(dotIndex);if(extension==".d2lresource"||this.m_displayInBrowser)this.m_link.target="_blank"}}if(this.IconIsDisplayed()){this.m_img=this.CreateElement("img");this.m_img.src="/d2l/img/lp/pixel.gif";this.m_img.width=1;this.m_img.height=1;this.m_img.alt="";if(parent.firstChild)parent.insertBefore(this.m_img,parent.firstChild);else parent.appendChild(this.m_img);
if(this.m_fileName.length>0){var me=this;D2L.Files.GetFileTypeInfo(this.m_fileName).Register(function(fileTypeInfo){fileTypeInfo.GetImage().Assign(me.m_img)})}}if(this.m_textNode===null){this.m_textNode=this.CreateElement("span");parent.appendChild(this.m_textNode)}this.SetNavigation(this.m_navigation);this.SetText(this.m_text);this.SetAlt(this.m_alt);if(this.SizeIsDisplayed()){this.m_sizeNode=this.CreateElement("span");this.GetDomNode().appendChild(this.m_sizeNode);this.SetSize(this.m_size)}if(this.m_source!=
null){var sourceSpan=this.CreateElement("span");sourceSpan.className="dfl_s";sourceSpan.style.paddingLeft="19px";sourceSpan.appendChild(this.CreateTextNode(new D2L.LP.Text.LangTerm("Framework.FileSelector.lblSource")));var trimmedSource=this.m_source;if(trimmedSource.length>60)trimmedSource="..."+trimmedSource.substr(trimmedSource.length-60);sourceSpan.appendChild(this.CreateTextNode(trimmedSource));this.AppendChild(sourceSpan);var me=this;setTimeout(function(){if(me.m_img)sourceSpan.style.paddingLeft=
me.m_img.offsetWidth+"px"},0)}},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.SetFile(new D2L.Files.FileInfo(deserializer.GetMember(),deserializer.GetMember(),deserializer.GetMember()),false);var overrideText=deserializer.GetMember();var overrideAlt=deserializer.GetMember();this.m_iconIsDisplayed=deserializer.GetBoolean();this.m_sizeIsDisplayed=deserializer.GetBoolean();this.m_hasLink=deserializer.GetBoolean();this.m_limitChars=deserializer.GetMember();
this.m_textFormat=deserializer.GetMember();if(overrideText.length>0){this.m_textIsOveridden=true;this.m_text=new D2L.LP.Text.PlainText(overrideText)}if(overrideAlt.length>0){this.m_altIsOveridden=true;this.m_alt=new D2L.LP.Text.PlainText(overrideAlt)}var domNode=this.GetDomNode();if(domNode.childNodes.length>0){if(this.m_hasLink){this.m_link=domNode.firstChild;if(this.IconIsDisplayed()){this.m_img=this.m_link.firstChild;this.m_textNode=this.m_link.childNodes[1]}}else if(this.IconIsDisplayed()){this.m_img=
this.IDomNode.firstChild;this.m_textNode=this.IDomNode.childNodes[1]}else this.m_textNode=this.IDomNode.firstChild;if(this.SizeIsDisplayed())this.m_sizeNode=domNode.childNodes[domNode.childNodes.length-1]}},Focus:function(){if(this.m_link)this.m_link.focus()},GetText:function(){return this.m_text},GetTextFormat:function(){return this.m_textFormat},IconIsDisplayed:function(){return this.m_iconIsDisplayed},SetAlt:function(alt){this.m_alt=D2L.LP.Text.IText.Normalize(alt,"D2L.Control.FileLink","SetAlt",
"alt");if(this.m_link!==null){var me=this;this.m_alt.GetText().Register(function(val){me.m_link.title=val})}},SetFile:function(file,buildDom,displayInBrowser){if(buildDom===undefined)buildDom=true;if(buildDom)file=D2L.Serialization.JsonDeserializer.Deserialize(file,D2L.Files.FileInfo);if(displayInBrowser!==undefined)this.m_displayInBrowser=displayInBrowser;this.m_fileName=file.FileName;this.SetNavigation(D2L.Util.GetViewFileUrl(file,this.m_displayInBrowser));this.SetSize(file.Size);if(!this.m_textIsOveridden){this.SetText(new D2L.LP.Text.PlainText(file.FileName));
if(!this.m_altIsOveridden)this.SetAlt(new D2L.LP.Text.LangTerm("Framework.FileSelector.altOpenFile",file.FileName))}else if(!this.m_altIsOveridden)this.SetAlt(new D2L.LP.Text.LangTerm("Framework.FileSelector.altOpenFile",this.m_text));if(buildDom){this.m_hasDomBeenBuilt=false;this.BuildDom()}else if(this.IconIsDisplayed()&&this.m_fileName.length>0&&this.m_img!==null){var me=this;D2L.Files.GetFileTypeInfo(this.m_fileName).Register(function(fileTypeInfo){fileTypeInfo.GetImage().Assign(me.m_img)})}},
SetNavigation:function(navigation){this.m_navigation=navigation;if(this.m_link)this.m_link.href=navigation},SetSize:function(size){if(this.SizeIsDisplayed()){this.m_size=size;if(this.m_sizeNode){if(this.m_sizeNode.firstChild){D2L.Util.Dom.Purge(this.m_sizeNode.firstChild);this.m_sizeNode.removeChild(this.m_sizeNode.firstChild)}this.m_sizeNode.appendChild(this.CreateTextNode(new D2L.LP.Text.SmlText(" ([0])",Culture.FormatFileSize(this.m_size))))}}},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,
"D2L.Control.FileLink","SetText","text");if(this.m_textNode){if(this.m_textNode.firstChild){D2L.Util.Dom.Purge(this.m_textNode.firstChild);this.m_textNode.removeChild(this.m_textNode.firstChild)}var me=this;this.m_text.GetText().Register(function(val){var txt=val;if(me.m_limitChars>0&&val.length>me.m_limitChars)txt=val.substr(0,me.m_limitChars-3)+"...";me.m_textNode.appendChild(me.CreateTextNode(txt))})}},SetTextFormat:function(textFormat){this.m_textFormat=textFormat;if(this.GetDomNode())this.GetDomNode().className=
this.GetTextFormat()==D2L.Control.TextFormat.Bold?"dfl dfl_b":"dfl"},SetSizeIsDisplayed:function(sizeIsDisplayed){this.m_sizeIsDisplayed=sizeIsDisplayed},SizeIsDisplayed:function(){return this.m_sizeIsDisplayed}});D2L.Files.FileLink=D2L.Control.FileLink;
D2L.MakeIFrameFullscreen=function(id){var iframe=document.getElementById(id);document.body.style.overflow="hidden";var paddingNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-page-main-padding",iframe);paddingNode.style.padding="0px";var resize=function(){var viewportHeight=UI.GetWindowHeight(window);var iframeY=D2L.Util.Dom.FindPosY(iframe);var height=viewportHeight-iframeY;iframe.style.height=height+"px"};setTimeout(resize,1E3);UI.OnPageLoad().RegisterMethod(resize);UI.GetWindowEventManager().Resize.RegisterMethod(function(){resize()})};
D2L.TransferFrameClicks=function(frame){var parent=window;try{while(parent!=parent.parent&&parent.D2L!==undefined)parent=parent.parent}catch(e){}var handleClick=function(evt){parent.D2L.LP.Web.UI.Events.OnClick.Trigger(evt)};try{if(frame.contentWindow.D2L!==undefined)frame.contentWindow.D2L.LP.Web.UI.Events.OnClick.AddListener(handleClick);else D2L.LP.Web.UI.Html.Dom.AddEventListener("click",frame.contentWindow.document,handleClick)}catch(e){}};
D2L.Control.Heading=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_text=new D2L.LP.Text.PlainText("");this.m_isInFieldGroup=false;this.m_hasActions=false;this.m_isDisplayed=true;this.m_domHeading=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_isInFieldGroup=deserializer.GetBoolean();this.m_hasActions=deserializer.GetBoolean();this.m_isDisplayed=deserializer.GetBoolean();if(this.m_isInFieldGroup)this.m_domHeading=
this.GetDomNode().cells[0].firstChild;else this.m_domHeading=this.GetDomNode();this.m_text=new D2L.LP.Text.PlainText(this.m_domHeading.innerHTML)},SetIsDisplayed:function(isDisplayed){if(isDisplayed!=this.m_isDisplayed){if(this.IsRendered())if(!isDisplayed)this.GetDomNode().style.display="none";else if(this.m_isInFieldGroup)if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.GetDomNode().style.display="inline";else this.GetDomNode().style.display="table-row";else this.GetDomNode().style.display=
"block";this.m_isDisplayed=isDisplayed}},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Heading","SetText","text");if(this.IsRendered())this.m_text.AssignHtml(this.m_domHeading,"innerHTML",true)}});
D2L.Control.Hidden=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_value=""},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);if(deserializer.HasMember())this.GetDomNode().ID2L=null;this.m_value=this.GetDomNode().value},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.CreateElement("input"));this.GetDomNode().type="hidden";this.GetDomNode().name=this.GetMappedId();
this.GetDomNode().value=this.m_value}},GetMultiEditValue:function(){return this.GetValue()},GetState:function(serializer){serializer.AddMember("Value",this.GetValue())},GetValue:function(){if(this.IsRendered())return this.GetDomNode().value;else return this.m_value},SetValue:function(value){this.m_value=value;if(this.IsRendered())this.GetDomNode().value=value}});
D2L.Control.HtmlEditor=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_mvcId=null;this.m_isInline=null;this.OnTempFileInsert=new D2L.EventHandler},AppendToEnd:function(html){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.AppendHtml(this.m_mvcId,html)},Focus:function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(this.m_mvcId)},GetHtml:function(){var htmlParam=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(this.m_mvcId);if(htmlParam!=null)return htmlParam.GetHtml();
else return""},HasChanged:function(){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.IsDirty(this.m_mvcId)},HasValue:function(){return new D2L.Util.DelayedReturn(this.GetHtml().trim().length>0)},Hide:function(){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(this.m_mvcId,false)},Initialize:function(){var me=this;setTimeout(function(){var onChangeEvent=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetOnChangeEvent(me.m_mvcId);if(onChangeEvent!==undefined)onChangeEvent.AddListener(function(){if(me.HasChanged())UI.GetFormManager().ForceChange(me.GetDomNode())})},
0)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_mvcId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(deserializer.GetMember());this.m_isInline=deserializer.GetBoolean()},IsEmpty:function(){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.IsEmpty(this.m_mvcId)},MoveCursorToStart:function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.MoveToStart(this.m_mvcId)},PasteHtml:function(html){var evt=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(this.m_mvcId,
function(){return evt});evt.Trigger(html)},SetIsDisplayed:function(isDisplayed){if(isDisplayed)this.Show();else this.Hide()},SetHtml:function(html){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetHtml(this.m_mvcId,html)},Show:function(){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(this.m_mvcId,true)},SetSize:function(width,height){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(this.m_mvcId,height,width)}});
D2L.Control.HtmlEditor.Initialize=function(id){var control=UI.GetControl(id);if(control==null)control=UI.GetByName(id);control.Initialize()};D2L.Control.HtmlEditor.ValidateRequired=function(obj,id){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.ValidateRequired(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id))};
D2L.Control.Image=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_text=null;this.m_isEnabled=true;this.m_isDisplayed=true;this.m_onClick=null;this.m_textNode=null;this.m_hasDefaultPadding=true;this.m_img=null;this.m_imgDisabled=null;this.m_imgNode=null;this.m_alt=null;this.m_anchorNode=null;this.m_childSpan=null;this.m_navInfo=null;this.OnMouseOver=new D2L.EventHandler;this.OnMouseOut=new D2L.EventHandler},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);
this.SetDomNode(this.CreateElement("span"));this.m_imgNode=this.CreateElement("img");if(this.HasDefaultPadding())this.m_imgNode.className="di_i";else this.m_imgNode.className="di_in";this.m_imgNode.alt="";if(!this.m_img&&this.m_isEnabled||!this.m_imgDisabled&&!this.m_isEnabled)this.m_imgNode.style.display="none";this.GetDomNode().insertBefore(this.m_imgNode,null);this.SetText(this.m_text);this.SetAlt(this.m_alt);this.SetIsEnabled(this.m_isEnabled);this.SetIsDisplayed(this.m_isDisplayed);this.SetNav(this.m_navInfo);
var me=this;D2L.Control.Image.InstallEvents(this.GetDomNode(),function(){return me})}},BuildAnchorNode:function(){if(!this.m_anchorNode&&this.m_imgNode){var anchor=this.CreateElement("a");if(!this.IsDisplayed())anchor.style.display="none";else anchor.style.display="inline";if(this.m_isEnabled)anchor.className="di_l";else anchor.className="di_l di_l_d";if(this.m_imgNode){this.m_anchorNode=this.m_imgNode.parentNode.insertBefore(anchor,this.m_imgNode);if(this.GetDomNode()==this.m_imgNode)this.SetDomNode(this.m_anchorNode)}if(this.m_imgNode){this.m_anchorNode.parentNode.removeChild(this.m_imgNode);
this.m_anchorNode.insertBefore(this.m_imgNode,null)}if(this.m_textNode){this.m_anchorNode.parentNode.removeChild(this.m_textNode);this.m_anchorNode.insertBefore(this.m_textNode,null)}if(this.m_childSpan){this.m_anchorNode.parentNode.removeChild(this.m_childSpan);this.m_anchorNode.insertBefore(this.m_childSpan,null)}}},BuildTextNode:function(){if(!this.m_textNode&&this.m_imgNode){var textSpan=this.CreateElement("span");if(!this.IsDisplayed())textSpan.style.display="none";else textSpan.style.display=
"inline";if(this.m_isEnabled)textSpan.className="di_t";else textSpan.className="di_t di_t_d";this.m_textNode=this.m_imgNode.parentNode.insertBefore(textSpan,this.m_imgNode.nextSibling)}},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_img=deserializer.GetObjectMin(D2L.Images.Image);this.m_imgDisabled=deserializer.GetObjectMin(D2L.Images.Image);this.m_isDisplayed=deserializer.GetBoolean();var hasChildren=deserializer.GetBoolean();var hasText=
deserializer.GetBoolean();this.m_isEnabled=deserializer.GetBoolean();this.m_href=deserializer.GetMember();this.m_imgNode=this.GetDomNode();if(this.m_href.length>0)this.m_anchorNode=this.m_imgNode.parentNode;if(hasText){this.m_textNode=this.m_imgNode.nextSibling;if(this.m_textNode.textContent)this.m_text=new D2L.LP.Text.PlainText(this.m_textNode.textContent);else this.m_text=new D2L.LP.Text.PlainText(this.m_textNode.innerText)}if(hasChildren){if(this.m_textNode)this.m_childSpan=this.m_textNode.nextSibling;
else this.m_childSpan=this.m_imgNode.nextSibling;this.SetIsDisplayed(this.m_isDisplayed)}this.m_alt=new D2L.LP.Text.PlainText(this.m_imgNode.alt)},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(this.m_imgNode)if(isEnabled){if(this.m_img){this.m_img.Assign(this.m_imgNode);this.m_imgNode.style.display="inline"}if(this.m_textNode)this.m_textNode.className="di_t";if(this.m_anchorNode){this.m_anchorNode.className="di_l";var href=this.GetWindow().document.createAttribute("href");href.value=
this.m_href;this.m_anchorNode.attributes.setNamedItem(href)}}else{if(this.m_imgDisabled){this.m_imgDisabled.Assign(this.m_imgNode);this.m_imgNode.style.display="inline"}if(this.m_textNode)this.m_textNode.className="di_t di_t_d";if(this.m_anchorNode){this.m_anchorNode.className="di_l di_l_d";if(this.m_anchorNode.attributes.getNamedItem("href"))this.m_anchorNode.attributes.removeNamedItem("href")}}},Focus:function(){if(this.m_anchorNode)this.m_anchorNode.focus()},GetImage:function(){return this.m_img},
GetImageDisabled:function(){return this.m_imgDisabled},GetOnClick:function(){if(this.m_navInfo!=null)return this.m_navInfo.GetOnClick();else return null},GetText:function(){return this.m_text},GetAlt:function(){return this.m_alt},HasDefaultPadding:function(){return this.m_hasDefaultPadding},Hide:function(){if(this.IsDisplayed()){this.SetIsDisplayed(false);var e=new D2L.TransformEvent(this.IDomNode);e.Bubble()}},IsEnabled:function(){return this.m_isEnabled},IsDisplayed:function(){return this.m_isDisplayed},
SetHasDefaultPadding:function(val){this.m_hasDefaultPadding=val;if(this.IsRendered()&&this.m_imgNode)if(val)this.m_imgNode.className="di_i";else this.m_imgNode.className="di_in"},SetOnClick:function(onClick){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Image.SetOnClick() is obsolete. "+"Please use SetNav() instead."),true);if(onClick){if(this.m_navInfo==null)this.m_navInfo=new D2L.NavInfo;this.m_navInfo.SetOnClick(onClick);this.SetNav(this.m_navInfo)}},SetNav:function(navInfo){if(navInfo){this.m_navInfo=
navInfo;if(this.IsRendered()){this.BuildAnchorNode();if(this.m_anchorNode){if(this.m_alt){var me=this;this.m_alt.GetText().Register(function(val){if(val.length>0){me.m_anchorNode.title=val;if(me.m_textNode&&UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion==8)me.m_textNode.title=val}})}var navStruct=this.m_navInfo.SetupHrefOnClick(this);this.m_href=navStruct.Href;if(this.m_isEnabled)this.m_anchorNode.href=this.m_href;if(navStruct.Target==null||navStruct.Target==""){if(this.m_anchorNode.attributes.getNamedItem("target"))this.m_anchorNode.attributes.removeNamedItem("target")}else this.m_anchorNode.target=
navStruct.Target;var me=this;if(navStruct.OnClick)this.AttachObject(this.m_anchorNode,"onclick",function(){if(navStruct.OnClick&&me.IsEnabled())return navStruct.OnClick.call()})}}}},SetImage:function(image){if(image){this.m_img=image;if(this.m_imgNode&&this.m_isEnabled){this.m_img.Assign(this.m_imgNode);this.m_imgNode.style.display="inline"}}},SetImageDisabled:function(image){if(image){this.m_imgDisabled=image;if(this.m_imgNode&&!this.m_isEnabled){this.m_imgDisabled.Assign(this.m_imgNode);this.m_imgNode.style.display=
"inline"}}},SetText:function(text){if(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Image","SetText","text");this.BuildTextNode();if(this.m_textNode){var me=this;this.m_text.GetHtml().Register(function(val){if(val.length>0)me.m_textNode.innerHTML=val})}}},SetAlt:function(alt){if(alt){this.m_alt=D2L.LP.Text.IText.Normalize(alt,"D2L.Control.Image","SetAlt","alt");if(this.m_imgNode){var me=this;this.m_alt.GetText().Register(function(val){if(val.length>0){me.m_imgNode.alt=val;me.m_imgNode.title=
val}})}if(this.m_anchorNode){var me=this;this.m_alt.GetText().Register(function(val){if(val.length>0){me.m_anchorNode.title=val;if(me.m_textNode&&UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion==8)me.m_textNode.title=val}})}}},Show:function(){if(!this.IsDisplayed()){this.SetIsDisplayed(true);var e=new D2L.TransformEvent(this.IDomNode);e.Bubble()}},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())if(!isDisplayed){this.IDomNode.style.display="none";if(this.m_anchorNode)this.m_anchorNode.style.display=
"none";if(this.m_textNode)this.m_textNode.style.display="none"}else{this.IDomNode.style.display="inline";if(this.m_anchorNode)this.m_anchorNode.style.display="inline";if(this.m_textNode)this.m_textNode.style.display="inline"}this.m_isDisplayed=isDisplayed}});
D2L.Control.Image.InstallEvents=function(domNode,GetControl){var me=null;UI.AttachObject(domNode,"onmouseover",function(){if(me===null)me=GetControl();me.OnMouseOver.Trigger(me)});UI.AttachObject(domNode,"onmouseout",function(){if(me===null)me=GetControl();me.OnMouseOut.Trigger(me)})};D2L.Image=D2L.Control.Image;D2L.Image.ImageInfo=D2L.Images.ImageInfo;
D2L.Control.ImageLink=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_alt=null;this.m_float=D2L.Style.Float.None;this.m_image=null;this.m_imageHover=null;this.m_isDisplayed=true;this.m_isEnabled=true;this.m_navInfo=null;this.m_isHover=false},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);var anchor=this.SetDomNode(this.GetUI().CreateElement("a"));anchor.className="dil";anchor.appendChild(this.GetUI().CreateElement("img"));
this.RenderAlt();this.RenderImage();this.RenderIsDisplayed();this.RenderFloat();this.RenderNav()},IntegrateControl:function(deserializer){arguments.callee.$.IntegrateControl.call(this);this.m_image=deserializer.GetObject("Image");if(deserializer.HasMember("ImageHover"))this.m_imageHover=deserializer.GetObject("ImageHover");this.m_navInfo=deserializer.GetObject("NavInfo");this.m_isDisplayed=deserializer.GetMember("IsDisplayed",true);this.m_float=deserializer.GetMember("Float",D2L.Style.Float.None)},
Focus:function(){if(this.IsRendered())this.GetDomNode().focus()},GetAlt:function(){return this.m_alt},GetFloat:function(){return this.m_float},GetImage:function(){return this.m_image},GetNav:function(){return this.m_navInfo},GetImageNode:function(){return this.GetDomNode().firstChild},IsDisplayed:function(){return this.m_isDisplayed},RenderAlt:function(){if(this.IsRendered()){if(this.m_alt===null){this.GetUI().GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("ImageLink 'Alt' is required."),
true);return}var imgNode=this.GetImageNode();this.m_alt.AssignText(imgNode,"alt");this.m_alt.AssignText(imgNode,"title")}},RenderFloat:function(){if(this.IsRendered())D2L.Util.Style.ApplyFloat(this.GetDomNode(),this.GetFloat())},RenderImage:function(){if(this.IsRendered())if(!this.m_isHover){if(this.m_image===null){this.GetUI().GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("ImageLink 'Image' is required."),true);return}this.m_image.Assign(this.GetImageNode(),false)}else{if(this.m_imageHover===
null){this.GetUI().GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("ImageLink 'Image' is required."),true);return}this.m_imageHover.Assign(this.GetImageNode(),false)}},RenderIsDisplayed:function(){if(this.IsRendered())this.GetDomNode().style.display=this.IsDisplayed()?"inline":"none"},RenderNav:function(){if(!this.IsRendered())return;if(this.m_navInfo===null){this.GetUI().GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("ImageLink must have a navigation component specified."),
true);return}var anchor=this.GetDomNode();var navStruct=this.m_navInfo.SetupHrefOnClick(this,true);anchor.href=navStruct.Href;if(navStruct.Target==null||navStruct.Target==""){if(anchor.attributes.getNamedItem("target"))anchor.attributes.removeNamedItem("target")}else this.m_anchorNode.target=navStruct.Target;var me=this;if(navStruct.OnClick)this.AttachObject(anchor,"onclick",function(){return navStruct.OnClick.call()});else anchor.onclick=null},SetAlt:function(alt){this.m_alt=alt;this.RenderAlt()},
SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled},SetFloat:function(floatVal){if(floatVal!==this.GetFloat()){this.m_float=floatVal;this.RenderFloat()}},SetImage:function(image){this.m_image=image;if(!this.m_isHover)this.RenderImage()},SetHoverImage:function(image){this.m_imageHover=image;this.RenderImage()},SetIsDisplayed:function(isDisplayed){if(isDisplayed!==this.IsDisplayed()){this.m_isDisplayed=isDisplayed;this.RenderIsDisplayed()}},SetNav:function(navInfo){this.m_navInfo=navInfo;this.RenderNav()}});
D2L.Control.ImageLink.InstallEvents=function(domNode,GetControl){var imgNode=domNode.firstChild;UI.AttachObject(imgNode,"onmouseover",function(){GetControl().m_isHover=true;GetControl().RenderImage()});UI.AttachObject(imgNode,"onmouseout",function(){GetControl().m_isHover=false;GetControl().RenderImage()})};
D2L.Control.ImageViewer=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isDisplayed=true},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_isDisplayed=deserializer.GetBoolean()},IsDisplayed:function(){return this.m_isDisplayed},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().display.display=isDisplayed?"inline":"none";this.m_isDisplayed=isDisplayed}});
D2L.Control.InlineHelp=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isDisplayed=true;this.m_isEnabled=true;this.m_text=new D2L.LP.Text.PlainText;this.m_isInLine=true},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var domNode=this.GetDomNode();this.m_isDisplayed=domNode.style.display!="none";this.m_isEnabled=domNode.className!="dh_sd";this.m_text=new D2L.LP.Text.PlainText(domNode.innerHTML);if(D2L.LP.Web.UI.Html.Dom.HasAttribute(domNode,
"data-isinline"))this.m_isInLine=D2L.LP.Web.UI.Html.Dom.GetAttribute(domNode,"data-isinline")!="false";else this.m_isInLine=domNode.style.display!="block"},GetText:function(){return this.m_text},IsDisplayed:function(){return this.m_isDisplayed},IsEnabled:function(){return this.m_isEnabled},SetIsDisplayed:function(isDisplayed){if(this.IsRendered()){var dis="inline";if(!this.m_isInLine)dis="block";this.GetDomNode().style.display=isDisplayed?dis:"none"}this.m_isDisplayed=isDisplayed},SetIsEnabled:function(isEnabled){this.m_isEnabled=
isEnabled;if(this.IsRendered())if(isEnabled){D2L.LP.Web.UI.Html.Dom.AddClassName("dh_s",this.GetDomNode());D2L.LP.Web.UI.Html.Dom.RemoveClassName("dh_sd",this.GetDomNode())}else{D2L.LP.Web.UI.Html.Dom.AddClassName("dh_sd",this.GetDomNode());D2L.LP.Web.UI.Html.Dom.RemoveClassName("dh_s",this.GetDomNode())}},SetText:function(text){this.m_text=text;if(this.IsRendered())this.m_text.AssignHtml(this.GetDomNode(),"innerHTML")}});
D2L.Control.Label=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isDisplayed=true;this.m_text=new D2L.LP.Text.PlainText},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_isDisplayed=this.GetDomNode().style.display!="none";this.m_text=new D2L.LP.Text.PlainText(this.GetDomNode().innerHTML)},GetText:function(){return this.m_text},IsDisplayed:function(){return this.m_isDisplayed},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().style.display=
isDisplayed?"inline":"none";this.m_isDisplayed=isDisplayed},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Label","SetText","text");if(this.IsRendered())this.m_text.AssignHtml(this.GetDomNode(),"innerHTML")}});
D2L.Control.LargeClassSize=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_viewType=0;this.m_groupTypeId=0;this.m_groupId=0},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_viewType=deserializer.GetMember();this.m_groupTypeId=deserializer.GetMember();this.m_groupId=deserializer.GetMember()},GetInfo:function(){return new D2L.Control.LargeClassSize.Info(this.m_viewType,this.m_groupTypeId,this.m_groupId)}});
D2L.Control.LargeClassSize.Info=D2L.Class.extend({Construct:function(viewType,groupTypeId,groupId){arguments.callee.$.Construct.call(this);this.m_viewType=viewType;this.m_groupTypeId=groupTypeId;this.m_groupId=groupId},GetViewType:function(){return this.m_viewType},GetGroupTypeId:function(){return this.m_groupTypeId},GetGroupId:function(){return this.m_groupId}});D2L.Control.LargeClassSize.ViewType={None:0,Users:1,Groups:2,Sections:3};
D2L.Control.Link=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_alt=new D2L.LP.Text.PlainText;this.m_float=D2L.Style.Float.None;this.m_href="javascript://";this.m_isEnabled=true;this.m_navInfo=new D2L.NavInfo;this.m_spacing=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing);this.m_text=new D2L.LP.Text.PlainText},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.GetUI().CreateElement("a"));this.RenderAlt();
this.RenderText();this.SetNav(this.m_navInfo);this.RenderIsEnabled();this.RenderFloat();this.RenderSpacing()},Focus:function(){try{if(this.IsRendered())this.GetDomNode().focus()}catch(e){}},GetAlt:function(){return this.m_alt},GetFloat:function(){return this.m_float},GetSpacing:function(){return this.m_spacing},GetText:function(){return this.m_text},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var node=this.GetDomNode();this.m_isEnabled=
node.className!="dlk_d";if(!this.m_isEnabled)D2L.Util.Aria.SetAttribute(node,"disabled","true");if(node.title.length>0)this.m_alt=new D2L.LP.Text.PlainText(node.title);if(node.firstChild)this.m_text=new D2L.LP.Text.PlainText(node.firstChild.data);this.m_href=deserializer.GetMember();this.m_float=deserializer.GetMember()},IsEnabled:function(){return this.m_isEnabled},RenderAlt:function(){if(this.IsRendered()){var me=this;this.m_alt.GetText().Register(function(val){if(val.length>0)me.GetDomNode().title=
val})}},RenderFloat:function(){if(this.IsRendered())D2L.Util.Style.ApplyFloat(this.GetDomNode(),this.GetFloat())},RenderIsEnabled:function(){var node=this.GetDomNode();if(!node)return;if(this.IsEnabled()){node.className="";var href=this.GetWindow().document.createAttribute("href");href.value=this.m_href;node.attributes.setNamedItem(href);D2L.Util.Aria.SetAttribute(node,"disabled","false")}else{node.className="dlk_d";if(node.attributes.getNamedItem("href"))node.attributes.removeNamedItem("href");D2L.Util.Aria.SetAttribute(node,
"disabled","true")}},RenderSpacing:function(){if(this.IsRendered())this.GetDomNode().style.margin=this.GetSpacing().ToCss()},RenderText:function(){if(this.IsRendered()){var me=this;this.m_text.GetHtml().Register(function(val){me.GetDomNode().innerHTML="";var span=UI.CreateElement("span");span.innerHTML=val;me.GetDomNode().appendChild(span);if(me.m_alt&&UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion==8)me.m_alt.GetText().Register(function(val){if(span&&val.length>
0)span.title=val})})}},SetAlt:function(alt){this.m_alt=D2L.LP.Text.IText.Normalize(alt,"D2L.Control.Link","SetAlt","alt");this.RenderAlt()},SetFloat:function(floatVal){if(floatVal!==this.GetFloat()){this.m_float=floatVal;this.RenderFloat()}},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())if(isDisplayed)this.GetDomNode().style.display="inline";else this.GetDomNode().style.display="none"},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;this.RenderIsEnabled()},SetNav:function(navInfo){if(!navInfo)return;
this.m_navInfo=navInfo;if(!this.IsRendered())return;var navStruct=this.m_navInfo.SetupHrefOnClick(this);this.m_href=navStruct.Href;if(this.IsEnabled())this.GetDomNode().href=this.m_href;if(navStruct.Target==null||navStruct.Target==""){if(this.GetDomNode().attributes.getNamedItem("target"))this.GetDomNode().attributes.removeNamedItem("target")}else this.GetDomNode().target=navStruct.Target;var me=this;this.AttachObject(this.GetDomNode(),"onclick",function(evt){D2L.Util.Dom.CancelBubble(evt);if(navStruct.OnClick&&
me.IsEnabled())return navStruct.OnClick.call()})},SetOnClick:function(onClick){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText("Link.SetOnClick() is obsolete. Please "+"use SetNav() instead."),true);if(onClick){this.m_navInfo.SetOnClick(onClick);this.SetNav(this.m_navInfo)}},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.Link","SetText","text");this.RenderText()}});D2L.Link=D2L.Control.Link;
D2L.Control.List=D2L.Control.extend({Construct:function(bulletType){arguments.callee.$.Construct.call(this);this.m_altLess=new D2L.LP.Text.PlainText;this.m_altMore=new D2L.LP.Text.PlainText;this.m_bulletType=bulletType;this.m_delimiter="";this.m_threshold=-1;this.m_isExpanded=false;this.m_lineHeight=1;this.m_objectName="";this.m_numItems=0;this.m_hasThreshold=false;this.m_isOnDemand=false;this.m_moreCountIsDisplayed=true;this.m_onDemandHasLessLink=false;this.m_onDemandTotalItemsCount=-1;this.m_moreLink=
null;this.m_lessLink=null;this.m_onDemandCallback=null;this.m_onDemandJsCallbackObjectJs=null;this.m_isOnDemandLoaded=false;this.m_onDemandReturnsAll=null;this.m_onDemandOrigNumItems=null},AddItem:function(item){this.AppendChild(item)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_bulletType=deserializer.GetMember();this.m_delimiter=deserializer.GetMember();this.m_objectName=deserializer.GetMember();this.m_threshold=deserializer.GetMember();
this.m_hasThreshold=this.m_threshold>=0;var onDemandCallbackName=deserializer.GetMember();this.m_onDemandHasLessLink=deserializer.GetBoolean();this.m_onDemandReturnsAll=deserializer.GetBoolean();this.m_onDemandTotalItemsCount=deserializer.GetMember();var onDemandJsCallbackObjectJsName=deserializer.GetMember();this.m_moreCountIsDisplayed=deserializer.GetBoolean();this.m_altLess=new D2L.LP.Text.PlainText(deserializer.GetMember());this.m_altMore=new D2L.LP.Text.PlainText(deserializer.GetMember());if(onDemandJsCallbackObjectJsName.length>
0)this.m_onDemandJsCallbackObjectJs=eval(onDemandJsCallbackObjectJsName);if(onDemandCallbackName.length>0)if(this.m_onDemandJsCallbackObjectJs)this.m_onDemandCallback=this.m_onDemandJsCallbackObjectJs[onDemandCallbackName];else this.m_onDemandCallback=this.GetWindow()[onDemandCallbackName];if(this.m_onDemandCallback!==null&&this.m_onDemandCallback!==undefined)this.m_isOnDemand=true;if(this.GetDomNode().childNodes.length==1&&this.GetDomNode().childNodes[0].className=="no_disp")this.GetDomNode().removeChild(this.GetDomNode().childNodes[0]);
this.m_numItems=this.GetDomNode().childNodes.length;if(this.m_hasThreshold||this.m_isOnDemand){this.m_numItems=this.m_numItems-2;this.m_moreLink=this.GetDomNode().childNodes[this.m_numItems].firstChild;this.m_lessLink=this.GetDomNode().childNodes[this.m_numItems+1].firstChild}for(var i=0;i<this.GetDomNode().childNodes.length;i++){var child=new D2L.Control.ListItem;child.IntegrateChild(this,this.GetDomNode().childNodes[i])}},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);
var ul=this.GetUI().CreateElement("ul");this.SetDomNode(ul);var className="dl";switch(this.m_bulletType){case D2L.Control.List.BulletTypeOptions.Circle:className+=" dl_ci";break;case D2L.Control.List.BulletTypeOptions.Disc:className+=" dl_di";break;case D2L.Control.List.BulletTypeOptions.Square:className+=" dl_sq";break;case D2L.Control.List.BulletTypeOptions.None:className+=" dl_no";break;case D2L.Control.List.BulletTypeOptions.Flat:defaultSpacing="1em,0em,1em,0em";className+=" dl_fl";break}ul.className=
className},AppendChild:function(child){if(this.m_hasThreshold||this.m_isOnDemand)child=arguments.callee.$.InsertBefore.call(this,child,this.Children()[this.m_numItems]);else child=arguments.callee.$.InsertBefore.call(this,child);this.m_numItems++;var delimSpan=this.CreateElement("span");if(this.m_hasThreshold&&this.m_numItems>this.m_threshold||this.m_isOnDemand&&this.m_onDemandHasLessLink)delimSpan.style.display="";else delimSpan.style.display="none";var marker="&lrm;";if(Culture.IsRightToLeft())marker=
"&rlm;";var TextNode=this.CreateTextNode(this.m_delimiter);delimSpan.innerHTML=marker;delimSpan.appendChild(TextNode);child.GetDomNode().appendChild(delimSpan);if(this.m_numItems-2>=0){var element=this.GetDomNode().childNodes[this.m_numItems-2];var spanElement=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(element);spanElement.style.display=""}if(this.m_hasThreshold)if(this.IsExpanded()){if(this.m_numItems>this.m_threshold)this.m_lessLink.parentNode.style.display="";this.UpdateLessLink()}else if(this.m_numItems>
this.m_threshold){child.GetDomNode().style.display="none";this.m_moreLink.parentNode.style.display="";this.UpdateMoreLink()}return child},Collapse:function(){if(!this.m_isExpanded||!this.m_isOnDemand&&!this.m_hasThreshold)return;this.m_isExpanded=false;var visibleNum=this.m_hasThreshold?this.m_threshold:this.m_onDemandOrigNumItems;for(var i=0;i<this.m_numItems;i++)if(i<visibleNum)this.GetDomNode().childNodes[i].style.display="";else this.GetDomNode().childNodes[i].style.display="none";this.m_moreLink.parentNode.style.display=
"";this.m_lessLink.parentNode.style.display="none";this.UpdateMoreLink()},Expand:function(){if(this.m_isExpanded||!this.m_isOnDemand&&!this.m_hasThreshold)return;this.m_isExpanded=true;var me=this;var image=this.CreateElement("img");D2L.LP.Text.LangTerm.AssignText("Standard.Misc.txtLoading",image,"title");D2L.LP.Text.LangTerm.AssignText("Standard.Misc.txtLoading",image,"alt");var UpdateItemsVisibility=function(){for(var i=0;i<me.m_numItems;i++)me.GetDomNode().childNodes[i].style.display="";me.m_moreLink.parentNode.style.display=
"none";if(me.m_hasThreshold||me.m_onDemandHasLessLink){me.m_lessLink.parentNode.style.display="";me.UpdateLessLink()}};if(this.m_hasThreshold||this.m_isOnDemandLoaded){UpdateItemsVisibility();return}var loadingImageInfo=new D2L.Images.ImageInfo("/d2l/img/lp/loading.gif",16,16);loadingImageInfo.Assign(image);this.m_moreLink.parentNode.appendChild(image);this.m_moreLink.style.display="none";this.m_onDemandOrigNumItems=this.m_numItems;var onDemandCallbackDL;if(this.m_onDemandJsCallbackObjectJs)onDemandCallbackDL=
this.m_onDemandCallback.call(this.m_onDemandJsCallbackObjectJs,this);else onDemandCallbackDL=this.m_onDemandCallback.call(this,this);onDemandCallbackDL.Register(function(result){me.m_isOnDemandLoaded=true;me.m_moreLink.style.display="";me.m_moreLink.parentNode.removeChild(image);if(result){if(me.m_onDemandReturnsAll)me.RemoveAll();me.AppendChildren(result)}UpdateItemsVisibility()})},GetBulletType:function(){return this.m_bulletType},IsExpanded:function(){return this.m_isExpanded},RemoveAll:function(){for(var i=
this.m_numItems-1;i>=0;i--)this.RemoveChild(this.Children()[i]);if(this.m_moreLink!=null)this.m_moreLink.parentNode.style.display="none";if(this.m_lessLink!=null)this.m_lessLink.parentNode.style.display="none";this.m_numItems=0},RenderLineHeight:function(){if(this.IsRendered())this.GetDomNode().style.lineHeight=this.m_lineHeight+"em"},SetLineHeight:function(lineHeight){this.m_lineHeight=lineHeight;this.RenderLineHeight()},UpdateMoreLink:function(){if(!this.m_isOnDemand&&!this.m_hasThreshold)return;
var numObjects;if(this.m_onDemandTotalItemsCount>=0)if(this.m_isOnDemandLoaded)numObjects=this.m_numItems-this.m_onDemandOrigNumItems;else numObjects=this.m_onDemandTotalItemsCount-this.m_numItems;else numObjects=this.m_numItems-this.m_threshold;var moreText;if(this.m_moreCountIsDisplayed&&(this.m_onDemandTotalItemsCount>=0||this.m_hasThreshold))moreText=new D2L.LP.Text.LangTerm("Framework.List.lblMore",numObjects);else moreText=new D2L.LP.Text.LangTerm("Framework.List.lblMoreNoNumber");moreText.AssignText(this.m_moreLink,
"innerHTML",true);this.m_altMore.AssignText(this.m_moreLink,"title",false)},UpdateLessLink:function(){if(this.m_hasThreshold||this.m_isOnDemand&&this.m_lessLink)this.m_altLess.AssignText(this.m_lessLink,"title",false)}});D2L.Control.List.BulletTypeOptions={None:1,Flat:2,Circle:3,Disc:4,Square:5,Custom:6};
D2L.Control.ListItem=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_bulletImg=null;this.m_bulletType=D2L.Control.List.BulletTypeOptions.None;this.m_textNode=null;this.m_text=null;var me=this;this.ParentChangeEvent().RegisterMethod(function(parent){me.m_bulletType=parent.GetBulletType();me.SetBulletImage(me.m_bulletImg)})},BuildDom:function(){if(this.m_hasDomBeenBuilt)return;arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.GetUI().CreateElement("li"));
if(this.m_text!==null)this.SetText(this.m_text);if(this.m_bulletImg!==null)this.SetBulletImage(this.m_bulletImg)},GetText:function(){return this.m_text},SetBulletImage:function(image){this.m_bulletImg=image;if(!this.IsRendered()||this.m_bulletImg===null)return;if(this.m_bulletType!==D2L.Control.List.BulletTypeOptions.Flat&&this.m_bulletType!==D2L.Control.List.BulletTypeOptions.Custom)return;var domNode=this.GetDomNode();image.GetSrc().Register(function(src){src="url('"+src+"')";if(this.m_bulletType==
D2L.Control.List.BulletTypeOptions.Custom)domNode.style.listStyleImage=src;else{var width=image.GetWidth();if(width===0)width=16;domNode.style.backgroundImage=src;domNode.style.backgroundRepeat="no-repeat";if(Culture.IsRightToLeft()){domNode.style.backgroundPosition="top right";domNode.style.paddingRight=width+4+"px"}else{domNode.style.backgroundPosition="2px 0px";domNode.style.paddingLeft=width+4+"px"}}})},SetText:function(text){this.m_text=text;if(!this.IsRendered())return;if(this.m_textNode===
null){this.m_textNode=this.GetUI().CreateElement("span");this.GetDomNode().appendChild(this.m_textNode)}this.m_text.AssignHtml(this.m_textNode,"innerHTML")}});
D2L.Control.LongEdit=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_backgroundColor="";this.m_height=-1;this.m_isDisplayed=true;this.m_isEnabled=true;this.m_text=new D2L.LP.Text.PlainText;this.m_title=new D2L.LP.Text.PlainText;this.m_width=-1},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);if(deserializer.HasMember())this.GetDomNode().ID2L=null;this.m_isDisplayed=this.GetDomNode().style.display!="none";
this.m_isEnabled=!this.GetDomNode().disabled;this.m_text=new D2L.LP.Text.PlainText(this.GetDomNode().value);this.m_title=new D2L.LP.Text.PlainText(this.GetDomNode().getAttribute("title"))},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.CreateElement("textarea"));this.GetDomNode().name=this.GetMappedId();this.SetIsDisplayed(this.m_isDisplayed);this.SetText(this.m_text);this.SetTitle(this.m_title);this.SetBackgroundColor(this.m_backgroundColor);
if(this.m_width>0)this.GetDomNode().style.width=this.m_width+"px";if(this.m_height>0)this.GetDomNode().style.height=this.m_height+"px"}},Focus:function(){if(this.IsRendered())this.GetDomNode().focus()},GetMultiEditValue:function(){if(this.IsEnabled()&&this.IsRendered())return this.GetDomNode().value;return""},GetText:function(){if(this.IsRendered())return new D2L.LP.Text.PlainText(this.GetDomNode().value);return this.m_text},GetTextAsString:function(){if(this.IsRendered())return this.GetDomNode().value;
return""},GetTitle:function(){return this.m_title},GetState:function(serializer){if(this.IsRendered())serializer.AddMember("Text",this.GetDomNode().value)},GetValue:function(){return this.GetText().GetText()},GetValueNoDelay:function(){return this.GetTextAsString()},HasValue:function(){var dr=new D2L.Util.DelayedReturn;this.GetText().GetText().Register(function(value){dr.Trigger(value.trim().length>0)});return dr},HasValueNoDelay:function(){return this.GetTextAsString().trim().length>0},IsDisplayed:function(){return this.m_isDisplayed},
IsEnabled:function(){if(this.IsRendered())return!this.GetDomNode().disabled;else return this.m_isEnabled},OpenSpellChecker:function(){var me=this;D2L.Util.SpellChecker.OpenSpellChecker(this.GetTextAsString(),false).Register(function(result){me.SetText(new D2L.LP.Text.PlainText(result))})},SetBackgroundColor:function(color){this.m_backgroundColor=color;if(this.IsRendered())this.GetDomNode().style.backgroundColor=color},SetHeight:function(height){this.m_height=height;if(this.IsRendered())if(height>
0)this.GetDomNode().style.height=height+"px";else this.GetDomNode().style.height="auto"},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().style.display=isDisplayed?"inline":"none";this.m_isDisplayed=isDisplayed},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(this.IsRendered())this.GetDomNode().disabled=!isEnabled},SetText:function(text){this.m_text=text;if(this.IsRendered())this.m_text.AssignText(this.GetDomNode(),"value")},SetTitle:function(title){this.m_title=
title;if(this.IsRendered())this.m_title.AssignText(this.GetDomNode(),"title")},SetWidth:function(width){this.m_width=width;if(this.IsRendered())if(width>0)this.GetDomNode().style.width=width+"px";else this.GetDomNode().style.width="auto"}});
D2L.Control.MessageArea=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_domAriaLog=null;this.m_domStatusContainer=null;this.m_domStatus=null;this.m_domStatusLiveRegion=null;this.m_domStatusText=null;this.m_domError=null;this.m_domErrorList=null;this.m_domErrorBalloons=[];this.m_domWarning=null;this.m_domWarningList=null;this.m_fadeOutsWaiting=0;this.m_oldHeight=0;this.m_hasWarnings=false;this.m_errorDescription=new D2L.LP.Text.LangTerm("Framework.MessageArea.lblErrors");
this.m_numWarnings=0;this.m_renderingDr=new D2L.Util.DelayedReturn(true);this.m_numErrors=0;this.m_mouseOverStatus=false;this.OnHeightChange=new D2L.EventHandler;this.OnRender=new D2L.EventHandler},AddAriaMessage:function(message){var firstTime=this.m_domAriaLog===null;var log=this.GetAriaLog();var doSet=function(){message.AssignText(log,"innerHTML",true)};message.GetPlainText().Register(function(text){if(firstTime)setTimeout(function(){doSet(text)});else doSet(text)})},AddErrorObj:function(error){var control=
null;if(error.m_controlId)control=UI.GetControl(error.m_controlId.ID(),error.m_controlId.SID());this.AddError(error.m_errorText,control)},AddError:function(errorText,control){if(this.m_domError===null)this.BuildDom_Error();var me=this;var item=this.GetUI().CreateElement("li");var HasFocusControl=function(cntl){if(cntl===undefined||cntl===null)return false;if(control.HasFocusControl!==undefined)return control.HasFocusControl();return control.Focus!==undefined};if(HasFocusControl(control)){var subjectStr=
errorText.GetSubject();var subject=new D2L.LP.Text.PlainText(subjectStr);errorText.SetSubject("{tempsubject}");if(subjectStr.length===0){subject=D2L.Control.Field.GetFieldParentText(control);if(subject===null)subject=new D2L.LP.Text.LangTerm("Framework.Validation.DefaultSubject")}var a=this.CreateElement("a");a.href="javascript://";this.AttachObject(a,"onclick",function(){control.Focus()});item.appendChild(a);D2L.Util.DelayedReturn.RegisterAll(errorText.GetHtml(),subject.GetHtml(),function(html,subjectText){a.innerHTML=
html.replace("{tempsubject}",D2L.Util.Html.Encode(subjectText));me.m_domErrorList.appendChild(item);errorText.SetSubject(subjectText);me.AttachBalloon(control,errorText)})}else{errorText.GetText().Register(function(text){item.appendChild(me.CreateTextNode(text))});this.m_domErrorList.appendChild(item);if(control!==undefined&&control!==null)me.AttachBalloon(control,errorText)}this.m_numErrors++;this.OnRender.Trigger()},AddWarningMessage:function(message,doRender){if(!this.m_hasWarnings)return;if(this.m_domWarningList===
null)this.BuildDom_Warning();if(doRender===undefined)doRender=false;var item=this.GetUI().CreateElement("li");message.AssignHtml(item,"innerHTML");this.m_domWarningList.appendChild(item);this.m_numWarnings++;if(doRender){this.RenderWarningLabel();this.RenderHeight()}},AttachBalloon:function(control,failureText){var domNode=control.GetDomNode();if(control.GetValidationBalloonDomNode!==undefined)domNode=control.GetValidationBalloonDomNode();if(domNode===undefined||domNode===null)return;var sibling=
domNode.nextSibling;while(sibling){var nodeType=sibling.nodeType;if(nodeType==1){var tagName=sibling.tagName.toLowerCase();var display=YAHOO.util.Dom.getStyle(sibling,"display");if(display=="block"||display.length===0){domNode=sibling.previousSibling;break}domNode=sibling;if(tagName=="br"&&display=="inline")break}else domNode=sibling;sibling=sibling.nextSibling}if(domNode!==null){var balloon=D2L.Validation.CreateErrorBalloon(failureText);failureText.GetHtml().Register(function(html){if(domNode.nextSibling)domNode.parentNode.insertBefore(balloon,
domNode.nextSibling);else domNode.parentNode.appendChild(balloon)});this.m_domErrorBalloons.push(balloon);control.GetWindow().UI.GetWindowEventManager().Transform.Trigger()}},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.GetUI().CreateElement("div"));this.GetDomNode().id=this.GetMappedId();this.GetDomNode().className="d_ma"},BuildDom_Error:function(){this.m_domError=this.GetUI().CreateElement("div");this.m_domError.className="d_ma_ve d2l-msg-container";
this.m_domError.tabIndex=0;var innerContainer=this.GetUI().CreateElement("div");innerContainer.className="d2l-msg-container-inner";D2L.Util.Aria.SetRole(this.m_domError,"alert");var h=this.GetUI().CreateElement("h2");h.id=this.GetUI().GetUniqueHtmlId();h.className="dsr";h.appendChild(this.GetUI().CreateTextNode(new D2L.LP.Text.LangTerm("Framework.MessageArea.hdrErrors")));innerContainer.appendChild(h);var p=this.GetUI().CreateElement("p");p.className="d_ma_vel";innerContainer.appendChild(p);this.m_domErrorList=
this.GetUI().CreateElement("ul");this.m_domErrorList.className="d_ma_ve_list";innerContainer.appendChild(this.m_domErrorList);this.m_domError.appendChild(innerContainer);this.OnRender.Trigger()},BuildDom_Status:function(){var me=this;this.m_domStatusContainer=this.GetUI().CreateElement("div");this.m_domStatusContainer.className="d_ma_s_c";var container=this.GetUI().CreateElement("div");this.m_domStatus=this.GetUI().CreateElement("div");this.m_domStatus.className="d_ma_s";this.m_domStatus.id=this.GetUI().GetUniqueHtmlId();
D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",this.m_domStatus,function(){me.m_mouseOverStatus=true});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",this.m_domStatus,function(){me.m_mouseOverStatus=false;me.FadeOutStatus()});var close=this.GetUI().CreateElement("img");close.src="/d2l/img/lp/dialog/x.png";D2L.LP.Web.UI.Html.Dom.AddEventListener("click",close,function(){me.m_domStatus.style.bottom="-10000px"});this.m_domStatus.appendChild(close);this.m_domStatusLiveRegion=this.GetUI().CreateElement("div");
this.m_domStatus.appendChild(this.m_domStatusLiveRegion);var img=this.GetUI().CreateElement("img");img.alt="";img.src="/d2l/img/lp/pixel.gif";this.m_domStatusLiveRegion.appendChild(img);container.appendChild(this.m_domStatus);this.m_domStatusContainer.appendChild(container);UI.GetById("d2l_body").appendChild(this.m_domStatusContainer);$container=$(container);$container.attr("role","alert");setTimeout(function(){$container.css("visibility","hidden");$container.css("visibility","visible")},100)},BuildDom_Warning:function(){if(!this.m_hasWarnings)return;
this.m_domWarning=this.GetUI().CreateElement("div");this.m_domWarning.className="d_ma_w d2l-msg-container";var innerContainer=this.GetUI().CreateElement("div");innerContainer.className="d2l-msg-container-inner";var h=this.GetUI().CreateElement("h2");h.className="d_ma_wh";h.innerHTML="Code Warnings";innerContainer.appendChild(h);var p=this.GetUI().CreateElement("p");p.className="d_ma_wl";innerContainer.appendChild(p);var span1=this.GetUI().CreateElement("span");p.appendChild(span1);var span2=this.GetUI().CreateElement("span");
span2.innerHTML='<a href="javascript:UI.GetMessageArea().ExpandWarnings();">Show Warnings</a>'+'<a href="javascript:UI.GetMessageArea().CollapseWarnings();" style="display:none;">Hide Warnings</a>';span2.style.paddingLeft="0.5em";p.appendChild(span2);this.m_domWarningList=this.GetUI().CreateElement("ul");this.m_domWarningList.style.display="none";this.m_domWarningList.className="d_ma_w_list";innerContainer.appendChild(this.m_domWarningList);this.m_domWarning.appendChild(innerContainer);this.RenderWarningLabel()},
ClearErrors:function(doRender){if(this.m_numErrors===0&&this.m_numWarnings===0)return new D2L.Util.DelayedReturn(true);var dr=new D2L.Util.DelayedReturn;for(var i=0;i<this.m_domErrorBalloons.length;i++){D2L.Util.Dom.Purge(this.m_domErrorBalloons[i]);if(this.m_domErrorBalloons[i]&&this.m_domErrorBalloons[i].parentNode)this.m_domErrorBalloons[i].parentNode.removeChild(this.m_domErrorBalloons[i])}this.m_domErrorBalloons=[];if(this.m_domErrorList!==null)while(this.m_domErrorList.childNodes.length>0){D2L.Util.Dom.Purge(this.m_domErrorList.firstChild);
this.m_domErrorList.removeChild(this.m_domErrorList.firstChild)}this.m_numErrors=0;if(doRender)this.RenderHeight().Register(function(){setTimeout(function(){dr.Trigger(true)},200)});else dr.Trigger(true);return dr},CollapseWarnings:function(){if(!this.m_hasWarnings)return;this.m_domWarning.childNodes[0].childNodes[1].childNodes[1].childNodes[0].style.display="inline";this.m_domWarning.childNodes[0].childNodes[1].childNodes[1].childNodes[1].style.display="none";this.m_domWarningList.style.display=
"none";this.RenderHeight()},ExpandWarnings:function(){if(!this.m_hasWarnings)return;this.m_domWarning.childNodes[0].childNodes[1].childNodes[1].childNodes[0].style.display="none";this.m_domWarning.childNodes[0].childNodes[1].childNodes[1].childNodes[1].style.display="inline";this.m_domWarningList.style.display="block";this.RenderHeight()},GetAriaLog:function(){if(this.m_domAriaLog===null){this.m_domAriaLog=this.GetUI().CreateElement("div");this.m_domAriaLog.className="d_ma_al";this.m_domAriaLog.innerHTML=
"<p>initial value</p>";D2L.Util.Aria.SetRole(this.m_domAriaLog,"log");D2L.Util.Aria.SetAttribute(this.m_domAriaLog,"live","assertive");this.GetDomNode().appendChild(this.m_domAriaLog)}return this.m_domAriaLog},GetHeight:function(){if(!this.HasErrors()&&!this.HasWarnings())return 0;var n=this.GetDomNode();n.style.height=this.m_oldHeight+"px";var height=0;if(this.HasErrors())height+=this.m_domError.offsetHeight;if(this.HasWarnings())height+=this.m_domWarning.offsetHeight;return height},HasErrors:function(){return this.m_numErrors>
0},HasWarnings:function(){return this.m_hasWarnings&&this.m_numWarnings>0},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer,false);this.m_hasWarnings=D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled();var parentId=deserializer.GetMember();var siblingId=deserializer.GetMember();var statusType=deserializer.GetMember();var errors=deserializer.GetObjectArray(D2L.Control.MessageArea.Error);var customIcon=deserializer.GetObject();var customMessage=
deserializer.GetObject();if(deserializer.HasMember())this.m_errorDescription=deserializer.GetObject();this.BuildDom();if(errors.length>0)for(var i=0;i<errors.length;i++)this.AddErrorObj(errors[i]);var domNode=this.GetDomNode();if(siblingId==null){var parent=UI.GetById(parentId);if(parent)if(parent.childNodes.length>0)parent.insertBefore(domNode,parent.firstChild);else parent.appendChild(domNode)}else{var sibling=UI.GetById(siblingId);if(sibling)if(sibling.nextSibling)sibling.parentNode.insertBefore(domNode,
sibling.nextSibling);else sibling.parentNode.appendChild(domNode)}if(statusType!==D2L.Control.MessageArea.Status.None)this.SetStatus(statusType);else if(customIcon!==null&&customMessage!==null)this.SetCustomStatus(customIcon,customMessage);else if(this.HasErrors()||this.HasWarnings())this.ShowErrors()},RenderErrorLabel:function(){var me=this;if(this.m_domError.childNodes[0].childNodes[1].firstChild){D2L.Util.Dom.Purge(this.m_domError.childNodes[0].childNodes[1].firstChild);this.m_domError.childNodes[0].childNodes[1].removeChild(this.m_domError.childNodes[0].childNodes[1].firstChild)}this.m_errorDescription.SetReplace(D2L.Util.Integer.Format(this.m_numErrors));
this.m_errorDescription.GetHtml().Register(function(html){me.m_domError.childNodes[0].childNodes[1].innerHTML=html})},RenderWarningLabel:function(){if(!this.HasWarnings())return;if(this.m_domWarning.childNodes[0].childNodes[1].firstChild.firstChild){D2L.Util.Dom.Purge(this.m_domWarning.childNodes[0].childNodes[1].firstChild.firstChild);this.m_domWarning.childNodes[0].childNodes[1].firstChild.removeChild(this.m_domWarning.childNodes[0].childNodes[1].firstChild.firstChild)}if(this.m_numWarnings>1)this.m_domWarning.childNodes[0].childNodes[1].firstChild.innerHTML=
"There are <b>"+D2L.Util.Integer.Format(this.m_domWarningList.childNodes.length)+" code warnings</b> on this page:";else this.m_domWarning.childNodes[0].childNodes[1].firstChild.innerHTML="There is <b>"+D2L.Util.Integer.Format(1)+" code warning</b> on this page:"},RenderHeight:function(setFocus){var me=this;var newDr=new D2L.Util.DelayedReturn;var domNode=this.GetDomNode();this.m_renderingDr.Register(function(){me.m_renderingDr=newDr;if(me.HasErrors()||me.HasWarnings())domNode.className="d_ma d_ma_e";
else domNode.className="d_ma";domNode.style.height=me.m_oldHeight+"px";if(me.m_hasWarnings&&me.m_domWarning!==null)if(me.HasWarnings()){if(me.m_domWarning.parentNode!==domNode)domNode.appendChild(me.m_domWarning)}else if(me.m_domWarning.parentNode===domNode)domNode.removeChild(me.m_domWarning);if(me.m_domError!==null)if(me.HasErrors()){if(me.m_domError.parentNode!==domNode)domNode.appendChild(me.m_domError)}else if(me.m_domError.parentNode===domNode)domNode.removeChild(me.m_domError);var height=me.GetHeight();
if(height!=me.m_oldHeight){me.m_oldHeight=height;if(me.HasErrors()||me.HasWarnings())domNode.style.height="auto";else domNode.style.height="0px";UI.GetWindowEventManager().Transform.Trigger();me.m_renderingDr.Trigger(true);me.OnHeightChange.Trigger();setTimeout(function(){if(setFocus&&me.HasErrors())me.m_domError.focus()})}else me.m_renderingDr.Trigger(true)});return newDr},Reset:function(){var dr=new D2L.Util.DelayedReturn;this.ClearErrors(true).Register(function(){dr.Trigger(true)});return dr},
SetCustomStatus:function(icon,message){this.SetStatusHelper(icon,message)},SetStatus:function(type){if(type==D2L.Control.MessageArea.Status.None)return;var image="";var lang="";switch(type){case D2L.Control.MessageArea.Status.Saved:image="Shared.Main.actSave";lang="Framework.MessageArea.lblStatus1";break;case D2L.Control.MessageArea.Status.Deleted:image="Shared.Main.actDelete";lang="Framework.MessageArea.lblStatus2";break;case D2L.Control.MessageArea.Status.Created:image="Framework.MessageArea.actStatus3";
lang="Framework.MessageArea.lblStatus3";break;case D2L.Control.MessageArea.Status.Reordered:image="Shared.Main.actReorder";lang="Framework.MessageArea.lblStatus4";break;case D2L.Control.MessageArea.Status.Copied:image="Shared.Main.actCopy";lang="Framework.MessageArea.lblStatus5";break;case D2L.Control.MessageArea.Status.Imported:image="Framework.MessageArea.actStatus6";lang="Framework.MessageArea.lblStatus6";break;case D2L.Control.MessageArea.Status.Exported:image="Framework.MessageArea.actStatus7";
lang="Framework.MessageArea.lblStatus7";break;case D2L.Control.MessageArea.Status.Moved:image="Shared.Main.actMoveObject";lang="Framework.MessageArea.lblStatus8";break;case D2L.Control.MessageArea.Status.Added:image="Shared.Main.actAdd";lang="Framework.MessageArea.lblStatus9";break;case D2L.Control.MessageArea.Status.Removed:image="Shared.Main.actRemove";lang="Framework.MessageArea.lblStatus10";break;case D2L.Control.MessageArea.Status.Enrolled:image="Framework.MessageArea.actStatus11";lang="Framework.MessageArea.lblStatus11";
break;case D2L.Control.MessageArea.Status.Unenrolled:image="Framework.MessageArea.actStatus12";lang="Framework.MessageArea.lblStatus12";break;case D2L.Control.MessageArea.Status.Sent:image="Framework.MessageArea.actStatus13";lang="Framework.MessageArea.lblStatus13";break}this.SetStatusHelper(new D2L.Images.ImageTerm(image),new D2L.LP.Text.LangTerm(lang))},SetStatusHelper:function(icon,message){if(!this.IsRendered())return;if(this.m_domStatus===null)this.BuildDom_Status();icon.Assign(this.m_domStatusLiveRegion.firstChild,
false);var me=this;if(this.m_domStatusText!==null)this.m_domStatusLiveRegion.removeChild(this.m_domStatusText);message.GetText().Register(function(text){setTimeout(function(){me.m_domStatusText=me.GetUI().CreateTextNode(text);me.m_domStatusLiveRegion.appendChild(me.m_domStatusText);var width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(me.m_domStatusLiveRegion).width;me.m_domStatusContainer.style.width=width+"px";me.ShowStatus()})})},SetMessages:function(messages){var me=this;this.Reset().Register(function(){if(messages.HasErrors()){me.m_errorDescription=
messages.m_errorDescription;for(var i=0;i<messages.m_errors.length;i++)me.AddErrorObj(messages.m_errors[i]);me.ShowErrors()}else if(messages.HasCustomStatus())me.SetCustomStatus(messages.GetCustomIcon(),messages.GetCustomMessage());else me.SetStatus(messages.GetStatusType())})},ShowStatus:function(){if(this.GetUI().GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.m_domStatus.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)";else this.m_domStatus.style.opacity="0";this.m_domStatus.style.bottom=
"1em";var anim=new YAHOO.util.Anim(this.m_domStatus.id,{opacity:{to:1}},0.3,YAHOO.util.Easing.easeInStrong);anim.animate();this.FadeOutStatus()},FadeOutStatus:function(){var me=this;var RestoreOpacity=function(){if(me.GetUI().GetBrowserInfo().Type==D2L.UI.BrowserType.IE)me.m_domStatus.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";else me.m_domStatus.style.opacity="1"};this.m_fadeOutsWaiting++;setTimeout(function(){if(me.m_fadeOutsWaiting>1){me.m_fadeOutsWaiting--;return}var anim=
new YAHOO.util.Anim(me.m_domStatus.id,{opacity:{to:0}},D2L.Control.MessageArea.FADE_OUT_DURATION,YAHOO.util.Easing.easeInStrong);anim.onTween.subscribe(function(){if(me.m_mouseOverStatus){anim.stop();setTimeout(RestoreOpacity)}else if(me.m_fadeOutsWaiting>1)anim.stop()});anim.onComplete.subscribe(function(){me.m_fadeOutsWaiting--;if(!me.m_mouseOverStatus&&me.m_fadeOutsWaiting==0)me.m_domStatus.style.bottom="-10000px"});anim.animate()},D2L.Control.MessageArea.WAIT_DURATION)},ShowErrors:function(){if(this.m_numErrors===
0)return new D2L.Util.DelayedReturn(true);this.RenderErrorLabel();return this.RenderHeight(true)}});D2L.Control.MessageArea.FADE_OUT_DURATION=2;D2L.Control.MessageArea.FADE_IN_DURATION=0.5;D2L.Control.MessageArea.WAIT_DURATION=4E3;
D2L.Control.MessageArea.Error=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_errorText=new D2L.LP.Text.PlainText;this.m_controlId=null},Deserialize:function(deserializer){this.m_errorText=deserializer.GetObject("ErrorText");if(deserializer.HasMember("ControlId"))this.m_controlId=deserializer.GetObject("ControlId",D2L.Control.Id)}});
D2L.Control.MessageArea.Messages=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_customIcon=null;this.m_customMessage=null;this.m_errorDescription=new D2L.LP.Text.LangTerm("Framework.MessageArea.lblErrors");this.m_statusType=D2L.Control.MessageArea.Status.None;this.m_errors=[]},Deserialize:function(deserializer){this.m_statusType=deserializer.GetMember("StatusType");if(deserializer.HasMember("CustomIcon")&&deserializer.HasMember("CustomMessage")){this.m_customIcon=
deserializer.GetObject("CustomIcon");this.m_customMessage=deserializer.GetObject("CustomMessage")}if(deserializer.HasMember("ErrorDescription"))this.m_errorDescription=deserializer.GetObject("ErrorDescription",D2L.LP.Text.IText);this.m_errors=deserializer.GetObjectArray("Errors",D2L.Control.MessageArea.Error)},GetCustomIcon:function(){return this.m_customIcon},GetCustomMessage:function(){return this.m_customMessage},GetStatusType:function(){return this.m_statusType},HasCustomStatus:function(){return this.m_customIcon!==
null},HasErrors:function(){return this.m_errors.length>0}});D2L.Control.MessageArea.Status={None:0,Saved:1,Deleted:2,Created:3,Reordered:4,Copied:5,Imported:6,Exported:7,Moved:8,Added:9,Removed:10,Enrolled:11,Unenrolled:12,Sent:13};D2L.LP.Web.UI.Common={Controls:{MessageArea:{Init:function(){}}}};
D2L.Control.MenuBar=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_clearFloat=null;this.m_hasBorderTop=true;this.m_hasBorderRight=true;this.m_hasBorderBottom=true;this.m_hasBorderLeft=true;this.m_isDisplayed=true;this.m_padding=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding,D2L.Style.Spacing.UnitType.Pixel,2);this.m_spacing=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing,D2L.Style.Spacing.UnitType.Pixel,0)},BuildDom:function(){if(this.IsRendered())return;
arguments.callee.$.BuildDom.call(this);var domNode=this.SetDomNode(this.GetUI().CreateElement("div"));domNode.className="dmb";this.IChildrenDomNode=this.GetUI().CreateElement("div");domNode.appendChild(this.IChildrenDomNode);this.m_clearFloat=new D2L.Control.ClearFloat;this.m_clearFloat.AppendTo(domNode);this.RenderIsDisplayed();this.RenderPadding();this.RenderSpacing();this.InstallEvents()},GetPadding:function(){return this.m_padding},GetSpacing:function(){return this.m_spacing},HasBorderTop:function(){return this.m_hasBorderTop},
HasBorderRight:function(){return this.m_hasBorderRight},HasBorderBottom:function(){return this.m_hasBorderBottom},HasBorderLeft:function(){return this.m_hasBorderLeft},IntegrateControl:function(deserializer){arguments.callee.$.IntegrateControl.call(this,deserializer);this.IChildrenDomNode=this.GetDomNode().firstChild;this.m_hasBorderTop=deserializer.GetMember("HasBorderTop",true);this.m_hasBorderRight=deserializer.GetMember("HasBorderRight",true);this.m_hasBorderBottom=deserializer.GetMember("HasBorderBottom",
true);this.m_hasBorderLeft=deserializer.GetMember("HasBorderLeft",true);this.m_isDisplayed=deserializer.GetMember("IsDisplayed",true);if(deserializer.HasMember("Padding"))this.m_padding=deserializer.GetObject("Padding");if(deserializer.HasMember("Spacing"))this.m_spacing=deserializer.GetObject("Spacing");this.InstallEvents()},InstallEvents:function(){var me=this;this.m_spacing.OnChange().RegisterMethod(function(){me.RenderSpacing()});this.m_padding.OnChange().RegisterMethod(function(){me.RenderPadding()})},
IsDisplayed:function(){return this.m_isDisplayed},RenderBorder:function(direction,hasBorder){if(this.IsRendered()){var value=hasBorder?"solid":"none";this.GetDomNode().style["border"+direction+"Style"]=value}},RenderIsDisplayed:function(){if(this.IsRendered())this.GetDomNode().style.display=this.IsDisplayed()?"block":"none"},RenderPadding:function(){if(this.IsRendered())this.GetDomNode().style.padding=this.GetPadding().ToCss()},RenderSpacing:function(){if(this.IsRendered())this.GetDomNode().style.margin=
this.GetSpacing().ToCss()},SetHasBorderTop:function(hasBorderTop){this.m_hasBorderTop=hasBorderTop;this.RenderBorder("Top",hasBorderTop)},SetHasBorderRight:function(hasBorderRight){this.m_hasBorderRight=hasBorderRight;this.RenderBorder("Right",hasBorderRight)},SetHasBorderBottom:function(hasBorderBottom){this.m_hasBorderBottom=hasBorderBottom;this.RenderBorder("Bottom",hasBorderBottom)},SetHasBorderLeft:function(hasBorderLeft){this.m_hasBorderLeft=hasBorderLeft;this.RenderBorder("Left",hasBorderLeft)},
SetIsDisplayed:function(isDisplayed){this.m_isDisplayed=isDisplayed;this.RenderIsDisplayed()}});
D2L.Nav=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_params=null;this.OnBeforeNavigate=new D2L.EventHandler;this.OnNavigate=new D2L.EventHandler;this.OnNavigationFailure=new D2L.EventHandler},Go:function(navInfo,skipValidation,skipHandlers){var result=true;if(!skipHandlers&&(navInfo.target=="_self"||navInfo.target=="_parent"||navInfo.target===""||navInfo.action=="RPC")){result=this.OnBeforeNavigate.Trigger(navInfo);if(!result)this.OnNavigationFailure.Trigger(navInfo)}if(result)if(navInfo.IsAction())this.GoAction(navInfo,
skipValidation);else{if(navInfo.target=="_self"||navInfo.target=="_parent"||navInfo.target===""||navInfo.action=="RPC"){result=this.OnNavigate.Trigger(navInfo);if(!result)this.OnNavigationFailure.Trigger(navInfo);else navInfo.OnNavigate.Trigger(navInfo)}if(result)if(navInfo.IsReload())this.GoSelf(navInfo);else this.GoTo(navInfo)}},GoRpc:function(rpc,rpcPage,ni){var PostCallback=function(rpcResponse){if(rpcResponse.GetResponseType()==D2L.Rpc.ResponseType.Success)if(ni)Nav.Go(ni)};D2L.Rpc.CreatePost(rpc,
PostCallback,rpcPage).Call()},SetAnchor:function(anchor){if(window.location.hash==anchor||window.location.hash=="#"+anchor)window.location.hash="d2l";window.location.hash=anchor},GetAnchor:function(){var ret=window.location.href.split("#")[1];if(!ret)ret="";return ret},GetParam:function(name){if(!this.m_params)this.m_params=this.GetParamArray();if(this.m_params[name])return this.m_params[name];else return null},Reload:function(navParams,skipHandlers){var n=new D2L.NavInfo;if(navParams)for(var paramName in navParams.m_params)n.SetParam(paramName,
navParams.m_params[paramName]);this.Go(n,true,skipHandlers)},SubmitAction:function(action,actionParam,navParams){var n=new D2L.NavInfo;if(!action){alert("action is required for the Nav.SubmitAction function");return}n.action=action;if(actionParam)n.actionParam=actionParam;if(navParams)for(var paramName in navParams.m_params)n.SetParam(paramName,navParams.m_params[paramName]);this.Go(n)},GetWindow:function(target){try{if(!target||target===""||target=="_self")return window;else if(target=="_parent")return window.parent;
else if(target=="_top")return window.top;else if(target=="_blank")return null;else return D2L.Util.Html.FindFrame(target,window)}catch(e){return null}},GetParamArray:function(){var params=new Object;var qs=window.location.href.split("?")[1];if(qs)qs=qs.split("#")[0];else qs="";var currName,currVal;if(qs.length>0){var qsArr=qs.split("&");var len=qsArr.length;for(var x=0;x<len;x++){currName=qsArr[x].split("=")[0];currVal=qsArr[x].split("=")[1];if(currName){if(!currVal)currVal="";currName=D2L.Util.Url.Decode(currName);
currVal=D2L.Util.Url.Decode(currVal);params[currName]=currVal}}}return params},GoTo:function(navInfo){var href=navInfo.GetHref();this.GoHelper(href,navInfo.target)},GoSelf:function(navInfo){UI.GetStateManager().SetSaveStateOnUnload(false);UI.GetStateManager().AddStateToNavInfo(navInfo);var change=this.GetParam("d2l_change");var newChange="0";if(change)if(change=="0")newChange="1";else newChange="0";else newChange="0";navInfo.SetParam("d2l_change",newChange);var href=navInfo.GetHref();this.GoHelper(href,
navInfo.target)},GoUrl:function(href){this.GoHelper(href,"_self")},GoHelper:function(href,target){if(href.length<2E3){var win=this.GetWindow(target);if(win)win.location.href=href;else if(target=="_blank")window.open(href);else window.open(href,target)}else{var body=document.getElementById("d2l_body");var frm=document.createElement("form");body.appendChild(frm);var url=href.split("?")[0].split("#")[0];var qs=href.split("?")[1];if(!qs)qs="";var anchor=href.split("#")[1];if(!anchor)anchor="";var pairs=
qs.split("&");var i;var newUrl=url;var firstTime=true;for(i=0;i<pairs.length;i++){var currPair=pairs[i];if(!currPair)currPair="";var currName=currPair.split("=")[0];if(!currName)currName="";var currVal=currPair.split("=")[1];if(!currVal)currVal="";if(currName.substring(0,9)=="d2l_state"){var input=document.createElement("input");input.type="hidden";input.name=D2L.Util.Url.Decode(currName);input.value=D2L.Util.Url.Decode(currVal);frm.appendChild(input)}else{if(firstTime){newUrl+="?";firstTime=false}else newUrl+=
"&";newUrl=newUrl+currName+"="+currVal}}if(anchor.length>0)newUrl=newUrl+"#"+anchor;var xsrfTokenInput=document.createElement("input");xsrfTokenInput.type="hidden";xsrfTokenInput.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();xsrfTokenInput.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();frm.appendChild(xsrfTokenInput);frm.method="post";frm.action=newUrl;frm.target=target;frm.submit()}},GoAction:function(navInfo,skipValidation,skipBeforeNavigateEvent){if(skipValidation===undefined)skipValidation=
false;if(skipBeforeNavigateEvent===undefined)skipBeforeNavigateEvent=false;var me=this;var DoNavigation=function(){if(UI.form.target=="_self"||navInfo.target=="_parent"||UI.form.target===""||navInfo.action=="RPC")if(!me.OnNavigate.Trigger(navInfo))return;UI.GetByName("d2l_action").value=UI.form.d2l_submitted?"":navInfo.action;UI.GetByName("d2l_actionparam").value=navInfo.actionParam;if(navInfo.GetParam("d2l_rf")!==undefined)UI.GetByName("d2l_rf").value=navInfo.GetParam("d2l_rf");UI.form.action=navInfo.GetHref();
if(navInfo.target&&navInfo.target.length>0)UI.form.target=navInfo.target;if(navInfo.IsAction())UI.GetMultiEditManager().AddMultiEditToForm();if(!navInfo.IgnoreState()){UI.GetStateManager().SetSaveStateOnUnload(false);UI.GetStateManager().AddStateToForm()}UI.GetControlMap().AddControlMapToForm();var goesToLegacyPage=UI.form.action.indexOf("/d2l/tools/")>=0;if(goesToLegacyPage){var hasFileInput=false;var arrElements=UI.form.elements;var currElemLength=arrElements.length;var currElem;for(var i=0;i<currElemLength;i++){currElem=
arrElements[i];if(currElem.name&&currElem.type&&currElem.name=="input"&&currElem.type=="file"){hasFileInput=true;break}}if(!hasFileInput&&!navInfo.doMultipartSubmission){UI.form.enctype="application/x-www-form-urlencoded";UI.form.encoding="application/x-www-form-urlencoded"}}var xsrfTokenParameterName=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();UI.GetByName(xsrfTokenParameterName).value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();UI.form.method="post";UI.GenerateHitCode();if((UI.GetBrowserInfo().Type==
D2L.UI.BrowserType.Safari||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Chrome)&&UI.GetBodyType()!=D2L.UI.BodyType.Normal)setTimeout(function(){UI.form.submit()});else UI.form.submit();if(UI.form.target=="_self"||UI.form.target==="")UI.form.d2l_submitted=true};if(!skipValidation)UI.GetValidationManager().Validate(["Action","Action"+navInfo.action]).Register(function(success){if(success)DoNavigation();else me.OnNavigationFailure.Trigger(navInfo)});else DoNavigation()},GetNavigation:function(){var ret=
window.location.href.split("?")[0];if(!ret)ret="";ret=ret.split("#")[0];if(ret.indexOf("/d2l/")>=0)ret=ret.substring(ret.indexOf("/d2l/"),ret.length);return ret},OpenWindow:function(name,navigation,width,height,hasMenubar,hasScrollbars,hasToolbar,hasLocation){if(width===undefined)width=640;if(height===undefined)height=480;if(hasMenubar===undefined)hasMenubar=true;if(hasScrollbars===undefined)hasScrollbars=true;if(hasToolbar===undefined)hasToolbar=true;if(hasLocation===undefined)hasLocation=true;name=
name.replace(".","_");var features="width="+width+",height="+height+","+"location="+(hasLocation?"1":"0")+","+"menubar="+(hasMenubar?"1":"0")+","+"resizable=1,"+"scrollbars="+(hasScrollbars?"1":"0")+","+"status=0,"+"toolbar="+(hasToolbar?"1":"0");var w=window.open(navigation,name,features);w.focus()}});
D2L.NavInfo=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.action="none";this.actionParam="";this.anchor="";this.doSmartScroll=false;this.navigation=Nav.GetNavigation();this.target="_self";this.m_params={};this.m_ignoreState=false;this.m_ignoreCurrentQueryParamsOnReload=false;this.m_event="";this.m_eventParams="";this.m_statusIsSet=false;this.m_forceSaveConfirmation=false;this.m_isNavigationSet=false;this.m_onClick=null;this.OnNavigate=new D2L.EventHandler},ForceSaveConfirmation:function(){this.m_forceSaveConfirmation=
true},GetAction:function(){return this.action},GetActionParam:function(){return this.actionParam},GetAnchor:function(){return this.anchor},GetHref:function(){var isAction=this.IsAction();var newParams;var currName;var currVal;var navigation=this.navigation;var params=new Object;var anchor=this.anchor;for(var n in this.m_params)params[n]=this.m_params[n];if(!anchor||anchor.length===0){anchor=navigation.split("#")[1];if(!anchor)anchor=""}navigation=navigation.split("#")[0];if(navigation.indexOf("?")>
0){var navQs=navigation.split("?")[1];navigation=navigation.split("?")[0];var navQsArr=navQs.split("&");for(var i=0;i<navQsArr.length;i++){var nameValArr=navQsArr[i].split("=");currName=D2L.Util.Url.Decode(nameValArr[0]);if(nameValArr.length==2)currVal=D2L.Util.Url.Decode(nameValArr[1]);else currVal=undefined;if(currName&&!params[currName])params[currName]=currVal}}if(this.IsReload()&&!this.m_ignoreCurrentQueryParamsOnReload){newParams=Nav.GetParamArray();for(currName in params)newParams[currName]=
params[currName];var scrollx,scrolly;if(this.doSmartScroll){scrollx=UI.GetScrollLeft();scrolly=UI.GetScrollTop()}else{scrollx=null;scrolly=null}newParams["d2l_scrollx"]=scrollx;newParams["d2l_scrolly"]=scrolly;if(!this.m_statusIsSet)newParams["dst"]=null}else{newParams=params;if(!this.IsExternal()&&this.GetTarget().toLowerCase()!="_top"&&this.GetTarget().toLowerCase()!="_blank"){var oldParams=Nav.GetParamArray();if(oldParams["d2l_body_type"])newParams["d2l_body_type"]=oldParams["d2l_body_type"]}}if(!newParams["ou"]&&
!this.IsExternal())if(Nav.GetParam("ou"))newParams["ou"]=Nav.GetParam("ou");else newParams["ou"]=Global.OrgUnitId;var qs="";var amp="";for(currName in newParams)if(newParams[currName]!==null)if(D2L.Util.JavaScript.IsArray(newParams[currName]))for(var i=0;i<newParams[currName].length;i++){qs+=amp+D2L.Util.Url.Encode(currName)+"="+D2L.Util.Url.Encode(newParams[currName][i]);amp="&"}else{qs+=amp+D2L.Util.Url.Encode(currName);if(newParams[currName]!==undefined)qs+="="+D2L.Util.Url.Encode(newParams[currName]);
amp="&"}var ret=navigation;if(qs.length>0)ret+="?"+qs;if(anchor.length>0)ret+="#"+D2L.Util.Url.Encode(anchor);return ret},GetNavigation:function(){return this.navigation},GetOnClick:function(){return this.m_onClick},GetEventParams:function(){return this.m_eventParams},GetEvent:function(){return this.m_event},GetParam:function(name){return this.m_params[name]},GetTarget:function(){return this.target},HasSmartScroll:function(){return this.doSmartScroll},IgnoreState:function(){return this.m_ignoreState},
IsAction:function(){return!(this.action.toString().toLowerCase()=="none")},IsEvent:function(){return this.m_event!==""},IsExternal:function(){var hasProtocal=this.navigation.search(new RegExp("^[a-zA-Z]+://","i"))>-1;return hasProtocal},IsReload:function(){return this.navigation.split("#")[0].split("?")[0].toLowerCase()==Nav.GetNavigation().split("#")[0].split("?")[0].toLowerCase()},SetAction:function(action){this.action=action},SetActionParam:function(actionParam){this.actionParam=actionParam},SetAnchor:function(anchor){this.anchor=
anchor},SetEventParams:function(eventParams){this.m_eventParams=eventParams},SetEvent:function(event){this.m_event=event},SetHasSmartScroll:function(doSmartScroll){this.doSmartScroll=doSmartScroll},SetIgnoreCurrentQueryParamsOnReload:function(bool){this.m_ignoreCurrentQueryParamsOnReload=bool},SetIgnoreState:function(ignoreState){this.m_ignoreState=ignoreState},SetMessageAreaStatusType:function(statusType){this.SetParam("dst",statusType);this.m_statusIsSet=true},SetNavigation:function(navigation){if(navigation&&
navigation!=""){if(navigation.toLowerCase()!="self")this.navigation=navigation;this.m_isNavigationSet=true}},SetOnClick:function(onClick){this.m_onClick=onClick},SetParam:function(name,value){if(!name)return;name=name.toString();if(name.length===0)return;if(value===null)value="";if(D2L.Util.JavaScript.IsArray(value))this.m_params[name]=value;else this.m_params[name]=value.toString()},SetTarget:function(target){this.target=target},SetupHrefOnClick:function(control,hasHref){var result=[];var executeHref=
false;if(hasHref===undefined)hasHref=true;result["Href"]=null;result["OnClick"]=null;result["Target"]=null;if(hasHref&&!this.IsAction()&&this.m_isNavigationSet&&!this.IsReload()&&!this.IsEvent()){result["Href"]=this.GetHref();if(this.GetTarget()!="_self"&&this.GetTarget()!=""&&this.GetTarget()!=null)result["Target"]=this.GetTarget();if(result["Href"].length<2E3)executeHref=true;else{executeHref=false;result["Href"]="javascript://"}}else if(hasHref)result["Href"]="javascript://";var me=this;var onClickFunction=
function(){if(me.IsEvent())if(Events!==undefined)Events[me.GetEvent()].Raise(me.GetEventParams());if(me.GetOnClick()!=null)me.GetOnClick().call(control);if(!hasHref||!executeHref){if(me.m_isNavigationSet||me.IsAction())Nav.Go(me);return false}else return true};result["OnClick"]=onClickFunction;return result},Deserialize:function(deserializer){if(deserializer.HasMember("Action"))this.SetAction(deserializer.GetMember("Action"));if(deserializer.HasMember("ActionParam"))this.SetActionParam(deserializer.GetMember("ActionParam"));
if(deserializer.HasMember("Anchor"))this.SetAnchor(deserializer.GetMember("Anchor"));if(deserializer.HasMember("Navigation"))this.SetNavigation(deserializer.GetMember("Navigation"));if(deserializer.HasMember("OnClick")){var onClick=deserializer.GetMember("OnClick");onClick=new Function(onClick);this.SetOnClick(onClick)}this.SetTarget(deserializer.GetMember("Target","_self"));if(deserializer.HasMember("NavParams"))this.m_params=deserializer.GetDictionary("NavParams");if(deserializer.HasMember("Event"))this.SetEvent(deserializer.GetMember("Event"));
if(deserializer.HasMember("EventParams"))this.SetEventParams(deserializer.GetMember("EventParams"))},DeserializeMin:function(deserializer){this.SetAction(deserializer.GetMember());this.SetActionParam(deserializer.GetMember());this.SetAnchor(deserializer.GetMember());this.SetNavigation(deserializer.GetMember());var onClick=deserializer.GetMember();onClick=new Function(onClick);this.SetOnClick(onClick);this.SetTarget(deserializer.GetMember());this.m_params=deserializer.GetDictionaryMin();this.SetEvent(deserializer.GetMember());
this.SetEventParams(deserializer.GetMember())},Serialize:function(serializer){serializer.AddMember("A",this.GetAction());serializer.AddMember("AP",this.GetActionParam());serializer.AddMember("AN",this.GetAnchor());if(this.m_isNavigationSet)serializer.AddMember("N",this.GetNavigation());else serializer.AddMember("N","");var onClick="";if(this.GetOnClick())onClick=this.GetOnClick().toString();if(onClick.substr(0,8)=="function")onClick=onClick.substring(onClick.indexOf("{")+1,onClick.lastIndexOf("}"));
serializer.AddMember("O",onClick);serializer.AddMember("T",this.GetTarget());var data=new D2L.Util.Dictionary;for(i in this.m_params)if(this.m_params)data.Add(i.toString(),this.m_params[i].toString());serializer.AddMember("NP",data);serializer.AddMember("E",this.GetEvent());serializer.AddMember("EP",this.GetEventParams())}});
D2L.NavParams=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_params=new Object},SetParam:function(name,value){if(!name)return;name=name.toString();if(name.length===0)return;if(value===null)value="";this.m_params[name]=value.toString()}});
D2L.UI.AriaController=D2L.Class.extend({Construct:function(ui){arguments.callee.$.Construct.call(this);this.m_ui=ui;if(D2L.Util.Aria.IsEnabled()){var me=this;this.m_ui.OnPageLoad().RegisterMethod(function(){me.OnPageLoad()})}},OnPageLoad:function(){var main=this.m_ui.GetById("d_content");if(main!==null)try{var topWindow=window.top;var topMost=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-main",topWindow.contentDocument);var bodyType=this.m_ui.GetBodyType();if(bodyType==D2L.UI.BodyType.Frame)D2L.Util.Aria.SetRole(main,
"complementary");else if(bodyType!=D2L.UI.BodyType.IFrame&&main.getAttribute("role")===null)if(main==topMost)D2L.Util.Aria.SetRole(main,"main")}catch(e){}var areaToolbars=this.m_ui.GetByClassName("datb_ul");for(var i=0;i<areaToolbars.length;i++)D2L.Util.Aria.SetRole(areaToolbars[i],"navigation");var toolbars=this.m_ui.GetByClassName("dtb_ul");for(var i=0;i<toolbars.length;i++)D2L.Util.Aria.SetRole(toolbars[i],"navigation");var actions=this.m_ui.GetByClassName("d2l-page-action");for(var i=0;i<actions.length;i++)D2L.Util.Aria.SetRole(actions[i],
"navigation")}});
D2L.FormManager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_fileUploads=[];this.hasChanged=false;this.m_uploadIsPrepared=false;this.m_hasSaveConfirmation=false;this.m_hasSaveConfirmationOriginal=false;this.m_formElementDisabled=[];this.m_saveConfirmationDialog=null;this.m_saveConfirmationMethod=null;this.m_skipUploads=false;this.OnChange=new D2L.EventHandler;this.OnChangeReset=new D2L.EventHandler;this.IDomNode=null;Nav.OnNavigate.Register(this,"ShowSaveConfirmation");
Nav.OnNavigate.Register(this,"UploadFilesNav");var me=this;UI.OnPageLoad().RegisterMethod(function(){me.IDomNode=UI.GetById("d2l_form");if(me.IDomNode){me.AttachObject(me.IDomNode,"ID2L",this);me.AttachObject(me.IDomNode,"onsubmit",function(){return false});me.AttachObject(me.IDomNode,"ID2LOnChange",new D2L.EventHandler);me.IDomNode.ID2LOnChange.Register(me,"HandleFormChange");me.AttachObject(me.IDomNode,"ID2LOnTransform",new D2L.EventHandler);me.IDomNode.ID2LOnTransform.Register(me,"HandleTransform")}})},
ForceChange:function(elem){if(elem===undefined||elem===null){this.hasChanged=true;return}if(D2L.Util.IsD2LControl(elem))elem=elem.GetDomNode();WindowEventManager.BubbleChangeEvent(elem,null)},GetSaveConfirmationDialog:function(){if(!this.m_saveConfirmationDialog)this.m_saveConfirmationDialog=new D2L.Dialog.SaveConfirmation;return this.m_saveConfirmationDialog},HandleFormChange:function(event){if(event.hasChangeBeenShown){this.hasChanged=true;this.OnChange.Trigger(event)}},HandleTransform:function(event){WindowEventManager.Transform.Trigger(event)},
HasChanged:function(){return this.hasChanged},ResetChanges:function(){this.hasChanged=false;this.m_hasSaveConfirmation=this.m_hasSaveConfirmationOriginal;this.OnChangeReset.Trigger()},SetHasSaveConfirmation:function(hasSaveConfirmation){this.m_hasSaveConfirmation=hasSaveConfirmation},SetSaveConfirmation:function(methodName){if(methodName.length>0)if(window[methodName])this.m_saveConfirmationMethod=window[methodName];this.m_hasSaveConfirmation=true;this.m_hasSaveConfirmationOriginal=true},ShowSaveConfirmation:function(ni){if(this.m_hasSaveConfirmation&&
this.HasChanged()&&(!ni.IsAction()||ni.m_forceSaveConfirmation)){var formManager=this;var DoNavigation=function(ret){if(ret){formManager.m_hasSaveConfirmation=false;setTimeout(function(){Nav.Go(ni)})}};var DialogCallback=function(response){if(response.GetType()==D2L.Dialog.ResponseType.Positive)if(formManager.m_saveConfirmationMethod){var dr=formManager.m_saveConfirmationMethod();dr.Register(function(ret){if(ret===true)DoNavigation(true)})}else{var PostCallback=function(response){if(response.GetResponseType()==
D2L.Rpc.ResponseType.Success)return true;else return false};var dr=D2L.Rpc.CreatePost("Save",PostCallback).Call();dr.Register(DoNavigation)}else if(response.GetType()==D2L.Dialog.ResponseType.Negative)DoNavigation(true)};var dialog=this.GetSaveConfirmationDialog();dialog.SetCallback(DialogCallback);dialog.Open();return false}return true},RegisterFileUpload:function(fileUpload){this.m_fileUploads.push(fileUpload)},PrepareForUpload:function(delayedReturn){var me=this;if(!this.m_uploadIsPrepared){var formAction=
UI.form.action;var formTarget=UI.form.target;delayedReturn.Register(function(){try{UI.form.action=formAction;UI.form.target=formTarget}catch(e){}for(var x in me.m_formElementDisabled)me.m_formElementDisabled[x].disabled=false;me.m_uploadIsPrepared=false});var iframe=UI.GetById("upload_frame");if(iframe===null)if(document.body.insertAdjacentHTML)document.body.insertAdjacentHTML("beforeEnd","<iframe id='upload_frame' name='upload_frame' style='position:absolute;left:-200px;top:-200px;width:1px;height:1px;'></iframe>");
else{iframe=document.createElement("iframe");iframe.id="upload_frame";iframe.name="upload_frame";iframe.style.position="absolute";iframe.style.left="-200px";iframe.style.top="-200px";iframe.style.width="1px";iframe.style.height="1px";document.body.appendChild(iframe)}UI.form.target="upload_frame";this.m_uploadIsPrepared=true}for(var i=0;i<UI.form.elements.length;i++)if(!UI.form.elements[i].disabled&&UI.form.elements[i].tagName.toLowerCase()!="fieldset"){this.m_formElementDisabled.push(UI.form.elements[i]);
UI.form.elements[i].disabled=true}},UploadFilesNav:function(ni){if(this.m_skipUploads||!ni.IsAction())return true;var numToUpload=0;for(var i=0;i<this.m_fileUploads.length;i++)numToUpload+=this.m_fileUploads[i].GetNumToUpload();if(numToUpload===0)return true;var me=this;this.UploadFiles().Register(function(success){if(success&&ni){me.m_skipUploads=true;Nav.Go(ni);me.m_skipUploads=false}});return false},UploadFiles:function(){var delayedReturn=new D2L.Util.DelayedReturn;var me=this;var FinishUpload=
function(success){delayedReturn.Trigger(success)};if(this.m_fileUploads.length===0)FinishUpload(true);var Upload=function(index){if(index<me.m_fileUploads.length){var uploadReturn=me.m_fileUploads[index].Upload();uploadReturn.Register(function(success){if(success)Upload(++index);else FinishUpload(false)})}else FinishUpload(true)};var totalUploads=0;var PrepareUpload=function(index){if(index<me.m_fileUploads.length){var fi=me.m_fileUploads[index];if(fi.IsEnabled())fi.UploadPrepare().Register(function(numUploads){if(numUploads<
0)FinishUpload(false);else totalUploads+=numUploads;if(index==me.m_fileUploads.length-1)if(totalUploads===0)FinishUpload(true);else{me.PrepareForUpload(delayedReturn);Upload(0)}PrepareUpload(++index)})}};PrepareUpload(0);return delayedReturn}});
D2L.UI.ShimController=D2L.Class.extend({Construct:function(ui){arguments.callee.$.Construct.call(this);this.m_shims=[];this.m_ui=ui;var me=this;ui.OnPageUnload().RegisterMethod(function(){me.ClearShims()})},ClearShim:function(handle){if(handle===undefined||handle===null)return;for(var i=0;i<this.m_shims.length;i++)if(this.m_shims[i]==handle){this.m_shims.splice(i,1);break}for(var i=0;i<handle.shims.length;i++)if(handle.shims[i]!==null)handle.shims[i].SetIsVisible(false)},ClearShims:function(depth){if(depth===
undefined||depth==-1||depth>this.m_shims.length)depth=this.m_shims.length;for(var i=0;i<depth;i++){var shimsData=this.m_shims.pop();for(var j=0;j<shimsData.shims.length;j++)if(shimsData.shims[j]!==null)shimsData.shims[j].SetIsVisible(false)}},ShimWindow:function(w,isTimeBased,isTransparent){var me=this;var shims=[];var TravelDown=function(win){var wFrames=win.document.getElementsByTagName("frame");var iframes=win.document.getElementsByTagName("iframe");var shimFrame=wFrames.length===0;for(var i=0;i<
wFrames.length;i++)try{TravelDown(wFrames[i].contentWindow)}catch(e){}for(var i=0;i<iframes.length;i++){var test=null;try{if(iframes[i].contentWindow!==undefined&&iframes[i].contentWindow.document!=undefined)test=iframes[i].contentWindow.document.location}catch(e){}if(isTransparent||test===null)shims.push(me.AddShim(win,iframes[i],isTimeBased,isTransparent));else if(D2L.LP.Web.UI.Html.Dom.HasClassName("dif",iframes[i])&&(iframes[i].offsetWidth>0||iframes[i].offsetHeight>0)){shimFrame=false;TravelDown(iframes[i].contentWindow)}}if(shimFrame)shims.push(me.AddShim(win,
win.document,isTimeBased,isTransparent))};var w=window;while(w.parent!=w)w=w.parent;TravelDown(w);return shims},AddShim:function(w,domNode,isTimeBased,isTransparent){if(w===undefined)w=window;if(isTimeBased===undefined)isTimeBased=false;if(isTransparent==undefined)isTransparent=false;var ui=this.m_ui;var offset=0;if(ui.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)offset=-1;var shim=null;try{shim=new D2L.Control.Shim(domNode,isTimeBased,ui.GetZIndex());if(isTransparent)shim.SetBackgroundColour("transparent");
shim.SetWindow(w);shim.SetIsVisible(true)}catch(e){}return shim},Shim:function(control,isTimeBased,isTransparent){var shimsData={"control":control,"shims":[]};if(this.m_shims.length===0)shimsData.shims=this.ShimWindow(window,isTimeBased,isTransparent);else if(!isTimeBased){var prevShim=this.m_shims[this.m_shims.length-1];shimsData.shims.push(this.AddShim(window,prevShim.control.GetDomNode(),isTimeBased,isTransparent))}this.m_shims.push(shimsData);if(control)control.IDomNode.style.zIndex=this.m_ui.GetZIndex();
return shimsData}});D2L.UI.BodyType={Normal:0,Frame:1,Dialog:2,IFrame:3,PrimaryFrame:4};D2L.UI.BrowserType={Unknown:0,IE:1,Safari:4,Firefox:6,Chrome:10};
D2L.Control.UserProfileBadge=D2L.Control.extend({Construct:function(userProfileBadgeInfo){arguments.callee.$.Construct.call(this);this.m_cacheBuster="";this.m_isDisplayed=true;this.m_orgId=0;this.m_size=100;this.m_userId=0;this.m_contextUserId=0;this.m_userProfileBadgeInfo=null;if(userProfileBadgeInfo!==undefined)this.m_userProfileBadgeInfo=userProfileBadgeInfo},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.CreateElement("img"));var profilebadgeImage=
this.m_userProfileBadgeInfo.GetProfileBadgeImage();var delayedSrc=profilebadgeImage.GetSrc();var domNode=this.GetDomNode();var me=this;delayedSrc.Register(function(src){domNode.src=src;domNode.style.width=profilebadgeImage.GetWidth()+"px";domNode.style.height=profilebadgeImage.GetHeight()+"px"});this.m_userProfileBadgeInfo.GetProfileBadgeAlternativeText().AssignText(this.GetDomNode(),"alt")},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);
this.m_isDisplayed=this.GetDomNode().style.display!="none";this.m_orgId=deserializer.GetMember();this.m_userId=deserializer.GetMember();this.m_size=deserializer.GetMember();this.m_cacheBuster=deserializer.GetMember();this.m_contextUserId=deserializer.GetMember()},IsDisplayed:function(){return this.m_isDisplayed},SetFile:function(json){var fileInfo=D2L.Serialization.JsonDeserializer.Deserialize(json,D2L.Files.FileInfo);this.GetDomNode().src="/d2l/common/viewprofileimage.d2l?"+"oi="+this.m_orgId+"&ui="+
this.m_userId+"&s="+this.m_size+"&lm="+fileInfo.GetLastModified()+"&v="+this.m_cacheBuster+"&cui="+this.m_contextUserId},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().style.display=isDisplayed?"inline":"none";this.m_isDisplayed=isDisplayed},SetProfileImage:function(profileImage){if(profileImage!==null)this.GetDomNode().src=D2L.Control.Thumbnail.GetViewThumbUrl(profileImage,this.m_size);else{var me=this;var img=new D2L.Images.ImageTerm("Framework.UserProfileBadge.actProfile"+
this.m_size);img.GetSrc().Register(function(src){me.GetDomNode().src=src})}}});
D2L.Control.ProgressBar=D2L.Control.extend({Construct:function(progressId){arguments.callee.$.Construct.call(this);this.m_allowCancel=true;this.m_cancelCallback=null;this.m_domBar=null;this.m_domBarProgress=null;this.m_errorCode=null;this.m_errorMessage=null;this.m_pollInterval=3E3;this.m_progress=0;this.m_progressId=0;this.m_status=D2L.Control.ProgressBar.ProgressStatus.NotStarted;this.m_steps=[];this.m_total=0;this.OnStatusChange=new D2L.EventHandler;if(progressId!==undefined)this.SetProgressId(progressId)},
BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);var me=this;var domNode=this.SetDomNode(this.GetUI().CreateElement("span"));domNode.className="dpb_c";this.m_domBar=this.GetUI().CreateElement("span");this.m_domBar.className="dpb_s";domNode.appendChild(this.m_domBar);this.m_domBarProgress=this.GetUI().CreateElement("img");this.m_domBarProgress.className="dpb_p";this.m_domBarProgress.alt="0%";this.m_domBarProgress.src="/d2l/img/lp/pixel.gif";this.m_domBarProgress.style.display=
"none";this.m_domBar.appendChild(this.m_domBarProgress);this.m_domBarTotal=this.GetUI().CreateElement("img");this.m_domBarTotal.className="dpb_b";this.m_domBarTotal.alt="";this.m_domBarTotal.src="/d2l/img/lp/pixel.gif";this.m_domBar.appendChild(this.m_domBarTotal);this.m_domCancel=this.GetUI().CreateElement("a");this.m_domCancel.href="javascript://";this.AttachObject(this.m_domCancel,"onclick",function(){me.CancelConfirm()});this.m_domCancel.appendChild(this.GetUI().CreateTextNode(new D2L.LP.Text.LangTerm("Framework.ProgressBar.lblCancel")));
this.m_domCancel.className="dpb_merr";this.m_domCancel.style.display="none";domNode.appendChild(this.m_domCancel);this.m_domMessage=this.GetUI().CreateElement("span");this.m_domMessage.className="dpb_merr";this.m_domMessage.style.display="none";domNode.appendChild(this.m_domMessage);this.m_domSteps=this.GetUI().CreateElement("ul");this.m_domSteps.className="dpb_sl";domNode.appendChild(this.m_domSteps);this.Render()},Cancel:function(doRpc){if(doRpc===undefined)doRpc=false;this.SetStatus(D2L.Control.ProgressBar.ProgressStatus.Cancel);
this.Render();if(doRpc&&this.m_progressId>0)D2L.Rpc.Create("Cancel",undefined,"/d2l/common/rpc/progress/progress.d2l").Call(this.m_progressId)},CancelConfirm:function(){if(this.m_cancelCallback===null){this.Cancel(true);return}var me=this;this.m_cancelCallback.call(this.m_cancelCallback,this.m_domCancel).Register(function(proceed){if(proceed)me.Cancel(true)})},Complete:function(){this.SetProgress(this.m_total)},Fail:function(errorCode,errorMessage){if(errorCode===undefined)errorCode=null;if(errorMessage===
undefined||errorMessage.length===0)errorMessage=null;this.m_errorCode=errorCode;this.m_errorMessage=errorMessage;this.SetStatus(D2L.Control.ProgressBar.ProgressStatus.Fail);this.Render()},GetStatus:function(){return this.m_status},GetErrorCode:function(){if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Fail)return this.m_errorCode;return null},GetErrorMessage:function(){if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Fail)return this.m_errorMessage;return null},OnStatusChangeEvent:function(){return this.OnStatusChange},
Render:function(){var className="dpb_c";if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Fail||this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Cancel)className+=" dpb_cd";else if(this.m_progress==this.m_total)className+=" dpb_cc";this.GetDomNode().className=className;this.Render_Cancel();this.Render_Progress();this.Render_Message();this.Render_Steps()},Render_Cancel:function(){if(this.m_domCancel&&this.m_allowCancel)if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.InProgress)this.m_domCancel.style.display=
"inline";else this.m_domCancel.style.display="none"},Render_Progress:function(){if(!this.m_domBar)return;var totalSrc="/d2l/img/lp/pixel.gif";var totalIsDisplayed=true;var progressIsDisplayed=true;var barIsDisplayed=true;if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.InProgress||this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.NotStarted||this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Complete){var percent=0;if(this.m_total>0){var percent=Math.round(this.m_progress/
this.m_total*100);var width=Math.round(percent/100*28)*7;this.GetUI().GetMessageArea().AddAriaMessage(new D2L.LP.Text.PlainText(percent+"%"));this.m_domBarProgress.alt=percent+"%";this.m_domBarProgress.title=percent+"%";this.m_domBarProgress.style.width=width+"px"}else{progressIsDisplayed=false;totalSrc="/d2l/img/lp/progressBar/a.gif"}}this.m_domBarTotal.src=totalSrc;this.m_domBarTotal.style.display=totalIsDisplayed?"inline":"none";this.m_domBarProgress.style.display=progressIsDisplayed?"inline":
"none";this.m_domBar.style.display=barIsDisplayed?"inline":"none"},Render_Message:function(){if(!this.m_domMessage)return;var term=null;if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.NotStarted){term=new D2L.LP.Text.LangTerm("Framework.ProgressBar.lblPleaseWait");this.m_domMessage.style.color="#000000"}else if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Cancel){term=new D2L.LP.Text.LangTerm("Framework.ProgressBar.lblCancelled");this.m_domMessage.style.color="#cc0000"}else if(this.GetStatus()==
D2L.Control.ProgressBar.ProgressStatus.Fail){if(this.m_errorMessage!==null)term=new D2L.LP.Text.LangTerm("Framework.ProgressBar.lblErrorWithMessage",this.m_errorMessage);else term=new D2L.LP.Text.LangTerm("Framework.ProgressBar.lblError");this.m_domMessage.style.color="#cc0000"}else if(this.GetStatus()==D2L.Control.ProgressBar.ProgressStatus.Complete){this.m_domMessage.style.color="#000000";term=new D2L.LP.Text.LangTerm("Framework.ProgressBar.lblComplete")}if(term!==null){this.GetUI().GetMessageArea().AddAriaMessage(term);
term.AssignText(this.m_domMessage,"innerHTML",true);this.m_domMessage.style.display="inline"}else this.m_domMessage.style.display="none"},Render_Steps:function(){if(!this.m_domSteps)return;for(var i=0;i<this.m_steps.length;i++){var step=this.m_steps[i];var created=true;if(this.m_domSteps.childNodes.length<=i){this.m_domSteps.appendChild(this.CreateElement("li"));created=false}var domStep=this.m_domSteps.childNodes[i];var inProgress=domStep.className=="dbp_sip";var className="";if(step.Status==D2L.Control.ProgressBar.ProgressStatus.InProgress){if(!inProgress||
!created)this.GetUI().GetMessageArea().AddAriaMessage(new D2L.LP.Text.PlainText(step.Title));className="dbp_sip"}else if(step.Status==D2L.Control.ProgressBar.ProgressStatus.Complete)className="dbp_sc";domStep.className=className;domStep.innerHTML=step.Title}this.m_domSteps.style.display=this.m_steps.length>0?"block":"none"},SetAllowCancel:function(allowCancel){this.m_allowCancel=allowCancel;this.Render_Cancel()},SetCancelCallback:function(callback){this.m_cancelCallback=callback},SetProgressId:function(progressId){this.m_progressId=
progressId;this.Start()},SetProgress:function(progress){if(progress>=this.m_total)progress=this.m_total;if(progress<0)progress=0;if(progress!=this.m_progress){if(progress==this.m_total)this.SetStatus(D2L.Control.ProgressBar.ProgressStatus.Complete);else if(progress>0)this.SetStatus(D2L.Control.ProgressBar.ProgressStatus.InProgress);this.m_progress=progress;this.Render()}},SetStatus:function(status){if(this.GetStatus()!=status){this.m_status=status;this.OnStatusChange.Trigger(this.m_status)}},Start:function(){var me=
this;var callback=function(response){if(response.GetResponseType()==D2L.Rpc.ResponseType.Success){var pbi=response.GetResult();me.m_total=pbi.Total;me.SetProgress(pbi.Progress);me.m_steps=pbi.Steps;me.Render_Steps();if(pbi.Status==D2L.Control.ProgressBar.ProgressStatus.Cancel)me.Cancel(false);else if(pbi.Status==D2L.Control.ProgressBar.ProgressStatus.Fail)me.Fail(pbi.ErrorCode,pbi.ErrorMessage);else if(pbi.Status==D2L.Control.ProgressBar.ProgressStatus.InProgress||pbi.Status==D2L.Control.ProgressBar.ProgressStatus.NotStarted)if(response.GetDuration()>=
me.m_pollInterval)poll();else setTimeout(poll,me.m_pollInterval-response.GetDuration())}else me.Cancel(false)};var poll=function(){if(me.GetStatus()<D2L.Control.ProgressBar.ProgressStatus.Complete)D2L.Rpc.Create("GetProgressBar",callback,"/d2l/common/rpc/progress/progress.d2l").Call(me.m_progressId)};poll()}});D2L.Control.ProgressBar.ProgressStatus={NotStarted:1,InProgress:2,Complete:3,Fail:4,Cancel:5};
D2L.Control.RadioButton=D2L.Control.extend({Construct:function(group,text,value){arguments.callee.$.Construct.call(this);if(group===undefined)group="";text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.RadioButton","Constructor","text");if(value===undefined)value="";this.m_group=group;this.m_text=text;this.m_value=value;this.m_isEnabled=true;this.m_label=null;this.m_input=null;this.m_isSelected=false;this.m_showText=true;this.m_onClickEvent=new D2L.EventHandler},BuildDom:function(){if(this.IsRendered())return;
arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.GetUI().CreateElement("span"));if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<8)this.m_input=this.GetUI().CreateElement('<input type="radio" name="'+this.m_group+'" />');else{this.m_input=this.GetUI().CreateElement("input");this.m_input.type="radio";this.m_input.name=this.m_group}this.m_input.className="d_rdo";this.m_input.id=this.GetMappedId();this.m_input.value=this.m_value;this.GetDomNode().appendChild(this.m_input);
this.SetIsSelected(this.m_isSelected);this.SetIsEnabled(this.m_isEnabled);this.SetText(this.m_text);this.InstallEvents()},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_showText=deserializer.GetBoolean();this.m_input=this.GetDomNode();this.m_isEnabled=!this.m_input.disabled;if(this.m_showText){this.m_label=this.m_input.nextSibling;this.m_text=new D2L.LP.Text.PlainText(this.m_label.innerHTML)}else{var text=deserializer.GetMember();this.m_text=
new D2L.LP.Text.PlainText(text)}this.m_group=this.m_input.name;this.m_value=this.m_input.value;this.InstallEvents()},GetMultiEditValue:function(){return D2L.Control.RadioButton.GetSelectedValue(this.m_group)},GetState:function(serializer){serializer.AddMember("SelectedVal",D2L.Control.RadioButton.GetSelectedValue(this.m_group))},GetText:function(){return this.m_text},GetValue:function(){return this.m_value},InstallEvents:function(){var me=this;var clickFunc=function(evt){me.OnClickEvent().Trigger(me);
D2L.Util.Dom.CancelBubble(evt)};if(this.m_input.addEventListener)this.m_input.addEventListener("click",clickFunc,false);else if(this.m_input.attachEvent)this.m_input.attachEvent("onclick",clickFunc)},IsEnabled:function(){return this.m_isEnabled},IsSelected:function(){if(this.IsRendered())return this.m_input.checked;else return this.m_isSelected},OnClickEvent:function(){return this.m_onClickEvent},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(this.IsRendered()){if(this.m_label!==null)this.m_label.className=
this.m_isEnabled?"":"d_rdo_d";this.m_input.disabled=!this.m_isEnabled}},SetIsSelected:function(isSelected){this.m_isSelected=isSelected;if(this.IsRendered()){if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<8)this.m_input.defaultChecked=isSelected;this.m_input.checked=isSelected}},SetShowText:function(showText){if(showText!=this.m_showText&&this.IsRendered()){if(this.m_label!==null){D2L.Util.Dom.Purge(this.m_label);this.m_label.parentNode.removeChild(this.m_label);
this.m_label=null}this.m_input.title=""}this.m_showText=showText;this.SetText(this.m_text)},SetText:function(text){this.m_text=text;if(this.IsRendered())if(this.ShowText()){if(this.m_label===null){this.m_label=this.CreateElement("label");this.m_label.htmlFor=this.GetMappedId();this.m_label.className=this.m_isEnabled?"":"d_rdo_d";if(this.m_input.nextSibling)this.m_input.parentNode.insertBefore(this.m_label,this.m_input.nextSibling);else this.m_input.parentNode.appendChild(this.m_label)}while(this.m_label.childNodes.length>
0)this.m_label.removeChild(this.m_label.childNodes[0]);this.m_label.appendChild(this.CreateTextNode(this.m_text))}else this.m_text.AssignText(this.m_input,"title")},SetValue:function(value){this.m_value=value;if(this.IsRendered())this.m_input.value=value},ShowText:function(){return this.m_showText}});
D2L.Control.RadioButton.GetSelectedValue=function(group){var form=UI.GetForm();if(form){var rdoGroup=form[group];if(rdoGroup)if(rdoGroup.length===undefined){if(rdoGroup.checked)return rdoGroup.value}else for(var i=0;i<rdoGroup.length;i++)if(rdoGroup[i].checked)return rdoGroup[i].value}return""};
D2L.Control.RadioButton.SetSelectedValue=function(group,value){var form=UI.GetForm();if(form){var rdoGroup=form[group];if(rdoGroup)if(rdoGroup.length===undefined){if(rdoGroup.value==value)rdoGroup.checked=true}else for(var i=0;i<rdoGroup.length;i++)if(rdoGroup[i].value==value)rdoGroup[i].checked=true}};D2L.Reorder={};
D2L.Reorder.ReorderManager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_groups=[]},DeserializeMin:function(deserializer){this.m_groups=deserializer.GetObjectArrayMin(D2L.Reorder.ReorderManager.ItemGroupData)},Init:function(){for(var i=0;i<this.m_groups.length;i++){var group=UI.GetControl(this.m_groups[i].m_controlId.ID(),this.m_groups[i].m_controlId.SID());if(group){group.m_name=this.m_groups[i].m_name;for(var j=0;j<this.m_groups[i].m_items.length;j++)this.m_groups[i].m_items[j].IntegrateChild(group,
UI.GetById(this.m_groups[i].m_items[j].m_myMappedId));group.Init()}}},GetGroup:function(groupName){groupName=groupName.toLowerCase();for(var i=0;i<this.m_groups.length;i++)if(this.m_groups[i].m_name==groupName)return UI.GetControl(this.m_groups[i].m_controlId.ID(),this.m_groups[i].m_controlId.SID());return null}});
D2L.Reorder.ReorderManager.ItemGroupData=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_controlId=null;this.m_name="";this.m_items=[]},DeserializeMin:function(deserializer){this.m_controlId=deserializer.GetObjectMin(D2L.Control.Id);this.m_name=deserializer.GetMember();this.m_items=deserializer.GetObjectArrayMin(D2L.Control.ReorderItem)}});
D2L.Control.ReorderItemGroup=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_name="";this.m_hasChangedHidden=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer)},Init:function(){var c;for(var i=0;i<this.Children().length;i++){if(i===0){this.m_hasChangedHidden=this.CreateElement("input");this.m_hasChangedHidden.type="hidden";this.m_hasChangedHidden.name=this.m_name+"_hasChanged";this.Children()[i].GetDomNode().parentNode.insertBefore(this.m_hasChangedHidden,
this.Children()[i].GetDomNode())}var child=this.Children()[i];if(child.IsEnabled()){if(child.GetDomNode().remove)child.GetDomNode().remove(0);else;c=-1;for(var j=0;j<this.Children().length;j++)if(i==j||this.Children()[j].IsEnabled()){c++;var option=document.createElement("option");option.appendChild(document.createTextNode(D2L.Util.Integer.Format(j+1)));if(i==j){option.selected=true;child.m_prevSortOrder=j+1}option.value=j+1+"_"+child.GetKey();child.GetDomNode().appendChild(option)}}else{child.GetDomNode().innerHTML=
D2L.Util.Integer.Format(i+1);child.m_hidden.value=i+1+"_"+child.GetKey()}if(this.m_hasChangedHidden.value.length>0)this.m_hasChangedHidden.value+=",";this.m_hasChangedHidden.value+=child.GetKey()}},GetItem:function(key){for(var i=0;i<this.Children().length;i++)if(this.Children()[i].GetKey()==key)return this.Children()[i];return null},Update:function(item,prevSortOrder,sortOrder){var temp;var i=item.m_prevSortOrder-1;var direction=sortOrder>i?1:-1;var offset=0;var j;while(i+1!=sortOrder){offset=0;
j=i+direction;while(j<this.Children().length&&j>-1&&!this.Children()[j].IsEnabled()){offset=offset+direction;j=j+direction}temp=this.Children()[i+direction+offset];this.Children()[i+direction+offset]=item;this.Children()[i]=temp;i=i+direction+offset}for(i=0;i<this.Children().length;i++)if(this.Children()[i].m_prevSortOrder!=i+1){this.Children()[i].m_prevSortOrder=0;this.Children()[i].SetSortOrder(i+1)}}});
D2L.Control.ReorderItem=D2L.Control.extend({Construct:function(key){arguments.callee.$.Construct.call(this);this.m_hidden=null;this.m_isEnabled=true;this.m_key=key;this.m_prevSortOrder=0;this.m_myMappedId=""},DeserializeMin:function(deserializer){this.m_key=deserializer.GetMember();this.m_myMappedId=deserializer.GetMember()},IntegrateChild:function(parent,domNode){arguments.callee.$.IntegrateChild.call(this,parent,domNode);this.m_isEnabled=this.GetDomNode().tagName.toLowerCase()=="select"?!this.GetDomNode().disabled:
false;if(!this.IsEnabled())this.m_hidden=this.GetDomNode().previousSibling;var me=this;this.AttachObject(this.GetDomNode(),"onchange",function(){me.SetSortOrder(parseInt(this.options[this.selectedIndex].value.split("_")[0]))})},GetKey:function(){return this.m_key},GetSortOrder:function(){if(this.IsEnabled())return parseInt(this.GetDomNode().options[this.GetDomNode().selectedIndex].value.split("_")[0]);else return parseInt(this.m_hidden.value.split("_")[0])},IsEnabled:function(){return this.m_isEnabled},
SetSortOrder:function(sortOrder){if(this.IsEnabled())for(var i=0;i<this.GetDomNode().options.length;i++)if(parseInt(this.GetDomNode().options[i].value.split("_")[0])==sortOrder){this.GetDomNode().selectedIndex=i;this.GetDomNode().options[i].value=sortOrder+"_"+this.GetKey();if(this.m_hidden)this.m_hidden.value=sortOrder+"_"+this.GetKey();WindowEventManager.BubbleChangeEvent(this.GetDomNode());if(this.m_prevSortOrder!==0)this.Parent().Update(this,this.m_prevSortOrder,sortOrder);this.m_prevSortOrder=
sortOrder;break}}});
D2L.Control.RichEdit=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this)},Initialize:function(){var me=this;setTimeout(function(){var onChangeEvent=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetOnChangeEvent(me.m_mvcId);if(onChangeEvent)onChangeEvent.AddListener(function(){var hasChanged=me.HasChanged();if(hasChanged){me.m_hasChangedNode.value="1";UI.GetFormManager().ForceChange(me.GetDomNode())}else me.m_hasChangedNode.value="0"})},0)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);
this.m_mvcId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(deserializer.GetMember());this.m_hasChangedNode=D2L.LP.Web.UI.Html.Dom.GetElementById(this.m_mvcId.GetValue()+"_hc")},Disable:function(){},Enable:function(){},Focus:function(){},GetMultiEditValue:function(){return this.GetText()},GetText:function(){var htmlParam=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(this.m_mvcId);if(htmlParam)return htmlParam.GetHtml();else return""},HasChanged:function(){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.IsDirty(this.m_mvcId)},
HasValue:function(){return new D2L.Util.DelayedReturn(this.HasValueNoDelay())},HasValueNoDelay:function(){return this.GetText().trim().length>0},IsEmpty:function(){return this.GetText().length===0},IsEnabled:function(){return true},IsHtml:function(){return true},SetIsEnabled:function(isEnabled){if(isEnabled)this.Enable();else this.Disable()},SetText:function(text){this.m_hasChangedNode.value="1";D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetHtml(this.m_mvcId,text)},ToggleEnabled:function(){if(this.IsEnabled())this.Disable();
else this.Enable()}});D2L.Control.RichEdit.Initialize=function(id){var control=UI.GetControl(id);if(!control)control=UI.GetByName(id);if(control.Initialize)control.Initialize()};D2L.Control.RichEdit.ValidateRequired=function(obj,id){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.ValidateRequired(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id))};
D2L.Control.EditableRichEdit=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this)},Initialize:function(){var evt=D2L.LP.Web.UI.Desktop.Controls.EditInPlace.HtmlEditor.GetEditorLoadedEvent(this.m_mvcId);var me=this;evt.AddListener(function(editorId){var onChangeEvt=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetOnChangeEvent(editorId);var htmlEditor=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId);onChangeEvt.AddListener(function(){if(D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.IsDirty(editorId))UI.GetFormManager().ForceChange(me.GetDomNode())})})},
IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_mvcId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(deserializer.GetMember());this.m_hasChangedNode=D2L.LP.Web.UI.Html.Dom.GetElementById(this.m_mvcId.GetValue()+"_hc")},Disable:function(){},Enable:function(){},Focus:function(){},GetMultiEditValue:function(){return this.GetText()},GetText:function(){var isOpen=D2L.LP.Web.UI.Desktop.Controls.EditInPlace.IsEditorOpen(this.m_mvcId);if(isOpen=="true"){var htmlParam=
D2L.LP.Web.UI.Desktop.Controls.EditInPlace.GetHtmlEditorContent(this.m_mvcId);if(htmlParam)return htmlParam.GetHtml();else return""}else{var htmlObject=D2L.LP.Web.UI.Html.Dom.GetElementById(this.m_mvcId.GetValue()+"_data");var html=htmlObject.value;return html}},HasChanged:function(){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.IsDirty(this.m_mvcId)},HasValue:function(){return new D2L.Util.DelayedReturn(this.HasValueNoDelay())},HasValueNoDelay:function(){return this.GetText().trim().length>0},
IsEmpty:function(){return this.GetText().length===0},IsEnabled:function(){return true},IsHtml:function(){return true},SetIsEnabled:function(isEnabled){if(isEnabled)this.Enable();else this.Disable()},SetText:function(text){this.m_hasChangedNode.value="1";D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetHtml(this.m_mvcId,text)},ToggleEnabled:function(){if(this.IsEnabled())this.Disable();else this.Enable()}});
D2L.Control.EditableRichEdit.Initialize=function(id){var control=UI.GetControl(id);if(!control)control=UI.GetByName(id);if(control.Initialize)control.Initialize()};D2L.Control.EditableRichEdit.ValidateRequired=function(obj,id){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.ValidateRequired(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id))};
D2L.Control.RichText=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_text=new D2L.LP.Text.PlainText;this.m_isHtml=false;this.m_isInline=false;this.m_textDomNode=null},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.CreateElement("div"));this.GetDomNode().className="drt";this.m_textDomNode=this.GetDomNode();this.SetIsInline(this.m_isInline);this.SetText(this.m_text)}},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,
deserializer);this.m_isInline=deserializer.GetBoolean();this.m_isHtml=deserializer.GetBoolean();var domNode=this.GetDomNode();if(domNode.firstChild&&domNode.firstChild.tagName&&domNode.firstChild.tagName.toLowerCase()=="label")this.m_textDomNode=domNode.firstChild;else this.m_textDomNode=domNode;if(this.m_isHtml)this.m_text=new D2L.LP.Text.HtmlText(this.m_textDomNode.innerHTML,false);else this.m_text=new D2L.LP.Text.PlainText(D2L.Util.Html.Decode(this.m_textDomNode.innerHTML))},IsInline:function(){return this.m_isInline},
GetText:function(){return this.m_text},SetIsInline:function(isInline){this.m_isInline=isInline;if(this.IsRendered())this.GetDomNode().style.display=this.m_isInline?"inline":"block"},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.RichText","SetText","text");if(this.IsRendered()){this.m_textDomNode.innerHTML="";this.m_text.AssignHtml(this.m_textDomNode,"innerHTML");D2L.LP.Web.UI.Html.Math.UpdateNode(this.m_textDomNode)}}});
D2L.Control.ShareButton={InstallEvents:function(node){var tweet=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-twitter",node);for(var i=0;i<tweet.length;i++)D2L.LP.Web.UI.Desktop.Controls.TweetButton.Init(tweet[i]);var gplusone=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-gplusone",node);for(var i=0;i<gplusone.length;i++)D2L.LP.Web.UI.Desktop.Controls.GooglePlusOne.Init(gplusone[i])}};
D2L.Control.SelectList=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_float=D2L.Style.Float.None;this.m_isDisplayed=true;this.options=[];this.m_onChange=null;this.m_spacing=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing);this.m_title=null;this.m_hasEnablerTargetItem=false;this.m_containerNode=null;var me=this;this.m_spacing.GetTop().SetUnitType(D2L.Style.Measurement.UnitType.Pixel);this.m_spacing.GetTop().SetValue(2);this.m_spacing.GetBottom().SetUnitType(D2L.Style.Measurement.UnitType.Pixel);
this.m_spacing.GetBottom().SetValue(2);this.m_spacing.OnChange().RegisterMethod(function(){me.RenderSpacing()});this.OnDomInsertion.RegisterMethod(function(){me.WrapInContainer()})},AddOption:function(parentKey,opt){var parentOpt=this.GetOption(parentKey);if(parentOpt)return parentOpt.AppendChild(opt);else return this.AppendChild(opt)},AppendChild:function(opt){return this.InsertBefore(opt,null)},Blur:function(){if(this.GetDomNode())this.GetDomNode().blur()},BuildDom:function(){if(this.IsRendered())return;
arguments.callee.$.BuildDom.call(this);var domNode=this.SetDomNode(this.GetUI().CreateElement("select"));D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select",domNode);if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Safari||UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Chrome)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-sidepad",domNode);domNode.name=this.GetMappedId();var container=this.GetUI().CreateElement("div");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-container",container);this.m_containerNode=
container;this.RenderTitle();this.RenderFloat();this.RenderSpacing();this.AttachObject(domNode,"ID2L",this);for(var i=0;i<this.options.length;i++){this.options[i].BuildDom();if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)domNode.add(this.options[i].GetDomNode());else domNode.add(this.options[i].GetDomNode(),null)}var me=this;D2L.Control.SelectList.InstallEvents(domNode,function(){return me})},ClearOptions:function(){while(this.options.length>0)this.RemoveChild(this.options[this.options.length-
1])},Disable:function(){this.GetDomNode().disabled=true},Enable:function(){this.GetDomNode().disabled=false},Focus:function(){if(this.IsRendered())this.GetDomNode().focus()},GetContainer:function(){return this.m_containerNode},GetFloat:function(){return this.m_float},GetIndex:function(opt){for(var i=0;i<this.GetDomNode().options.length;i++)if(this.GetDomNode().options[i].ID2L==opt)return i;return-1},GetMultiEditValue:function(){return this.GetSelectedValue()},GetOption:function(key){for(var i=0;i<
this.options.length;i++)if(this.options[i].key==key)return this.options[i];return null},GetOptions:function(){return this.options},GetSelectedIndex:function(){return this.GetDomNode().selectedIndex},GetSelectedOption:function(){if(this.GetDomNode().selectedIndex>=0)return this.GetDomNode().options[this.GetDomNode().selectedIndex].ID2L;else return null},GetSelectedKey:function(){var opt=this.GetSelectedOption();if(opt!=null)return this.GetSelectedOption().key;else return null},GetSelectedValue:function(){var opt=
this.GetSelectedOption();if(opt!==null&&opt!==undefined)return opt.val;else return null},GetSpacing:function(){return this.m_spacing},GetState:function(serializer){var selectedOption=this.GetSelectedOption();if(selectedOption){serializer.AddMember("SelectedKey",selectedOption.GetKey());serializer.AddMember("SelectedVal",selectedOption.GetVal())}},GetTitle:function(){return this.m_title},GetValidationDomNode:function(){return this.GetContainer()},Hide:function(){this.SetIsDisplayed(false)},InsertBefore:function(opt,
beforeOpt){if(!opt||opt===undefined||opt===null)return null;if(!beforeOpt||beforeOpt===undefined||beforeOpt===null)beforeOpt=null;this.BuildDom();var index=-1,insertBefore=null;if(beforeOpt){for(var i=0;i<this.m_children.length;i++)if(this.m_children[i]==beforeOpt){index=i;break}if(index!=-1){if(beforeOpt.m_previousSibling){beforeOpt.m_previousSibling.m_nextSibling=opt;opt.m_previousSibling=beforeOpt.m_previousSibling}beforeOpt.m_previousSibling=opt;opt.m_nextSibling=beforeOpt}}if(index!=-1){insertBefore=
beforeOpt;this.m_children.splice(index,0,opt)}else{if(this.m_children.length>0){var optTemp=this.m_children[this.m_children.length-1];optTemp.m_nextSibling=opt;opt.m_previousSibling=optTemp}this.m_children.push(opt)}opt.m_parent=this;opt.m_sl=this;this.InsertHelper(opt,insertBefore);return opt},InsertHelper:function(opt,beforeOpt){if(beforeOpt===undefined||beforeOpt===null){opt.BuildDom();if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.GetDomNode().add(opt.GetDomNode());else this.GetDomNode().add(opt.GetDomNode(),
null);this.options.push(opt)}else{var index=this.GetIndex(beforeOpt);opt.BuildDom();if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.GetDomNode().add(opt.GetDomNode(),index);else this.GetDomNode().add(opt.GetDomNode(),beforeOpt.GetDomNode());this.options.splice(index,0,opt)}},InsertSorted:function(opt){var isGreaterThan=function(opt1,opt2){return opt1.text.toLowerCase()>opt2.text.toLowerCase()};return arguments.callee.$.InsertSorted.call(this,opt,isGreaterThan)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,
deserializer);this.m_containerNode=this.GetDomNode().parentNode;this.m_isDisplayed=this.GetContainer().style.display!=="none";this.SetOnChange(new Function(deserializer.GetMember()));this.m_hasEnablerTargetItem=deserializer.GetBoolean();this.m_float=deserializer.GetMember();var start=deserializer.GetMember();var end=deserializer.GetMember();var interval=deserializer.GetMember();var c=[];if(start>-1&&end>-1)for(var i=start;i<end+1;i=i+interval)c.push(new D2L.Control.SelectOption(i.toString(),i.toString()));
else c=deserializer.GetObjectArrayMin(D2L.Control.SelectOption);for(var i=0;i<c.length;i++){this.options.push(c[i]);c[i].IntegrateChild(this,this.GetDomNode().childNodes[this.options.length-1])}},IsDisplayed:function(){return this.m_isDisplayed},IsEnabled:function(){return!this.GetDomNode().disabled},OnChange:function(event){event=event!==undefined?event:window.event!==undefined?window.event:null;WindowEventManager.BubbleChangeEvent(this.GetDomNode(),event);if(this.m_hasEnablerTargetItem&&this.Enablers)this.Enablers.ResetEnablers();
if(this.m_onChange!==undefined&&this.m_onChange!==null)this.m_onChange.call(this)},RemoveChild:function(opt){if(opt){if(opt.m_parent==this){while(opt.m_children.length>0)opt.RemoveChild(opt.m_children[0]);arguments.callee.$.RemoveChild.call(this,opt);for(var i=0;i<this.options.length;i++)if(this.options[i]==opt){this.options.splice(i,1);break}}else opt.m_parent.RemoveChild(opt);return opt}return null},RenderFloat:function(){if(this.IsRendered())D2L.Util.Style.ApplyFloat(this.GetContainer(),this.GetFloat())},
RenderSpacing:function(){if(this.IsRendered())this.GetDomNode().style.margin=this.GetSpacing().ToCss()},RenderTitle:function(){if(this.IsRendered())if(this.m_title!==null)this.m_title.AssignText(this.GetDomNode(),"title");else this.GetDomNode().removeAttribute("title")},SelectOption:function(opt,triggerChange){if(opt)if(opt.canSelect){var index=this.GetIndex(opt);if(index==-1)return;this.GetDomNode().options.selectedIndex=index;if(triggerChange)this.OnChange()}},SelectOptionByKey:function(key,triggerChange){var opt=
this.GetOption(key);if(opt!==null)this.SelectOption(opt,triggerChange)},SetFloat:function(val){this.m_float=val;this.RenderFloat()},SetIsEnabled:function(isEnabled){if(isEnabled)this.Enable();else this.Disable()},SetTitle:function(title){this.m_title=title===undefined?null:title;this.RenderTitle()},SetIsDisplayed:function(isDisplayed){if(this.IsDisplayed()!=isDisplayed){if(isDisplayed)this.GetContainer().style.display="inline-block";else this.GetContainer().style.display="none";this.m_isDisplayed=
isDisplayed;var transformEvent=new D2L.TransformEvent(this.GetDomNode());transformEvent.Bubble()}},SetOnChange:function(onChange){this.m_onChange=onChange},Show:function(){this.SetIsDisplayed(true)},ToggleEnabled:function(){if(this.IsEnabled())this.Disable();else this.Enable()},WrapInContainer:function(){var selectList=this.GetDomNode();if(selectList&&selectList.parentNode!==this.m_containerNode){selectList.parentNode.insertBefore(this.m_containerNode,selectList);var selectArrow=this.GetUI().CreateElement("div");
D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-arrow",selectArrow);this.m_containerNode.appendChild(selectList);this.m_containerNode.appendChild(selectArrow)}}});D2L.Control.SelectList.InstallEvents=function(domNode,GetControl){UI.AttachObject(domNode,"onchange",function(e){var me=GetControl();me.OnChange.call(me,e)})};D2L.SelectList=D2L.Control.SelectList.extend({Construct:function(name,onChange){arguments.callee.$.Construct.call(this);this.m_onChange=onChange}});
D2L.Control.SelectOption=D2L.Control.extend({Construct:function(key,val,text){arguments.callee.$.Construct.call(this);if(key===undefined)key="";if(val===undefined)val="";if(text===undefined||text===null)text="";else if(text.isString===undefined)text=text.toString();this.canSelect=true;this.depth=0;this.key=key;this.m_depthStr="";this.m_sl=null;this.text=text.stripHtml();this.val=val;this.m_options=[]},AppendChild:function(opt){return this.InsertBefore(opt,null)},BuildDom:function(){if(!this.IsRendered()){arguments.callee.$.BuildDom.call(this);
if(this.canSelect){this.SetDomNode(document.createElement("OPTION"));this.AttachObject(this.IDomNode,"ID2L",this);this.GetDomNode().value=this.val;var depthStr="";for(var i=0;i<this.depth;i++)depthStr+="&nbsp;&nbsp;&nbsp;";if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE){depthStr=depthStr.replace(/&nbsp;/g," ");this.GetDomNode().text=depthStr+this.text}else this.GetDomNode().innerHTML=depthStr+this.text}else{this.SetDomNode(document.createElement("OPTGROUP"));this.AttachObject(this.IDomNode,"ID2L",
this);this.GetDomNode().label=this.text}this.m_depthStr=depthStr}},DeserializeMin:function(deserializer){this.key=deserializer.GetMember();this.val=deserializer.GetMember();this.canSelect=deserializer.GetBoolean();this.m_options=deserializer.GetObjectArrayMin(D2L.Control.SelectOption)},GetDepth:function(){return this.depth},GetKey:function(){return this.key},GetText:function(){return this.text},GetVal:function(){return this.val},InsertBefore:function(opt,beforeOpt){if(!opt||opt===undefined||opt===
null)return null;if(!beforeOpt||beforeOpt===undefined||beforeOpt===null)beforeOpt=null;this.BuildDom();var index=-1,insertBefore=null;if(beforeOpt!==null){for(var i=0;i<this.m_children.length;i++)if(this.m_children[i]==beforeOpt){index=i;break}if(index!=-1){if(beforeOpt.m_previousSibling){beforeOpt.m_previousSibling.m_nextSibling=opt;opt.m_previousSibling=beforeOpt.m_previousSibling}beforeOpt.m_previousSibling=opt;opt.m_nextSibling=beforeOpt}}if(index!=-1){insertBefore=beforeOpt;this.m_children.splice(index,
0,opt)}else{if(this.m_children.length>0){var optTemp=this.m_children[this.m_children.length-1];optTemp.m_nextSibling=opt;opt.m_previousSibling=optTemp}insertBefore=this.m_nextSibling;var temp=this;while(insertBefore===null&&temp.m_parent!==this.m_sl){temp=temp.m_parent;insertBefore=temp.m_nextSibling}this.m_children.push(opt)}opt.depth=this.depth+1;opt.m_parent=this;opt.m_sl=this.m_sl;this.m_sl.InsertHelper(opt,insertBefore);return opt},InsertSorted:function(opt){var isGreaterThan=function(opt1,opt2){return opt1.text.toLowerCase()>
opt2.text.toLowerCase()};return arguments.callee.$.InsertSorted.call(this,opt,isGreaterThan)},IntegrateChild:function(parent,domNode){arguments.callee.$.IntegrateChild.call(this,parent,domNode);this.m_sl=this.GetDomNode().parentNode.ID2L;this.text=this.GetDomNode().innerHTML.toString().stripHtml().replace(/^(&nbsp;)*/,"");if(parent!==this.m_sl)this.depth=parent.depth+1;for(var i=0;i<this.m_options.length;i++){this.m_sl.options.push(this.m_options[i]);this.m_options[i].IntegrateChild(this,this.m_sl.GetDomNode().childNodes[this.m_sl.options.length-
1])}},RemoveChild:function(opt){if(opt&&opt.m_parent==this){while(opt.m_children.length>0)opt.RemoveChild(opt.m_children[0]);arguments.callee.$.RemoveChild.call(this,opt);for(var i=0;i<this.m_sl.options.length;i++)if(this.m_sl.options[i]==opt){this.m_sl.options.splice(i,1);break}return opt}return null},SetText:function(text){this.text=text.stripHtml();if(this.GetDomNode())if(this.canSelect)this.GetDomNode().text=this.m_depthStr+this.text;else this.GetDomNode().label=this.text},SetVal:function(val){this.val=
val;if(this.GetDomNode())this.GetDomNode().value=val}});D2L.SelectOption=D2L.Control.SelectOption;
D2L.Control.Shim=D2L.Control.extend({Construct:function(domScope,isTimeBased,zIndex){if(isTimeBased===undefined)isTimeBased=false;arguments.callee.$.Construct.call(this);this.m_backgroundColour="#333300";this.m_domScope=domScope;this.m_externalObjects=[];this.m_height=0;this.m_isTimeBased=isTimeBased;this.m_opacity=0.5;this.m_posX=0;this.m_posY=0;this.m_width=0;this.m_zIndex=zIndex;if(isTimeBased){this.m_backgroundColour="#ffffff";this.m_opacity=0}},BuildDom:function(){if(this.IsRendered())return;
arguments.callee.$.BuildDom.call(this);var domNode=this.SetDomNode(this.GetWindow().document.createElement("div"));domNode.className="ddial_shim";domNode.style.zIndex=this.m_zIndex;this.RenderOpacity()},GetBackgroundColour:function(){return this.m_backgroundColour},GetHeight:function(){return this.m_height},GetOpacity:function(){return this.m_opacity},GetPosition:function(){return{"x":this.m_posX,"y":this.m_posY}},GetWidth:function(){return this.m_width},RenderBackgroundColour:function(){if(this.IsRendered())this.GetDomNode().style.backgroundColor=
this.GetBackgroundColour()},RenderOpacity:function(){if(!this.IsRendered())return;this.GetDomNode().style.opacity=this.GetOpacity();if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)this.GetDomNode().style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+this.GetOpacity()*100+")"},SetBackgroundColour:function(colour){this.m_backgroundColour=colour;this.RenderBackgroundColour()},SetIsVisible:function(isVisible){if(isVisible){this.SetObjectVisibility(this.m_domScope);this.BuildDom();var me=
this;var body=me.GetWindow().document.getElementsByTagName("body");if(body&&body.length==1){body[0].style.position="relative";body[0].appendChild(me.GetDomNode())}if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion>=8)setTimeout(function(){me.RenderBackgroundColour()},0);else me.RenderBackgroundColour();if(this.m_isTimeBased)setTimeout(function(){me.GetDomNode().className+=" ddial_shim_loading";me.SetBackgroundColour("#d6e1f3");me.SetOpacity(0.3)},500)}else if(this.IsRendered()){for(var n=
0;n<this.m_externalObjects.length;n++)try{this.m_externalObjects[n].style.visibility="visible"}catch(e){}try{this.GetDomNode().parentNode.removeChild(this.GetDomNode())}catch(e){}}},SetObjectVisibility:function(domNode){var tags=["applet","object","embed"];if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE&&UI.GetBrowserInfo().MajorVersion<7)tags.push("select");for(var tagIndex=0;tagIndex<tags.length;tagIndex++){var domNodes=domNode.getElementsByTagName(tags[tagIndex]);for(var n=0;n<domNodes.length;n++){domNodes[n].style.visibility=
"hidden";this.m_externalObjects.push(domNodes[n])}}var iframes=domNode.getElementsByTagName("iframe");for(var m=0;m<iframes.length;m++)try{if(iframes[m].contentWindow)this.SetObjectVisibility(iframes[m].contentWindow.document)}catch(e){}},SetOpacity:function(opacity){this.m_opacity=opacity;this.RenderOpacity()}});D2L.Control.Tabs={};D2L.Control.Tabs.AriaIsEnabled=true;
D2L.Control.Tabs.AriaController=D2L.Class.extend({Construct:function(tabGroup){arguments.callee.$.Construct.call(this);this.m_tabGroup=tabGroup},Init:function(){var me=this;this.m_tabGroup.SelectTabEvent().RegisterMethod(function(tab){D2L.Util.Aria.SetAttribute(tab.m_objL.firstChild,"selected","true");if(me.m_tabGroup.m_isFromTab)tab.m_objL.firstChild.focus()});this.m_tabGroup.UnSelectTabEvent().RegisterMethod(function(tab){D2L.Util.Aria.SetAttribute(tab.m_objL.firstChild,"selected","false")});var header=
this.m_tabGroup.GetDomNode().firstChild;var headerRow=header.firstChild.rows[0];D2L.Util.Aria.SetRole(headerRow,"tablist");for(var i=0;i<headerRow.cells.length;i++){var cell=headerRow.cells[i];D2L.Util.Aria.SetRole(cell,"presentation");if(cell.className=="d_tabs_c"||cell.className=="d_tabs_c_s")D2L.Util.Aria.SetRole(cell.firstChild,"tab")}var container=this.m_tabGroup.GetDomNode().childNodes[1];D2L.Util.Aria.SetRole(container,"tabpanel");D2L.Util.Aria.SetAttribute(container,"expanded","true")}});
D2L.Control.Tab=D2L.Control.extend({Construct:function(text,name,onClick){arguments.callee.$.Construct.call(this);if(name===undefined)name="";if(onClick===undefined)onClick="";this.m_name=name;this.m_text=text;this.m_isSelected=false;this.m_onClick=new Function(onClick);this.m_objL=null;this.m_objC=null;this.m_objR=null;this.m_objLink=null;this.m_paddingTop="1em";this.m_paddingRight="1em";this.m_paddingBottom="1em";this.m_paddingLeft="1em"},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);
if(this.m_name===undefined)this.m_name=this.GetUI().GetUniqueHtmlId();this.SetDomNode(this.GetUI().CreateElement("div"));this.GetDomNode().className="d_tabs_tab";this.IChildrenDomNode=this.GetUI().CreateElement("div");this.IChildrenDomNode.className="d_tabs_tabcontent";this.SetPadding(this.m_paddingTop,this.m_paddingRight,this.m_paddingBottom,this.m_paddingLeft);this.GetDomNode().appendChild(this.IChildrenDomNode)},Click:function(){this.Parent().m_tabToSelect=this;return this.m_onClick.call(this)},
DeserializeMin:function(deserializer){this.m_name=deserializer.GetMember();this.m_text=deserializer.GetMember();this.m_isSelected=deserializer.GetBoolean();this.m_onClick=new Function(deserializer.GetMember())},GetName:function(){return this.m_name},IntegrateChild:function(parent,domNode){arguments.callee.$.IntegrateChild.call(this,parent,domNode);this.m_objL=UI.GetById(parent.GetMappedId()+"_"+this.m_name+"_l");this.m_objLink=this.m_objL.firstChild;this.InstallEvents()},InstallEvents:function(){var me=
this;this.AttachObject(this.m_objL,"onclick",function(){me.Parent().ClickTab(me.GetName())});var onmouseover=function(){if(this.parentNode.className=="d_tabs_c"||this.parentNode.className=="d_tabs_c_o")this.parentNode.className="d_tabs_c_o";else this.parentNode.className="d_tabs_c_s_o"};var onmouseout=function(){if(this.parentNode.className=="d_tabs_c_o"||this.parentNode.className=="d_tabs_c")this.parentNode.className="d_tabs_c";else this.parentNode.className="d_tabs_c_s"};this.AttachObject(this.m_objLink,
"onmouseover",onmouseover);this.AttachObject(this.m_objLink,"onfocus",onmouseover);this.AttachObject(this.m_objLink,"onmouseout",onmouseout);this.AttachObject(this.m_objLink,"onblur",onmouseout);this.AttachObject(this.m_objLink,"onclick",function(){return false})},IsSelected:function(){return this.m_isSelected},SetPadding:function(top,right,bottom,left){this.m_paddingTop=top;this.m_paddingRight=right;this.m_paddingBottom=bottom;this.m_paddingLeft=left;if(this.IsRendered()){this.IChildrenDomNode.style.paddingTop=
this.m_paddingTop;this.IChildrenDomNode.style.paddingRight=this.m_paddingRight;this.IChildrenDomNode.style.paddingBottom=this.m_paddingBottom;this.IChildrenDomNode.style.paddingLeft=this.m_paddingLeft}}});
D2L.Control.TabGroup=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_ariaController=new D2L.Control.Tabs.AriaController(this);this.m_isFromTab=false;this.m_container=null;this.m_hasBorder=true;this.m_selectedTab=null;this.m_selectTabEvent=new D2L.EventHandler;this.m_tabToSelect=null;this.m_unSelectTabEvent=new D2L.EventHandler;this.OnClick=new D2L.EventHandler;var me=this;Nav.OnNavigate.RegisterMethod(function(navInfo){if(me.m_tabToSelect)if(navInfo.action!=
"RPC"){me.m_oldSelectedTab=me.m_selectedTab;me.m_selectedTab=me.m_tabToSelect;if(me.m_tabToSelect!=me.m_oldSelectedTab)navInfo.SetParam("d2l_isfromtab","1");me.m_tabToSelect=null}});Nav.OnNavigationFailure.RegisterMethod(function(){me.m_tabToSelect=null;if(me.m_oldSelectedTab)me.m_selectedTab=me.m_oldSelectedTab});this.OnChildAdd.RegisterMethod(function(evt,child){if(me.IsRendered())me.BuildDom_Tab(child)})},IntegrateControlMin:function(deserializer){this.m_container=this.GetDomNode().childNodes[1];
var tabs=deserializer.GetObjectArrayMin(D2L.Control.Tab);this.m_isFromTab=deserializer.GetBoolean();var selectedTab="";for(var i=0;i<tabs.length;i++){tabs[i].IntegrateChild(this,UI.GetById(this.GetMappedId()+"_"+tabs[i].m_name));if(tabs[i].IsSelected())selectedTab=tabs[i].m_name}if(D2L.Control.Tabs.AriaIsEnabled)this.m_ariaController.Init();if(selectedTab.length>0)this.SelectTab(selectedTab)},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);var domNode=this.SetDomNode(this.GetUI().CreateElement("div"));
domNode.className="d_tabs";var header=this.GetUI().CreateElement("div");header.className="d_tabs_header";if(!this.m_hasBorder)header.style.background="none";domNode.appendChild(header);var headerTable=this.GetUI().CreateElement("table");headerTable.cellSpacing="0";headerTable.cellPadding="0";header.appendChild(headerTable);var headerTableRow=headerTable.insertRow(-1);this.m_container=this.GetUI().CreateElement("div");this.m_container.className="d_tabs_container";if(!this.m_hasBorder){this.m_container.style.border=
"none";this.m_container.style.background="none"}domNode.appendChild(this.m_container);for(var i=0;i<this.Children().length;i++){if(i==0){var beforeTabsSpacerCell=headerTableRow.insertCell(-1);var beforeTabsSpacerImg=this.GetUI().CreateElement("img");beforeTabsSpacerImg.width="2";beforeTabsSpacerImg.height="1";beforeTabsSpacerImg.src="/d2l/tools/img/pixel.gif";beforeTabsSpacerCell.appendChild(beforeTabsSpacerImg)}this.BuildDom_Tab(this.Children()[i])}},BuildDom_Tab:function(tab){if(!this.IsRendered())return;
var headerTableRow=this.GetDomNode().firstChild.firstChild.rows[0];tab.BuildDom();tab.m_objL=headerTableRow.insertCell(-1);tab.m_objL.id=this.GetMappedId()+"_"+tab.m_name+"_l";tab.m_objL.className="d_tabs_c";tab.m_objLink=this.GetUI().CreateElement("a");tab.m_objLink.href="javascript://";tab.m_objLink.appendChild(this.CreateTextNode(tab.m_text));tab.m_objL.appendChild(tab.m_objLink);if(tab.GetDomNode())this.m_container.appendChild(tab.GetDomNode());tab.InstallEvents()},ClickTab:function(name){var tab=
this.GetTab(name);if(tab&&tab!=this.m_selectedTab){tab.Click();this.OnClick.Trigger(tab)}},GetSelectedTab:function(){return this.m_selectedTab},GetState:function(serializer){var tab=this.GetSelectedTab();if(tab)serializer.AddMember("SelectedTab",tab.m_name);else serializer.AddMember("SelectedTab","")},GetTab:function(name){for(var i=0;i<this.Children().length;i++)if(this.Children()[i].m_name==name)return this.Children()[i];return null},SelectTab:function(name){if(this.m_selectedTab){var selectedTab=
this.m_selectedTab;if(selectedTab.m_objL)selectedTab.m_objL.className="d_tabs_c";if(selectedTab.GetDomNode())selectedTab.GetDomNode().style.display="none";selectedTab.m_isSelected=false;this.m_selectedTab=null;this.UnSelectTabEvent().Trigger(selectedTab)}var tab=this.GetTab(name);if(tab){if(tab.m_objL)tab.m_objL.className="d_tabs_c_s";if(tab.GetDomNode())tab.GetDomNode().style.display="block";tab.m_isSelected=true;this.m_selectedTab=tab;this.m_tabToSelect=tab;this.SelectTabEvent().Trigger(tab)}},
SelectTabEvent:function(){return this.m_selectTabEvent},SetHasBorder:function(hasBorder){this.m_hasBorder=hasBorder},UnSelectTabEvent:function(){return this.m_unSelectTabEvent}});
D2L.Control.TextBlock=D2L.Control.extend({Construct:function(text){arguments.callee.$.Construct.call(this);if(text===undefined)text=new D2L.LP.Text.PlainText;this.m_float=D2L.Style.Float.None;this.m_isDisplayed=true;this.m_isInline=true;this.m_text=text},BuildDom:function(){if(this.IsRendered())return;arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.GetUI().CreateElement("span"));this.RenderFloat();this.RenderIsDisplayed();this.RenderIsInline();this.RenderText()},GetFloat:function(){return this.m_float},
GetText:function(){return this.m_text},IntegrateControl:function(deserializer){arguments.callee.$.IntegrateControl.call(this,deserializer);this.m_float=deserializer.GetMember("Float",D2L.Style.Float.None);this.m_isDisplayed=deserializer.GetMember("IsDisplayed",true);this.m_isInline=deserializer.GetMember("IsInline",true);this.m_text=new D2L.LP.Text.PlainText(this.GetDomNode().innerHTML)},IsDisplayed:function(){return this.m_isDisplayed},IsInline:function(){return this.m_isInline},RenderFloat:function(){if(this.IsRendered())D2L.Util.Style.ApplyFloat(this.GetDomNode(),
this.GetFloat())},RenderIsDisplayed:function(){if(this.IsRendered())if(this.IsDisplayed())if(this.IsInline())this.GetDomNode().style.display="inline";else this.GetDomNode().style.display="block";else this.GetDomNode().style.display="none"},RenderIsInline:function(){if(this.IsRendered()&&this.IsDisplayed())if(this.IsInline())this.GetDomNode().style.display="inline";else this.GetDomNode().style.display="block"},RenderText:function(){if(this.IsRendered())this.GetText().AssignHtml(this.GetDomNode(),"innerHTML")},
SetFloat:function(val){this.m_float=val;this.RenderFloat()},SetIsDisplayed:function(isDisplayed){this.m_isDisplayed=isDisplayed;this.RenderIsDisplayed()},SetIsInline:function(isInline){this.m_isInline=isInline;this.RenderIsInline()},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,"D2L.Control.TextBlock","SetText","text");this.RenderText()}});
D2L.Control.Thumbnail=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_size=100;this.m_isDisplayed=true;this.m_fileInfo=null;this.m_queryString=""},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_isDisplayed=deserializer.GetBoolean();this.m_size=deserializer.GetMember();this.m_queryString=deserializer.GetMember()},SetFile:function(json){var fileInfo=D2L.Serialization.JsonDeserializer.Deserialize(json,
D2L.Files.FileInfo);this.SetImageFile(fileInfo)},SetImageFile:function(fileInfo){if(this.IsRendered()){this.GetDomNode().src="/d2l/img/lp/pixel.gif";var me=this;setTimeout(function(){me.GetDomNode().src=D2L.Control.Thumbnail.GetViewThumbUrl(fileInfo,me.m_size)+me.m_queryString})}this.m_fileInfo=fileInfo},SetIsDisplayed:function(isDisplayed){if(this.IsRendered())this.GetDomNode().style.display=isDisplayed?"inline":"none";this.m_isDisplayed=isDisplayed}});
D2L.Control.Thumbnail.GetViewThumbUrl=function(fileInfo,size){var fileId=fileInfo.GetFileId();var fileSystemType=fileInfo.GetFileSystemType();var lastModified=fileInfo.GetLastModified();fileId=D2L.Util.Base64.Encode(fileId);fileId=fileId.replace("=","").replace("/","_");if(fileId.Length>100)return"/d2l/common/viewThumb.d2lfile/"+fileSystemType+"/"+DateTime.Now.Ticks+"/"+lastModified+"/"+size+"?ou="+Global.OrgUnitId+"&fid="+fileId;else return"/d2l/common/viewThumb.d2lfile/"+fileSystemType+"/"+fileId+
"/"+lastModified+"/"+size+"?ou="+Global.OrgUnitId};D2L.Util.Aria={};D2L.Util.Aria.IsEnabled=function(){var browserInfo=UI.GetBrowserInfo();return browserInfo.Type==D2L.UI.BrowserType.Firefox&&browserInfo.MajorVersion>=3||browserInfo.Type==D2L.UI.BrowserType.IE&&browserInfo.MajorVersion>=8};D2L.Util.Aria.RemoveAttribute=function(element,attribute){if(D2L.Util.Aria.IsEnabled()&&element!==undefined&&element!==null)element.removeAttribute("aria-"+attribute)};
D2L.Util.Aria.SetAttribute=function(element,attribute,value){if(D2L.Util.Aria.IsEnabled()&&element!==undefined&&element!==null)element.setAttribute("aria-"+attribute,value)};D2L.Util.Aria.SetRole=function(element,role){if(D2L.Util.Aria.IsEnabled()&&element!==undefined&&element!==null)element.setAttribute("role",role)};D2L.Util.Aria.Politeness={Off:"off",Polite:"polite",Assertive:"assertive",Rude:"rude"};
D2L.Util.Aria.MakeLiveRegion=function(control,politeness){if(politeness===undefined)politeness=D2L.Util.Aria.Politeness.Assertive;var domNode=control;if(D2L.Util.IsD2LControl(control)){if(!control.IsRendered())control.BuildDom();domNode=control.GetDomNode()}D2L.Util.Aria.SetAttribute(domNode,"live",politeness)};D2L.Util.Base64={};
D2L.Util.Base64.Encode=function(data){var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var reg=new RegExp("([^%])|(%[a-fA-F0-9][a-fA-F0-9])","g");var binary="";var ret=encodeURIComponent(data).replace(reg,function(m){var val;if(m.length==1)val=m.charCodeAt(0);else val=parseInt(m.substr(1),16);val=val.toString(2);while(val.length<8)val="0"+val;binary+=val;val="";while(binary.length>=6){val+=chars.charAt(parseInt(binary.substr(0,6),2));binary=binary.substr(6)}return val});
if(binary.length>0){while(binary.length<6)binary+="0";ret+=chars.charAt(parseInt(binary,2))}while(ret.length%4!=0)ret+="=";return ret};
D2L.Util.Base64.Decode=function(data){data=data.replace(/[^a-z0-9\+\/]/ig,"");var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var ret="";var binary="";for(var i=0;i<data.length;i++){var val=chars.indexOf(data.charAt(i));val=val.toString(2);while(val.length<6)val="0"+val;binary+=val;while(binary.length>=8){var ch=binary.substr(0,8);binary=binary.substr(8);ch=parseInt(ch,2);ch=ch.toString(16);if(ch.length==1)ch="0"+ch;ret+="%"+ch}}return decodeURIComponent(ret)};
D2L.Util.Clipboard=D2L.Class.extend({Construct:function(){this.m_item=null},Clear:function(){this.m_item=null},IsEmpty:function(){return this.m_item===null},Get:function(){return this.m_item},Set:function(clipboardItem){this.m_item=clipboardItem}});D2L.Util.Clipboard.Actions={Cut:1,Copy:2};
D2L.Util.Clipboard.Item=D2L.Class.extend({Construct:function(dataObj,clipboardAction){this.m_dataObj=dataObj;this.m_action=clipboardAction},GetAction:function(){return this.m_action},GetDataObject:function(){return this.m_dataObj},SetAction:function(action){this.m_action=action},SetDataObject:function(dataObj){this.m_dataObj=dataObj}});
D2L.Util.DataSource=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_count=0;this.m_index=-1;this.m_rawData=[];this.m_fields=[]},Deserialize:function(deserializer){this.m_fields=deserializer.GetMember("Fields");this.m_rawData=deserializer.GetMember("Data");this.m_count=this.m_rawData.length},GetFields:function(){return this.m_fields},GetFieldIndex:function(field){for(var i=0;i<this.m_fields.length;i++)if(this.m_fields[i]==field)return i;return-1},GetNumRows:function(){return this.m_count},
GetRow:function(){return this.m_index},GetValue:function(field,type){if(this.IsEOF())throw"DataSource has reached end of data.";else{var fieldIndex=this.GetFieldIndex(field);if(fieldIndex<0)throw"DataSource does not contain field '"+field+"'.";if(this.m_index==-1)this.MoveAhead();var rawValue=this.m_rawData[this.m_index][fieldIndex];return D2L.Serialization.JsonDeserializer.Deserialize(rawValue,type)}},IsEOF:function(){return this.m_index>=this.m_count},MoveAhead:function(num){if(num===undefined)num=
1;this.m_index+=num},Read:function(){this.m_index++;return!this.IsEOF()}});D2L.Data={};D2L.Data.DataSource=D2L.Util.DataSource;
D2L.Util.DateTime=D2L.Class.extend({Construct:function(year,month,day,hour,minute,second){arguments.callee.$.Construct.call(this);if(hour===undefined)hour=0;if(minute===undefined)minute=0;if(second===undefined)second=0;this.m_date=new Date(year,month-1,day,hour,minute,second)},CompareTo:function(date){if(this.GetTimestamp()<date.GetTimestamp())return-1;else if(this.GetTimestamp()>date.GetTimestamp())return 1;else return 0},GetDay:function(){return this.m_date.getDate()},GetDayOfWeek:function(){return this.m_date.getDay()},
GetHour:function(){return this.m_date.getHours()},GetMinute:function(){return this.m_date.getMinutes()},GetMonth:function(){return this.m_date.getMonth()+1},GetSecond:function(){return this.m_date.getSeconds()},GetTimestamp:function(){return this.m_date.getTime()},GetYear:function(){return this.m_date.getFullYear()},Deserialize:function(deserializer){var year=deserializer.GetMember("Year");var month=deserializer.GetMember("Month");var day=deserializer.GetMember("Day");var hour=deserializer.GetMember("Hour");
var minute=deserializer.GetMember("Minute");var second=deserializer.GetMember("Second");this.m_date=new Date(year,month-1,day,hour,minute,second)},Serialize:function(serializer){serializer.AddMember("Year",this.GetYear());serializer.AddMember("Month",this.GetMonth());serializer.AddMember("Day",this.GetDay());serializer.AddMember("Hour",this.GetHour());serializer.AddMember("Minute",this.GetMinute());serializer.AddMember("Second",this.GetSecond())}});
D2L.Util.DateTime.ConvertToD2LDateTime=function(dateTime){var result=new D2L.DateTime;result.SetMonth(0);result.SetDay(1);result.SetYear(dateTime.GetYear());result.SetMonth(dateTime.GetMonth()-1);result.SetDay(dateTime.GetDay());result.SetHour(dateTime.GetHour());result.SetMinute(dateTime.GetMinute());return result};
D2L.Util.DateTime.ConvertFromD2LDateTime=function(d2lDateTime){var result=new D2L.Util.DateTime(d2lDateTime.GetYear(),d2lDateTime.GetMonth()+1,d2lDateTime.GetDay(),d2lDateTime.GetHour(),d2lDateTime.GetMinute(),0);return result};
D2L.Util.DateTime.Now=function(){var diffMilliseconds=(new Date).getTime()-D2L.Util.DateTime.LoadTimestamp;var newDate=new Date(D2L.Util.DateTime.LoadDateTime.GetTimestamp()+diffMilliseconds);return new D2L.Util.DateTime(newDate.getFullYear(),newDate.getMonth()+1,newDate.getDate(),newDate.getHours(),newDate.getMinutes(),newDate.getSeconds())};D2L.Util.DateTime.Today=function(){var now=D2L.Util.DateTime.Now();return new D2L.Util.DateTime(now.GetYear(),now.GetMonth(),now.GetDay(),0,0,0)};
D2L.Util.DateTime.DayOfWeek={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6};D2L.Util.DateTime.LoadDateTime=null;D2L.Util.DateTime.LoadTimestamp=(new Date).getTime();D2L.Util.DateTime.ConvertToLocalDateTime=function(dateTime){var result=new D2L.LocalDateTime(dateTime.GetYear(),dateTime.GetMonth(),dateTime.GetDay(),dateTime.GetHour(),dateTime.GetMinute(),0);return result};
D2L.Util.Decimal={MaxValue:999999999999999,MinValue:-999999999999999,Parse:function(value){return Culture.GetNumberParser().ParseDecimal(value)},FormatSimple:function(value){return Culture.GetNumberFormatter().FormatDecimalSimple(value)},Format:function(value,numOfDecimalPoints,trailingZeroes){return Culture.GetNumberFormatter().FormatDecimal(value,numOfDecimalPoints,trailingZeroes)}};
D2L.Util.DelayedReturn=D2L.Class.extend({Construct:function(ret){arguments.callee.$.Construct.call(this,true);this.m_hasReturned=false;this.m_isDelayedReturn=true;this.m_registrees=[];this.m_returnValue=null;if(ret!==undefined)this.Trigger(ret)},Dispose:function(){this.m_registrees=null},GetReturnValue:function(){return this.m_returnValue},HasReturned:function(){return this.m_hasReturned},Register:function(method){if(this.HasReturned())method.call(method,this.GetReturnValue());else this.m_registrees.push(method)},
RegisterWithReturn:function(method){var dr=new D2L.Util.DelayedReturn;this.Register(function(val){var ret=method(val);dr.Trigger(ret)});return dr},Trigger:function(ret){if(!this.HasReturned())if(D2L.Util.IsDelayedReturn(ret)){var me=this;ret.Register(function(ret2){me.Trigger(ret2)})}else{this.m_returnValue=ret;this.m_hasReturned=true;if(this.m_registrees)for(var i=0;i<this.m_registrees.length;i++)this.m_registrees[i].call(this.m_registrees[i],ret)}},Unregister:function(method){var newRegistrees=
[];for(var i=0;i<this.m_registrees.length;i++)if(this.m_registrees[i]!=method)newRegistrees.push(this.m_registrees[i]);this.m_registrees=newRegistrees}});D2L.Util.DelayedReturn.Create=function(beginMethod,endMethod){return new D2L.MethodProxy(beginMethod,endMethod)};
D2L.Util.DelayedReturn.RegisterAll=function(){var args=[];for(var i=0;i<arguments.length-1;i++)args.push(arguments[i]);var callback=arguments[arguments.length-1];D2L.Util.DelayedReturn.RegisterMultiple(args,function(retVals){callback.apply(callback,retVals)})};
D2L.Util.DelayedReturn.RegisterMultiple=function(drs,callback){if(drs.length===0)callback.apply(callback,[]);var retVals=[];var numComplete=0;for(var i=0;i<drs.length;i++){var f=function(){var index=i;drs[i].Register(function(val){retVals[index]=val;numComplete++;if(numComplete==drs.length)callback.call(callback,retVals)})};f()}};D2L.Util.IsDelayedReturn=function(obj){if(obj!==undefined&&obj!==null)return obj.m_isDelayedReturn!==undefined;return false};
D2L.Util.Dictionary=D2L.Class.extend({Construct:function(){this.m_keys=[];this.m_dict={};this.m_values=[];arguments.callee.$.Construct.call(this)},Add:function(key,value){var found=false;for(var i=0;i<this.m_keys.length;i++)if(this.m_keys[i]==key){this.m_values[i]=value;found=true;break}if(!found){this.m_keys.push(key);this.m_values.push(value)}this.m_dict[key]=value},ContainsKey:function(key){for(var i=0;i<this.m_keys.length;i++)if(this.m_keys[i]==key)return true;return false},GetCount:function(){return this.m_keys.length},
Get:function(key){if(this.m_dict[key]!==undefined)return this.m_dict[key];return undefined},Keys:function(){return this.m_keys},Remove:function(key){for(var i=0;i<this.m_keys.length;i++)if(this.m_keys[i]==key){this.m_keys.splice(i,1);this.m_values.splice(i,1);this.m_dict[key]=undefined;return true}return false},Values:function(){return this.m_values},Serialize:function(serializer){for(var i=0;i<this.m_keys.length;i++)serializer.AddMember(this.m_keys[i],this.Get(this.m_keys[i]))},Deserialize:function(deserializer){var keys=
deserializer.Keys();for(var i=0;i<keys.length;i++)this.Add(keys[i],deserializer.GetMember(keys[i]))}});D2L.Util.Dom={};D2L.Util.Dom.GetHeightHelper=function(node){return D2L.Util.Dom.GetSizeHelper(node).height};D2L.Util.Dom.GetWidthHelper=function(node){return D2L.Util.Dom.GetSizeHelper(node).width};
D2L.Util.Dom.GetSizeHelper=function(node){var dr=new D2L.Util.DelayedReturn;var me=this;var n=node.cloneNode(true);n.id="";n.style.display="none";if(node.parentNode)node.parentNode.insertBefore(n,node);n.style.borderStyle="none";n.style.margin="0px";n.style.padding="0px";n.style.overflow="hidden";n.style.left="-2000px";n.style.position="absolute";n.style.display="block";var height=n.offsetHeight;var width=n.offsetWidth;if(n.parentNode)n.parentNode.removeChild(n);return{height:height,width:width}};
D2L.Util.Dom.CancelBubble=function(event){if(event===undefined)event=window.event;if(event.stopPropagation!==undefined)event.stopPropagation();else if(event.cancelBubble!==undefined)event.cancelBubble=true};D2L.Util.Dom.FindPosX=function(domNode){var x=0;var xy=YAHOO.util.Dom.getXY(domNode);if(xy)x=xy[0];return x};D2L.Util.Dom.FindPosY=function(domNode){var y=0;var xy=YAHOO.util.Dom.getXY(domNode);if(xy)y=xy[1];return y};
D2L.Util.Dom.FindPosXY=function(domNode){var xy=YAHOO.util.Dom.getXY(domNode);if(!xy){xy=[];xy[0]=0;xy[1]=0}return xy};
D2L.Util.Dom.ScrollTo=function(node,doMiddle,doScrollToBottom){if(!node||!node.offsetLeft||!node.offsetWidth)return;if(doMiddle===undefined)doMiddle=false;if(doScrollToBottom===undefined)doScrollToBottom=false;var posX=D2L.Util.Dom.FindPosX(node);var posY=D2L.Util.Dom.FindPosY(node);var width=node.offsetWidth;var scrollLeft=UI.GetScrollLeft();var scrollTop=UI.GetScrollTop();var clientWidth=UI.GetWindowWidth();var clientHeight=UI.GetWindowHeight();var isBottom=false;if(doScrollToBottom&&node.offsetHeight&&
node.offsetHeight+posY>=scrollTop+clientHeight&&posY>scrollTop){posY=posY+node.offsetHeight;isBottom=true}var scrollAmtX=0;var scrollAmtY=0;var diff=0;if(!isBottom)diff=clientHeight;if(doMiddle)diff=clientHeight/2;if(posY<scrollTop)scrollAmtY=posY-scrollTop-diff;else if(posY>scrollTop+clientHeight)scrollAmtY=posY-(scrollTop+clientHeight)+diff;if(posX<scrollLeft)scrollAmtX=posX-scrollLeft;else if(posX+width>scrollLeft+clientWidth)scrollAmtX=posX+width-(scrollLeft+clientWidth);if(scrollAmtX!=0||scrollAmtY!=
0)window.scrollBy(scrollAmtX,scrollAmtY)};var ScrollToDomNode=D2L.Util.Dom.ScrollTo;D2L.Util.Dom.Purge=function(d){var a=d.attributes,i,l,n;if(a){l=a.length;for(i=0;i<l;i+=1)if(a[i]){n=a[i].name;if(typeof d[n]==="function")d[n]=null}}a=d.childNodes;if(a){l=a.length;for(i=0;i<l;i+=1)D2L.Util.Dom.Purge(d.childNodes[i])}};
D2L.Util.Dom.SetPngSrc=function(img,src,width,height){img.width=width;img.height=height;if(img.runtimeStyle){img.src="/d2l/tools/img/pixel.gif";img.runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"',sizingMethod='scale')"}else img.src=src};D2L.Util.Dom.IsKeyEnter=function(e){var evt=e||window.event;if(evt===undefined||evt===null)return false;if(evt.keyCode==13||evt.charCode==13||evt.which==13)return true;else return false};
D2L.Util.Dom.IsAncestor=function(ancestorNode,node){return YAHOO.util.Dom.isAncestor(ancestorNode,node)};
D2L.Util.Dom.GetElementsByClassName=function(elem,className){if(elem.getElementsByClassName!==undefined)return elem.getElementsByClassName(className);var allElems=elem.all?elem.all:elem.getElementsByTagName("*");var elems=[];className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");for(var i=0;i<allElems.length;i++)if(oRegExp.test(allElems[i].className))elems.push(allElems[i]);return elems};
D2L.Util.Dom.HasClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return false;var classes=domNode.className.split(" ");for(var i=0;i<classes.length;i++)if(classes[i]==className)return true;return false};D2L.Util.Email={};D2L.Util.Email.GetValidityRegex=function(){return new RegExp(/^[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/)};
D2L.Util.Email.IsAddressValid=function(emailAddress){return D2L.Util.Email.GetValidityRegex().test(emailAddress)};function IsEmailValid(emailAddress){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("IsEmailValid() is deprecated, use D2L.Util.Email.IsAddressValid( address ) instead.");return D2L.Util.Email.IsAddressValid(emailAddress)}
function d2l_Encoder(valSep,valReplace,rowSep,rowReplace){this.ResetData();this.valSep=valSep;this.rowSep=rowSep;this.valReplace=this.escapeChar+valReplace;this.rowReplace=this.escapeChar+rowReplace}d2l_Encoder.prototype.escapeChar="\\";d2l_Encoder.prototype.escapeReplace="\\&";d2l_Encoder.prototype.ResetData=function(){this.rows=new Array};
d2l_Encoder.prototype.AddRow=function(){var data=new Array;if(arguments[0]!==undefined)if(arguments[0].join)data=arguments[0];else for(var i=0;i<arguments.length;i++)data[i]=arguments[i];this.rows[this.rows.length]=data};d2l_Encoder.prototype.Encode=function(val){var ret=val;if(val.split){ret=val.split(this.escapeChar).join(this.escapeReplace);ret=ret.split(this.valSep).join(this.valReplace);ret=ret.split(this.rowSep).join(this.rowReplace)}return ret};
d2l_Encoder.prototype.Decode=function(val){var ret=val.split(this.rowReplace).join(this.rowSep);ret=ret.split(this.valReplace).join(this.valSep);ret=ret.split(this.escapeReplace).join(this.escapeChar);return ret};
d2l_Encoder.prototype.Serialize=function(){var ret="";var currRow;var valReplace=this.escapeChar+this.valReplace;var rowReplace=this.escapeChar+this.rowReplace;var currVal,valSep;var currRowVals,rowSep;rowSep="";for(var i=0;i<this.rows.length;i++){currRow=this.rows[i];currRowVals="";valSep="";for(var x=0;x<currRow.length;x++){currVal=this.Encode(currRow[x]);currRowVals+=valSep+currVal;valSep=this.valSep}ret+=rowSep+currRowVals;rowSep=this.rowSep}return ret};
d2l_Encoder.prototype.Deserialize=function(data){this.ResetData();var rows=data.split(this.rowSep);var currData;var rowReplace=this.escapeChar+this.rowReplace;var valReplace=this.escapeChar+this.valReplace;for(var i=0;i<rows.length;i++){currData=rows[i].split(this.valSep);for(var x=0;x<currData.length;x++)currData[x]=this.Decode(currData[x]);this.rows[this.rows.length]=currData}return this.rows};D2L.Util.Html={};
D2L.Util.Html.Encode=function(str){if(str!=undefined&&str.encodeHtml!==undefined)return str.encodeHtml();return str};D2L.Util.Html.Decode=function(str){if(str!=undefined&&str.encodeHtml!==undefined)return str.decodeHtml();return str};D2L.Util.Html.HasClassName=function(domNode,className){if(domNode&&domNode.className!==undefined){var classNames=domNode.className.split(" ");for(var i=0;i<classNames.length;i++)if(classNames[i]==className)return true}return false};
D2L.Util.Html.JsString=function(str){var str=new String(str);str=str.replace("\\","\\\\");str=str.replace("'","\\'");str=str.replace('"','\\"');str=str.replace("/","\\/");str=str.replace("\n","\\n");return str};
D2L.Util.Html.FindFrame=function(frameName,baseWindow){if(baseWindow===undefined)baseWindow=window;var FindFrameFromWindow=function(win){var TravelDown=function(win2){if(win2.frames&&win2.frames[frameName])return win2.frames[frameName];else if(win2.frames)for(var i=0;i<win2.frames.length;i++){var result=TravelDown(win2.frames[i]);if(result!==null)return result}return null};var start=win;while(true)if(start.parent&&start.parent!=start)start=start.parent;else break;var down=TravelDown(start);if(down!==
null)return down;if(win.opener)return FindFrameFromWindow(win.opener);return null};return FindFrameFromWindow(baseWindow)};D2L.Util.Html.IsDomNode=function(obj){if(obj!==undefined&&obj!==null)return obj.tagName!==undefined;return false};D2L.Util.Integer={MaxValue32:2147483647,MinValue32:-2147483648,MaxValue64:999999999999999,MinValue64:-999999999999999,Parse:function(value){return Culture.GetNumberParser().ParseInteger(value)},Format:function(value){return Culture.GetNumberFormatter().FormatInteger(value)}};
D2L.Util.IsD2LControl=function(obj){if(obj!==undefined)return obj.isD2LControl!==undefined;return false};D2L.Util.JavaScript={};D2L.Util.JavaScript.DeepCopy=function(obj){if(obj===undefined||obj===null)return obj;if(typeof obj=="object"&&obj.__isArray){var copy=[];for(var i=0;i<obj.length;i++)copy.push(D2L.Util.JavaScript.DeepCopy(obj[i]));return copy}else if(typeof obj=="object"){var copy={};for(var property in obj)copy[property]=D2L.Util.JavaScript.DeepCopy(obj[property]);return copy}return obj};
D2L.Util.JavaScript.IsArray=function(obj){if(obj&&obj.pop&&obj.push)return true;return false};function isArray(obj){return D2L.Util.JavaScript.IsArray(obj)}D2L.Util.Number={};D2L.Util.Number.Mod=function(num,base){var mod=num%base;return mod<0?base+mod:mod};
D2L.Util.Percentage={FormatSimple:function(value,outOf){return Culture.GetNumberFormatter().FormatPercentageSimple(value)},Format:function(value,outOf,numOfDecimalPoints,trailingZeroes){return Culture.GetNumberFormatter().FormatPercentage(value,outOf,numOfDecimalPoints,trailingZeroes)}};D2L.Util.ProfanityFilter={};
D2L.Util.ProfanityFilter.IsValidTerm=function(term){var dl=new D2L.Util.DelayedReturn;var callback=function(rpcResponse){if(rpcResponse.GetResponseType()==D2L.Rpc.ResponseType.Success)dl.Trigger(rpcResponse.GetResult());else dl.Trigger(false)};D2L.Rpc.Create("IsValidTerm",callback,"/d2l/common/rpc/profanityFilter/profanityFilter.d2l").Call(term);return dl};
D2L.Util.ProfanityFilter.FilterTerms=function(terms){var dl=new D2L.Util.DelayedReturn;var callback=function(rpcResponse){if(rpcResponse.GetResponseType()==D2L.Rpc.ResponseType.Success)dl.Trigger(rpcResponse.GetResult());else dl.Trigger([])};D2L.Rpc.Create("FilterTerms",callback,"/d2l/common/rpc/profanityFilter/profanityFilter.d2l").Call(terms);return dl};D2L.Util.ProfanityFilter.Synchronous={};
D2L.Util.ProfanityFilter.Synchronous.IsValidTerm=function(term){var rpcResponse=D2L.Rpc.CreateSynchronous("IsValidTerm","/d2l/common/rpc/profanityFilter/profanityFilter.d2l").Call(term);if(rpcResponse.GetResponseType()==D2L.Rpc.ResponseType.Success)return rpcResponse.GetResult();else return false};
D2L.Util.ProfanityFilter.Synchronous.FilterTerms=function(terms){var rpcResponse=D2L.Rpc.CreateSynchronous("FilterTerms","/d2l/common/rpc/profanityFilter/profanityFilter.d2l").Call(terms);if(rpcResponse.GetResponseType()==D2L.Rpc.ResponseType.Success)return rpcResponse.GetResult();else return false};D2L.Util.SpellChecker={};
D2L.Util.SpellChecker.OpenSpellChecker=function(text,isTextHtml,previewText,isPreviewTextHtml){var dr=new D2L.Util.DelayedReturn;var dialog=new D2L.Dialog.SpellChecker;dialog.SetText(text);dialog.SetIsTextHtml(isTextHtml);if(previewText!==undefined&&isPreviewTextHtml!==undefined){dialog.SetPreviewText(previewText);dialog.SetIsPreviewTextHtml(isPreviewTextHtml)}var callback=function(dialogResponse){if(dialogResponse.GetType()==D2L.Dialog.ResponseType.Positive)dr.Trigger(dialogResponse.GetData("text"));
dialog.Close()};dialog.SetCallback(callback);dialog.Open();return dr};if(String.prototype.trim===undefined)String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.isString=true;String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};String.prototype.stripHtml=function(){var str=this.replace("&nbsp;"," ");return str.replace(/(<([^>]+)>)/ig,"")};
String.prototype.encodeHtml=function(){var str=this.toString();return D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(str)};String.prototype.d_oldReplace=String.prototype.replace;String.prototype.replace=function(strOrRegex,replaceVal){if(strOrRegex.isString)return this.split(strOrRegex).join(replaceVal);else return this.d_oldReplace(strOrRegex,replaceVal)};String.prototype.format=function(params){var str=this.toString();for(var i=0;i<arguments.length;i++)str=str.replace("{"+i+"}",arguments[i]);return str};
String.prototype.langReplace=function(params){var str=this.toString();for(var i=0;i<arguments.length;i++)str=str.replace("["+i+"]",arguments[i]);return str};String.prototype.decodeHtml=function(){return this.replace(/\&[a-zA-Z0-9#]*;/g,DecodeHtmlEntity)};String.prototype.jsString=function(){return D2L.Util.Html.JsString(this.toString())};String.prototype.endsWith=function(end){var str=this.toString();return str.length>=end.length&&str.substr(str.length-end.length)==end};
function DecodeHtmlEntity(entity){var newEntity=entity;var entities=window.getHtmlEntities();if(entities[entity])newEntity="&#"+entities[entity]+";";var charCodeMatches=newEntity.match(/\&\#[0-9]+;/);if(charCodeMatches)return String.fromCharCode(newEntity.substring(2,newEntity.length-1));return entity}
window.getHtmlEntities=function(){if(this.entities!==undefined)return this.entities;this.entities={"&quot;":34,"&amp;":38,"&lt;":60,"&gt;":62,"&OElig;":338,"&oelig;":339,"&Scaron;":352,"&scaron;":353,"&Yuml;":376,"&circ;":710,"&tilde;":732,"&ensp;":8194,"&emsp;":8195,"&thinsp;":8201,"&zwnj;":8204,"&zwj;":8205,"&lrm;":8206,"&rlm;":8207,"&ndash;":8211,"&mdash;":8212,"&lsquo;":8216,"&rsquo;":8217,"&sbquo;":8218,"&ldquo;":8220,"&rdquo;":8221,"&bdquo;":8222,"&dagger;":8224,"&Dagger;":8225,"&permil;":8240,
"&lsaquo;":8249,"&rsaquo;":8250,"&euro;":8364,"&apos;":39,"&nbsp;":160,"&iexcl;":161,"&cent;":162,"&pound;":163,"&curren;":164,"&yen;":165,"&brvbar;":166,"&sect;":167,"&uml;":168,"&copy;":169,"&ordf;":170,"&laquo;":171,"&not;":172,"&shy;":173,"&reg;":174,"&macr;":175,"&deg;":176,"&plusmn;":177,"&sup2;":178,"&sup3;":179,"&acute;":180,"&micro;":181,"&para;":182,"&middot;":183,"&cedil;":184,"&sup1;":185,"&ordm;":186,"&raquo;":187,"&frac14;":188,"&frac12;":189,"&frac34;":190,"&iquest;":191,"&Agrave;":192,
"&Aacute;":193,"&Acirc;":194,"&Atilde;":195,"&Auml;":196,"&Aring;":197,"&AElig;":198,"&Ccedil;":199,"&Egrave;":200,"&Eacute;":201,"&Ecirc;":202,"&Euml;":203,"&Igrave;":204,"&Iacute;":205,"&Icirc;":206,"&Iuml;":207,"&ETH;":208,"&Ntilde;":209,"&Ograve;":210,"&Oacute;":211,"&Ocirc;":212,"&Otilde;":213,"&Ouml;":214,"&times;":215,"&Oslash;":216,"&Ugrave;":217,"&Uacute;":218,"&Ucirc;":219,"&Uml;":220,"&Yacute;":221,"&THORN;":222,"&szlig;":223,"&agrave;":224,"&aacute;":225,"&acirc;":226,"&atilde;":227,"&auml;":228,
"&aring;":229,"&aelig;":230,"&ccedil;":231,"&egrave;":232,"&eactute;":233,"&ecirc;":234,"&euml;":235,"&igrave;":236,"&iacute;":237,"&icirc;":238,"&iuml;":239,"&eth;":240,"&ntilde;":241,"&ograve;":242,"&oacute;":243,"&ocirc;":244,"&otilde;":245,"&ouml;":246,"&divide;":247,"&oslash;":248,"&ugrave;":249,"&uacute;":250,"&ucirc;":251,"&uuml;":252,"&yacute;":253,"&thorn;":254,"&yuml;":255};return this.entities};
D2L.Util.StringBuilder=D2L.Class.extend({Construct:function(initialValue){this.m_buffer=new Array("");if(initialValue!==undefined)this.Append(initialValue)},Append:function(value){this.m_buffer.push(value)},ToString:function(){return this.m_buffer.join("")}});D2L.Util.Style={};
D2L.Util.Style.ApplyFloat=function(domNode,val){var f="none";val=UI.GetCulture().GetFloat(val);if(val==D2L.Style.Float.Left)f="left";else if(val==D2L.Style.Float.Right)f="right";if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.IE)domNode.style.styleFloat=f;else domNode.style.cssFloat=f};D2L.Util.Url={};D2L.Util.Url.Encode=function(str){var ret=encodeURIComponent(str);ret=ret.replace("'","%27");ret=ret.replace("%2F","/");ret=ret.replace("%2C",",");return ret};D2L.Util.Url.Decode=function(str){return decodeURIComponent(str)};
D2L.Util.Url.IsExternal=function(url){url=url.trim();var regexp=new RegExp("^[a-zA-Z]+://","i");var hasProtocol=regexp.test(url);if(hasProtocol){var protocol=url.substr(0,url.indexOf(":"));if(protocol.toLowerCase()=="javascript")hasProtocol=false}return hasProtocol};
D2L.Util.GetViewFileUrl=function(file,stream){if(stream===undefined)stream=false;var fileId=D2L.Util.Base64.Encode(file.FileId).replace("=","").replace("/","_");var fileName=D2L.Util.Url.Encode(file.FileName.replace(/[#?\/\\%&+]/g,"_")).replace(/\.\.+/g,".").replace("+","%20");var url="/d2l/common/viewFile.d2lfile/";if(fileId.length>100)url+=file.FileSystemType+"/"+(new Date).getTime()+"/"+fileName+"?ou="+Global.OrgUnitId+"&fid="+fileId;else url+=file.FileSystemType+"/"+fileId+"/"+fileName+"?ou="+
Global.OrgUnitId;if(stream)url+="&display=1";return url};
D2L.Util.GetViewImageFileUrl=function(file,size,fillColour){if(size===undefined)size=0;if(fillColour===undefined)fillColour="#ffffff";fillColour=D2L.Util.Url.Encode(fillColour);var fileId=D2L.Util.Base64.Encode(file.FileId).replace("=","").replace("/","+");var fileName=D2L.Util.Url.Encode(file.FileName.replace(/[#?\/\\%&+]/g,"_")).replace(/\.\.+/g,".").replace("+","%20");if(fileId.length>100)return"/d2l/common/viewImage.d2lfile/"+file.FileSystemType+"/"+(new Date).getTime()+"/"+fileName+"?ou="+Global.OrgUnitId+
"&fid="+fileId+"&s="+size+"&c="+fillColour;else return"/d2l/common/viewImage.d2lfile/"+file.FileSystemType+"/"+fileId+"/"+fileName+"?ou="+Global.OrgUnitId+"&s="+size+"&c="+fillColour};D2L.Util.GetViewImageUrl=function(imageTerm){return"/d2l/common/language/viewImage.d2l?ou="+Global.OrgUnitId+"&isi="+Global.ImageSetId+"&iv="+Global.ImageVersion+"&t="+imageTerm};window.oldAlert=window.alert;
window.alert=function(obj){if(obj&&obj.isString){obj=obj.replace(/<br[\s]*[\/]?[\s]*>/gi,"\n");obj=obj.stripHtml();obj=obj.decodeHtml()}this.oldAlert(obj)};window.oldConfirm=window.confirm;window.confirm=function(obj){if(obj&&obj.isString){obj=obj.replace(/<br[\s]*[\/]?[\s]*>/gi,"\n");obj=obj.stripHtml();obj=obj.decodeHtml()}return this.oldConfirm(obj)};D2L.Validation={};D2L.Validation.NumberFailureType={None:0,NaN:1,NaNOutOfRange:2,GTE:3,GT:4,LTE:5,LT:6};
D2L.Validation.CreateErrorBalloon=function(failureText){var div1=document.createElement("div");div1.className="d_vb";var div2=document.createElement("div");div2.className="d_vb1";div1.appendChild(div2);var div3=document.createElement("div");div3.className="d_vb2";div1.appendChild(div3);failureText.GetHtml().Register(function(html){div3.innerHTML=html});return div1};
D2L.Validation.IValidator=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_passed=true},CanValidateNoDelay:function(obj){return obj.GetValueNoDelay!==undefined},GetFailureText:function(){return new D2L.LP.Text.LangTerm("Framework.Validation.GenericInvalid")},Passed:function(){return this.m_passed},Validate:function(){return true},ValidateObject:function(obj){return new D2L.Util.DelayedReturn(this.Validate())},ValidateObjectNoDelay:function(obj){return this.Validate()}});
D2L.Validation.StringValidator=D2L.Validation.IValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this);this.m_value=value;this.m_maxCharacters=0;this.m_isRequired=false;this.m_regex=null;this.m_regexFailureText=new D2L.LP.Text.PlainText;this.m_failureText=new D2L.LP.Text.PlainText},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);if(deserializer.HasMember()){this.m_maxCharacters=deserializer.GetMember();this.m_isRequired=
deserializer.GetBoolean();if(deserializer.HasMember()){var regex=deserializer.GetMember();if(regex.length>0){this.m_regex=new RegExp(regex);this.m_regexFailureText=deserializer.GetObject(D2L.LP.Text.IText)}}}},GetFailureText:function(){return this.m_failureText},GetRegexFailureText:function(){return this.m_regexFailureText},GetIsRequired:function(){return this.m_isRequired},GetMaxCharacters:function(){return this.m_maxCharacters},GetRegex:function(){return this.m_regex},GetValue:function(){return this.m_value},
SetRegexFailureText:function(failureText){this.m_regexFailureText=failureText},SetIsRequired:function(isRequired){this.m_isRequired=isRequired},SetMaxCharacters:function(maxCharacters){this.m_maxCharacters=maxCharacters},SetRegex:function(regex){this.m_regex=regex},SetValue:function(value){this.m_value=value},Validate:function(value){if(value===undefined)value=this.GetValue();if(this.GetIsRequired()){var validator=new D2L.Validation.RequiredValidator(value);if(!validator.Validate()){this.m_failureText=
validator.GetFailureText();return false}}else if(value.length===0)return true;if(this.GetMaxCharacters()>0&&value.length>this.GetMaxCharacters()){this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.StringMaxCharacters",this.GetMaxCharacters());return false}if(this.GetRegex()!==null&&!this.GetRegex().test(value)){this.m_failureText=this.GetRegexFailureText();return false}return true},ValidateObject:function(obj){var dr=new D2L.Util.DelayedReturn;var me=this;obj.GetValue().Register(function(value){dr.Trigger(me.Validate(value))});
return dr},ValidateObjectNoDelay:function(obj){return this.Validate(obj.GetValueNoDelay())}});D2L.Control.ValidatorString=D2L.Validation.StringValidator;
D2L.Validation.AndValidator=D2L.Validation.IValidator.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_children=[];this.m_failureText=new D2L.LP.Text.PlainText},CanValidateNoDelay:function(obj){var ret=true;for(var i=0;i<this.m_children.length;i++){var validator=UI.GetControl(this.m_children[i].ID(),this.m_children[i].SID());ret=ret&&validator.CanValidateNoDelay(obj)}return ret},IntegrateControlMin:function(deserializer){this.m_children=deserializer.GetObjectArrayMin(D2L.Control.Id)},
GetFailureText:function(){return this.m_failureText},Validate:function(){var ret=true;for(var i=0;i<this.m_children.length;i++){var validator=UI.GetControl(this.m_children[i].ID(),this.m_children[i].SID());var pass=validator.Validate();validator.m_passed=pass;if(!pass)this.m_failureText=validator.GetFailureText();ret=ret&&pass}return pass},ValidateObject:function(obj){var dr=new D2L.Util.DelayedReturn;var me=this;var ret=true;var HandleResult=function(validator,result){validator.m_passed=result;if(!result)me.m_failureText=
validator.GetFailureText();ret=ret&&result};var Validate=function(index){if(index==me.m_children.length||!ret)dr.Trigger(ret);else{var validator=UI.GetControl(me.m_children[index].ID(),me.m_children[index].SID());var drChild=validator.ValidateObject(obj);if(D2L.Util.IsDelayedReturn(drChild))drChild.Register(function(pass){HandleResult(validator,pass);Validate(++index)});else{HandleResult(validator,drChild);Validate(++index)}}};Validate(0);return dr},ValidateObjectNoDelay:function(obj){var me=this;
var Validate=function(index){if(index==me.m_children.length)return true;else{var validator=UI.GetControl(me.m_children[index].ID(),me.m_children[index].SID());var success=validator.ValidateObjectNoDelay(obj);validator.m_passed=success;if(!success)me.m_failureText=validator.GetFailureText();return Validate(++index)&&success}};return Validate(0)}});D2L.Control.ValidatorAnd=D2L.Validation.AndValidator;
D2L.Validation.CustomValidator=D2L.Validation.IValidator.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_jsFunction=null;this.m_jsParams=[this];this.m_failureText=null;this.m_failureControl=null;this.m_failureControlId=null;this.m_validationTarget=null},CanValidateNoDelay:function(){return false},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_jsFunction=deserializer.GetMember();this.m_jsParams=this.m_jsParams.concat(deserializer.GetMember());
var failureControlID=deserializer.GetMember();var failureControlSID=deserializer.GetMember();if(failureControlID.length>0)this.m_failureControlId=new D2L.Control.Id(failureControlID,failureControlSID);var failureText=deserializer.GetMember().replace("{tempsubject}","{subject}");if(failureText.length>0)this.m_failureText=new D2L.LP.Text.SmlText(failureText)},Focus:function(){if(this.m_failureControlId!==null)this.m_failureControl=UI.GetControl(this.m_failureControlId.ID(),this.m_failureControlId.SID());
if(this.m_failureControl!==null)if(this.m_failureControl.Focus!==undefined)this.m_failureControl.Focus();else if(this.m_failureControl.focus!==undefined)try{this.m_failureControl.focus()}catch(e){}},GetDomNode:function(){if(this.m_failureControlId!==null)this.m_failureControl=UI.GetControl(this.m_failureControlId.ID(),this.m_failureControlId.SID());if(this.m_failureControl!==null)if(D2L.Util.IsD2LControl(this.m_failureControl)){if(this.m_failureControl.GetValidationDomNode!==undefined)return this.m_failureControl.GetValidationDomNode();
return this.m_failureControl.GetDomNode()}else return this.m_failureControl;return null},GetFailureText:function(){return this.m_failureText},GetValidationTarget:function(){return this.m_validationTarget},HasFocusControl:function(){var control=this.m_failureControl;if(this.m_failureControlId!==null)control=UI.GetControl(this.m_failureControlId.ID(),this.m_failureControlId.SID());if(control!==null)return control.Focus!==undefined||control.focus!==undefined;return false},SetFailureControl:function(control){this.m_failureControl=
control;if(this.m_failureControl!==null){var domNode=control;if(D2L.Util.IsD2LControl(control))domNode=control.GetDomNode();var me=this;if(domNode!==null){this.AttachObject(domNode,"ID2LOnRemove",new D2L.EventHandler);domNode.ID2LOnRemove.RegisterMethod(function(evt){me.IsEnabled=function(){return false}})}}},SetDomNode:function(domNode){this.SetFailureControl(domNode)},SetFailureText:function(failureText){this.m_failureText=D2L.LP.Text.IText.Normalize(failureText,"D2L.Validation.CustomValidator",
"SetFailureText","failureText")},ValidateObject:function(obj){this.m_validationTarget=obj;return new D2L.Util.DelayedReturn(this.Validate())},Validate:function(){var ret=true;if(this.m_jsFunction!==undefined&&this.m_jsFunction!==null){ret=this.m_jsFunction.apply(this.m_jsFunction,this.m_jsParams);if(ret===undefined)ret=true}return ret}});D2L.Control.Validator=D2L.Validation.CustomValidator;
D2L.Validation.DateRangeValidator=D2L.Validation.IValidator.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_startYear=null;this.m_startMonth=null;this.m_startDay=null;this.m_startHour=null;this.m_startMinute=null;this.m_endYear=null;this.m_endMonth=null;this.m_endDay=null;this.m_endHour=null;this.m_endMinute=null;this.m_hasStartDate=true;this.m_hasEndDate=true;this.m_failureText=null;this.m_validationFailureSource=0},GetFailureText:function(){return this.m_failureText},
Validate:function(){var validator;if(this.m_hasStartDate){validator=new D2L.Validation.DateTimeValidator(this.m_startYear,this.m_startMonth,this.m_startDay,this.m_startHour,this.m_startMinute,this.m_startSecond);if(!validator.Validate()){this.m_validationFailureSource=1;this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.DateRangeStartInvalid");return false}}if(this.m_hasEndDate){validator=new D2L.Validation.DateTimeValidator(this.m_endYear,this.m_endMonth,this.m_endDay,this.m_endHour,
this.m_endMinute,this.m_endSecond);if(!validator.Validate()){this.m_validationFailureSource=2;this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.DateRangeEndInvalid");return false}}this.m_validationFailureSource=0;this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.DateRangeInvalid");if(this.m_hasStartDate&&this.m_hasEndDate){if(this.m_startYear<this.m_endYear)return true;else if(this.m_startYear>this.m_endYear)return false;if(this.m_startMonth<this.m_endMonth)return true;
else if(this.m_startMonth>this.m_endMonth)return false;if(this.m_startDay<this.m_endDay)return true;else if(this.m_startDay>this.m_endDay)return false;if(this.m_hasTime){if(this.m_startHour<this.m_endHour)return true;else if(this.m_startHour>this.m_endHour)return false;if(this.m_startMinute<this.m_endMinute)return true;else if(this.m_startMinute>=this.m_endMinute)return false}}return true},ValidateObject:function(obj){return new D2L.Util.DelayedReturn(this.ValidateObjectNoDelay(obj))},ValidateObjectNoDelay:function(obj){this.m_hasStartDate=
obj.HasStartDate();this.m_hasEndDate=obj.HasEndDate();this.m_hasTime=obj.HasTime();if(this.m_hasStartDate){this.m_startYear=obj.GetStartYear();this.m_startMonth=obj.GetStartMonth();this.m_startDay=obj.GetStartDay();if(this.m_hasTime){this.m_startHour=obj.GetStartHour();this.m_startMinute=obj.GetStartMinute()}}if(this.m_hasEndDate){this.m_endYear=obj.GetEndYear();this.m_endMonth=obj.GetEndMonth();this.m_endDay=obj.GetEndDay();if(this.m_hasTime){this.m_endHour=obj.GetEndHour();this.m_endMinute=obj.GetEndMinute()}}var pass=
this.Validate();if(!pass&&obj.m_validationFailureSource!==undefined)obj.m_validationFailureSource=this.m_validationFailureSource;return pass}});D2L.Control.ValidatorDateRange=D2L.Validation.DateRangeValidator;
D2L.Validation.DateTimeValidator=D2L.Validation.IValidator.extend({Construct:function(year,month,day,hour,minute){arguments.callee.$.Construct.call(this);var today=new D2L.Util.DateTime.Now;if(year===undefined)year=today.GetYear();if(month===undefined)month=today.GetMonth();if(day===undefined)day=today.GetDay();if(hour===undefined)hour=today.GetHour();if(minute===undefined)minute=today.GetMinute();this.m_year=year;this.m_month=month;this.m_day=day;this.m_hour=hour;this.m_minute=minute},GetFailureText:function(){return new D2L.LP.Text.LangTerm("Framework.Validation.DateInvalid")},
GetDay:function(){return this.m_day},GetMonth:function(){return this.m_month},GetHour:function(){return this.m_hour},GetMinute:function(){return this.m_minute},GetYear:function(){return this.m_year},SetDay:function(day){this.m_day=day},SetMonth:function(month){this.m_month=month},SetYear:function(year){this.m_year=year},SetHour:function(hour){this.m_hour=hour},SetMinute:function(minute){this.m_minute=minute},Validate:function(year,month,day,hour,minute){if(year===undefined||year===null)year=this.GetYear();
if(month===undefined||month===null)month=this.GetMonth();if(day===undefined||day===null)day=this.GetDay();if(hour===undefined||hour===null)hour=this.GetHour();if(minute===undefined||minute===null)minute=this.GetMinute();if(isNaN(year)||year<1753||year>9999)return false;if(isNaN(month)||month<1||month>12)return false;if(isNaN(day)||day<1||day>31)return false;if(isNaN(hour)||hour<0||hour>23)return false;if(isNaN(minute)||minute<0||minute>59)return false;var allowedDays=31;if(month==2)if(year%4===0&&
(!(year%100===0)||year%400===0))allowedDays=29;else allowedDays=28;else if(month==4||month==6||month==9||month==11)allowedDays=30;if(day>allowedDays)return false;return true},ValidateObject:function(obj){return new D2L.Util.DelayedReturn(this.Validate(obj.GetYear(),obj.GetMonth(),obj.GetDay(),obj.GetHour(),obj.GetMinute()))},ValidateObjectNoDelay:function(obj){return this.Validate(obj.GetYear(),obj.GetMonth(),obj.GetDay(),obj.GetHour(),obj.GetMinute())}});D2L.Control.ValidatorDateTime=D2L.Validation.DateTimeValidator;
D2L.Validation.DecimalValidator=D2L.Validation.IValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this);if(value===undefined)value=0;this.m_value=value;this.m_min=null;this.m_max=null;this.m_minIsInclusive=true;this.m_maxIsInclusive=true;this.m_minIsSet=false;this.m_maxIsSet=false;this.m_lastFailureType=D2L.Validation.NumberFailureType.None},IntegrateControlMin:function(deserializer){this.m_value=deserializer.GetMember();this.m_min=deserializer.GetMember();this.m_max=deserializer.GetMember();
this.m_minIsSet=deserializer.GetBoolean();this.m_maxIsSet=deserializer.GetBoolean();this.m_minIsInclusive=deserializer.GetBoolean();this.m_maxIsInclusive=deserializer.GetBoolean()},GetFailureText:function(){if(this.m_lastFailureType==D2L.Validation.NumberFailureType.NaN)return new D2L.LP.Text.LangTerm("Framework.Validation.DecimalInvalid");else if(this.m_lastFailureType==D2L.Validation.NumberFailureType.NaNOutOfRange)return new D2L.LP.Text.LangTerm("Framework.Validation.DecimalInvalidRange",D2L.Util.Decimal.Format(D2L.Util.Decimal.MinValue),
D2L.Util.Decimal.Format(D2L.Util.Decimal.MaxValue));var param1=undefined;var param2=undefined;var term;if(this.m_minIsSet&&this.m_maxIsSet){param1=this.m_min;if(param1!=undefined)param1=D2L.Util.Decimal.Format(param1);param2=this.m_max;if(param2!=undefined)param2=D2L.Util.Decimal.Format(param2);if(this.m_minIsInclusive&&this.m_maxIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenBothInclusive",param1,param2);else if(this.m_minIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenMinInclusive",
param1,param2);else if(this.m_maxIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenMaxInclusive",param1,param2);else term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenNoneInclusive",param1,param2)}else if(this.m_minIsSet){param1=this.m_min;if(param1!=undefined)param1=D2L.Util.Decimal.Format(param1);if(this.m_minIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberHigherInclusive",param1);else term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberHigher",
param1)}else if(this.m_maxIsSet){param1=this.m_max;if(param1!=undefined)param1=D2L.Util.Decimal.Format(param1);if(this.m_maxIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberLowerInclusive",param1);else term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberLower",param1)}else;return term},GetMax:function(){return this.m_max},GetMin:function(){return this.m_min},GetMaxIsInclusive:function(){return this.m_maxIsInclusive},GetMinIsInclusive:function(){return this.m_minIsInclusive},
GetValue:function(){return this.m_value},SetMax:function(max){this.m_max=max;this.m_maxIsSet=true},SetMin:function(min){this.m_min=min;this.m_minIsSet=true},SetMaxIsInclusive:function(maxIsInclusive){this.m_maxIsInclusive=maxIsInclusive},SetMinIsInclusive:function(minIsInclusive){this.m_minIsInclusive=minIsInclusive},SetValue:function(value){this.m_value=value},Validate:function(value){if(value===undefined)value=this.m_value;this.m_lastFailureType=D2L.Validation.NumberFailureType.None;if(value.isString){if(value.length===
0)return true;try{value=D2L.Util.Decimal.Parse(value)}catch(e){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaN;return false}}if(isNaN(value)){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaN;return false}if(this.m_minIsSet)if(this.GetMinIsInclusive()){if(value<this.GetMin()){this.m_lastFailureType=D2L.Validation.NumberFailureType.LTE;return false}}else if(value<=this.GetMin()){this.m_lastFailureType=D2L.Validation.NumberFailureType.LT;return false}if(value<D2L.Util.Decimal.MinValue){this.m_lastFailureType=
D2L.Validation.NumberFailureType.NaNOutOfRange;return false}if(this.m_maxIsSet)if(this.GetMaxIsInclusive()){if(value>this.GetMax()){this.m_lastFailureType=D2L.Validation.NumberFailureType.GTE;return false}}else if(value>=this.GetMax()){this.m_lastFailureType=D2L.Validation.NumberFailureType.GT;return false}if(value>D2L.Util.Decimal.MaxValue){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaNOutOfRange;return false}return true},ValidateObject:function(obj){var dr=new D2L.Util.DelayedReturn;
var me=this;obj.GetValue().Register(function(value){dr.Trigger(me.Validate(D2L.Util.Decimal.Parse(value)))});return dr},ValidateObjectNoDelay:function(obj){return this.Validate(obj.GetValueNoDelay())}});D2L.Control.ValidatorDecimal=D2L.Validation.DecimalValidator;D2L.Validation.EmailValidator=D2L.Validation.StringValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value);this.SetRegex(D2L.Util.Email.GetValidityRegex());this.SetRegexFailureText(new D2L.LP.Text.LangTerm("Framework.Validation.EmailInvalid"))}});
D2L.Control.ValidatorEmail=D2L.Validation.EmailValidator;
D2L.Validation.FileNameValidator=D2L.Validation.StringValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value);this.SetRestrictLength(true);this.SetRegex(new RegExp(D2L.Files.ValidFileNameNoMaxCharactersRegex));this.SetRegexFailureText(new D2L.LP.Text.LangTerm("Framework.Validation.FileNameInvalid",D2L.Files.InvalidFileNameCharacters));this.m_validExtensions=null;this.m_reservedFilenames=["con","prn","aux","nul","com1","com2","com3","com4","com5","com6","com7","com8",
"com9","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9","clock$"]},SetValidExtensions:function(extensions){this.m_validExtensions=extensions},SetRestrictLength:function(restrictLength){if(restrictLength)this.SetMaxCharacters(D2L.Files.MaxFileNameCharacters);else this.SetMaxCharacters(0)},Validate:function(value){value=value.trim();var pass=arguments.callee.$.Validate.call(this,value);if(!pass)return false;var valueToCompare=value.toLowerCase();var pos=value.indexOf(".");if(pos>0)valueToCompare=
value.substring(0,pos).toLowerCase();for(var i=0;i<this.m_reservedFilenames.length;i++)if(this.m_reservedFilenames[i]==valueToCompare){this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.FileNameReserved");return false}var extension="";var dotIndex=value.lastIndexOf(".");if(dotIndex>-1&&dotIndex!=value.length-1)extension=value.substr(dotIndex+1).toLowerCase();var extensions=D2L.Files.RestrictedExtensions;for(var i=0;i<extensions.length;i++)if(extension==extensions[i]){this.m_failureText=
new D2L.LP.Text.LangTerm("Framework.Validation.FileSetRestrictedExtension");return false}if(this.m_validExtensions!==null&&this.m_validExtensions.length>0){var valid=false;for(var i=0;i<this.m_validExtensions.length;i++)if(extension==this.m_validExtensions[i]){valid=true;break}if(!valid){this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.FileSetInvalidExtension",this.m_validExtensions.join(", "));return false}}return true}});D2L.Control.ValidatorFileName=D2L.Validation.FileNameValidator;
D2L.Validation.FileSetValidator=D2L.Validation.IValidator.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_maxTotalFileSize=0;this.m_totalFileSize=0;this.m_fileNames=[];this.m_failureText=null;this.m_truncateFileNames=false;this.m_filenameValidator=new D2L.Validation.FileNameValidator;this.m_filenameValidator.SetRestrictLength(false)},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);this.m_maxTotalFileSize=deserializer.GetMember();
if(deserializer.HasMember())this.m_filenameValidator.SetValidExtensions(deserializer.GetMember())},GetFailureText:function(){return this.m_failureText},GetMaxTotalFileSize:function(){return this.m_maxTotalFileSize},GetTotalFileSize:function(){return this.m_totalFileSize},SetMaxTotalFileSize:function(maxTotalFileSize){this.m_maxTotalFileSize=maxTotalFileSize},SetTotalFileSize:function(totalFileSize){this.m_totalFileSize=totalFileSize},ValidateObject:function(obj){if(obj.SetValidationFailureIndex)obj.SetValidationFailureIndex(-1);
if(obj.GetMaxTotalFileSize)this.SetMaxTotalFileSize(obj.GetMaxTotalFileSize());if(obj.GetTotalFileSize)this.SetTotalFileSize(obj.GetTotalFileSize());if(obj.GetFileNames)this.m_fileNames=obj.GetFileNames();if(this.m_maxTotalFileSize>0&&this.m_totalFileSize>this.m_maxTotalFileSize){this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.FileSetMaxTotalFileSizeExceeded",Culture.FormatFileSize(this.m_maxTotalFileSize));return new D2L.Util.DelayedReturn(false)}var me=this;var index=0;var ValidateFileName=
function(){if(me.m_fileNames.length===index)return new D2L.Util.DelayedReturn(true);var fileName=me.m_fileNames[index];if(fileName.length===0)return ValidateFileName(++index);var isValid=me.m_filenameValidator.Validate(fileName);if(!isValid){me.m_failureText=me.m_filenameValidator.GetFailureText();return new D2L.Util.DelayedReturn(false)}if(fileName.length>D2L.Files.MaxFileNameCharacters&&!me.m_truncateFileNames){var dr=new D2L.Util.DelayedReturn;var Cb=function(dialogResponse){if(dialogResponse.GetType()==
D2L.Dialog.ResponseType.Positive){me.m_truncateFileNames=true;dr.Trigger(ValidateFileName(++index))}else{me.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.FileSetFileNameTooLong",D2L.Files.MaxFileNameCharacters);dr.Trigger(false)}};UI.Confirm(Cb,new D2L.LP.Text.LangTerm("Framework.Validation.FileSetFileNameTooLong1",D2L.Files.MaxFileNameCharacters),new D2L.LP.Text.LangTerm("Framework.Validation.FileSetFileNameTooLong2"));return dr}else return ValidateFileName(++index)};var result=ValidateFileName(index);
result.Register(function(success){if(!success)obj.SetValidationFailureIndex(index)});return result}});D2L.Control.ValidatorFileSet=D2L.Validation.FileSetValidator;
D2L.Validation.FolderNameValidator=D2L.Validation.StringValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value);this.SetMaxCharacters(D2L.Files.MaxDirectoryNameCharacters);this.SetRegex(new RegExp(D2L.Files.ValidDirectoryNameRegex));this.SetRegexFailureText(new D2L.LP.Text.LangTerm("Framework.Validation.FolderNameInvalid",D2L.Files.InvalidDirectoryNameCharacters));this.m_reservedFoldernames=["con","prn","aux","nul","com1","com2","com3","com4","com5","com6","com7",
"com8","com9","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9","clock$"]},Validate:function(value){value=value.trim();var pass=arguments.callee.$.Validate.call(this,value);if(!pass)return false;var valueToCompare=value.toLowerCase();for(var i=0;i<this.m_reservedFoldernames.length;i++)if(this.m_reservedFoldernames[i]==valueToCompare){this.m_failureText=new D2L.LP.Text.LangTerm("Framework.Validation.FolderNameReserved");return false}return true}});D2L.Control.ValidatorFolderName=D2L.Validation.FolderNameValidator;
D2L.Validation.Group=D2L.Class.extend({Construct:function(name){if(name===undefined)name="";arguments.callee.$.Construct.call(this);this.m_controls=[];this.m_isEnabled=true;this.m_name=name},DeserializeMin:function(deserializer){this.m_name=deserializer.GetMember().toLowerCase();this.m_controls=deserializer.GetObjectArrayMin(D2L.Validation.ValidationControlInfo)},GetName:function(){return this.m_name},IsEnabled:function(){return this.m_isEnabled},SetIsEnabled:function(isEnabled){this.m_isEnabled=
isEnabled},Validate:function(skipFailureMessage){return UI.GetValidationManager().Validate(this.GetName(),skipFailureMessage)}});
D2L.Validation.Int64Validator=D2L.Validation.IValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this);if(value===undefined)value=0;this.m_value=value;this.m_is64Bit=true;this.m_min=null;this.m_max=null;this.m_minIsInclusive=true;this.m_maxIsInclusive=true;this.m_minIsSet=false;this.m_maxIsSet=false;this.m_lastFailureType=D2L.Validation.NumberFailureType.None},IntegrateControlMin:function(deserializer){this.m_min=deserializer.GetMember();this.m_max=deserializer.GetMember();
this.m_minIsSet=deserializer.GetBoolean();this.m_maxIsSet=deserializer.GetBoolean();this.m_minIsInclusive=deserializer.GetBoolean();this.m_maxIsInclusive=deserializer.GetBoolean()},GetFailureText:function(){if(this.m_lastFailureType==D2L.Validation.NumberFailureType.NaN)return new D2L.LP.Text.LangTerm("Framework.Validation.IntegerInvalid");else if(this.m_lastFailureType==D2L.Validation.NumberFailureType.NaNOutOfRange)if(!this.m_is64Bit)return new D2L.LP.Text.LangTerm("Framework.Validation.IntegerInvalid32",
D2L.Util.Integer.Format(D2L.Util.Integer.MinValue32),D2L.Util.Integer.Format(D2L.Util.Integer.MaxValue32));else return new D2L.LP.Text.LangTerm("Framework.Validation.IntegerInvalid64",D2L.Util.Integer.Format(D2L.Util.Integer.MinValue64),D2L.Util.Integer.Format(D2L.Util.Integer.MaxValue64));var param1=undefined;var param2=undefined;var term;if(this.m_minIsSet&&this.m_maxIsSet){param1=this.m_min;if(param1!=undefined)param1=D2L.Util.Integer.Format(param1);param2=this.m_max;if(param2!=undefined)param2=
D2L.Util.Integer.Format(param2);if(this.m_minIsInclusive&&this.m_maxIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenBothInclusive",param1,param2);else if(this.m_minIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenMinInclusive",param1,param2);else if(this.m_maxIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenMaxInclusive",param1,param2);else term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberBetweenNoneInclusive",
param1,param2)}else if(this.m_minIsSet){param1=this.m_min;if(param1!=undefined)param1=D2L.Util.Integer.Format(param1);if(this.m_minIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberHigherInclusive",param1);else term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberHigher",param1)}else if(this.m_maxIsSet){param1=this.m_max;if(param1!=undefined)param1=D2L.Util.Integer.Format(param1);if(this.m_maxIsInclusive)term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberLowerInclusive",
param1);else term=new D2L.LP.Text.LangTerm("Framework.Validation.NumberLower",param1)}else;return term},GetMax:function(){return this.m_max},GetMin:function(){return this.m_min},GetMaxIsInclusive:function(){return this.m_maxIsInclusive},GetMinIsInclusive:function(){return this.m_minIsInclusive},GetValue:function(){return this.m_value},SetMax:function(max){this.m_max=max;this.m_maxIsSet=true},SetMin:function(min){this.m_min=min;this.m_minIsSet=true},SetMaxIsInclusive:function(maxIsInclusive){this.m_maxIsInclusive=
maxIsInclusive},SetMinIsInclusive:function(minIsInclusive){this.m_minIsInclusive=minIsInclusive},SetValue:function(value){this.m_value=value},Validate:function(value){if(value===undefined)value=this.m_value;this.m_lastFailureType=D2L.Validation.NumberFailureType.None;if(value.isString){if(value.length===0)return true;try{value=D2L.Util.Integer.Parse(value)}catch(e){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaN;return false}}if(isNaN(value)){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaN;
return false}if(this.m_minIsSet)if(this.GetMinIsInclusive()){if(value<this.GetMin()){this.m_lastFailureType=D2L.Validation.NumberFailureType.LTE;return false}}else if(value<=this.GetMin()){this.m_lastFailureType=D2L.Validation.NumberFailureType.LT;return false}if(!this.m_is64Bit&&value<D2L.Util.Integer.MinValue32||this.m_is64Bit&&value<D2L.Util.Integer.MinValue64){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaNOutOfRange;return false}if(this.m_maxIsSet)if(this.GetMaxIsInclusive()){if(value>
this.GetMax()){this.m_lastFailureType=D2L.Validation.NumberFailureType.GTE;return false}}else if(value>=this.GetMax()){this.m_lastFailureType=D2L.Validation.NumberFailureType.GT;return false}if(!this.m_is64Bit&&value>D2L.Util.Integer.MaxValue32||this.m_is64Bit&&value>D2L.Util.Integer.MaxValue64){this.m_lastFailureType=D2L.Validation.NumberFailureType.NaNOutOfRange;return false}return true},ValidateObject:function(obj){var dr=new D2L.Util.DelayedReturn;var me=this;obj.GetValue().Register(function(value){dr.Trigger(me.Validate(D2L.Util.Integer.Parse(value)))});
return dr},ValidateObjectNoDelay:function(obj){return this.Validate(obj.GetValueNoDelay())}});D2L.Control.ValidatorInt64=D2L.Validation.Int64Validator;D2L.Validation.Int32Validator=D2L.Validation.Int64Validator.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value);this.m_is64Bit=false}});D2L.Control.ValidatorInt32=D2L.Validation.Int32Validator;
D2L.Validation.Manager=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_groups=[];this.m_groupLessControls=[];this.m_isValidating=false},DeserializeMin:function(deserializer){this.m_groups=deserializer.GetObjectArrayMin(D2L.Validation.Group)},GetControlInfo:function(cId,addToAction){var vci=null;for(var i=0;i<this.m_groups.length;i++)for(var j=0;j<this.m_groups[i].m_controls.length;j++)if(this.m_groups[i].m_controls[j].ControlId.ID()==cId.ID()&&this.m_groups[i].m_controls[j].ControlId.SID()==
cId.SID()){vci=this.m_groups[i].m_controls[j];break}if(vci===null){vci=new D2L.Validation.ValidationControlInfo;vci.ControlId=cId;this.m_groupLessControls.push(vci);if(addToAction)this.SetControlValidationGroup(cId,"action")}return vci},SetControlValidator:function(cId,vcId){var vci=this.GetControlInfo(cId,true);vci.ValidatorControlId=vcId},SetControlSubject:function(cId,subject){if(subject===undefined||subject===null)subject="";this.GetControlInfo(cId).Subject=subject},SetControlValidationGroup:function(cId,
groupName){groupName=groupName.toLowerCase();var vci=null;for(var i=0;i<this.m_groups.length;i++)for(var j=0;j<this.m_groups[i].m_controls.length;j++)if(this.m_groups[i].m_controls[j].ControlId.ID()==cId.ID()&&this.m_groups[i].m_controls[j].ControlId.SID()==cId.SID()){vci=this.m_groups[i].m_controls[j];this.m_groups[i].m_controls.splice(j,1);break}for(var i=0;i<this.m_groupLessControls.length;i++)if(this.m_groupLessControls[i].ControlId.ID()==cId.ID()&&this.m_groupLessControls[i].ControlId.SID()==
cId.SID()){vci=this.m_groupLessControls[i];this.m_groupLessControls.splice(i,1);break}if(vci===null){vci=new D2L.Validation.ValidationControlInfo;vci.ControlId=cId}var group=this.GetGroup(groupName,true);group.m_controls.push(vci)},GetGroup:function(groupName,addIfNotThere){if(addIfNotThere===undefined)addIfNotThere=false;groupName=groupName.toLowerCase();for(var i=0;i<this.m_groups.length;i++)if(this.m_groups[i].GetName()==groupName)return this.m_groups[i];if(addIfNotThere){var group=new D2L.Validation.Group(groupName);
this.m_groups.push(group);return group}return null},Validate:function(groupNames,skipFailureMessage){if(!D2L.Util.JavaScript.IsArray(groupNames))groupNames=[groupNames];var controlHash={};var controls=[];for(var i=0;i<groupNames.length;i++){var group=this.GetGroup(groupNames[i]);if(group!==null&&group.IsEnabled())for(var j=0;j<group.m_controls.length;j++){var key=group.m_controls[j].ControlId.ID()+"_"+group.m_controls[j].ControlId.SID();if(controlHash[key]===undefined){controlHash[key]=true;controls.push(group.m_controls[j])}}}return this.ValidateControls(controls,
skipFailureMessage)},ValidateControls:function(controls,skipFailureMessage){if(controls.length===0)return new D2L.Util.DelayedReturn(true);if(this.m_isValidating)return new D2L.Util.DelayedReturn(false);this.m_isValidating=true;if(skipFailureMessage===undefined)skipFailureMessage=false;var ret=new D2L.Util.DelayedReturn;var success=true;var me=this;var Finish=function(pass){me.m_isValidating=false;ret.Trigger(pass)};var HandleReturn=function(vci,validator,control,pass){validator.m_passed=pass;if(!pass){success=
false;if(!skipFailureMessage){WindowEventManager.BubbleExpandEvent(control.GetDomNode(),null);var failureText=validator.GetFailureText();if(failureText!==null){failureText.SetSubject(vci.Subject);UI.GetMessageArea().AddError(failureText,control)}}}};var Validate=function(index){if(index==controls.length)if(!success&&!skipFailureMessage)setTimeout(function(){UI.GetMessageArea().ShowErrors(true).Register(function(){Finish(false)})});else Finish(success);else{var vci=controls[index];var validator=UI.GetControl(vci.ValidatorControlId.ID(),
vci.ValidatorControlId.SID());var control=UI.GetControl(vci.ControlId.ID(),vci.ControlId.SID());if((control.Validate!==undefined||control.IsInDom())&&(control.IsEnabled===undefined||control.IsEnabled())){var dRet=null;if(validator.CanValidateNoDelay(control))dRet=validator.ValidateObjectNoDelay(control);else dRet=validator.ValidateObject(control);if(D2L.Util.IsDelayedReturn(dRet))dRet.Register(function(pass){HandleReturn(vci,validator,control,pass);Validate(++index)});else{HandleReturn(vci,validator,
control,dRet);Validate(++index)}}else Validate(++index)}};UI.GetMessageArea().Reset().Register(function(){Validate(0)});return ret},ValidateGroup:function(groupName,skipFailureMessage){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.SmlText("ValidationManager.ValidateGroup('[0]') "+"is deprecated, use Validate() instead.",groupName),false);if(skipFailureMessage===undefined)skipFailureMessage=false;var controls=[];var group=this.GetGroup(groupName);if(group===null||!group.IsEnabled())return true;
var controls=group.m_controls;var success=true;if(controls.length===0)return true;if(this.m_isValidating)return false;this.m_isValidating=true;var mrDr=UI.GetMessageArea().Reset();var me=this;var HandleReturn=function(vci,validator,control,pass){validator.m_passed=pass;if(!pass){success=false;if(!skipFailureMessage){WindowEventManager.BubbleExpandEvent(control.GetDomNode(),null);var failureText=validator.GetFailureText();if(failureText!==null)failureText.SetSubject(vci.Subject);mrDr.Register(function(){UI.GetMessageArea().AddError(failureText,
control)})}}};var Validate=function(index){if(index==controls.length)if(!success){if(!skipFailureMessage)mrDr.Register(function(){UI.GetMessageArea().ShowErrors(true).Register(function(){me.m_isValidating=false})});return false}else{me.m_isValidating=false;return true}else{var vci=controls[index];var validator=UI.GetControl(vci.ValidatorControlId.ID(),vci.ValidatorControlId.SID());var control=UI.GetControl(vci.ControlId.ID(),vci.ControlId.SID());if(control.IsEnabled===undefined||control.IsEnabled()){var pass=
validator.ValidateObjectNoDelay(control);HandleReturn(vci,validator,control,pass);return Validate(++index)&&pass}else return Validate(++index)}};return Validate(0)}});
D2L.Validation.RegexValidator=D2L.Validation.StringValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this,value)},IntegrateControlMin:function(deserializer){if(deserializer.HasMember()){this.SetRegex(new RegExp(deserializer.GetMember()));this.SetRegexFailureText(deserializer.GetObject(D2L.LP.Text.IText))}arguments.callee.$.IntegrateControlMin.call(this,deserializer)}});D2L.Control.ValidatorRegex=D2L.Validation.RegexValidator;
D2L.Validation.RequiredValidator=D2L.Validation.IValidator.extend({Construct:function(value){arguments.callee.$.Construct.call(this);this.m_value=value;this.m_failureTerm=null},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);if(deserializer.HasMember())this.m_failureTerm=new D2L.LP.Text.LangTerm(deserializer.GetMember())},GetFailureText:function(){if(this.m_failureTerm===null)return new D2L.LP.Text.LangTerm("Framework.Validation.Required");
else return this.m_failureTerm},GetValue:function(){return this.m_value},SetValue:function(value){this.m_value=value},Validate:function(value){if(value===undefined)value=this.GetValue();if(value===undefined||value===null)return false;if(value.isString)return value.trim().length>0;return true},ValidateObject:function(obj){var dr=new D2L.Util.DelayedReturn;obj.HasValue().Register(function(value){dr.Trigger(value)});return dr},ValidateObjectNoDelay:function(obj){return obj.HasValueNoDelay()}});
D2L.Control.ValidatorRequired=D2L.Validation.RequiredValidator;D2L.Validation.ValidationControlInfo=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.ControlId=null;this.ValidatorControlId=null;this.Subject="";this.IsEnablerTargetItem=false},DeserializeMin:function(deserializer){this.ControlId=deserializer.GetObjectMin(D2L.Control.Id);this.ValidatorControlId=deserializer.GetObjectMin(D2L.Control.Id);this.Subject=deserializer.GetMember();this.IsEnablerTargetItem=deserializer.GetBoolean()}});
/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={};}YAHOO.namespace=function(){var A=arguments,E=null,C,B,D;for(C=0;C<A.length;C=C+1){D=(""+A[C]).split(".");E=YAHOO;for(B=(D[0]=="YAHOO")?1:0;B<D.length;B=B+1){E[D[B]]=E[D[B]]||{};E=E[D[B]];}}return E;};YAHOO.log=function(D,A,C){var B=YAHOO.widget.Logger;if(B&&B.log){return B.log(D,A,C);}else{return false;}};YAHOO.register=function(A,E,D){var I=YAHOO.env.modules,B,H,G,F,C;if(!I[A]){I[A]={versions:[],builds:[]};}B=I[A];H=D.version;G=D.build;F=YAHOO.env.listeners;B.name=A;B.version=H;B.build=G;B.versions.push(H);B.builds.push(G);B.mainClass=E;for(C=0;C<F.length;C=C+1){F[C](B);}if(E){E.VERSION=H;E.BUILD=G;}else{YAHOO.log("mainClass is undefined for module "+A,"warn");}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(A){return YAHOO.env.modules[A]||null;};YAHOO.env.ua=function(){var C={ie:0,opera:0,gecko:0,webkit:0,mobile:null,air:0,caja:0},B=navigator.userAgent,A;if((/KHTML/).test(B)){C.webkit=1;}A=B.match(/AppleWebKit\/([^\s]*)/);if(A&&A[1]){C.webkit=parseFloat(A[1]);if(/ Mobile\//.test(B)){C.mobile="Apple";}else{A=B.match(/NokiaN[^\/]*/);if(A){C.mobile=A[0];}}A=B.match(/AdobeAIR\/([^\s]*)/);if(A){C.air=A[0];}}if(!C.webkit){A=B.match(/Opera[\s\/]([^\s]*)/);if(A&&A[1]){C.opera=parseFloat(A[1]);A=B.match(/Opera Mini[^;]*/);if(A){C.mobile=A[0];}}else{A=B.match(/MSIE\s([^;]*)/);if(A&&A[1]){C.ie=parseFloat(A[1]);}else{A=B.match(/Gecko\/([^\s]*)/);if(A){C.gecko=1;A=B.match(/rv:([^\s\)]*)/);if(A&&A[1]){C.gecko=parseFloat(A[1]);}}}}}A=B.match(/Caja\/([^\s]*)/);if(A&&A[1]){C.caja=parseFloat(A[1]);}return C;}();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var B=YAHOO_config.listener,A=YAHOO.env.listeners,D=true,C;if(B){for(C=0;C<A.length;C=C+1){if(A[C]==B){D=false;break;}}if(D){A.push(B);}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var B=YAHOO.lang,F="[object Array]",C="[object Function]",A=Object.prototype,E=["toString","valueOf"],D={isArray:function(G){return A.toString.apply(G)===F;},isBoolean:function(G){return typeof G==="boolean";},isFunction:function(G){return A.toString.apply(G)===C;},isNull:function(G){return G===null;},isNumber:function(G){return typeof G==="number"&&isFinite(G);},isObject:function(G){return(G&&(typeof G==="object"||B.isFunction(G)))||false;},isString:function(G){return typeof G==="string";},isUndefined:function(G){return typeof G==="undefined";},_IEEnumFix:(YAHOO.env.ua.ie)?function(I,H){var G,K,J;for(G=0;G<E.length;G=G+1){K=E[G];J=H[K];if(B.isFunction(J)&&J!=A[K]){I[K]=J;}}}:function(){},extend:function(J,K,I){if(!K||!J){throw new Error("extend failed, please check that "+"all dependencies are included.");}var H=function(){},G;H.prototype=K.prototype;J.prototype=new H();J.prototype.constructor=J;J.superclass=K.prototype;if(K.prototype.constructor==A.constructor){K.prototype.constructor=K;}if(I){for(G in I){if(B.hasOwnProperty(I,G)){J.prototype[G]=I[G];}}B._IEEnumFix(J.prototype,I);}},augmentObject:function(K,J){if(!J||!K){throw new Error("Absorb failed, verify dependencies.");}var G=arguments,I,L,H=G[2];if(H&&H!==true){for(I=2;I<G.length;I=I+1){K[G[I]]=J[G[I]];}}else{for(L in J){if(H||!(L in K)){K[L]=J[L];}}B._IEEnumFix(K,J);}},augmentProto:function(J,I){if(!I||!J){throw new Error("Augment failed, verify dependencies.");}var G=[J.prototype,I.prototype],H;for(H=2;H<arguments.length;H=H+1){G.push(arguments[H]);}B.augmentObject.apply(this,G);},dump:function(G,L){var I,K,N=[],O="{...}",H="f(){...}",M=", ",J=" => ";if(!B.isObject(G)){return G+"";}else{if(G instanceof Date||("nodeType" in G&&"tagName" in G)){return G;}else{if(B.isFunction(G)){return H;}}}L=(B.isNumber(L))?L:3;if(B.isArray(G)){N.push("[");for(I=0,K=G.length;I<K;I=I+1){if(B.isObject(G[I])){N.push((L>0)?B.dump(G[I],L-1):O);}else{N.push(G[I]);}N.push(M);}if(N.length>1){N.pop();}N.push("]");}else{N.push("{");for(I in G){if(B.hasOwnProperty(G,I)){N.push(I+J);if(B.isObject(G[I])){N.push((L>0)?B.dump(G[I],L-1):O);}else{N.push(G[I]);}N.push(M);}}if(N.length>1){N.pop();}N.push("}");}return N.join("");},substitute:function(V,H,O){var L,K,J,R,S,U,Q=[],I,M="dump",P=" ",G="{",T="}",N;for(;;){L=V.lastIndexOf(G);if(L<0){break;}K=V.indexOf(T,L);if(L+1>=K){break;}I=V.substring(L+1,K);R=I;U=null;J=R.indexOf(P);if(J>-1){U=R.substring(J+1);R=R.substring(0,J);}S=H[R];if(O){S=O(R,S,U);}if(B.isObject(S)){if(B.isArray(S)){S=B.dump(S,parseInt(U,10));}else{U=U||"";N=U.indexOf(M);if(N>-1){U=U.substring(4);}if(S.toString===A.toString||N>-1){S=B.dump(S,parseInt(U,10));}else{S=S.toString();}}}else{if(!B.isString(S)&&!B.isNumber(S)){S="~-"+Q.length+"-~";Q[Q.length]=I;}}V=V.substring(0,L)+S+V.substring(K+1);}for(L=Q.length-1;L>=0;L=L-1){V=V.replace(new RegExp("~-"+L+"-~"),"{"+Q[L]+"}","g");}return V;},trim:function(G){try{return G.replace(/^\s+|\s+$/g,"");}catch(H){return G;}},merge:function(){var J={},H=arguments,G=H.length,I;for(I=0;I<G;I=I+1){B.augmentObject(J,H[I],true);}return J;},later:function(N,H,O,J,K){N=N||0;H=H||{};var I=O,M=J,L,G;if(B.isString(O)){I=H[O];}if(!I){throw new TypeError("method undefined");}if(!B.isArray(M)){M=[J];}L=function(){I.apply(H,M);};G=(K)?setInterval(L,N):setTimeout(L,N);return{interval:K,cancel:function(){if(this.interval){clearInterval(G);}else{clearTimeout(G);}}};},isValue:function(G){return(B.isObject(G)||B.isString(G)||B.isNumber(G)||B.isBoolean(G));}};B.hasOwnProperty=(A.hasOwnProperty)?function(G,H){return G&&G.hasOwnProperty(H);}:function(G,H){return !B.isUndefined(G[H])&&G.constructor.prototype[H]!==G[H];};D.augmentObject(B,D,true);YAHOO.util.Lang=B;B.augment=B.augmentProto;YAHOO.augment=B.augmentProto;YAHOO.extend=B.extend;})();YAHOO.register("yahoo",YAHOO,{version:"2.7.0",build:"1799"});/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
(function(){YAHOO.env._id_counter=YAHOO.env._id_counter||0;var E=YAHOO.util,L=YAHOO.lang,m=YAHOO.env.ua,A=YAHOO.lang.trim,d={},h={},N=/^t(?:able|d|h)$/i,X=/color$/i,K=window.document,W=K.documentElement,e="ownerDocument",n="defaultView",v="documentElement",t="compatMode",b="offsetLeft",P="offsetTop",u="offsetParent",Z="parentNode",l="nodeType",C="tagName",O="scrollLeft",i="scrollTop",Q="getBoundingClientRect",w="getComputedStyle",a="currentStyle",M="CSS1Compat",c="BackCompat",g="class",F="className",J="",B=" ",s="(?:^|\\s)",k="(?= |$)",U="g",p="position",f="fixed",V="relative",j="left",o="top",r="medium",q="borderLeftWidth",R="borderTopWidth",D=m.opera,I=m.webkit,H=m.gecko,T=m.ie;E.Dom={CUSTOM_ATTRIBUTES:(!W.hasAttribute)?{"for":"htmlFor","class":F}:{"htmlFor":"for","className":g},get:function(y){var AA,Y,z,x,G;if(y){if(y[l]||y.item){return y;}if(typeof y==="string"){AA=y;y=K.getElementById(y);if(y&&y.id===AA){return y;}else{if(y&&K.all){y=null;Y=K.all[AA];for(x=0,G=Y.length;x<G;++x){if(Y[x].id===AA){return Y[x];}}}}return y;}if(y.DOM_EVENTS){y=y.get("element");}if("length" in y){z=[];for(x=0,G=y.length;x<G;++x){z[z.length]=E.Dom.get(y[x]);}return z;}return y;}return null;},getComputedStyle:function(G,Y){if(window[w]){return G[e][n][w](G,null)[Y];}else{if(G[a]){return E.Dom.IE_ComputedStyle.get(G,Y);}}},getStyle:function(G,Y){return E.Dom.batch(G,E.Dom._getStyle,Y);},_getStyle:function(){if(window[w]){return function(G,y){y=(y==="float")?y="cssFloat":E.Dom._toCamel(y);var x=G.style[y],Y;if(!x){Y=G[e][n][w](G,null);if(Y){x=Y[y];}}return x;};}else{if(W[a]){return function(G,y){var x;switch(y){case"opacity":x=100;try{x=G.filters["DXImageTransform.Microsoft.Alpha"].opacity;}catch(z){try{x=G.filters("alpha").opacity;}catch(Y){}}return x/100;case"float":y="styleFloat";default:y=E.Dom._toCamel(y);x=G[a]?G[a][y]:null;return(G.style[y]||x);}};}}}(),setStyle:function(G,Y,x){E.Dom.batch(G,E.Dom._setStyle,{prop:Y,val:x});},_setStyle:function(){if(T){return function(Y,G){var x=E.Dom._toCamel(G.prop),y=G.val;if(Y){switch(x){case"opacity":if(L.isString(Y.style.filter)){Y.style.filter="alpha(opacity="+y*100+")";if(!Y[a]||!Y[a].hasLayout){Y.style.zoom=1;}}break;case"float":x="styleFloat";default:Y.style[x]=y;}}else{}};}else{return function(Y,G){var x=E.Dom._toCamel(G.prop),y=G.val;if(Y){if(x=="float"){x="cssFloat";}Y.style[x]=y;}else{}};}}(),getXY:function(G){return E.Dom.batch(G,E.Dom._getXY);},_canPosition:function(G){return(E.Dom._getStyle(G,"display")!=="none"&&E.Dom._inDoc(G));},_getXY:function(){if(K[v][Q]){return function(y){var z,Y,AA,AF,AE,AD,AC,G,x,AB=Math.floor,AG=false;if(E.Dom._canPosition(y)){AA=y[Q]();AF=y[e];z=E.Dom.getDocumentScrollLeft(AF);Y=E.Dom.getDocumentScrollTop(AF);AG=[AB(AA[j]),AB(AA[o])];if(T&&m.ie<8){AE=2;AD=2;AC=AF[t];G=S(AF[v],q);x=S(AF[v],R);if(m.ie===6){if(AC!==c){AE=0;AD=0;}}if((AC==c)){if(G!==r){AE=parseInt(G,10);}if(x!==r){AD=parseInt(x,10);}}AG[0]-=AE;AG[1]-=AD;}if((Y||z)){AG[0]+=z;AG[1]+=Y;}AG[0]=AB(AG[0]);AG[1]=AB(AG[1]);}else{}return AG;};}else{return function(y){var x,Y,AA,AB,AC,z=false,G=y;if(E.Dom._canPosition(y)){z=[y[b],y[P]];x=E.Dom.getDocumentScrollLeft(y[e]);Y=E.Dom.getDocumentScrollTop(y[e]);AC=((H||m.webkit>519)?true:false);while((G=G[u])){z[0]+=G[b];z[1]+=G[P];if(AC){z=E.Dom._calcBorders(G,z);}}if(E.Dom._getStyle(y,p)!==f){G=y;while((G=G[Z])&&G[C]){AA=G[i];AB=G[O];if(H&&(E.Dom._getStyle(G,"overflow")!=="visible")){z=E.Dom._calcBorders(G,z);}if(AA||AB){z[0]-=AB;z[1]-=AA;}}z[0]+=x;z[1]+=Y;}else{if(D){z[0]-=x;z[1]-=Y;}else{if(I||H){z[0]+=x;z[1]+=Y;}}}z[0]=Math.floor(z[0]);z[1]=Math.floor(z[1]);}else{}return z;};}}(),getX:function(G){var Y=function(x){return E.Dom.getXY(x)[0];};return E.Dom.batch(G,Y,E.Dom,true);},getY:function(G){var Y=function(x){return E.Dom.getXY(x)[1];};return E.Dom.batch(G,Y,E.Dom,true);},setXY:function(G,x,Y){E.Dom.batch(G,E.Dom._setXY,{pos:x,noRetry:Y});},_setXY:function(G,z){var AA=E.Dom._getStyle(G,p),y=E.Dom.setStyle,AD=z.pos,Y=z.noRetry,AB=[parseInt(E.Dom.getComputedStyle(G,j),10),parseInt(E.Dom.getComputedStyle(G,o),10)],AC,x;if(AA=="static"){AA=V;y(G,p,AA);}AC=E.Dom._getXY(G);if(!AD||AC===false){return false;}if(isNaN(AB[0])){AB[0]=(AA==V)?0:G[b];}if(isNaN(AB[1])){AB[1]=(AA==V)?0:G[P];}if(AD[0]!==null){y(G,j,AD[0]-AC[0]+AB[0]+"px");}if(AD[1]!==null){y(G,o,AD[1]-AC[1]+AB[1]+"px");}if(!Y){x=E.Dom._getXY(G);if((AD[0]!==null&&x[0]!=AD[0])||(AD[1]!==null&&x[1]!=AD[1])){E.Dom._setXY(G,{pos:AD,noRetry:true});}}},setX:function(Y,G){E.Dom.setXY(Y,[G,null]);},setY:function(G,Y){E.Dom.setXY(G,[null,Y]);},getRegion:function(G){var Y=function(x){var y=false;if(E.Dom._canPosition(x)){y=E.Region.getRegion(x);}else{}return y;};return E.Dom.batch(G,Y,E.Dom,true);},getClientWidth:function(){return E.Dom.getViewportWidth();},getClientHeight:function(){return E.Dom.getViewportHeight();},getElementsByClassName:function(AB,AF,AC,AE,x,AD){AB=L.trim(AB);AF=AF||"*";AC=(AC)?E.Dom.get(AC):null||K;if(!AC){return[];}var Y=[],G=AC.getElementsByTagName(AF),z=E.Dom.hasClass;for(var y=0,AA=G.length;y<AA;++y){if(z(G[y],AB)){Y[Y.length]=G[y];}}if(AE){E.Dom.batch(Y,AE,x,AD);}return Y;},hasClass:function(Y,G){return E.Dom.batch(Y,E.Dom._hasClass,G);},_hasClass:function(x,Y){var G=false,y;if(x&&Y){y=E.Dom.getAttribute(x,F)||J;if(Y.exec){G=Y.test(y);}else{G=Y&&(B+y+B).indexOf(B+Y+B)>-1;}}else{}return G;},addClass:function(Y,G){return E.Dom.batch(Y,E.Dom._addClass,G);},_addClass:function(x,Y){var G=false,y;if(x&&Y){y=E.Dom.getAttribute(x,F)||J;if(!E.Dom._hasClass(x,Y)){E.Dom.setAttribute(x,F,A(y+B+Y));G=true;}}else{}return G;},removeClass:function(Y,G){return E.Dom.batch(Y,E.Dom._removeClass,G);},_removeClass:function(y,x){var Y=false,AA,z,G;if(y&&x){AA=E.Dom.getAttribute(y,F)||J;E.Dom.setAttribute(y,F,AA.replace(E.Dom._getClassRegex(x),J));z=E.Dom.getAttribute(y,F);if(AA!==z){E.Dom.setAttribute(y,F,A(z));Y=true;if(E.Dom.getAttribute(y,F)===""){G=(y.hasAttribute&&y.hasAttribute(g))?g:F;y.removeAttribute(G);}}}else{}return Y;},replaceClass:function(x,Y,G){return E.Dom.batch(x,E.Dom._replaceClass,{from:Y,to:G});
},_replaceClass:function(y,x){var Y,AB,AA,G=false,z;if(y&&x){AB=x.from;AA=x.to;if(!AA){G=false;}else{if(!AB){G=E.Dom._addClass(y,x.to);}else{if(AB!==AA){z=E.Dom.getAttribute(y,F)||J;Y=(B+z.replace(E.Dom._getClassRegex(AB),B+AA)).split(E.Dom._getClassRegex(AA));Y.splice(1,0,B+AA);E.Dom.setAttribute(y,F,A(Y.join(J)));G=true;}}}}else{}return G;},generateId:function(G,x){x=x||"yui-gen";var Y=function(y){if(y&&y.id){return y.id;}var z=x+YAHOO.env._id_counter++;if(y){if(y[e].getElementById(z)){return E.Dom.generateId(y,z+x);}y.id=z;}return z;};return E.Dom.batch(G,Y,E.Dom,true)||Y.apply(E.Dom,arguments);},isAncestor:function(Y,x){Y=E.Dom.get(Y);x=E.Dom.get(x);var G=false;if((Y&&x)&&(Y[l]&&x[l])){if(Y.contains&&Y!==x){G=Y.contains(x);}else{if(Y.compareDocumentPosition){G=!!(Y.compareDocumentPosition(x)&16);}}}else{}return G;},inDocument:function(G,Y){return E.Dom._inDoc(E.Dom.get(G),Y);},_inDoc:function(Y,x){var G=false;if(Y&&Y[C]){x=x||Y[e];G=E.Dom.isAncestor(x[v],Y);}else{}return G;},getElementsBy:function(Y,AF,AB,AD,y,AC,AE){AF=AF||"*";AB=(AB)?E.Dom.get(AB):null||K;if(!AB){return[];}var x=[],G=AB.getElementsByTagName(AF);for(var z=0,AA=G.length;z<AA;++z){if(Y(G[z])){if(AE){x=G[z];break;}else{x[x.length]=G[z];}}}if(AD){E.Dom.batch(x,AD,y,AC);}return x;},getElementBy:function(x,G,Y){return E.Dom.getElementsBy(x,G,Y,null,null,null,true);},batch:function(x,AB,AA,z){var y=[],Y=(z)?AA:window;x=(x&&(x[C]||x.item))?x:E.Dom.get(x);if(x&&AB){if(x[C]||x.length===undefined){return AB.call(Y,x,AA);}for(var G=0;G<x.length;++G){y[y.length]=AB.call(Y,x[G],AA);}}else{return false;}return y;},getDocumentHeight:function(){var Y=(K[t]!=M||I)?K.body.scrollHeight:W.scrollHeight,G=Math.max(Y,E.Dom.getViewportHeight());return G;},getDocumentWidth:function(){var Y=(K[t]!=M||I)?K.body.scrollWidth:W.scrollWidth,G=Math.max(Y,E.Dom.getViewportWidth());return G;},getViewportHeight:function(){var G=self.innerHeight,Y=K[t];if((Y||T)&&!D){G=(Y==M)?W.clientHeight:K.body.clientHeight;}return G;},getViewportWidth:function(){var G=self.innerWidth,Y=K[t];if(Y||T){G=(Y==M)?W.clientWidth:K.body.clientWidth;}return G;},getAncestorBy:function(G,Y){while((G=G[Z])){if(E.Dom._testElement(G,Y)){return G;}}return null;},getAncestorByClassName:function(Y,G){Y=E.Dom.get(Y);if(!Y){return null;}var x=function(y){return E.Dom.hasClass(y,G);};return E.Dom.getAncestorBy(Y,x);},getAncestorByTagName:function(Y,G){Y=E.Dom.get(Y);if(!Y){return null;}var x=function(y){return y[C]&&y[C].toUpperCase()==G.toUpperCase();};return E.Dom.getAncestorBy(Y,x);},getPreviousSiblingBy:function(G,Y){while(G){G=G.previousSibling;if(E.Dom._testElement(G,Y)){return G;}}return null;},getPreviousSibling:function(G){G=E.Dom.get(G);if(!G){return null;}return E.Dom.getPreviousSiblingBy(G);},getNextSiblingBy:function(G,Y){while(G){G=G.nextSibling;if(E.Dom._testElement(G,Y)){return G;}}return null;},getNextSibling:function(G){G=E.Dom.get(G);if(!G){return null;}return E.Dom.getNextSiblingBy(G);},getFirstChildBy:function(G,x){var Y=(E.Dom._testElement(G.firstChild,x))?G.firstChild:null;return Y||E.Dom.getNextSiblingBy(G.firstChild,x);},getFirstChild:function(G,Y){G=E.Dom.get(G);if(!G){return null;}return E.Dom.getFirstChildBy(G);},getLastChildBy:function(G,x){if(!G){return null;}var Y=(E.Dom._testElement(G.lastChild,x))?G.lastChild:null;return Y||E.Dom.getPreviousSiblingBy(G.lastChild,x);},getLastChild:function(G){G=E.Dom.get(G);return E.Dom.getLastChildBy(G);},getChildrenBy:function(Y,y){var x=E.Dom.getFirstChildBy(Y,y),G=x?[x]:[];E.Dom.getNextSiblingBy(x,function(z){if(!y||y(z)){G[G.length]=z;}return false;});return G;},getChildren:function(G){G=E.Dom.get(G);if(!G){}return E.Dom.getChildrenBy(G);},getDocumentScrollLeft:function(G){G=G||K;return Math.max(G[v].scrollLeft,G.body.scrollLeft);},getDocumentScrollTop:function(G){G=G||K;return Math.max(G[v].scrollTop,G.body.scrollTop);},insertBefore:function(Y,G){Y=E.Dom.get(Y);G=E.Dom.get(G);if(!Y||!G||!G[Z]){return null;}return G[Z].insertBefore(Y,G);},insertAfter:function(Y,G){Y=E.Dom.get(Y);G=E.Dom.get(G);if(!Y||!G||!G[Z]){return null;}if(G.nextSibling){return G[Z].insertBefore(Y,G.nextSibling);}else{return G[Z].appendChild(Y);}},getClientRegion:function(){var x=E.Dom.getDocumentScrollTop(),Y=E.Dom.getDocumentScrollLeft(),y=E.Dom.getViewportWidth()+Y,G=E.Dom.getViewportHeight()+x;return new E.Region(x,y,G,Y);},setAttribute:function(Y,G,x){G=E.Dom.CUSTOM_ATTRIBUTES[G]||G;Y.setAttribute(G,x);},getAttribute:function(Y,G){G=E.Dom.CUSTOM_ATTRIBUTES[G]||G;return Y.getAttribute(G);},_toCamel:function(Y){var x=d;function G(y,z){return z.toUpperCase();}return x[Y]||(x[Y]=Y.indexOf("-")===-1?Y:Y.replace(/-([a-z])/gi,G));},_getClassRegex:function(Y){var G;if(Y!==undefined){if(Y.exec){G=Y;}else{G=h[Y];if(!G){Y=Y.replace(E.Dom._patterns.CLASS_RE_TOKENS,"\\$1");G=h[Y]=new RegExp(s+Y+k,U);}}}return G;},_patterns:{ROOT_TAG:/^body|html$/i,CLASS_RE_TOKENS:/([\.\(\)\^\$\*\+\?\|\[\]\{\}])/g},_testElement:function(G,Y){return G&&G[l]==1&&(!Y||Y(G));},_calcBorders:function(x,y){var Y=parseInt(E.Dom[w](x,R),10)||0,G=parseInt(E.Dom[w](x,q),10)||0;if(H){if(N.test(x[C])){Y=0;G=0;}}y[0]+=G;y[1]+=Y;return y;}};var S=E.Dom[w];if(m.opera){E.Dom[w]=function(Y,G){var x=S(Y,G);if(X.test(G)){x=E.Dom.Color.toRGB(x);}return x;};}if(m.webkit){E.Dom[w]=function(Y,G){var x=S(Y,G);if(x==="rgba(0, 0, 0, 0)"){x="transparent";}return x;};}})();YAHOO.util.Region=function(C,D,A,B){this.top=C;this.y=C;this[1]=C;this.right=D;this.bottom=A;this.left=B;this.x=B;this[0]=B;this.width=this.right-this.left;this.height=this.bottom-this.top;};YAHOO.util.Region.prototype.contains=function(A){return(A.left>=this.left&&A.right<=this.right&&A.top>=this.top&&A.bottom<=this.bottom);};YAHOO.util.Region.prototype.getArea=function(){return((this.bottom-this.top)*(this.right-this.left));};YAHOO.util.Region.prototype.intersect=function(E){var C=Math.max(this.top,E.top),D=Math.min(this.right,E.right),A=Math.min(this.bottom,E.bottom),B=Math.max(this.left,E.left);if(A>=C&&D>=B){return new YAHOO.util.Region(C,D,A,B);
}else{return null;}};YAHOO.util.Region.prototype.union=function(E){var C=Math.min(this.top,E.top),D=Math.max(this.right,E.right),A=Math.max(this.bottom,E.bottom),B=Math.min(this.left,E.left);return new YAHOO.util.Region(C,D,A,B);};YAHOO.util.Region.prototype.toString=function(){return("Region {"+"top: "+this.top+", right: "+this.right+", bottom: "+this.bottom+", left: "+this.left+", height: "+this.height+", width: "+this.width+"}");};YAHOO.util.Region.getRegion=function(D){var F=YAHOO.util.Dom.getXY(D),C=F[1],E=F[0]+D.offsetWidth,A=F[1]+D.offsetHeight,B=F[0];return new YAHOO.util.Region(C,E,A,B);};YAHOO.util.Point=function(A,B){if(YAHOO.lang.isArray(A)){B=A[1];A=A[0];}YAHOO.util.Point.superclass.constructor.call(this,B,A,B,A);};YAHOO.extend(YAHOO.util.Point,YAHOO.util.Region);(function(){var B=YAHOO.util,A="clientTop",F="clientLeft",J="parentNode",K="right",W="hasLayout",I="px",U="opacity",L="auto",D="borderLeftWidth",G="borderTopWidth",P="borderRightWidth",V="borderBottomWidth",S="visible",Q="transparent",N="height",E="width",H="style",T="currentStyle",R=/^width|height$/,O=/^(\d[.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz|%){1}?/i,M={get:function(X,Z){var Y="",a=X[T][Z];if(Z===U){Y=B.Dom.getStyle(X,U);}else{if(!a||(a.indexOf&&a.indexOf(I)>-1)){Y=a;}else{if(B.Dom.IE_COMPUTED[Z]){Y=B.Dom.IE_COMPUTED[Z](X,Z);}else{if(O.test(a)){Y=B.Dom.IE.ComputedStyle.getPixel(X,Z);}else{Y=a;}}}}return Y;},getOffset:function(Z,e){var b=Z[T][e],X=e.charAt(0).toUpperCase()+e.substr(1),c="offset"+X,Y="pixel"+X,a="",d;if(b==L){d=Z[c];if(d===undefined){a=0;}a=d;if(R.test(e)){Z[H][e]=d;if(Z[c]>d){a=d-(Z[c]-d);}Z[H][e]=L;}}else{if(!Z[H][Y]&&!Z[H][e]){Z[H][e]=b;}a=Z[H][Y];}return a+I;},getBorderWidth:function(X,Z){var Y=null;if(!X[T][W]){X[H].zoom=1;}switch(Z){case G:Y=X[A];break;case V:Y=X.offsetHeight-X.clientHeight-X[A];break;case D:Y=X[F];break;case P:Y=X.offsetWidth-X.clientWidth-X[F];break;}return Y+I;},getPixel:function(Y,X){var a=null,b=Y[T][K],Z=Y[T][X];Y[H][K]=Z;a=Y[H].pixelRight;Y[H][K]=b;return a+I;},getMargin:function(Y,X){var Z;if(Y[T][X]==L){Z=0+I;}else{Z=B.Dom.IE.ComputedStyle.getPixel(Y,X);}return Z;},getVisibility:function(Y,X){var Z;while((Z=Y[T])&&Z[X]=="inherit"){Y=Y[J];}return(Z)?Z[X]:S;},getColor:function(Y,X){return B.Dom.Color.toRGB(Y[T][X])||Q;},getBorderColor:function(Y,X){var Z=Y[T],a=Z[X]||Z.color;return B.Dom.Color.toRGB(B.Dom.Color.toHex(a));}},C={};C.top=C.right=C.bottom=C.left=C[E]=C[N]=M.getOffset;C.color=M.getColor;C[G]=C[P]=C[V]=C[D]=M.getBorderWidth;C.marginTop=C.marginRight=C.marginBottom=C.marginLeft=M.getMargin;C.visibility=M.getVisibility;C.borderColor=C.borderTopColor=C.borderRightColor=C.borderBottomColor=C.borderLeftColor=M.getBorderColor;B.Dom.IE_COMPUTED=C;B.Dom.IE_ComputedStyle=M;})();(function(){var C="toString",A=parseInt,B=RegExp,D=YAHOO.util;D.Dom.Color={KEYWORDS:{black:"000",silver:"c0c0c0",gray:"808080",white:"fff",maroon:"800000",red:"f00",purple:"800080",fuchsia:"f0f",green:"008000",lime:"0f0",olive:"808000",yellow:"ff0",navy:"000080",blue:"00f",teal:"008080",aqua:"0ff"},re_RGB:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,re_hex:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,re_hex3:/([0-9A-F])/gi,toRGB:function(E){if(!D.Dom.Color.re_RGB.test(E)){E=D.Dom.Color.toHex(E);}if(D.Dom.Color.re_hex.exec(E)){E="rgb("+[A(B.$1,16),A(B.$2,16),A(B.$3,16)].join(", ")+")";}return E;},toHex:function(H){H=D.Dom.Color.KEYWORDS[H]||H;if(D.Dom.Color.re_RGB.exec(H)){var G=(B.$1.length===1)?"0"+B.$1:Number(B.$1),F=(B.$2.length===1)?"0"+B.$2:Number(B.$2),E=(B.$3.length===1)?"0"+B.$3:Number(B.$3);H=[G[C](16),F[C](16),E[C](16)].join("");}if(H.length<6){H=H.replace(D.Dom.Color.re_hex3,"$1$1");}if(H!=="transparent"&&H.indexOf("#")<0){H="#"+H;}return H.toLowerCase();}};}());YAHOO.register("dom",YAHOO.util.Dom,{version:"2.7.0",build:"1796"});/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={};}YAHOO.namespace=function(){var A=arguments,E=null,C,B,D;for(C=0;C<A.length;C=C+1){D=(""+A[C]).split(".");E=YAHOO;for(B=(D[0]=="YAHOO")?1:0;B<D.length;B=B+1){E[D[B]]=E[D[B]]||{};E=E[D[B]];}}return E;};YAHOO.log=function(D,A,C){var B=YAHOO.widget.Logger;if(B&&B.log){return B.log(D,A,C);}else{return false;}};YAHOO.register=function(A,E,D){var I=YAHOO.env.modules,B,H,G,F,C;if(!I[A]){I[A]={versions:[],builds:[]};}B=I[A];H=D.version;G=D.build;F=YAHOO.env.listeners;B.name=A;B.version=H;B.build=G;B.versions.push(H);B.builds.push(G);B.mainClass=E;for(C=0;C<F.length;C=C+1){F[C](B);}if(E){E.VERSION=H;E.BUILD=G;}else{YAHOO.log("mainClass is undefined for module "+A,"warn");}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(A){return YAHOO.env.modules[A]||null;};YAHOO.env.ua=function(){var C={ie:0,opera:0,gecko:0,webkit:0,mobile:null,air:0,caja:0},B=navigator.userAgent,A;if((/KHTML/).test(B)){C.webkit=1;}A=B.match(/AppleWebKit\/([^\s]*)/);if(A&&A[1]){C.webkit=parseFloat(A[1]);if(/ Mobile\//.test(B)){C.mobile="Apple";}else{A=B.match(/NokiaN[^\/]*/);if(A){C.mobile=A[0];}}A=B.match(/AdobeAIR\/([^\s]*)/);if(A){C.air=A[0];}}if(!C.webkit){A=B.match(/Opera[\s\/]([^\s]*)/);if(A&&A[1]){C.opera=parseFloat(A[1]);A=B.match(/Opera Mini[^;]*/);if(A){C.mobile=A[0];}}else{A=B.match(/MSIE\s([^;]*)/);if(A&&A[1]){C.ie=parseFloat(A[1]);}else{A=B.match(/Gecko\/([^\s]*)/);if(A){C.gecko=1;A=B.match(/rv:([^\s\)]*)/);if(A&&A[1]){C.gecko=parseFloat(A[1]);}}}}}A=B.match(/Caja\/([^\s]*)/);if(A&&A[1]){C.caja=parseFloat(A[1]);}return C;}();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var B=YAHOO_config.listener,A=YAHOO.env.listeners,D=true,C;if(B){for(C=0;C<A.length;C=C+1){if(A[C]==B){D=false;break;}}if(D){A.push(B);}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var B=YAHOO.lang,F="[object Array]",C="[object Function]",A=Object.prototype,E=["toString","valueOf"],D={isArray:function(G){return A.toString.apply(G)===F;},isBoolean:function(G){return typeof G==="boolean";},isFunction:function(G){return A.toString.apply(G)===C;},isNull:function(G){return G===null;},isNumber:function(G){return typeof G==="number"&&isFinite(G);},isObject:function(G){return(G&&(typeof G==="object"||B.isFunction(G)))||false;},isString:function(G){return typeof G==="string";},isUndefined:function(G){return typeof G==="undefined";},_IEEnumFix:(YAHOO.env.ua.ie)?function(I,H){var G,K,J;for(G=0;G<E.length;G=G+1){K=E[G];J=H[K];if(B.isFunction(J)&&J!=A[K]){I[K]=J;}}}:function(){},extend:function(J,K,I){if(!K||!J){throw new Error("extend failed, please check that "+"all dependencies are included.");}var H=function(){},G;H.prototype=K.prototype;J.prototype=new H();J.prototype.constructor=J;J.superclass=K.prototype;if(K.prototype.constructor==A.constructor){K.prototype.constructor=K;}if(I){for(G in I){if(B.hasOwnProperty(I,G)){J.prototype[G]=I[G];}}B._IEEnumFix(J.prototype,I);}},augmentObject:function(K,J){if(!J||!K){throw new Error("Absorb failed, verify dependencies.");}var G=arguments,I,L,H=G[2];if(H&&H!==true){for(I=2;I<G.length;I=I+1){K[G[I]]=J[G[I]];}}else{for(L in J){if(H||!(L in K)){K[L]=J[L];}}B._IEEnumFix(K,J);}},augmentProto:function(J,I){if(!I||!J){throw new Error("Augment failed, verify dependencies.");}var G=[J.prototype,I.prototype],H;for(H=2;H<arguments.length;H=H+1){G.push(arguments[H]);}B.augmentObject.apply(this,G);},dump:function(G,L){var I,K,N=[],O="{...}",H="f(){...}",M=", ",J=" => ";if(!B.isObject(G)){return G+"";}else{if(G instanceof Date||("nodeType" in G&&"tagName" in G)){return G;}else{if(B.isFunction(G)){return H;}}}L=(B.isNumber(L))?L:3;if(B.isArray(G)){N.push("[");for(I=0,K=G.length;I<K;I=I+1){if(B.isObject(G[I])){N.push((L>0)?B.dump(G[I],L-1):O);}else{N.push(G[I]);}N.push(M);}if(N.length>1){N.pop();}N.push("]");}else{N.push("{");for(I in G){if(B.hasOwnProperty(G,I)){N.push(I+J);if(B.isObject(G[I])){N.push((L>0)?B.dump(G[I],L-1):O);}else{N.push(G[I]);}N.push(M);}}if(N.length>1){N.pop();}N.push("}");}return N.join("");},substitute:function(V,H,O){var L,K,J,R,S,U,Q=[],I,M="dump",P=" ",G="{",T="}",N;for(;;){L=V.lastIndexOf(G);if(L<0){break;}K=V.indexOf(T,L);if(L+1>=K){break;}I=V.substring(L+1,K);R=I;U=null;J=R.indexOf(P);if(J>-1){U=R.substring(J+1);R=R.substring(0,J);}S=H[R];if(O){S=O(R,S,U);}if(B.isObject(S)){if(B.isArray(S)){S=B.dump(S,parseInt(U,10));}else{U=U||"";N=U.indexOf(M);if(N>-1){U=U.substring(4);}if(S.toString===A.toString||N>-1){S=B.dump(S,parseInt(U,10));}else{S=S.toString();}}}else{if(!B.isString(S)&&!B.isNumber(S)){S="~-"+Q.length+"-~";Q[Q.length]=I;}}V=V.substring(0,L)+S+V.substring(K+1);}for(L=Q.length-1;L>=0;L=L-1){V=V.replace(new RegExp("~-"+L+"-~"),"{"+Q[L]+"}","g");}return V;},trim:function(G){try{return G.replace(/^\s+|\s+$/g,"");}catch(H){return G;}},merge:function(){var J={},H=arguments,G=H.length,I;for(I=0;I<G;I=I+1){B.augmentObject(J,H[I],true);}return J;},later:function(N,H,O,J,K){N=N||0;H=H||{};var I=O,M=J,L,G;if(B.isString(O)){I=H[O];}if(!I){throw new TypeError("method undefined");}if(!B.isArray(M)){M=[J];}L=function(){I.apply(H,M);};G=(K)?setInterval(L,N):setTimeout(L,N);return{interval:K,cancel:function(){if(this.interval){clearInterval(G);}else{clearTimeout(G);}}};},isValue:function(G){return(B.isObject(G)||B.isString(G)||B.isNumber(G)||B.isBoolean(G));}};B.hasOwnProperty=(A.hasOwnProperty)?function(G,H){return G&&G.hasOwnProperty(H);}:function(G,H){return !B.isUndefined(G[H])&&G.constructor.prototype[H]!==G[H];};D.augmentObject(B,D,true);YAHOO.util.Lang=B;B.augment=B.augmentProto;YAHOO.augment=B.augmentProto;YAHOO.extend=B.extend;})();YAHOO.register("yahoo",YAHOO,{version:"2.7.0",build:"1799"});(function(){YAHOO.env._id_counter=YAHOO.env._id_counter||0;var E=YAHOO.util,L=YAHOO.lang,m=YAHOO.env.ua,A=YAHOO.lang.trim,d={},h={},N=/^t(?:able|d|h)$/i,X=/color$/i,K=window.document,W=K.documentElement,e="ownerDocument",n="defaultView",v="documentElement",t="compatMode",b="offsetLeft",P="offsetTop",u="offsetParent",Z="parentNode",l="nodeType",C="tagName",O="scrollLeft",i="scrollTop",Q="getBoundingClientRect",w="getComputedStyle",a="currentStyle",M="CSS1Compat",c="BackCompat",g="class",F="className",J="",B=" ",s="(?:^|\\s)",k="(?= |$)",U="g",p="position",f="fixed",V="relative",j="left",o="top",r="medium",q="borderLeftWidth",R="borderTopWidth",D=m.opera,I=m.webkit,H=m.gecko,T=m.ie;E.Dom={CUSTOM_ATTRIBUTES:(!W.hasAttribute)?{"for":"htmlFor","class":F}:{"htmlFor":"for","className":g},get:function(y){var AA,Y,z,x,G;if(y){if(y[l]||y.item){return y;}if(typeof y==="string"){AA=y;y=K.getElementById(y);if(y&&y.id===AA){return y;}else{if(y&&K.all){y=null;Y=K.all[AA];for(x=0,G=Y.length;x<G;++x){if(Y[x].id===AA){return Y[x];}}}}return y;}if(y.DOM_EVENTS){y=y.get("element");}if("length" in y){z=[];for(x=0,G=y.length;x<G;++x){z[z.length]=E.Dom.get(y[x]);}return z;}return y;}return null;},getComputedStyle:function(G,Y){if(window[w]){return G[e][n][w](G,null)[Y];}else{if(G[a]){return E.Dom.IE_ComputedStyle.get(G,Y);}}},getStyle:function(G,Y){return E.Dom.batch(G,E.Dom._getStyle,Y);},_getStyle:function(){if(window[w]){return function(G,y){y=(y==="float")?y="cssFloat":E.Dom._toCamel(y);var x=G.style[y],Y;if(!x){Y=G[e][n][w](G,null);if(Y){x=Y[y];}}return x;};}else{if(W[a]){return function(G,y){var x;switch(y){case"opacity":x=100;try{x=G.filters["DXImageTransform.Microsoft.Alpha"].opacity;}catch(z){try{x=G.filters("alpha").opacity;}catch(Y){}}return x/100;case"float":y="styleFloat";default:y=E.Dom._toCamel(y);x=G[a]?G[a][y]:null;return(G.style[y]||x);}};}}}(),setStyle:function(G,Y,x){E.Dom.batch(G,E.Dom._setStyle,{prop:Y,val:x});},_setStyle:function(){if(T){return function(Y,G){var x=E.Dom._toCamel(G.prop),y=G.val;if(Y){switch(x){case"opacity":if(L.isString(Y.style.filter)){Y.style.filter="alpha(opacity="+y*100+")";if(!Y[a]||!Y[a].hasLayout){Y.style.zoom=1;}}break;case"float":x="styleFloat";default:Y.style[x]=y;}}else{}};}else{return function(Y,G){var x=E.Dom._toCamel(G.prop),y=G.val;if(Y){if(x=="float"){x="cssFloat";}Y.style[x]=y;}else{}};}}(),getXY:function(G){return E.Dom.batch(G,E.Dom._getXY);},_canPosition:function(G){return(E.Dom._getStyle(G,"display")!=="none"&&E.Dom._inDoc(G));},_getXY:function(){if(K[v][Q]){return function(y){var z,Y,AA,AF,AE,AD,AC,G,x,AB=Math.floor,AG=false;if(E.Dom._canPosition(y)){AA=y[Q]();AF=y[e];z=E.Dom.getDocumentScrollLeft(AF);Y=E.Dom.getDocumentScrollTop(AF);AG=[AB(AA[j]),AB(AA[o])];if(T&&m.ie<8){AE=2;AD=2;AC=AF[t];G=S(AF[v],q);x=S(AF[v],R);if(m.ie===6){if(AC!==c){AE=0;AD=0;}}if((AC==c)){if(G!==r){AE=parseInt(G,10);}if(x!==r){AD=parseInt(x,10);}}AG[0]-=AE;AG[1]-=AD;}if((Y||z)){AG[0]+=z;AG[1]+=Y;}AG[0]=AB(AG[0]);AG[1]=AB(AG[1]);}else{}return AG;};}else{return function(y){var x,Y,AA,AB,AC,z=false,G=y;if(E.Dom._canPosition(y)){z=[y[b],y[P]];x=E.Dom.getDocumentScrollLeft(y[e]);Y=E.Dom.getDocumentScrollTop(y[e]);AC=((H||m.webkit>519)?true:false);while((G=G[u])){z[0]+=G[b];z[1]+=G[P];if(AC){z=E.Dom._calcBorders(G,z);}}if(E.Dom._getStyle(y,p)!==f){G=y;while((G=G[Z])&&G[C]){AA=G[i];AB=G[O];if(H&&(E.Dom._getStyle(G,"overflow")!=="visible")){z=E.Dom._calcBorders(G,z);}if(AA||AB){z[0]-=AB;z[1]-=AA;}}z[0]+=x;z[1]+=Y;}else{if(D){z[0]-=x;z[1]-=Y;}else{if(I||H){z[0]+=x;z[1]+=Y;}}}z[0]=Math.floor(z[0]);z[1]=Math.floor(z[1]);}else{}return z;};}}(),getX:function(G){var Y=function(x){return E.Dom.getXY(x)[0];};return E.Dom.batch(G,Y,E.Dom,true);},getY:function(G){var Y=function(x){return E.Dom.getXY(x)[1];};return E.Dom.batch(G,Y,E.Dom,true);},setXY:function(G,x,Y){E.Dom.batch(G,E.Dom._setXY,{pos:x,noRetry:Y});},_setXY:function(G,z){var AA=E.Dom._getStyle(G,p),y=E.Dom.setStyle,AD=z.pos,Y=z.noRetry,AB=[parseInt(E.Dom.getComputedStyle(G,j),10),parseInt(E.Dom.getComputedStyle(G,o),10)],AC,x;if(AA=="static"){AA=V;y(G,p,AA);}AC=E.Dom._getXY(G);if(!AD||AC===false){return false;}if(isNaN(AB[0])){AB[0]=(AA==V)?0:G[b];}if(isNaN(AB[1])){AB[1]=(AA==V)?0:G[P];}if(AD[0]!==null){y(G,j,AD[0]-AC[0]+AB[0]+"px");}if(AD[1]!==null){y(G,o,AD[1]-AC[1]+AB[1]+"px");}if(!Y){x=E.Dom._getXY(G);if((AD[0]!==null&&x[0]!=AD[0])||(AD[1]!==null&&x[1]!=AD[1])){E.Dom._setXY(G,{pos:AD,noRetry:true});}}},setX:function(Y,G){E.Dom.setXY(Y,[G,null]);},setY:function(G,Y){E.Dom.setXY(G,[null,Y]);},getRegion:function(G){var Y=function(x){var y=false;if(E.Dom._canPosition(x)){y=E.Region.getRegion(x);}else{}return y;};return E.Dom.batch(G,Y,E.Dom,true);},getClientWidth:function(){return E.Dom.getViewportWidth();},getClientHeight:function(){return E.Dom.getViewportHeight();},getElementsByClassName:function(AB,AF,AC,AE,x,AD){AB=L.trim(AB);AF=AF||"*";AC=(AC)?E.Dom.get(AC):null||K;if(!AC){return[];}var Y=[],G=AC.getElementsByTagName(AF),z=E.Dom.hasClass;for(var y=0,AA=G.length;y<AA;++y){if(z(G[y],AB)){Y[Y.length]=G[y];}}if(AE){E.Dom.batch(Y,AE,x,AD);}return Y;},hasClass:function(Y,G){return E.Dom.batch(Y,E.Dom._hasClass,G);},_hasClass:function(x,Y){var G=false,y;if(x&&Y){y=E.Dom.getAttribute(x,F)||J;if(Y.exec){G=Y.test(y);}else{G=Y&&(B+y+B).indexOf(B+Y+B)>-1;}}else{}return G;},addClass:function(Y,G){return E.Dom.batch(Y,E.Dom._addClass,G);},_addClass:function(x,Y){var G=false,y;if(x&&Y){y=E.Dom.getAttribute(x,F)||J;if(!E.Dom._hasClass(x,Y)){E.Dom.setAttribute(x,F,A(y+B+Y));G=true;}}else{}return G;},removeClass:function(Y,G){return E.Dom.batch(Y,E.Dom._removeClass,G);},_removeClass:function(y,x){var Y=false,AA,z,G;if(y&&x){AA=E.Dom.getAttribute(y,F)||J;E.Dom.setAttribute(y,F,AA.replace(E.Dom._getClassRegex(x),J));z=E.Dom.getAttribute(y,F);if(AA!==z){E.Dom.setAttribute(y,F,A(z));Y=true;if(E.Dom.getAttribute(y,F)===""){G=(y.hasAttribute&&y.hasAttribute(g))?g:F;y.removeAttribute(G);}}}else{}return Y;},replaceClass:function(x,Y,G){return E.Dom.batch(x,E.Dom._replaceClass,{from:Y,to:G});
},_replaceClass:function(y,x){var Y,AB,AA,G=false,z;if(y&&x){AB=x.from;AA=x.to;if(!AA){G=false;}else{if(!AB){G=E.Dom._addClass(y,x.to);}else{if(AB!==AA){z=E.Dom.getAttribute(y,F)||J;Y=(B+z.replace(E.Dom._getClassRegex(AB),B+AA)).split(E.Dom._getClassRegex(AA));Y.splice(1,0,B+AA);E.Dom.setAttribute(y,F,A(Y.join(J)));G=true;}}}}else{}return G;},generateId:function(G,x){x=x||"yui-gen";var Y=function(y){if(y&&y.id){return y.id;}var z=x+YAHOO.env._id_counter++;if(y){if(y[e].getElementById(z)){return E.Dom.generateId(y,z+x);}y.id=z;}return z;};return E.Dom.batch(G,Y,E.Dom,true)||Y.apply(E.Dom,arguments);},isAncestor:function(Y,x){Y=E.Dom.get(Y);x=E.Dom.get(x);var G=false;if((Y&&x)&&(Y[l]&&x[l])){if(Y.contains&&Y!==x){G=Y.contains(x);}else{if(Y.compareDocumentPosition){G=!!(Y.compareDocumentPosition(x)&16);}}}else{}return G;},inDocument:function(G,Y){return E.Dom._inDoc(E.Dom.get(G),Y);},_inDoc:function(Y,x){var G=false;if(Y&&Y[C]){x=x||Y[e];G=E.Dom.isAncestor(x[v],Y);}else{}return G;},getElementsBy:function(Y,AF,AB,AD,y,AC,AE){AF=AF||"*";AB=(AB)?E.Dom.get(AB):null||K;if(!AB){return[];}var x=[],G=AB.getElementsByTagName(AF);for(var z=0,AA=G.length;z<AA;++z){if(Y(G[z])){if(AE){x=G[z];break;}else{x[x.length]=G[z];}}}if(AD){E.Dom.batch(x,AD,y,AC);}return x;},getElementBy:function(x,G,Y){return E.Dom.getElementsBy(x,G,Y,null,null,null,true);},batch:function(x,AB,AA,z){var y=[],Y=(z)?AA:window;x=(x&&(x[C]||x.item))?x:E.Dom.get(x);if(x&&AB){if(x[C]||x.length===undefined){return AB.call(Y,x,AA);}for(var G=0;G<x.length;++G){y[y.length]=AB.call(Y,x[G],AA);}}else{return false;}return y;},getDocumentHeight:function(){var Y=(K[t]!=M||I)?K.body.scrollHeight:W.scrollHeight,G=Math.max(Y,E.Dom.getViewportHeight());return G;},getDocumentWidth:function(){var Y=(K[t]!=M||I)?K.body.scrollWidth:W.scrollWidth,G=Math.max(Y,E.Dom.getViewportWidth());return G;},getViewportHeight:function(){var G=self.innerHeight,Y=K[t];if((Y||T)&&!D){G=(Y==M)?W.clientHeight:K.body.clientHeight;}return G;},getViewportWidth:function(){var G=self.innerWidth,Y=K[t];if(Y||T){G=(Y==M)?W.clientWidth:K.body.clientWidth;}return G;},getAncestorBy:function(G,Y){while((G=G[Z])){if(E.Dom._testElement(G,Y)){return G;}}return null;},getAncestorByClassName:function(Y,G){Y=E.Dom.get(Y);if(!Y){return null;}var x=function(y){return E.Dom.hasClass(y,G);};return E.Dom.getAncestorBy(Y,x);},getAncestorByTagName:function(Y,G){Y=E.Dom.get(Y);if(!Y){return null;}var x=function(y){return y[C]&&y[C].toUpperCase()==G.toUpperCase();};return E.Dom.getAncestorBy(Y,x);},getPreviousSiblingBy:function(G,Y){while(G){G=G.previousSibling;if(E.Dom._testElement(G,Y)){return G;}}return null;},getPreviousSibling:function(G){G=E.Dom.get(G);if(!G){return null;}return E.Dom.getPreviousSiblingBy(G);},getNextSiblingBy:function(G,Y){while(G){G=G.nextSibling;if(E.Dom._testElement(G,Y)){return G;}}return null;},getNextSibling:function(G){G=E.Dom.get(G);if(!G){return null;}return E.Dom.getNextSiblingBy(G);},getFirstChildBy:function(G,x){var Y=(E.Dom._testElement(G.firstChild,x))?G.firstChild:null;return Y||E.Dom.getNextSiblingBy(G.firstChild,x);},getFirstChild:function(G,Y){G=E.Dom.get(G);if(!G){return null;}return E.Dom.getFirstChildBy(G);},getLastChildBy:function(G,x){if(!G){return null;}var Y=(E.Dom._testElement(G.lastChild,x))?G.lastChild:null;return Y||E.Dom.getPreviousSiblingBy(G.lastChild,x);},getLastChild:function(G){G=E.Dom.get(G);return E.Dom.getLastChildBy(G);},getChildrenBy:function(Y,y){var x=E.Dom.getFirstChildBy(Y,y),G=x?[x]:[];E.Dom.getNextSiblingBy(x,function(z){if(!y||y(z)){G[G.length]=z;}return false;});return G;},getChildren:function(G){G=E.Dom.get(G);if(!G){}return E.Dom.getChildrenBy(G);},getDocumentScrollLeft:function(G){G=G||K;return Math.max(G[v].scrollLeft,G.body.scrollLeft);},getDocumentScrollTop:function(G){G=G||K;return Math.max(G[v].scrollTop,G.body.scrollTop);},insertBefore:function(Y,G){Y=E.Dom.get(Y);G=E.Dom.get(G);if(!Y||!G||!G[Z]){return null;}return G[Z].insertBefore(Y,G);},insertAfter:function(Y,G){Y=E.Dom.get(Y);G=E.Dom.get(G);if(!Y||!G||!G[Z]){return null;}if(G.nextSibling){return G[Z].insertBefore(Y,G.nextSibling);}else{return G[Z].appendChild(Y);}},getClientRegion:function(){var x=E.Dom.getDocumentScrollTop(),Y=E.Dom.getDocumentScrollLeft(),y=E.Dom.getViewportWidth()+Y,G=E.Dom.getViewportHeight()+x;return new E.Region(x,y,G,Y);},setAttribute:function(Y,G,x){G=E.Dom.CUSTOM_ATTRIBUTES[G]||G;Y.setAttribute(G,x);},getAttribute:function(Y,G){G=E.Dom.CUSTOM_ATTRIBUTES[G]||G;return Y.getAttribute(G);},_toCamel:function(Y){var x=d;function G(y,z){return z.toUpperCase();}return x[Y]||(x[Y]=Y.indexOf("-")===-1?Y:Y.replace(/-([a-z])/gi,G));},_getClassRegex:function(Y){var G;if(Y!==undefined){if(Y.exec){G=Y;}else{G=h[Y];if(!G){Y=Y.replace(E.Dom._patterns.CLASS_RE_TOKENS,"\\$1");G=h[Y]=new RegExp(s+Y+k,U);}}}return G;},_patterns:{ROOT_TAG:/^body|html$/i,CLASS_RE_TOKENS:/([\.\(\)\^\$\*\+\?\|\[\]\{\}])/g},_testElement:function(G,Y){return G&&G[l]==1&&(!Y||Y(G));},_calcBorders:function(x,y){var Y=parseInt(E.Dom[w](x,R),10)||0,G=parseInt(E.Dom[w](x,q),10)||0;if(H){if(N.test(x[C])){Y=0;G=0;}}y[0]+=G;y[1]+=Y;return y;}};var S=E.Dom[w];if(m.opera){E.Dom[w]=function(Y,G){var x=S(Y,G);if(X.test(G)){x=E.Dom.Color.toRGB(x);}return x;};}if(m.webkit){E.Dom[w]=function(Y,G){var x=S(Y,G);if(x==="rgba(0, 0, 0, 0)"){x="transparent";}return x;};}})();YAHOO.util.Region=function(C,D,A,B){this.top=C;this.y=C;this[1]=C;this.right=D;this.bottom=A;this.left=B;this.x=B;this[0]=B;this.width=this.right-this.left;this.height=this.bottom-this.top;};YAHOO.util.Region.prototype.contains=function(A){return(A.left>=this.left&&A.right<=this.right&&A.top>=this.top&&A.bottom<=this.bottom);};YAHOO.util.Region.prototype.getArea=function(){return((this.bottom-this.top)*(this.right-this.left));};YAHOO.util.Region.prototype.intersect=function(E){var C=Math.max(this.top,E.top),D=Math.min(this.right,E.right),A=Math.min(this.bottom,E.bottom),B=Math.max(this.left,E.left);if(A>=C&&D>=B){return new YAHOO.util.Region(C,D,A,B);
}else{return null;}};YAHOO.util.Region.prototype.union=function(E){var C=Math.min(this.top,E.top),D=Math.max(this.right,E.right),A=Math.max(this.bottom,E.bottom),B=Math.min(this.left,E.left);return new YAHOO.util.Region(C,D,A,B);};YAHOO.util.Region.prototype.toString=function(){return("Region {"+"top: "+this.top+", right: "+this.right+", bottom: "+this.bottom+", left: "+this.left+", height: "+this.height+", width: "+this.width+"}");};YAHOO.util.Region.getRegion=function(D){var F=YAHOO.util.Dom.getXY(D),C=F[1],E=F[0]+D.offsetWidth,A=F[1]+D.offsetHeight,B=F[0];return new YAHOO.util.Region(C,E,A,B);};YAHOO.util.Point=function(A,B){if(YAHOO.lang.isArray(A)){B=A[1];A=A[0];}YAHOO.util.Point.superclass.constructor.call(this,B,A,B,A);};YAHOO.extend(YAHOO.util.Point,YAHOO.util.Region);(function(){var B=YAHOO.util,A="clientTop",F="clientLeft",J="parentNode",K="right",W="hasLayout",I="px",U="opacity",L="auto",D="borderLeftWidth",G="borderTopWidth",P="borderRightWidth",V="borderBottomWidth",S="visible",Q="transparent",N="height",E="width",H="style",T="currentStyle",R=/^width|height$/,O=/^(\d[.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz|%){1}?/i,M={get:function(X,Z){var Y="",a=X[T][Z];if(Z===U){Y=B.Dom.getStyle(X,U);}else{if(!a||(a.indexOf&&a.indexOf(I)>-1)){Y=a;}else{if(B.Dom.IE_COMPUTED[Z]){Y=B.Dom.IE_COMPUTED[Z](X,Z);}else{if(O.test(a)){Y=B.Dom.IE.ComputedStyle.getPixel(X,Z);}else{Y=a;}}}}return Y;},getOffset:function(Z,e){var b=Z[T][e],X=e.charAt(0).toUpperCase()+e.substr(1),c="offset"+X,Y="pixel"+X,a="",d;if(b==L){d=Z[c];if(d===undefined){a=0;}a=d;if(R.test(e)){Z[H][e]=d;if(Z[c]>d){a=d-(Z[c]-d);}Z[H][e]=L;}}else{if(!Z[H][Y]&&!Z[H][e]){Z[H][e]=b;}a=Z[H][Y];}return a+I;},getBorderWidth:function(X,Z){var Y=null;if(!X[T][W]){X[H].zoom=1;}switch(Z){case G:Y=X[A];break;case V:Y=X.offsetHeight-X.clientHeight-X[A];break;case D:Y=X[F];break;case P:Y=X.offsetWidth-X.clientWidth-X[F];break;}return Y+I;},getPixel:function(Y,X){var a=null,b=Y[T][K],Z=Y[T][X];Y[H][K]=Z;a=Y[H].pixelRight;Y[H][K]=b;return a+I;},getMargin:function(Y,X){var Z;if(Y[T][X]==L){Z=0+I;}else{Z=B.Dom.IE.ComputedStyle.getPixel(Y,X);}return Z;},getVisibility:function(Y,X){var Z;while((Z=Y[T])&&Z[X]=="inherit"){Y=Y[J];}return(Z)?Z[X]:S;},getColor:function(Y,X){return B.Dom.Color.toRGB(Y[T][X])||Q;},getBorderColor:function(Y,X){var Z=Y[T],a=Z[X]||Z.color;return B.Dom.Color.toRGB(B.Dom.Color.toHex(a));}},C={};C.top=C.right=C.bottom=C.left=C[E]=C[N]=M.getOffset;C.color=M.getColor;C[G]=C[P]=C[V]=C[D]=M.getBorderWidth;C.marginTop=C.marginRight=C.marginBottom=C.marginLeft=M.getMargin;C.visibility=M.getVisibility;C.borderColor=C.borderTopColor=C.borderRightColor=C.borderBottomColor=C.borderLeftColor=M.getBorderColor;B.Dom.IE_COMPUTED=C;B.Dom.IE_ComputedStyle=M;})();(function(){var C="toString",A=parseInt,B=RegExp,D=YAHOO.util;D.Dom.Color={KEYWORDS:{black:"000",silver:"c0c0c0",gray:"808080",white:"fff",maroon:"800000",red:"f00",purple:"800080",fuchsia:"f0f",green:"008000",lime:"0f0",olive:"808000",yellow:"ff0",navy:"000080",blue:"00f",teal:"008080",aqua:"0ff"},re_RGB:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,re_hex:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,re_hex3:/([0-9A-F])/gi,toRGB:function(E){if(!D.Dom.Color.re_RGB.test(E)){E=D.Dom.Color.toHex(E);}if(D.Dom.Color.re_hex.exec(E)){E="rgb("+[A(B.$1,16),A(B.$2,16),A(B.$3,16)].join(", ")+")";}return E;},toHex:function(H){H=D.Dom.Color.KEYWORDS[H]||H;if(D.Dom.Color.re_RGB.exec(H)){var G=(B.$1.length===1)?"0"+B.$1:Number(B.$1),F=(B.$2.length===1)?"0"+B.$2:Number(B.$2),E=(B.$3.length===1)?"0"+B.$3:Number(B.$3);H=[G[C](16),F[C](16),E[C](16)].join("");}if(H.length<6){H=H.replace(D.Dom.Color.re_hex3,"$1$1");}if(H!=="transparent"&&H.indexOf("#")<0){H="#"+H;}return H.toLowerCase();}};}());YAHOO.register("dom",YAHOO.util.Dom,{version:"2.7.0",build:"1799"});YAHOO.util.CustomEvent=function(D,C,B,A){this.type=D;this.scope=C||window;this.silent=B;this.signature=A||YAHOO.util.CustomEvent.LIST;this.subscribers=[];if(!this.silent){}var E="_YUICEOnSubscribe";if(D!==E){this.subscribeEvent=new YAHOO.util.CustomEvent(E,this,true);}this.lastError=null;};YAHOO.util.CustomEvent.LIST=0;YAHOO.util.CustomEvent.FLAT=1;YAHOO.util.CustomEvent.prototype={subscribe:function(A,B,C){if(!A){throw new Error("Invalid callback for subscriber to '"+this.type+"'");}if(this.subscribeEvent){this.subscribeEvent.fire(A,B,C);}this.subscribers.push(new YAHOO.util.Subscriber(A,B,C));},unsubscribe:function(D,F){if(!D){return this.unsubscribeAll();}var E=false;for(var B=0,A=this.subscribers.length;B<A;++B){var C=this.subscribers[B];if(C&&C.contains(D,F)){this._delete(B);E=true;}}return E;},fire:function(){this.lastError=null;var K=[],E=this.subscribers.length;if(!E&&this.silent){return true;}var I=[].slice.call(arguments,0),G=true,D,J=false;if(!this.silent){}var C=this.subscribers.slice(),A=YAHOO.util.Event.throwErrors;for(D=0;D<E;++D){var M=C[D];if(!M){J=true;}else{if(!this.silent){}var L=M.getScope(this.scope);if(this.signature==YAHOO.util.CustomEvent.FLAT){var B=null;if(I.length>0){B=I[0];}try{G=M.fn.call(L,B,M.obj);}catch(F){this.lastError=F;if(A){throw F;}}}else{try{G=M.fn.call(L,this.type,I,M.obj);}catch(H){this.lastError=H;if(A){throw H;}}}if(false===G){if(!this.silent){}break;}}}return(G!==false);},unsubscribeAll:function(){var A=this.subscribers.length,B;for(B=A-1;B>-1;B--){this._delete(B);}this.subscribers=[];return A;},_delete:function(A){var B=this.subscribers[A];if(B){delete B.fn;delete B.obj;}this.subscribers.splice(A,1);},toString:function(){return"CustomEvent: "+"'"+this.type+"', "+"context: "+this.scope;}};YAHOO.util.Subscriber=function(A,B,C){this.fn=A;this.obj=YAHOO.lang.isUndefined(B)?null:B;this.overrideContext=C;};YAHOO.util.Subscriber.prototype.getScope=function(A){if(this.overrideContext){if(this.overrideContext===true){return this.obj;}else{return this.overrideContext;}}return A;};YAHOO.util.Subscriber.prototype.contains=function(A,B){if(B){return(this.fn==A&&this.obj==B);}else{return(this.fn==A);}};YAHOO.util.Subscriber.prototype.toString=function(){return"Subscriber { obj: "+this.obj+", overrideContext: "+(this.overrideContext||"no")+" }";};if(!YAHOO.util.Event){YAHOO.util.Event=function(){var H=false;var I=[];var J=[];var G=[];var E=[];var C=0;var F=[];var B=[];var A=0;var D={63232:38,63233:40,63234:37,63235:39,63276:33,63277:34,25:9};var K=YAHOO.env.ua.ie?"focusin":"focus";var L=YAHOO.env.ua.ie?"focusout":"blur";return{POLL_RETRYS:2000,POLL_INTERVAL:20,EL:0,TYPE:1,FN:2,WFN:3,UNLOAD_OBJ:3,ADJ_SCOPE:4,OBJ:5,OVERRIDE:6,lastError:null,isSafari:YAHOO.env.ua.webkit,webkit:YAHOO.env.ua.webkit,isIE:YAHOO.env.ua.ie,_interval:null,_dri:null,DOMReady:false,throwErrors:false,startInterval:function(){if(!this._interval){var M=this;var N=function(){M._tryPreloadAttach();};this._interval=setInterval(N,this.POLL_INTERVAL);}},onAvailable:function(S,O,Q,R,P){var M=(YAHOO.lang.isString(S))?[S]:S;for(var N=0;N<M.length;N=N+1){F.push({id:M[N],fn:O,obj:Q,overrideContext:R,checkReady:P});}C=this.POLL_RETRYS;this.startInterval();},onContentReady:function(P,M,N,O){this.onAvailable(P,M,N,O,true);},onDOMReady:function(M,N,O){if(this.DOMReady){setTimeout(function(){var P=window;if(O){if(O===true){P=N;}else{P=O;}}M.call(P,"DOMReady",[],N);},0);}else{this.DOMReadyEvent.subscribe(M,N,O);}},_addListener:function(O,M,Y,S,W,b){if(!Y||!Y.call){return false;}if(this._isValidCollection(O)){var Z=true;for(var T=0,V=O.length;T<V;++T){Z=this.on(O[T],M,Y,S,W)&&Z;}return Z;}else{if(YAHOO.lang.isString(O)){var R=this.getEl(O);if(R){O=R;}else{this.onAvailable(O,function(){YAHOO.util.Event.on(O,M,Y,S,W);});return true;}}}if(!O){return false;}if("unload"==M&&S!==this){J[J.length]=[O,M,Y,S,W];return true;}var N=O;if(W){if(W===true){N=S;}else{N=W;}}var P=function(c){return Y.call(N,YAHOO.util.Event.getEvent(c,O),S);};var a=[O,M,Y,P,N,S,W];var U=I.length;I[U]=a;if(this.useLegacyEvent(O,M)){var Q=this.getLegacyIndex(O,M);if(Q==-1||O!=G[Q][0]){Q=G.length;B[O.id+M]=Q;G[Q]=[O,M,O["on"+M]];E[Q]=[];O["on"+M]=function(c){YAHOO.util.Event.fireLegacyEvent(YAHOO.util.Event.getEvent(c),Q);};}E[Q].push(a);}else{try{this._simpleAdd(O,M,P,b);}catch(X){this.lastError=X;this.removeListener(O,M,Y);return false;}}return true;},addListener:function(N,Q,M,O,P){return this._addListener(N,Q,M,O,P,false);},addFocusListener:function(N,M,O,P){return this._addListener(N,K,M,O,P,true);},removeFocusListener:function(N,M){return this.removeListener(N,K,M);},addBlurListener:function(N,M,O,P){return this._addListener(N,L,M,O,P,true);},removeBlurListener:function(N,M){return this.removeListener(N,L,M);},fireLegacyEvent:function(R,P){var T=true,M,V,U,N,S;V=E[P].slice();for(var O=0,Q=V.length;O<Q;++O){U=V[O];if(U&&U[this.WFN]){N=U[this.ADJ_SCOPE];S=U[this.WFN].call(N,R);T=(T&&S);}}M=G[P];if(M&&M[2]){M[2](R);}return T;},getLegacyIndex:function(N,O){var M=this.generateId(N)+O;if(typeof B[M]=="undefined"){return -1;}else{return B[M];}},useLegacyEvent:function(M,N){return(this.webkit&&this.webkit<419&&("click"==N||"dblclick"==N));},removeListener:function(N,M,V){var Q,T,X;if(typeof N=="string"){N=this.getEl(N);}else{if(this._isValidCollection(N)){var W=true;for(Q=N.length-1;Q>-1;Q--){W=(this.removeListener(N[Q],M,V)&&W);}return W;}}if(!V||!V.call){return this.purgeElement(N,false,M);}if("unload"==M){for(Q=J.length-1;Q>-1;Q--){X=J[Q];if(X&&X[0]==N&&X[1]==M&&X[2]==V){J.splice(Q,1);return true;}}return false;}var R=null;var S=arguments[3];if("undefined"===typeof S){S=this._getCacheIndex(N,M,V);}if(S>=0){R=I[S];}if(!N||!R){return false;}if(this.useLegacyEvent(N,M)){var P=this.getLegacyIndex(N,M);var O=E[P];if(O){for(Q=0,T=O.length;Q<T;++Q){X=O[Q];if(X&&X[this.EL]==N&&X[this.TYPE]==M&&X[this.FN]==V){O.splice(Q,1);break;}}}}else{try{this._simpleRemove(N,M,R[this.WFN],false);}catch(U){this.lastError=U;return false;}}delete I[S][this.WFN];delete I[S][this.FN];
I.splice(S,1);return true;},getTarget:function(O,N){var M=O.target||O.srcElement;return this.resolveTextNode(M);},resolveTextNode:function(N){try{if(N&&3==N.nodeType){return N.parentNode;}}catch(M){}return N;},getPageX:function(N){var M=N.pageX;if(!M&&0!==M){M=N.clientX||0;if(this.isIE){M+=this._getScrollLeft();}}return M;},getPageY:function(M){var N=M.pageY;if(!N&&0!==N){N=M.clientY||0;if(this.isIE){N+=this._getScrollTop();}}return N;},getXY:function(M){return[this.getPageX(M),this.getPageY(M)];},getRelatedTarget:function(N){var M=N.relatedTarget;if(!M){if(N.type=="mouseout"){M=N.toElement;}else{if(N.type=="mouseover"){M=N.fromElement;}}}return this.resolveTextNode(M);},getTime:function(O){if(!O.time){var N=new Date().getTime();try{O.time=N;}catch(M){this.lastError=M;return N;}}return O.time;},stopEvent:function(M){this.stopPropagation(M);this.preventDefault(M);},stopPropagation:function(M){if(M.stopPropagation){M.stopPropagation();}else{M.cancelBubble=true;}},preventDefault:function(M){if(M.preventDefault){M.preventDefault();}else{M.returnValue=false;}},getEvent:function(O,M){var N=O||window.event;if(!N){var P=this.getEvent.caller;while(P){N=P.arguments[0];if(N&&Event==N.constructor){break;}P=P.caller;}}return N;},getCharCode:function(N){var M=N.keyCode||N.charCode||0;if(YAHOO.env.ua.webkit&&(M in D)){M=D[M];}return M;},_getCacheIndex:function(Q,R,P){for(var O=0,N=I.length;O<N;O=O+1){var M=I[O];if(M&&M[this.FN]==P&&M[this.EL]==Q&&M[this.TYPE]==R){return O;}}return -1;},generateId:function(M){var N=M.id;if(!N){N="yuievtautoid-"+A;++A;M.id=N;}return N;},_isValidCollection:function(N){try{return(N&&typeof N!=="string"&&N.length&&!N.tagName&&!N.alert&&typeof N[0]!=="undefined");}catch(M){return false;}},elCache:{},getEl:function(M){return(typeof M==="string")?document.getElementById(M):M;},clearCache:function(){},DOMReadyEvent:new YAHOO.util.CustomEvent("DOMReady",this),_load:function(N){if(!H){H=true;var M=YAHOO.util.Event;M._ready();M._tryPreloadAttach();}},_ready:function(N){var M=YAHOO.util.Event;if(!M.DOMReady){M.DOMReady=true;M.DOMReadyEvent.fire();M._simpleRemove(document,"DOMContentLoaded",M._ready);}},_tryPreloadAttach:function(){if(F.length===0){C=0;if(this._interval){clearInterval(this._interval);this._interval=null;}return;}if(this.locked){return;}if(this.isIE){if(!this.DOMReady){this.startInterval();return;}}this.locked=true;var S=!H;if(!S){S=(C>0&&F.length>0);}var R=[];var T=function(V,W){var U=V;if(W.overrideContext){if(W.overrideContext===true){U=W.obj;}else{U=W.overrideContext;}}W.fn.call(U,W.obj);};var N,M,Q,P,O=[];for(N=0,M=F.length;N<M;N=N+1){Q=F[N];if(Q){P=this.getEl(Q.id);if(P){if(Q.checkReady){if(H||P.nextSibling||!S){O.push(Q);F[N]=null;}}else{T(P,Q);F[N]=null;}}else{R.push(Q);}}}for(N=0,M=O.length;N<M;N=N+1){Q=O[N];T(this.getEl(Q.id),Q);}C--;if(S){for(N=F.length-1;N>-1;N--){Q=F[N];if(!Q||!Q.id){F.splice(N,1);}}this.startInterval();}else{if(this._interval){clearInterval(this._interval);this._interval=null;}}this.locked=false;},purgeElement:function(Q,R,T){var O=(YAHOO.lang.isString(Q))?this.getEl(Q):Q;var S=this.getListeners(O,T),P,M;if(S){for(P=S.length-1;P>-1;P--){var N=S[P];this.removeListener(O,N.type,N.fn);}}if(R&&O&&O.childNodes){for(P=0,M=O.childNodes.length;P<M;++P){this.purgeElement(O.childNodes[P],R,T);}}},getListeners:function(O,M){var R=[],N;if(!M){N=[I,J];}else{if(M==="unload"){N=[J];}else{N=[I];}}var T=(YAHOO.lang.isString(O))?this.getEl(O):O;for(var Q=0;Q<N.length;Q=Q+1){var V=N[Q];if(V){for(var S=0,U=V.length;S<U;++S){var P=V[S];if(P&&P[this.EL]===T&&(!M||M===P[this.TYPE])){R.push({type:P[this.TYPE],fn:P[this.FN],obj:P[this.OBJ],adjust:P[this.OVERRIDE],scope:P[this.ADJ_SCOPE],index:S});}}}}return(R.length)?R:null;},_unload:function(T){var N=YAHOO.util.Event,Q,P,O,S,R,U=J.slice(),M;for(Q=0,S=J.length;Q<S;++Q){O=U[Q];if(O){M=window;if(O[N.ADJ_SCOPE]){if(O[N.ADJ_SCOPE]===true){M=O[N.UNLOAD_OBJ];}else{M=O[N.ADJ_SCOPE];}}O[N.FN].call(M,N.getEvent(T,O[N.EL]),O[N.UNLOAD_OBJ]);U[Q]=null;}}O=null;M=null;J=null;if(I){for(P=I.length-1;P>-1;P--){O=I[P];if(O){N.removeListener(O[N.EL],O[N.TYPE],O[N.FN],P);}}O=null;}G=null;N._simpleRemove(window,"unload",N._unload);},_getScrollLeft:function(){return this._getScroll()[1];},_getScrollTop:function(){return this._getScroll()[0];},_getScroll:function(){var M=document.documentElement,N=document.body;if(M&&(M.scrollTop||M.scrollLeft)){return[M.scrollTop,M.scrollLeft];}else{if(N){return[N.scrollTop,N.scrollLeft];}else{return[0,0];}}},regCE:function(){},_simpleAdd:function(){if(window.addEventListener){return function(O,P,N,M){O.addEventListener(P,N,(M));};}else{if(window.attachEvent){return function(O,P,N,M){O.attachEvent("on"+P,N);};}else{return function(){};}}}(),_simpleRemove:function(){if(window.removeEventListener){return function(O,P,N,M){O.removeEventListener(P,N,(M));};}else{if(window.detachEvent){return function(N,O,M){N.detachEvent("on"+O,M);};}else{return function(){};}}}()};}();(function(){var EU=YAHOO.util.Event;EU.on=EU.addListener;EU.onFocus=EU.addFocusListener;EU.onBlur=EU.addBlurListener;
/* DOMReady: based on work by: Dean Edwards/John Resig/Matthias Miller */
if(EU.isIE){YAHOO.util.Event.onDOMReady(YAHOO.util.Event._tryPreloadAttach,YAHOO.util.Event,true);var n=document.createElement("p");EU._dri=setInterval(function(){try{n.doScroll("left");clearInterval(EU._dri);EU._dri=null;EU._ready();n=null;}catch(ex){}},EU.POLL_INTERVAL);}else{if(EU.webkit&&EU.webkit<525){EU._dri=setInterval(function(){var rs=document.readyState;if("loaded"==rs||"complete"==rs){clearInterval(EU._dri);EU._dri=null;EU._ready();}},EU.POLL_INTERVAL);}else{EU._simpleAdd(document,"DOMContentLoaded",EU._ready);}}EU._simpleAdd(window,"load",EU._load);EU._simpleAdd(window,"unload",EU._unload);EU._tryPreloadAttach();})();}YAHOO.util.EventProvider=function(){};YAHOO.util.EventProvider.prototype={__yui_events:null,__yui_subscribers:null,subscribe:function(A,C,F,E){this.__yui_events=this.__yui_events||{};var D=this.__yui_events[A];if(D){D.subscribe(C,F,E);
}else{this.__yui_subscribers=this.__yui_subscribers||{};var B=this.__yui_subscribers;if(!B[A]){B[A]=[];}B[A].push({fn:C,obj:F,overrideContext:E});}},unsubscribe:function(C,E,G){this.__yui_events=this.__yui_events||{};var A=this.__yui_events;if(C){var F=A[C];if(F){return F.unsubscribe(E,G);}}else{var B=true;for(var D in A){if(YAHOO.lang.hasOwnProperty(A,D)){B=B&&A[D].unsubscribe(E,G);}}return B;}return false;},unsubscribeAll:function(A){return this.unsubscribe(A);},createEvent:function(G,D){this.__yui_events=this.__yui_events||{};var A=D||{};var I=this.__yui_events;if(I[G]){}else{var H=A.scope||this;var E=(A.silent);var B=new YAHOO.util.CustomEvent(G,H,E,YAHOO.util.CustomEvent.FLAT);I[G]=B;if(A.onSubscribeCallback){B.subscribeEvent.subscribe(A.onSubscribeCallback);}this.__yui_subscribers=this.__yui_subscribers||{};var F=this.__yui_subscribers[G];if(F){for(var C=0;C<F.length;++C){B.subscribe(F[C].fn,F[C].obj,F[C].overrideContext);}}}return I[G];},fireEvent:function(E,D,A,C){this.__yui_events=this.__yui_events||{};var G=this.__yui_events[E];if(!G){return null;}var B=[];for(var F=1;F<arguments.length;++F){B.push(arguments[F]);}return G.fire.apply(G,B);},hasEvent:function(A){if(this.__yui_events){if(this.__yui_events[A]){return true;}}return false;}};(function(){var A=YAHOO.util.Event,C=YAHOO.lang;YAHOO.util.KeyListener=function(D,I,E,F){if(!D){}else{if(!I){}else{if(!E){}}}if(!F){F=YAHOO.util.KeyListener.KEYDOWN;}var G=new YAHOO.util.CustomEvent("keyPressed");this.enabledEvent=new YAHOO.util.CustomEvent("enabled");this.disabledEvent=new YAHOO.util.CustomEvent("disabled");if(C.isString(D)){D=document.getElementById(D);}if(C.isFunction(E)){G.subscribe(E);}else{G.subscribe(E.fn,E.scope,E.correctScope);}function H(O,N){if(!I.shift){I.shift=false;}if(!I.alt){I.alt=false;}if(!I.ctrl){I.ctrl=false;}if(O.shiftKey==I.shift&&O.altKey==I.alt&&O.ctrlKey==I.ctrl){var J,M=I.keys,L;if(YAHOO.lang.isArray(M)){for(var K=0;K<M.length;K++){J=M[K];L=A.getCharCode(O);if(J==L){G.fire(L,O);break;}}}else{L=A.getCharCode(O);if(M==L){G.fire(L,O);}}}}this.enable=function(){if(!this.enabled){A.on(D,F,H);this.enabledEvent.fire(I);}this.enabled=true;};this.disable=function(){if(this.enabled){A.removeListener(D,F,H);this.disabledEvent.fire(I);}this.enabled=false;};this.toString=function(){return"KeyListener ["+I.keys+"] "+D.tagName+(D.id?"["+D.id+"]":"");};};var B=YAHOO.util.KeyListener;B.KEYDOWN="keydown";B.KEYUP="keyup";B.KEY={ALT:18,BACK_SPACE:8,CAPS_LOCK:20,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,META:224,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PRINTSCREEN:44,RIGHT:39,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,UP:38};})();YAHOO.register("event",YAHOO.util.Event,{version:"2.7.0",build:"1799"});YAHOO.register("yahoo-dom-event", YAHOO, {version: "2.7.0", build: "1799"});
/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
YAHOO.util.CustomEvent=function(D,C,B,A){this.type=D;this.scope=C||window;this.silent=B;this.signature=A||YAHOO.util.CustomEvent.LIST;this.subscribers=[];if(!this.silent){}var E="_YUICEOnSubscribe";if(D!==E){this.subscribeEvent=new YAHOO.util.CustomEvent(E,this,true);}this.lastError=null;};YAHOO.util.CustomEvent.LIST=0;YAHOO.util.CustomEvent.FLAT=1;YAHOO.util.CustomEvent.prototype={subscribe:function(A,B,C){if(!A){throw new Error("Invalid callback for subscriber to '"+this.type+"'");}if(this.subscribeEvent){this.subscribeEvent.fire(A,B,C);}this.subscribers.push(new YAHOO.util.Subscriber(A,B,C));},unsubscribe:function(D,F){if(!D){return this.unsubscribeAll();}var E=false;for(var B=0,A=this.subscribers.length;B<A;++B){var C=this.subscribers[B];if(C&&C.contains(D,F)){this._delete(B);E=true;}}return E;},fire:function(){this.lastError=null;var K=[],E=this.subscribers.length;if(!E&&this.silent){return true;}var I=[].slice.call(arguments,0),G=true,D,J=false;if(!this.silent){}var C=this.subscribers.slice(),A=YAHOO.util.Event.throwErrors;for(D=0;D<E;++D){var M=C[D];if(!M){J=true;}else{if(!this.silent){}var L=M.getScope(this.scope);if(this.signature==YAHOO.util.CustomEvent.FLAT){var B=null;if(I.length>0){B=I[0];}try{G=M.fn.call(L,B,M.obj);}catch(F){this.lastError=F;if(A){throw F;}}}else{try{G=M.fn.call(L,this.type,I,M.obj);}catch(H){this.lastError=H;if(A){throw H;}}}if(false===G){if(!this.silent){}break;}}}return(G!==false);},unsubscribeAll:function(){var A=this.subscribers.length,B;for(B=A-1;B>-1;B--){this._delete(B);}this.subscribers=[];return A;},_delete:function(A){var B=this.subscribers[A];if(B){delete B.fn;delete B.obj;}this.subscribers.splice(A,1);},toString:function(){return"CustomEvent: "+"'"+this.type+"', "+"context: "+this.scope;}};YAHOO.util.Subscriber=function(A,B,C){this.fn=A;this.obj=YAHOO.lang.isUndefined(B)?null:B;this.overrideContext=C;};YAHOO.util.Subscriber.prototype.getScope=function(A){if(this.overrideContext){if(this.overrideContext===true){return this.obj;}else{return this.overrideContext;}}return A;};YAHOO.util.Subscriber.prototype.contains=function(A,B){if(B){return(this.fn==A&&this.obj==B);}else{return(this.fn==A);}};YAHOO.util.Subscriber.prototype.toString=function(){return"Subscriber { obj: "+this.obj+", overrideContext: "+(this.overrideContext||"no")+" }";};if(!YAHOO.util.Event){YAHOO.util.Event=function(){var H=false;var I=[];var J=[];var G=[];var E=[];var C=0;var F=[];var B=[];var A=0;var D={63232:38,63233:40,63234:37,63235:39,63276:33,63277:34,25:9};var K=YAHOO.env.ua.ie?"focusin":"focus";var L=YAHOO.env.ua.ie?"focusout":"blur";return{POLL_RETRYS:2000,POLL_INTERVAL:20,EL:0,TYPE:1,FN:2,WFN:3,UNLOAD_OBJ:3,ADJ_SCOPE:4,OBJ:5,OVERRIDE:6,lastError:null,isSafari:YAHOO.env.ua.webkit,webkit:YAHOO.env.ua.webkit,isIE:YAHOO.env.ua.ie,_interval:null,_dri:null,DOMReady:false,throwErrors:false,startInterval:function(){if(!this._interval){var M=this;var N=function(){M._tryPreloadAttach();};this._interval=setInterval(N,this.POLL_INTERVAL);}},onAvailable:function(S,O,Q,R,P){var M=(YAHOO.lang.isString(S))?[S]:S;for(var N=0;N<M.length;N=N+1){F.push({id:M[N],fn:O,obj:Q,overrideContext:R,checkReady:P});}C=this.POLL_RETRYS;this.startInterval();},onContentReady:function(P,M,N,O){this.onAvailable(P,M,N,O,true);},onDOMReady:function(M,N,O){if(this.DOMReady){setTimeout(function(){var P=window;if(O){if(O===true){P=N;}else{P=O;}}M.call(P,"DOMReady",[],N);},0);}else{this.DOMReadyEvent.subscribe(M,N,O);}},_addListener:function(O,M,Y,S,W,b){if(!Y||!Y.call){return false;}if(this._isValidCollection(O)){var Z=true;for(var T=0,V=O.length;T<V;++T){Z=this.on(O[T],M,Y,S,W)&&Z;}return Z;}else{if(YAHOO.lang.isString(O)){var R=this.getEl(O);if(R){O=R;}else{this.onAvailable(O,function(){YAHOO.util.Event.on(O,M,Y,S,W);});return true;}}}if(!O){return false;}if("unload"==M&&S!==this){J[J.length]=[O,M,Y,S,W];return true;}var N=O;if(W){if(W===true){N=S;}else{N=W;}}var P=function(c){return Y.call(N,YAHOO.util.Event.getEvent(c,O),S);};var a=[O,M,Y,P,N,S,W];var U=I.length;I[U]=a;if(this.useLegacyEvent(O,M)){var Q=this.getLegacyIndex(O,M);if(Q==-1||O!=G[Q][0]){Q=G.length;B[O.id+M]=Q;G[Q]=[O,M,O["on"+M]];E[Q]=[];O["on"+M]=function(c){YAHOO.util.Event.fireLegacyEvent(YAHOO.util.Event.getEvent(c),Q);};}E[Q].push(a);}else{try{this._simpleAdd(O,M,P,b);}catch(X){this.lastError=X;this.removeListener(O,M,Y);return false;}}return true;},addListener:function(N,Q,M,O,P){return this._addListener(N,Q,M,O,P,false);},addFocusListener:function(N,M,O,P){return this._addListener(N,K,M,O,P,true);},removeFocusListener:function(N,M){return this.removeListener(N,K,M);},addBlurListener:function(N,M,O,P){return this._addListener(N,L,M,O,P,true);},removeBlurListener:function(N,M){return this.removeListener(N,L,M);},fireLegacyEvent:function(R,P){var T=true,M,V,U,N,S;V=E[P].slice();for(var O=0,Q=V.length;O<Q;++O){U=V[O];if(U&&U[this.WFN]){N=U[this.ADJ_SCOPE];S=U[this.WFN].call(N,R);T=(T&&S);}}M=G[P];if(M&&M[2]){M[2](R);}return T;},getLegacyIndex:function(N,O){var M=this.generateId(N)+O;if(typeof B[M]=="undefined"){return -1;}else{return B[M];}},useLegacyEvent:function(M,N){return(this.webkit&&this.webkit<419&&("click"==N||"dblclick"==N));},removeListener:function(N,M,V){var Q,T,X;if(typeof N=="string"){N=this.getEl(N);}else{if(this._isValidCollection(N)){var W=true;for(Q=N.length-1;Q>-1;Q--){W=(this.removeListener(N[Q],M,V)&&W);}return W;}}if(!V||!V.call){return this.purgeElement(N,false,M);}if("unload"==M){for(Q=J.length-1;Q>-1;Q--){X=J[Q];if(X&&X[0]==N&&X[1]==M&&X[2]==V){J.splice(Q,1);return true;}}return false;}var R=null;var S=arguments[3];if("undefined"===typeof S){S=this._getCacheIndex(N,M,V);}if(S>=0){R=I[S];}if(!N||!R){return false;}if(this.useLegacyEvent(N,M)){var P=this.getLegacyIndex(N,M);var O=E[P];if(O){for(Q=0,T=O.length;Q<T;++Q){X=O[Q];if(X&&X[this.EL]==N&&X[this.TYPE]==M&&X[this.FN]==V){O.splice(Q,1);break;}}}}else{try{this._simpleRemove(N,M,R[this.WFN],false);}catch(U){this.lastError=U;return false;}}delete I[S][this.WFN];delete I[S][this.FN];
I.splice(S,1);return true;},getTarget:function(O,N){var M=O.target||O.srcElement;return this.resolveTextNode(M);},resolveTextNode:function(N){try{if(N&&3==N.nodeType){return N.parentNode;}}catch(M){}return N;},getPageX:function(N){var M=N.pageX;if(!M&&0!==M){M=N.clientX||0;if(this.isIE){M+=this._getScrollLeft();}}return M;},getPageY:function(M){var N=M.pageY;if(!N&&0!==N){N=M.clientY||0;if(this.isIE){N+=this._getScrollTop();}}return N;},getXY:function(M){return[this.getPageX(M),this.getPageY(M)];},getRelatedTarget:function(N){var M=N.relatedTarget;if(!M){if(N.type=="mouseout"){M=N.toElement;}else{if(N.type=="mouseover"){M=N.fromElement;}}}return this.resolveTextNode(M);},getTime:function(O){if(!O.time){var N=new Date().getTime();try{O.time=N;}catch(M){this.lastError=M;return N;}}return O.time;},stopEvent:function(M){this.stopPropagation(M);this.preventDefault(M);},stopPropagation:function(M){if(M.stopPropagation){M.stopPropagation();}else{M.cancelBubble=true;}},preventDefault:function(M){if(M.preventDefault){M.preventDefault();}else{M.returnValue=false;}},getEvent:function(O,M){var N=O||window.event;if(!N){var P=this.getEvent.caller;while(P){N=P.arguments[0];if(N&&Event==N.constructor){break;}P=P.caller;}}return N;},getCharCode:function(N){var M=N.keyCode||N.charCode||0;if(YAHOO.env.ua.webkit&&(M in D)){M=D[M];}return M;},_getCacheIndex:function(Q,R,P){for(var O=0,N=I.length;O<N;O=O+1){var M=I[O];if(M&&M[this.FN]==P&&M[this.EL]==Q&&M[this.TYPE]==R){return O;}}return -1;},generateId:function(M){var N=M.id;if(!N){N="yuievtautoid-"+A;++A;M.id=N;}return N;},_isValidCollection:function(N){try{return(N&&typeof N!=="string"&&N.length&&!N.tagName&&!N.alert&&typeof N[0]!=="undefined");}catch(M){return false;}},elCache:{},getEl:function(M){return(typeof M==="string")?document.getElementById(M):M;},clearCache:function(){},DOMReadyEvent:new YAHOO.util.CustomEvent("DOMReady",this),_load:function(N){if(!H){H=true;var M=YAHOO.util.Event;M._ready();M._tryPreloadAttach();}},_ready:function(N){var M=YAHOO.util.Event;if(!M.DOMReady){M.DOMReady=true;M.DOMReadyEvent.fire();M._simpleRemove(document,"DOMContentLoaded",M._ready);}},_tryPreloadAttach:function(){if(F.length===0){C=0;if(this._interval){clearInterval(this._interval);this._interval=null;}return;}if(this.locked){return;}if(this.isIE){if(!this.DOMReady){this.startInterval();return;}}this.locked=true;var S=!H;if(!S){S=(C>0&&F.length>0);}var R=[];var T=function(V,W){var U=V;if(W.overrideContext){if(W.overrideContext===true){U=W.obj;}else{U=W.overrideContext;}}W.fn.call(U,W.obj);};var N,M,Q,P,O=[];for(N=0,M=F.length;N<M;N=N+1){Q=F[N];if(Q){P=this.getEl(Q.id);if(P){if(Q.checkReady){if(H||P.nextSibling||!S){O.push(Q);F[N]=null;}}else{T(P,Q);F[N]=null;}}else{R.push(Q);}}}for(N=0,M=O.length;N<M;N=N+1){Q=O[N];T(this.getEl(Q.id),Q);}C--;if(S){for(N=F.length-1;N>-1;N--){Q=F[N];if(!Q||!Q.id){F.splice(N,1);}}this.startInterval();}else{if(this._interval){clearInterval(this._interval);this._interval=null;}}this.locked=false;},purgeElement:function(Q,R,T){var O=(YAHOO.lang.isString(Q))?this.getEl(Q):Q;var S=this.getListeners(O,T),P,M;if(S){for(P=S.length-1;P>-1;P--){var N=S[P];this.removeListener(O,N.type,N.fn);}}if(R&&O&&O.childNodes){for(P=0,M=O.childNodes.length;P<M;++P){this.purgeElement(O.childNodes[P],R,T);}}},getListeners:function(O,M){var R=[],N;if(!M){N=[I,J];}else{if(M==="unload"){N=[J];}else{N=[I];}}var T=(YAHOO.lang.isString(O))?this.getEl(O):O;for(var Q=0;Q<N.length;Q=Q+1){var V=N[Q];if(V){for(var S=0,U=V.length;S<U;++S){var P=V[S];if(P&&P[this.EL]===T&&(!M||M===P[this.TYPE])){R.push({type:P[this.TYPE],fn:P[this.FN],obj:P[this.OBJ],adjust:P[this.OVERRIDE],scope:P[this.ADJ_SCOPE],index:S});}}}}return(R.length)?R:null;},_unload:function(T){var N=YAHOO.util.Event,Q,P,O,S,R,U=J.slice(),M;for(Q=0,S=J.length;Q<S;++Q){O=U[Q];if(O){M=window;if(O[N.ADJ_SCOPE]){if(O[N.ADJ_SCOPE]===true){M=O[N.UNLOAD_OBJ];}else{M=O[N.ADJ_SCOPE];}}O[N.FN].call(M,N.getEvent(T,O[N.EL]),O[N.UNLOAD_OBJ]);U[Q]=null;}}O=null;M=null;J=null;if(I){for(P=I.length-1;P>-1;P--){O=I[P];if(O){N.removeListener(O[N.EL],O[N.TYPE],O[N.FN],P);}}O=null;}G=null;N._simpleRemove(window,"unload",N._unload);},_getScrollLeft:function(){return this._getScroll()[1];},_getScrollTop:function(){return this._getScroll()[0];},_getScroll:function(){var M=document.documentElement,N=document.body;if(M&&(M.scrollTop||M.scrollLeft)){return[M.scrollTop,M.scrollLeft];}else{if(N){return[N.scrollTop,N.scrollLeft];}else{return[0,0];}}},regCE:function(){},_simpleAdd:function(){if(window.addEventListener){return function(O,P,N,M){O.addEventListener(P,N,(M));};}else{if(window.attachEvent){return function(O,P,N,M){O.attachEvent("on"+P,N);};}else{return function(){};}}}(),_simpleRemove:function(){if(window.removeEventListener){return function(O,P,N,M){O.removeEventListener(P,N,(M));};}else{if(window.detachEvent){return function(N,O,M){N.detachEvent("on"+O,M);};}else{return function(){};}}}()};}();(function(){var EU=YAHOO.util.Event;EU.on=EU.addListener;EU.onFocus=EU.addFocusListener;EU.onBlur=EU.addBlurListener;
/* DOMReady: based on work by: Dean Edwards/John Resig/Matthias Miller */
if(EU.isIE){YAHOO.util.Event.onDOMReady(YAHOO.util.Event._tryPreloadAttach,YAHOO.util.Event,true);var n=document.createElement("p");EU._dri=setInterval(function(){try{n.doScroll("left");clearInterval(EU._dri);EU._dri=null;EU._ready();n=null;}catch(ex){}},EU.POLL_INTERVAL);}else{if(EU.webkit&&EU.webkit<525){EU._dri=setInterval(function(){var rs=document.readyState;if("loaded"==rs||"complete"==rs){clearInterval(EU._dri);EU._dri=null;EU._ready();}},EU.POLL_INTERVAL);}else{EU._simpleAdd(document,"DOMContentLoaded",EU._ready);}}EU._simpleAdd(window,"load",EU._load);EU._simpleAdd(window,"unload",EU._unload);EU._tryPreloadAttach();})();}YAHOO.util.EventProvider=function(){};YAHOO.util.EventProvider.prototype={__yui_events:null,__yui_subscribers:null,subscribe:function(A,C,F,E){this.__yui_events=this.__yui_events||{};var D=this.__yui_events[A];if(D){D.subscribe(C,F,E);
}else{this.__yui_subscribers=this.__yui_subscribers||{};var B=this.__yui_subscribers;if(!B[A]){B[A]=[];}B[A].push({fn:C,obj:F,overrideContext:E});}},unsubscribe:function(C,E,G){this.__yui_events=this.__yui_events||{};var A=this.__yui_events;if(C){var F=A[C];if(F){return F.unsubscribe(E,G);}}else{var B=true;for(var D in A){if(YAHOO.lang.hasOwnProperty(A,D)){B=B&&A[D].unsubscribe(E,G);}}return B;}return false;},unsubscribeAll:function(A){return this.unsubscribe(A);},createEvent:function(G,D){this.__yui_events=this.__yui_events||{};var A=D||{};var I=this.__yui_events;if(I[G]){}else{var H=A.scope||this;var E=(A.silent);var B=new YAHOO.util.CustomEvent(G,H,E,YAHOO.util.CustomEvent.FLAT);I[G]=B;if(A.onSubscribeCallback){B.subscribeEvent.subscribe(A.onSubscribeCallback);}this.__yui_subscribers=this.__yui_subscribers||{};var F=this.__yui_subscribers[G];if(F){for(var C=0;C<F.length;++C){B.subscribe(F[C].fn,F[C].obj,F[C].overrideContext);}}}return I[G];},fireEvent:function(E,D,A,C){this.__yui_events=this.__yui_events||{};var G=this.__yui_events[E];if(!G){return null;}var B=[];for(var F=1;F<arguments.length;++F){B.push(arguments[F]);}return G.fire.apply(G,B);},hasEvent:function(A){if(this.__yui_events){if(this.__yui_events[A]){return true;}}return false;}};(function(){var A=YAHOO.util.Event,C=YAHOO.lang;YAHOO.util.KeyListener=function(D,I,E,F){if(!D){}else{if(!I){}else{if(!E){}}}if(!F){F=YAHOO.util.KeyListener.KEYDOWN;}var G=new YAHOO.util.CustomEvent("keyPressed");this.enabledEvent=new YAHOO.util.CustomEvent("enabled");this.disabledEvent=new YAHOO.util.CustomEvent("disabled");if(C.isString(D)){D=document.getElementById(D);}if(C.isFunction(E)){G.subscribe(E);}else{G.subscribe(E.fn,E.scope,E.correctScope);}function H(O,N){if(!I.shift){I.shift=false;}if(!I.alt){I.alt=false;}if(!I.ctrl){I.ctrl=false;}if(O.shiftKey==I.shift&&O.altKey==I.alt&&O.ctrlKey==I.ctrl){var J,M=I.keys,L;if(YAHOO.lang.isArray(M)){for(var K=0;K<M.length;K++){J=M[K];L=A.getCharCode(O);if(J==L){G.fire(L,O);break;}}}else{L=A.getCharCode(O);if(M==L){G.fire(L,O);}}}}this.enable=function(){if(!this.enabled){A.on(D,F,H);this.enabledEvent.fire(I);}this.enabled=true;};this.disable=function(){if(this.enabled){A.removeListener(D,F,H);this.disabledEvent.fire(I);}this.enabled=false;};this.toString=function(){return"KeyListener ["+I.keys+"] "+D.tagName+(D.id?"["+D.id+"]":"");};};var B=YAHOO.util.KeyListener;B.KEYDOWN="keydown";B.KEYUP="keyup";B.KEY={ALT:18,BACK_SPACE:8,CAPS_LOCK:20,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,META:224,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PRINTSCREEN:44,RIGHT:39,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,UP:38};})();YAHOO.register("event",YAHOO.util.Event,{version:"2.7.0",build:"1796"});/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
(function(){var B=YAHOO.util;var A=function(D,C,E,F){if(!D){}this.init(D,C,E,F);};A.NAME="Anim";A.prototype={toString:function(){var C=this.getEl()||{};var D=C.id||C.tagName;return(this.constructor.NAME+": "+D);},patterns:{noNegatives:/width|height|opacity|padding/i,offsetAttribute:/^((width|height)|(top|left))$/,defaultUnit:/width|height|top$|bottom$|left$|right$/i,offsetUnit:/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i},doMethod:function(C,E,D){return this.method(this.currentFrame,E,D-E,this.totalFrames);},setAttribute:function(C,F,E){var D=this.getEl();if(this.patterns.noNegatives.test(C)){F=(F>0)?F:0;}if("style" in D){B.Dom.setStyle(D,C,F+E);}else{if(C in D){D[C]=F;}}},getAttribute:function(C){var E=this.getEl();var G=B.Dom.getStyle(E,C);if(G!=="auto"&&!this.patterns.offsetUnit.test(G)){return parseFloat(G);}var D=this.patterns.offsetAttribute.exec(C)||[];var H=!!(D[3]);var F=!!(D[2]);if("style" in E){if(F||(B.Dom.getStyle(E,"position")=="absolute"&&H)){G=E["offset"+D[0].charAt(0).toUpperCase()+D[0].substr(1)];}else{G=0;}}else{if(C in E){G=E[C];}}return G;},getDefaultUnit:function(C){if(this.patterns.defaultUnit.test(C)){return"px";}return"";},setRuntimeAttribute:function(D){var I;var E;var F=this.attributes;this.runtimeAttributes[D]={};var H=function(J){return(typeof J!=="undefined");};if(!H(F[D]["to"])&&!H(F[D]["by"])){return false;}I=(H(F[D]["from"]))?F[D]["from"]:this.getAttribute(D);if(H(F[D]["to"])){E=F[D]["to"];}else{if(H(F[D]["by"])){if(I.constructor==Array){E=[];for(var G=0,C=I.length;G<C;++G){E[G]=I[G]+F[D]["by"][G]*1;}}else{E=I+F[D]["by"]*1;}}}this.runtimeAttributes[D].start=I;this.runtimeAttributes[D].end=E;this.runtimeAttributes[D].unit=(H(F[D].unit))?F[D]["unit"]:this.getDefaultUnit(D);return true;},init:function(E,J,I,C){var D=false;var F=null;var H=0;E=B.Dom.get(E);this.attributes=J||{};this.duration=!YAHOO.lang.isUndefined(I)?I:1;this.method=C||B.Easing.easeNone;this.useSeconds=true;this.currentFrame=0;this.totalFrames=B.AnimMgr.fps;this.setEl=function(M){E=B.Dom.get(M);};this.getEl=function(){return E;};this.isAnimated=function(){return D;};this.getStartTime=function(){return F;};this.runtimeAttributes={};this.animate=function(){if(this.isAnimated()){return false;}this.currentFrame=0;this.totalFrames=(this.useSeconds)?Math.ceil(B.AnimMgr.fps*this.duration):this.duration;if(this.duration===0&&this.useSeconds){this.totalFrames=1;}B.AnimMgr.registerElement(this);return true;};this.stop=function(M){if(!this.isAnimated()){return false;}if(M){this.currentFrame=this.totalFrames;this._onTween.fire();}B.AnimMgr.stop(this);};var L=function(){this.onStart.fire();this.runtimeAttributes={};for(var M in this.attributes){this.setRuntimeAttribute(M);}D=true;H=0;F=new Date();};var K=function(){var O={duration:new Date()-this.getStartTime(),currentFrame:this.currentFrame};O.toString=function(){return("duration: "+O.duration+", currentFrame: "+O.currentFrame);};this.onTween.fire(O);var N=this.runtimeAttributes;for(var M in N){this.setAttribute(M,this.doMethod(M,N[M].start,N[M].end),N[M].unit);}H+=1;};var G=function(){var M=(new Date()-F)/1000;var N={duration:M,frames:H,fps:H/M};N.toString=function(){return("duration: "+N.duration+", frames: "+N.frames+", fps: "+N.fps);};D=false;H=0;this.onComplete.fire(N);};this._onStart=new B.CustomEvent("_start",this,true);this.onStart=new B.CustomEvent("start",this);this.onTween=new B.CustomEvent("tween",this);this._onTween=new B.CustomEvent("_tween",this,true);this.onComplete=new B.CustomEvent("complete",this);this._onComplete=new B.CustomEvent("_complete",this,true);this._onStart.subscribe(L);this._onTween.subscribe(K);this._onComplete.subscribe(G);}};B.Anim=A;})();YAHOO.util.AnimMgr=new function(){var C=null;var B=[];var A=0;this.fps=1000;this.delay=1;this.registerElement=function(F){B[B.length]=F;A+=1;F._onStart.fire();this.start();};this.unRegister=function(G,F){F=F||E(G);if(!G.isAnimated()||F==-1){return false;}G._onComplete.fire();B.splice(F,1);A-=1;if(A<=0){this.stop();}return true;};this.start=function(){if(C===null){C=setInterval(this.run,this.delay);}};this.stop=function(H){if(!H){clearInterval(C);for(var G=0,F=B.length;G<F;++G){this.unRegister(B[0],0);}B=[];C=null;A=0;}else{this.unRegister(H);}};this.run=function(){for(var H=0,F=B.length;H<F;++H){var G=B[H];if(!G||!G.isAnimated()){continue;}if(G.currentFrame<G.totalFrames||G.totalFrames===null){G.currentFrame+=1;if(G.useSeconds){D(G);}G._onTween.fire();}else{YAHOO.util.AnimMgr.stop(G,H);}}};var E=function(H){for(var G=0,F=B.length;G<F;++G){if(B[G]==H){return G;}}return -1;};var D=function(G){var J=G.totalFrames;var I=G.currentFrame;var H=(G.currentFrame*G.duration*1000/G.totalFrames);var F=(new Date()-G.getStartTime());var K=0;if(F<G.duration*1000){K=Math.round((F/H-1)*G.currentFrame);}else{K=J-(I+1);}if(K>0&&isFinite(K)){if(G.currentFrame+K>=J){K=J-(I+1);}G.currentFrame+=K;}};};YAHOO.util.Bezier=new function(){this.getPosition=function(E,D){var F=E.length;var C=[];for(var B=0;B<F;++B){C[B]=[E[B][0],E[B][1]];}for(var A=1;A<F;++A){for(B=0;B<F-A;++B){C[B][0]=(1-D)*C[B][0]+D*C[parseInt(B+1,10)][0];C[B][1]=(1-D)*C[B][1]+D*C[parseInt(B+1,10)][1];}}return[C[0][0],C[0][1]];};};(function(){var A=function(F,E,G,H){A.superclass.constructor.call(this,F,E,G,H);};A.NAME="ColorAnim";A.DEFAULT_BGCOLOR="#fff";var C=YAHOO.util;YAHOO.extend(A,C.Anim);var D=A.superclass;var B=A.prototype;B.patterns.color=/color$/i;B.patterns.rgb=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i;B.patterns.hex=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i;B.patterns.hex3=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i;B.patterns.transparent=/^transparent|rgba\(0, 0, 0, 0\)$/;B.parseColor=function(E){if(E.length==3){return E;}var F=this.patterns.hex.exec(E);if(F&&F.length==4){return[parseInt(F[1],16),parseInt(F[2],16),parseInt(F[3],16)];}F=this.patterns.rgb.exec(E);if(F&&F.length==4){return[parseInt(F[1],10),parseInt(F[2],10),parseInt(F[3],10)];}F=this.patterns.hex3.exec(E);if(F&&F.length==4){return[parseInt(F[1]+F[1],16),parseInt(F[2]+F[2],16),parseInt(F[3]+F[3],16)];
}return null;};B.getAttribute=function(E){var G=this.getEl();if(this.patterns.color.test(E)){var I=YAHOO.util.Dom.getStyle(G,E);var H=this;if(this.patterns.transparent.test(I)){var F=YAHOO.util.Dom.getAncestorBy(G,function(J){return !H.patterns.transparent.test(I);});if(F){I=C.Dom.getStyle(F,E);}else{I=A.DEFAULT_BGCOLOR;}}}else{I=D.getAttribute.call(this,E);}return I;};B.doMethod=function(F,J,G){var I;if(this.patterns.color.test(F)){I=[];for(var H=0,E=J.length;H<E;++H){I[H]=D.doMethod.call(this,F,J[H],G[H]);}I="rgb("+Math.floor(I[0])+","+Math.floor(I[1])+","+Math.floor(I[2])+")";}else{I=D.doMethod.call(this,F,J,G);}return I;};B.setRuntimeAttribute=function(F){D.setRuntimeAttribute.call(this,F);if(this.patterns.color.test(F)){var H=this.attributes;var J=this.parseColor(this.runtimeAttributes[F].start);var G=this.parseColor(this.runtimeAttributes[F].end);if(typeof H[F]["to"]==="undefined"&&typeof H[F]["by"]!=="undefined"){G=this.parseColor(H[F].by);for(var I=0,E=J.length;I<E;++I){G[I]=J[I]+G[I];}}this.runtimeAttributes[F].start=J;this.runtimeAttributes[F].end=G;}};C.ColorAnim=A;})();
/*
TERMS OF USE - EASING EQUATIONS
Open source under the BSD License.
Copyright 2001 Robert Penner All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

 * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 * Neither the name of the author nor the names of contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
YAHOO.util.Easing={easeNone:function(B,A,D,C){return D*B/C+A;},easeIn:function(B,A,D,C){return D*(B/=C)*B+A;},easeOut:function(B,A,D,C){return -D*(B/=C)*(B-2)+A;},easeBoth:function(B,A,D,C){if((B/=C/2)<1){return D/2*B*B+A;}return -D/2*((--B)*(B-2)-1)+A;},easeInStrong:function(B,A,D,C){return D*(B/=C)*B*B*B+A;},easeOutStrong:function(B,A,D,C){return -D*((B=B/C-1)*B*B*B-1)+A;},easeBothStrong:function(B,A,D,C){if((B/=C/2)<1){return D/2*B*B*B*B+A;}return -D/2*((B-=2)*B*B*B-2)+A;},elasticIn:function(C,A,G,F,B,E){if(C==0){return A;}if((C/=F)==1){return A+G;}if(!E){E=F*0.3;}if(!B||B<Math.abs(G)){B=G;var D=E/4;}else{var D=E/(2*Math.PI)*Math.asin(G/B);}return -(B*Math.pow(2,10*(C-=1))*Math.sin((C*F-D)*(2*Math.PI)/E))+A;},elasticOut:function(C,A,G,F,B,E){if(C==0){return A;}if((C/=F)==1){return A+G;}if(!E){E=F*0.3;}if(!B||B<Math.abs(G)){B=G;var D=E/4;}else{var D=E/(2*Math.PI)*Math.asin(G/B);}return B*Math.pow(2,-10*C)*Math.sin((C*F-D)*(2*Math.PI)/E)+G+A;},elasticBoth:function(C,A,G,F,B,E){if(C==0){return A;}if((C/=F/2)==2){return A+G;}if(!E){E=F*(0.3*1.5);}if(!B||B<Math.abs(G)){B=G;var D=E/4;}else{var D=E/(2*Math.PI)*Math.asin(G/B);}if(C<1){return -0.5*(B*Math.pow(2,10*(C-=1))*Math.sin((C*F-D)*(2*Math.PI)/E))+A;}return B*Math.pow(2,-10*(C-=1))*Math.sin((C*F-D)*(2*Math.PI)/E)*0.5+G+A;},backIn:function(B,A,E,D,C){if(typeof C=="undefined"){C=1.70158;}return E*(B/=D)*B*((C+1)*B-C)+A;},backOut:function(B,A,E,D,C){if(typeof C=="undefined"){C=1.70158;}return E*((B=B/D-1)*B*((C+1)*B+C)+1)+A;},backBoth:function(B,A,E,D,C){if(typeof C=="undefined"){C=1.70158;}if((B/=D/2)<1){return E/2*(B*B*(((C*=(1.525))+1)*B-C))+A;}return E/2*((B-=2)*B*(((C*=(1.525))+1)*B+C)+2)+A;},bounceIn:function(B,A,D,C){return D-YAHOO.util.Easing.bounceOut(C-B,0,D,C)+A;},bounceOut:function(B,A,D,C){if((B/=C)<(1/2.75)){return D*(7.5625*B*B)+A;}else{if(B<(2/2.75)){return D*(7.5625*(B-=(1.5/2.75))*B+0.75)+A;}else{if(B<(2.5/2.75)){return D*(7.5625*(B-=(2.25/2.75))*B+0.9375)+A;}}}return D*(7.5625*(B-=(2.625/2.75))*B+0.984375)+A;},bounceBoth:function(B,A,D,C){if(B<C/2){return YAHOO.util.Easing.bounceIn(B*2,0,D,C)*0.5+A;}return YAHOO.util.Easing.bounceOut(B*2-C,0,D,C)*0.5+D*0.5+A;}};(function(){var A=function(H,G,I,J){if(H){A.superclass.constructor.call(this,H,G,I,J);}};A.NAME="Motion";var E=YAHOO.util;YAHOO.extend(A,E.ColorAnim);var F=A.superclass;var C=A.prototype;C.patterns.points=/^points$/i;C.setAttribute=function(G,I,H){if(this.patterns.points.test(G)){H=H||"px";F.setAttribute.call(this,"left",I[0],H);F.setAttribute.call(this,"top",I[1],H);}else{F.setAttribute.call(this,G,I,H);}};C.getAttribute=function(G){if(this.patterns.points.test(G)){var H=[F.getAttribute.call(this,"left"),F.getAttribute.call(this,"top")];}else{H=F.getAttribute.call(this,G);}return H;};C.doMethod=function(G,K,H){var J=null;if(this.patterns.points.test(G)){var I=this.method(this.currentFrame,0,100,this.totalFrames)/100;J=E.Bezier.getPosition(this.runtimeAttributes[G],I);}else{J=F.doMethod.call(this,G,K,H);}return J;};C.setRuntimeAttribute=function(P){if(this.patterns.points.test(P)){var H=this.getEl();var J=this.attributes;var G;var L=J["points"]["control"]||[];var I;var M,O;if(L.length>0&&!(L[0] instanceof Array)){L=[L];}else{var K=[];for(M=0,O=L.length;M<O;++M){K[M]=L[M];}L=K;}if(E.Dom.getStyle(H,"position")=="static"){E.Dom.setStyle(H,"position","relative");}if(D(J["points"]["from"])){E.Dom.setXY(H,J["points"]["from"]);
}else{E.Dom.setXY(H,E.Dom.getXY(H));}G=this.getAttribute("points");if(D(J["points"]["to"])){I=B.call(this,J["points"]["to"],G);var N=E.Dom.getXY(this.getEl());for(M=0,O=L.length;M<O;++M){L[M]=B.call(this,L[M],G);}}else{if(D(J["points"]["by"])){I=[G[0]+J["points"]["by"][0],G[1]+J["points"]["by"][1]];for(M=0,O=L.length;M<O;++M){L[M]=[G[0]+L[M][0],G[1]+L[M][1]];}}}this.runtimeAttributes[P]=[G];if(L.length>0){this.runtimeAttributes[P]=this.runtimeAttributes[P].concat(L);}this.runtimeAttributes[P][this.runtimeAttributes[P].length]=I;}else{F.setRuntimeAttribute.call(this,P);}};var B=function(G,I){var H=E.Dom.getXY(this.getEl());G=[G[0]-H[0]+I[0],G[1]-H[1]+I[1]];return G;};var D=function(G){return(typeof G!=="undefined");};E.Motion=A;})();(function(){var D=function(F,E,G,H){if(F){D.superclass.constructor.call(this,F,E,G,H);}};D.NAME="Scroll";var B=YAHOO.util;YAHOO.extend(D,B.ColorAnim);var C=D.superclass;var A=D.prototype;A.doMethod=function(E,H,F){var G=null;if(E=="scroll"){G=[this.method(this.currentFrame,H[0],F[0]-H[0],this.totalFrames),this.method(this.currentFrame,H[1],F[1]-H[1],this.totalFrames)];}else{G=C.doMethod.call(this,E,H,F);}return G;};A.getAttribute=function(E){var G=null;var F=this.getEl();if(E=="scroll"){G=[F.scrollLeft,F.scrollTop];}else{G=C.getAttribute.call(this,E);}return G;};A.setAttribute=function(E,H,G){var F=this.getEl();if(E=="scroll"){F.scrollLeft=H[0];F.scrollTop=H[1];}else{C.setAttribute.call(this,E,H,G);}};B.Scroll=D;})();YAHOO.register("animation",YAHOO.util.Anim,{version:"2.7.0",build:"1796"});
D2L.LP.Web.UI.Common={CompositeViews:{},Controls:{},MasterPages:{}};
D2L.LP.Web.UI.Common.Controls.Button={Build:function(doc){doc=doc||document;var node=doc.createElement("a");D2L.LP.Web.UI.Html.Dom.AddClassName("vui-button",node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button",node);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-onclick","var a=1;");return node},ClickNode:function(node){D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",node)},GetTextNode:function(node){var text=$(node).vui_button("getText");return text},GetTitleNode:function(node){var dom=D2L.LP.Web.UI.Html.Dom;
var hasTitle=dom.HasAttribute(node,"title");if(!hasTitle)return"";var title=dom.GetAttribute(node,"title");return title},Init:function(node){$(node).vui_button();var me=D2L.LP.Web.UI.Common.Controls.Button;var dom=D2L.LP.Web.UI.Html.Dom;var isDisabled=!me.IsEnabledNode(node);me.InitPageButtons(node);var hasOnClick=dom.HasAttribute(node,"data-onclick");if(!hasOnClick)return;var onClick=dom.GetAttribute(node,"data-onclick");dom.RemoveAttribute(node,"data-onclick");var processingText=dom.GetAttribute(node,
"data-processing-text");var clickTime=null;var isProcessing=false;var bypassDoubleClickPrevention=dom.HasClassName("d2l-button-bypass",node);var beginProcessing=function(){isProcessing=true;setTimeout(function(){if(isProcessing&&processingText!==null){$(node).vui_button("processingStart");D2L.LP.Web.UI.Events.OnProcessingBegin.Trigger()}},200)};var finishProcessing=function(){if(processingText!==null){$(node).vui_button("processingEnd");D2L.LP.Web.UI.Events.OnProcessingEnd.Trigger()}isProcessing=
false};var execOnClick=function(){if(node.d2l_onClick!==undefined)return node.d2l_onClick();return eval(onClick)};$(node).click(function(){var currentTime=(new Date).getTime();if(!bypassDoubleClickPrevention&&clickTime!==null&&currentTime-clickTime<=500){clickTime=currentTime;return}isDisabled=!me.IsEnabledNode(node);if(isDisabled||!bypassDoubleClickPrevention&&isProcessing)return;clickTime=currentTime;var ret=execOnClick();if(typeof ret==="undefined"||ret===null||ret.AddListener===undefined)return;
beginProcessing();ret.AddListener(finishProcessing);ret.AddReleaseListener(finishProcessing)})},IsPageButton:function(node){var dom=D2L.LP.Web.UI.Html.Dom;var isPageButton=dom.GetParentElementByClassName("d2l-page-buttons",node)!==null;if(isPageButton)return true;var isDialogButton=dom.GetParentElementByClassName("d2l-dialog-buttons",node)!==null;if(isDialogButton){var isDialogFooterButton=dom.GetParentElementByClassName("d2l-dialog-footer",node)!==null;if(!isDialogFooterButton)return true}return false},
InitPageButtons:function(node){var me=D2L.LP.Web.UI.Common.Controls.Button;var isPageButton=me.IsPageButton(node);if(!isPageButton)return;var enableOnEnd=true;D2L.LP.Web.UI.Events.OnProcessingBegin.AddListener(function(){enableOnEnd=me.IsEnabledNode(node);if(enableOnEnd)me.SetIsEnabledNode(node,false)});D2L.LP.Web.UI.Events.OnProcessingEnd.AddListener(function(){if(enableOnEnd)me.SetIsEnabledNode(node,true);enableOnEnd=true})},IsEnabledNode:function(node){var isEnabled=$(node).vui_button("isEnabled");
return isEnabled},IsPrimaryNode:function(node){var isPrimary=D2L.LP.Web.UI.Html.Dom.HasClassName("vui-button-primary",node);return isPrimary},IsVisibleNode:function(node){var isVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",node);return isVisible},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabledNode(node,isEnabled)},SetIsEnabledNode:function(node,isEnabled){var isEnabledCurrent=D2L.LP.Web.UI.Common.Controls.Button.IsEnabledNode(node);
if(isEnabled==isEnabledCurrent)return;$(node).vui_button("setIsEnabled",isEnabled);var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?"data-href":"href");if(!hasHref)return;var href=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,isEnabled?"data-href":"href");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?"href":"data-href",href);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?"data-href":"href")},SetIsPrimaryNode:function(node,isPrimary){if(!isPrimary)D2L.LP.Web.UI.Html.Dom.RemoveClassName("vui-button-primary",
node);else D2L.LP.Web.UI.Html.Dom.AddClassName("vui-button-primary",node)},SetIsVisibleNode:function(node,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isVisible)},SetOnClickNode:function(node,onClick){node.d2l_onClick=onClick},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(node,text)},SetTextNode:function(node,text){$(node).vui_button("setText",text)},SetTitleNode:function(node,
title){if(title===undefined||title===null||title.length===0)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"title");else D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"title",title)}};
D2L.LP.Web.UI.Common.Controls.Edit={ClearValue:function(id){D2L.LP.Web.UI.Common.Controls.Edit.SetValue(id,"");var inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.Edit.SetClearLinkIsVisible(inputNode,false);inputNode.focus();var onClear=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),0);if(onClear==null)return;onClear.call(onClear)},ClearValueNode:function(node){D2L.LP.Web.UI.Common.Controls.Edit.SetValueNode(node,"")},SetClearLinkIsVisible:function(inputNode,
isVisible){var iconNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(inputNode);if(iconNode!==null&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-edit-clearicon",iconNode))return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-edit-clearicon-visible",iconNode))return;if(!inputNode.value){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-edit-clearicon-hidden",iconNode);return}var isCurrentlyVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-edit-clearicon-hidden",iconNode);if(isVisible){if(!isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-edit-clearicon-hidden",
iconNode)}else if(isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-edit-clearicon-hidden",iconNode)},GetValue:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(input)},GetValueNode:function(node){if(node!==null)return node.value;return""},SetValue:function(id,value){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(input!==null)D2L.LP.Web.UI.Common.Controls.Edit.SetValueNode(input,value)},SetValueNode:function(node,
value){node.value=value},IsEnabledNode:function(node){if(node.disabled!==undefined)return!node.disabled;return true},IsVisibleNode:function(node){return D2L.LP.Web.UI.Html.Dom.IsVisible(node)},IsVisible:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.Edit.IsVisibleNode(input)},ValidateEnabledVisibleNode:function(node){if(!node)return true;var isEnabled=D2L.LP.Web.UI.Common.Controls.Edit.IsEnabledNode(node);var isVisible=D2L.LP.Web.UI.Common.Controls.Edit.IsVisibleNode(node);
if(!isEnabled||!isVisible)return false;return true},ValidateMinLength:function(id,minLength){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(input);if(!isEnabledVisible)return true;var length=input.value.trim().length;if(length===0||length>=minLength)return true;return false},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(input);
if(!isEnabledVisible)return true;var isEmpty=input.value.trim().length===0;return!isEmpty}};
D2L.LP.Web.UI.Common.Controls.EditUrl={Validate:function(id,allowInternal){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var value=D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(node);if(value===undefined||value===null||value.trim().length===0)return true;var regexpStr;if(allowInternal)regexpStr=D2L.LP.Web.UI.ObjectRepository.Get("UrlRegEx","AllowInternal");else regexpStr=
D2L.LP.Web.UI.ObjectRepository.Get("UrlRegEx","NoInternal");var regexp=new RegExp(regexpStr,"i");return regexp.test(value)},Required:function(id,allowInternal){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var hasProtocol=D2L.LP.Web.UI.Common.Controls.EditUrl.Validate(id,allowInternal);if(!hasProtocol)return true;var value=D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(node);
if(value===undefined||value===null||value.trim().length===0)return true;var regexp=new RegExp("(:|/)[a-zA-Z0-9]","i");var hasContent=regexp.test(value);if(allowInternal&&hasContent)return true;return hasContent}};
D2L.LP.Web.UI.Common.Controls.Form={BuildParams:function(id,params){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Common.Controls.Form.BuildParamsNode(form,params)},BuildParamsNode:function(form,params){var elements=D2L.LP.Web.UI.Common.Controls.Form.GetFormElements(form);var scopeToIgnore=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-scope");return D2L.LP.Web.UI.Common.Controls.Form.BuildParamsHelper(elements,params,scopeToIgnore)},GetFormElements:function(form){var elements;
var isNested=D2L.LP.Web.UI.Common.Controls.Form.IsNestedForm(form);if(isNested){var pageForm=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-primary",form);var pageFormElements=pageForm.elements;elements=[];for(var i=0;i<pageFormElements.length;i++){var pageFormElement=pageFormElements[i];if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,pageFormElement))elements.push(pageFormElement)}}else elements=form.elements;return elements},BuildParamsHelper:function(elements,params,scopeToIgnore){if(params===
undefined||params===null)params={};for(var key in params)if(params[key]===null)delete params[key];for(var i=0;i<elements.length;i++){var element=elements[i];if(element.name!==undefined&&element.name!=""&&element.disabled==false&&!(element.tagName.toLowerCase()=="input"&&(element.type=="radio"||element.type=="checkbox")&&element.checked==false)){var elemName=element.name;if(scopeToIgnore&&scopeToIgnore!="")elemName=elemName.replace(scopeToIgnore,"");if(params[elemName]!==undefined)if(D2L.LP.Web.UI.Html.JavaScript.IsArray(params[elemName]))params[elemName].push(element.value);
else params[elemName]=[params[elemName],element.value];else params[elemName]=element.value}}return params},ClearChange:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.ChangeTracking.ClearChange(node)},ClearChanges:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);D2L.LP.Web.UI.Common.Controls.ChangeTracking.ClearChanges(form)},FinishSubmit:function(form){var params=D2L.LP.Web.UI.Common.Controls.Form.BuildParamsNode(form,null);
var location=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");var method=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-method");var target=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-target");var newForm=document.createElement("form");newForm.className="d2l-hidden";D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,"action",location);D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,"method",method);if(target)D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,"target",target);D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,
"enctype","application/x-www-form-urlencoded");newForm.onsubmit="return false;";var CreateAndAddHidden=function(name,val){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=name;hidden.value=val;newForm.appendChild(hidden)};CreateAndAddHidden(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());for(var key in params){var value=params[key];if(D2L.LP.Web.UI.Html.JavaScript.IsArray(value))for(var i=0;i<value.length;i++)CreateAndAddHidden(key,
value[i]);else CreateAndAddHidden(key,value)}document.body.appendChild(newForm);newForm.submit();newForm.parentNode.removeChild(newForm)},ClearValidation:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(form)},DoSubmit:function(form,submitFunc){form.m_stopChangeTrackingPrompt=true;var parentForms=D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName("d2l-form",form);for(var i=0;i<parentForms.length;i++)parentForms[i].m_stopChangeTrackingPrompt=
true;D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.Trigger(form);D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(form);var evt=new D2L.LP.Web.UI.Events.Event;evt.AddListener(function(){form.m_stopChangeTrackingPrompt=false;form.m_skipValidation=false;for(var i=0;i<parentForms.length;i++)parentForms[i].m_stopChangeTrackingPrompt=false});if(submitFunc===undefined)submitFunc=function(evt2){var hasAction=D2L.LP.Web.UI.Html.Dom.HasAttribute(form,"data-location");var submit=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,
"submit");var handleRet=function(retVal){if(retVal===true||retVal===false)evt2.Trigger(retVal);else if(retVal!==undefined&&retVal.AddListener!==undefined)retVal.AddListener(handleRet);else evt2.Trigger(true)};if(submit!==null){var ret=submit.call(submit);if(ret===undefined)ret=true;handleRet(ret)}else if(hasAction){form.m_skipValidation=false;D2L.LP.Web.UI.Common.Controls.Form.FinishSubmit(form);setTimeout(function(){evt2.Trigger(true)})}};var validators=D2L.LP.Web.UI.Common.Controls.Form.GetValidators(form);
if(validators.length>0&&!form.m_skipValidation)D2L.LP.Web.UI.Common.Controls.Form.Validate(form,validators).AddListener(function(passed){if(passed){form.m_skipValidation=true;submitFunc(evt)}else evt.Trigger(false)});else{form.m_skipValidation=false;submitFunc(evt)}return evt},GetForm:function(id){var form=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(form===null)throw"Form not found: '"+id.GetValue()+"'.";return form},GetLocation:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);
var loc=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");if(loc)return new D2L.LP.Web.Http.UrlLocation(loc);else return null},GetRpcVerb:function(form){var verb=D2L.LP.Web.UI.Rpc.Verbs.POST;var method=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-method");if(method==="get")verb=D2L.LP.Web.UI.Rpc.Verbs.GET;return verb},GetValidators:function(form){var allForms=[];allForms.push(form);allForms=allForms.concat(D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form",form));var validators=[];
for(var i=0;i<allForms.length;i++){var formNode=allForms[i];if(formNode.d2l_validators!==undefined)for(var j=0;j<formNode.d2l_validators.length;j++)validators.push(formNode.d2l_validators[j]())}return validators},HasChanged:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Common.Controls.Form.HasChangedNode(form)},HasValueChanged:function(id){var valueNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.ChangeTracking.HasValueChanged(valueNode)},
HasChangedNode:function(node){return D2L.LP.Web.UI.Common.Controls.ChangeTracking.HasChanged(node)},IsNestedForm:function(formNode){return D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-form-nested",formNode)},RpcObjectSubmit:function(id,loc,skipValidation,params){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);var evt=new D2L.LP.Web.UI.Events.Event;var submitFunc=function(evt2){params=D2L.LP.Web.UI.Common.Controls.Form.BuildParams(id,params);var rpcEvt=D2L.LP.Web.UI.Rpc.ConnectObject(D2L.LP.Web.UI.Common.Controls.Form.GetRpcVerb(form),
loc,params);rpcEvt.AddListener(function(val){evt.Trigger(val);evt2.Trigger()})};var doSubmitEvt=D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form,submitFunc);doSubmitEvt.AddListener(function(pass){if(!pass)setTimeout(function(){evt.Release()},50)});return evt},RpcSubmit:function(id,location,skipValidation,params,options){if(skipValidation===undefined||skipValidation===null)skipValidation=false;var submitFunc=function(evt){params=D2L.LP.Web.UI.Common.Controls.Form.BuildParams(id,params);var rpcEvt=
D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Common.Controls.Form.GetRpcVerb(form),location,params,options);rpcEvt.AddListener(function(pass){evt.Trigger(pass)})};var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);form.m_skipValidation=skipValidation;var submitRet=D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form,submitFunc);return submitRet},RpcSubmitPartial:function(placeholderId,id,location,skipValidation,params,options){if(skipValidation===undefined||skipValidation===null)skipValidation=false;
if(options===undefined||options===null)options={};if(params===undefined||params===null)params={};var ret=new D2L.LP.Web.UI.Events.Event;params["_d2l_prc"]=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId.GetValue());var functions={success:function(result){ret.Trigger(result);if(result&&options.success)options.success.call(options.success);if(!result&&options.failure!==undefined)options.failure.call(options.failure)},failure:function(){ret.Trigger(false);if(options.failure!==
undefined)options.failure.call(options.failure)}};var evt;evt=D2L.LP.Web.UI.Common.Controls.Form.RpcSubmit(id,location,skipValidation,params,functions);evt.AddListener(function(success){if(!success)ret.Trigger(false)});return ret},Reset:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);var elements=D2L.LP.Web.UI.Common.Controls.Form.GetFormElements(form);for(var i=0;i<elements.length;i++){var element=elements[i];if(element&&element.defaultValue!==undefined&&element.value!==undefined)element.value=
element.defaultValue;if(element&&element.defaultChecked!==undefined&&element.checked!==undefined)element.checked=element.defaultChecked}D2L.LP.Web.UI.Common.Controls.ChangeTracking.ClearChanges(form);D2L.LP.Web.UI.Events.OnFormReset.Trigger(form)},SetLocation:function(id,location){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",location.GetUrl())},StopChangeTracking:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);
form.m_stopChangeTrackingPrompt=true},Submit:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form)},SubmitByButton:function(buttonId){var submitButton=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var form=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form",submitButton);if(form)return D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form)},SubmitToIFrame:function(id,iframeId,location){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);
var iframe=D2L.LP.Web.UI.Html.Dom.GetElementById(iframeId);return D2L.LP.Web.UI.Common.Controls.Form.SubmitToIFrameHelper(form,iframe,location)},SubmitToIFrameHelper:function(form,iframe,location){var oldAction=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");var oldTarget=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-target");D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",location.GetUrl());D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-target",iframe.name);var evt=D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form);
evt.AddListener(function(){if(oldAction===null)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(form,"data-location");else D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",oldAction);if(oldTarget===null)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(form,"data-target");else D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-target",oldTarget)});return evt},SubmitToDialog:function(id,dialogOpenerId,dialogLocation,dialogSettings){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(form,
dialogOpenerId,dialogLocation,dialogSettings)},ValidateById:function(formId){var evt=new D2L.LP.Web.UI.Events.Event;var form=D2L.LP.Web.UI.Html.Dom.GetElementById(formId.GetValue());var validators=D2L.LP.Web.UI.Common.Controls.Form.GetValidators(form);D2L.LP.Web.UI.Common.Controls.Form.Validate(form,validators).AddListener(function(passed){if(passed)evt.Trigger(true);else evt.Trigger(false)});return evt}};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Common.Controls.ChangeTracking={AddChangeTrackElement:function(elementNode,onChangeEvent,getValueDelegate){var visuallyChangeTrackers=false;var trackerNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-tracker",elementNode);var ancestorFormWithTrackChanges=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-track-changes",elementNode);visuallyChangeTrackers=ancestorFormWithTrackChanges!=null&&trackerNode!=null;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-form-tracked-element",
elementNode);var element={getValueDelegate:getValueDelegate,initialValue:getValueDelegate(),hasChanged:false};elementNode.d2l_tracking_element=element;var onChange=function(){D2L.LP.Web.UI.Common.Controls.ChangeTracking.OnChange.Trigger(elementNode);var newValue=getValueDelegate();if(element.initialValue!==newValue){if(visuallyChangeTrackers)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-form-tracker-changed",trackerNode);element.hasChanged=true}else{element.hasChanged=false;if(visuallyChangeTrackers){var noMoreChangedElements=
!D2L.LP.Web.UI.Common.Controls.ChangeTracking.HasChanged(trackerNode);if(noMoreChangedElements)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-form-tracker-changed",trackerNode)}}};onChangeEvent.AddListener(onChange)},ClearChanges:function(ancestorNode){var elements=D2L.LP.Web.UI.Common.Controls.ChangeTracking.GetElements(ancestorNode);for(var i=0;i<elements.length;i++){elements[i].initialValue=elements[i].getValueDelegate();elements[i].hasChanged=false}var trackerNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-tracker",
ancestorNode);for(var i=0;i<trackerNodes.length;i++)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-form-tracker-changed",trackerNodes[i])},ClearChange:function(elementNode){if(elementNode===undefined||elementNode===null)return;var element=elementNode.d2l_tracking_element;if(element===undefined)return;element.initialValue=element.getValueDelegate();element.hasChanged=false;var trackerNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-tracker",elementNode);if(trackerNode===null)return;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-form-tracker-changed",
trackerNode)},GetElements:function(ancestorNode){var elements=[];var elementNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-tracked-element",ancestorNode);for(var i=0;i<elementNodes.length;i++)if(elementNodes[i].d2l_tracking_element)elements.push(elementNodes[i].d2l_tracking_element);return elements},HasChanged:function(ancestorNode){var elements=D2L.LP.Web.UI.Common.Controls.ChangeTracking.GetElements(ancestorNode);for(var i=0;i<elements.length;i++)if(elements[i].hasChanged)return true;
return false},HasValueChanged:function(elementNode){if(elementNode===undefined||elementNode===null)return false;var element=elementNode.d2l_tracking_element;if(element===undefined)return false;return element.hasChanged}};D2L.LP.Web.UI.Common.Controls.ChangeTracking.OnChange=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Common.Controls.Hidden={GetValue:function(id,defaultValue){var noThrow=defaultValue!==undefined;var node=D2L.LP.Web.UI.Common.Controls.Hidden.Get(id,noThrow);if(node===null)return defaultValue;var value=node.value;return value},Get:function(id,noThrow){var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(hidden===null){if(noThrow)return null;throw"Hidden not found: '"+id.GetValue()+"'.";}return hidden},SetValue:function(id,value){var hidden=D2L.LP.Web.UI.Common.Controls.Hidden.Get(id);
hidden.value=value;if(hidden.d2l_changeEvent)hidden.d2l_changeEvent.Trigger()}};D2L.LP.Web.UI.Common.Controls.HtmlBlock={SetHtml:function(id,val){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"HtmlBlock not found '"+idVal+"'.";node.innerHTML=val}};
D2L.LP.Web.UI.Common.Controls.IFrame={AddOnLoadHandler:function(iframe,handler){if(iframe.m_loaded)handler();else D2L.LP.Web.UI.Html.Dom.AddEventListener("load",iframe,handler)},SetLocation:function(id,location){var $frame=id.$();var loadingIcon=$frame.prev(".d2l-iframe-loading-container");loadingIcon.show();$frame.hide().load(function(){loadingIcon.hide();$frame.show()}).attr("src",location.GetUrl())},GetNextGeneratedId:function(){var id=10;return function(){return id++}}()};
D2L.LP.Web.UI.Common.Controls.ImageLink={SetTitle:function(id,title){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){node.title=title;var titleNode=node.firstChild;while(titleNode.childNodes.length>0)titleNode.removeChild(titleNode.childNodes[0]);titleNode.appendChild(document.createTextNode(title))}},SetImage:function(id,src,width,height){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){node.style.backgroundImage="url("+src+")";if(width!==
0)node.style.width=width+"px";if(height!==0)node.style.height=height+"px"}},AddOnClick:function(id,onclick){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"onclick","return false;");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){if(D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node))onclick()})},AddOnFocus:function(id,onFocus){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
if(node===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,onFocus)},AddOnBlur:function(id,onBlur){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,onBlur)},IsEnabledNode:function(node){return!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-imagelink-disabled",node)},IsEnabled:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node)},
SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabledNode(node,isEnabled)},SetIsEnabledNode:function(node,isEnabled){var isDisabled=!D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node);if(!isEnabled==isDisabled)return;D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled",!isEnabled);var hoverClassName=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-hoverClassName");if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-imagelink-disabled",
node);if(hoverClassName)D2L.LP.Web.UI.Html.Dom.AddClassName(hoverClassName,node);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","false")}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-imagelink-disabled",node);if(hoverClassName)D2L.LP.Web.UI.Html.Dom.RemoveClassName(hoverClassName,node);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true")}var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?"data-href":"href");if(!hasHref)return;var href=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,
isEnabled?"data-href":"href");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?"href":"data-href",href);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?"data-href":"href")}};
D2L.LP.Web.UI.Common.Controls.Link={InstallClickable:function(node){node.tabIndex=0;var handleEnter=function(){D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",node)};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(key){if(key.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)handleEnter()})},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;while(node.firstChild)node.removeChild(node.firstChild);node.appendChild(document.createTextNode(text))}};
D2L.LP.Web.UI.Common.Controls.SelectList={GetInput:function(id,noThrow){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!noThrow&&input===null)throw"SelectList not found: '"+id.GetValue()+"'.";return input},GetSelectedValue:function(id,defaultValue){var noThrow=defaultValue!==undefined;var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id,noThrow);if(input===null)return defaultValue;var option=input.options[input.selectedIndex];return option.value},GetValues:function(id){var input=
D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);var values=[];for(var i=0;i<input.options.length;i++)values.push(input.options[i].value);return values},SetIsVisibleFunction:function(id,isVisible){var node=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-select-container",node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(container,isVisible)},SetSelectedValue:function(id,value){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);
for(var i=0;i<input.options.length;i++)if(input.options[i].value===value){input.selectedIndex=i;break}},Focus:function(id){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);input.focus()},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);if(input.options.length===0)return false;var option=input.options[input.selectedIndex];if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-selectlist-nonselectable",option))return false;return true}};
D2L.LP.Web.UI.Desktop.MasterPages.Dialog={NumOfDialogs:0,Offset:20,AdaptPageToDialog:function(handle){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var doc=handle.frame.contentWindow.document;var pageHeader=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-header",handle.container);if(pageHeader===null)return;var close=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-close",handle.container);if(close!==null)return;close=doc.createElement("a");close.className="d2l-dialog-close vui-outline";
me.InitClose(close,handle.frame.contentWindow);pageHeader.insertBefore(close,pageHeader.childNodes[1])},InitClose:function(node,nodeWin){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);");if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"onclick")){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"onclick","return false;");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Abort(nodeWin)})}},
InitResize:function(node,nodeWin){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle(nodeWin);var settings={Handle:node,DisplayType:"none",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var evt=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(handle.dialog,settings,nodeWin,handle.rootWin);evt.AddListener(function(size){handle.isResized=true;me.SetSize(handle,size.width-8,size.height-8)});D2L.LP.Web.UI.Events.OnSizingFinished.AddListener(function(){if(!handle||!handle.container||
!handle.body)return;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);handle.height=rect.height+handle.nodes.footer.offsetHeight;var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=handle.height-rectBody.height;me.SetSize(handle,handle.width,handle.height)});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(partialNode){if(!handle||!handle.nodes.footer||!handle.container||!handle.body)return;if(partialNode.nodeType!==1)return;if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(handle.nodes.footer,
partialNode))return;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);var height=rect.height;if(handle.height===height)return;var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.nodes.footer);height+=footerRect.height;if(handle.height===height)return;handle.height=height;var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=handle.height-rectBody.height;me.SetSize(handle,handle.width,handle.height)})},InitTitle:function(node,nodeWin){var closeNode=
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-close",node)[0];var handle=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.GetHandle(nodeWin);D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitleHelper(handle,handle.dialog,node,closeNode,nodeWin,handle.rootWin)},InitTitleHelper:function(handle,dialogNode,titleNode,closeNode,nodeWin,win){var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;dragSettings.SetHandle(titleNode);dragSettings.SetIsDelayed(false);dragSettings.SetDragDropEffect(D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move);
if(closeNode)dragSettings.AddHandleException(closeNode);dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow);dragSettings.GetDragStartEvent().AddListener(function(){handle.isDragged=true});dragSettings.SetIsAutoScroll(false);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(dialogNode,dragSettings,nodeWin,win)},SetWidth:function(width){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle();width=Math.max(width,400);handle.width=width;handle.dialog.style.width=
width+"px";handle.setWidthCalled=true;if(handle.container!==null)handle.container.style.width=width-2+"px";if(handle.frame!==null)handle.frame.style.width=width-2+"px";handle.onresize();handle.dialog.OnResize.Trigger()},SetSize:function(handle,width,height){width=Math.max(width,400);handle.width=width;handle.height=height;handle.dialog.style.width=width+"px";handle.dialog.style.height=height+"px";if(handle.container!==null)handle.container.style.width=width-2+"px";if(handle.inner!==null)handle.inner.style.height=
height-2+"px";if(handle.frame!==null){handle.frame.style.width=width-2+"px";handle.frame.style.height=height-2+"px"}if(handle.body!==null&&handle.nodes.footer!==null){var footerSize=handle.nodes.footer.offsetHeight;handle.body.style.height=height-3-handle.bodyDiff-footerSize+"px";handle.dialog.OnResize.Trigger()}if(handle.setWidthCalled)return;clearTimeout(handle.heightTimeout);handle.heightTimeout=setTimeout(function(){if(handle.body===null||handle.nodes.title===null||handle.nodes.footer===null)return;
var headerPlusFooterHeight=handle.nodes.title.offsetHeight+handle.nodes.footer.offsetHeight;var newBodyHeight=parseInt(height-headerPlusFooterHeight);handle.body.style.height=newBodyHeight+"px";handle.dialog.OnResize.Trigger()},0)},Build:function(handle,form,location,settings){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;handle.width=settings.Width?settings.Width:400;handle.height=settings.Height?settings.Height:300;var dialogHeight=handle.height;var loadedOnce=false;var adjustSize=function(){var scroll=
D2L.LP.Web.UI.Html.Dom.GetScrollPosition(handle.rootWin);handle.dialog.style.top=scroll.top+50+handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs*handle.rootWin.D2L.LP.Web.UI.Common.MasterPages.Dialog.Offset+"px";me.SetSize(handle,handle.width,handle.height)};handle.dialog=handle.rootWin.document.createElement("div");handle.dialog.OnResize=new D2L.LP.Web.UI.Events.Event;handle.dialog.className="d2l-dialog d2l-dialog-loading";handle.dialog.d2l_handle=handle;handle.firstLoadEvent=
new D2L.LP.Web.UI.Events.Event;handle.inner=handle.rootWin.document.createElement("div");handle.inner.className="d2l-dialog-inner";handle.dialog.appendChild(handle.inner);var frameId=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();handle.inner.innerHTML="<iframe src='/d2l/tools/blank.html' name='"+frameId+"'></iframe>";handle.frame=handle.inner.firstChild;handle.frame.frameBorder="0";handle.frame.scrolling="no";handle.frame.className="d2l-dialog-frame d2l-dialog-frame-loading";handle.onresize=function(){if(handle.isDragged)return;
var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);var left=Math.max(viewport.width/2-handle.width/2,0);handle.dialog.style.left=left+handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs*handle.rootWin.D2L.LP.Web.UI.Common.MasterPages.Dialog.Offset+"px"};D2L.LP.Web.UI.Events.OnResize.AddListener(handle.onresize);D2L.LP.Web.UI.Html.Dom.AddEventListener("load",handle.frame,function(){if(!loadedOnce){loadedOnce=true;handle.firstLoadEvent.Trigger();return}handle.container=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-width",handle.frame.contentWindow.document);if(handle.container!==null)handle.frame.style.overflow="hidden";else{handle.frame.style.overflow="scroll";handle.container=handle.frame.contentWindow.document.body;me.AdaptPageToDialog(handle)}handle.body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",handle.container);if(handle.body===null)handle.body=handle.container;handle.nodes.title=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-title",
handle.container);handle.nodes.footer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-footer-container",handle.container);if(settings.Onload!==undefined)settings.Onload.call(settings.Onload,handle);var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);dialogHeight=rect.height;if(!handle.setWidthCalled)handle.width=rect.width;if(handle.frame.contentWindow.D2L!==undefined){handle.frame.contentWindow.D2L.LP.Web.UI.Events.OnContentHeightChange.AddListener(function(newHeight){var desiredGrowth=
newHeight+handle.bodyDiff-handle.height;if(handle.isResized||desiredGrowth<0)return;rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.dialog);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(handle.rootWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);var top=Math.max(rect.top-scroll.top,0);var roomToGrow=viewport.height-top-rect.height;newHeight=handle.height+Math.min(desiredGrowth,roomToGrow);me.SetSize(handle,handle.width,newHeight)});if(settings.Height===undefined){var h=
D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.container,"data-height");if(h!==null)handle.height=parseInt(h);else{var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);handle.height=Math.max(Math.min(dialogHeight+handle.nodes.footer.offsetHeight+10,viewport.height-100),200)}}if(handle.settings.AutoClose){handle.ondocumentclick=function(){handle.frame.contentWindow.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Close()};D2L.LP.Web.UI.Events.OnClick.AddListener(handle.ondocumentclick)}}setTimeout(function(){var rectBody=
D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=dialogHeight-rectBody.height;adjustSize();handle.onresize()},0);handle.frame.contentWindow.document.body.style.overflow="hidden";me.Focus(handle.container,handle.frame.contentWindow);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-dialog-loading",handle.dialog);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-dialog-frame-loading",handle.frame)});adjustSize();handle.onresize();if(form===null)handle.firstLoadEvent.AddListener(function(){handle.frame.src=
location.GetUrl()});handle.inner.appendChild(handle.frame)},Abort:function(win){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(false,undefined,win)},Close:function(result){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(true,result)},CloseExternal:function(result){parent.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(true,result)},CloseHelper:function(doTrigger,result,win){var handle=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.GetHandle(win);if(handle===null)return result;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(doTrigger,
true,result,handle)},CloseHelperWithHandle:function(doTrigger,doFocus,result,handle){if(handle.m_isClosed)return;if(handle.onresize!==null)handle.win.D2L.LP.Web.UI.Events.OnResize.RemoveListener(handle.onresize);if(handle.ondocumentclick!==null)handle.win.D2L.LP.Web.UI.Events.OnClick.RemoveListener(handle.ondocumentclick);if(handle.shim!==null&&handle.settings.ShimType>0)D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(handle.shim);if(doTrigger)handle.evt.Trigger(result);else handle.evt.Release();setTimeout(function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperForFocusSwitch(handle,
doFocus)},0);handle.m_isClosed=true},CloseHelperForFocusSwitch:function(handle,doFocus){var removeDialog=function(){handle.dialog.d2l_handle=null;handle.dialog.parentNode.removeChild(handle.dialog);handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs--};var assignFocusToOpener=function(){try{if(doFocus)handle.opener.focus()}catch(e){}};if(navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1){var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-body");
if(body!==null){var rootDocument=handle.rootWin.document;var ieInput=rootDocument.createElement("input");ieInput.style.position="absolute";ieInput.style.height="0px";ieInput.style.width="0px";ieInput.style.top=rootDocument.documentElement.scrollTop+"px";ieInput.style.left=rootDocument.documentElement.scrollLeft+"px";body.appendChild(ieInput);var focusAndRemove=function(){ieInput.focus();body.removeChild(ieInput)};setTimeout(function(){focusAndRemove()},0);ieInput.focus()}removeDialog();assignFocusToOpener()}else{assignFocusToOpener();
removeDialog()}handle=null},Focus:function(dialog,win){var focusId=D2L.LP.Web.UI.Html.Dom.GetAttribute(dialog,"data-focusid");if(focusId!==null){var focusElem=win.D2L.LP.Web.UI.Html.Dom.GetElementById(focusId);if(D2L.LP.Web.UI.Html.Dom.IsFocusable(focusElem)){D2L.LP.Web.UI.Html.Dom.FocusNode(focusElem);return}}var doc=win.document;var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var closeElem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-close",dialog);var elems=me.GetFocusableElements(dialog);
if(elems.length===0)return;try{elems[0].focus()}catch(e){}if(closeElem===null)return;var first=doc.createElement("span");first.tabIndex=0;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",first,function(){elems[elems.length-1].focus()});closeElem.parentNode.insertBefore(first,closeElem);var last=doc.createElement("span");last.tabIndex=0;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",last,function(){closeElem.focus()});var lastElem=elems[elems.length-1];if(lastElem.nextSibling)lastElem.parentNode.insertBefore(last,
lastElem.nextSibling);else lastElem.parentNode.appendChild(last)},GetFocusableElements:function(dialog){var focusableElems={"a":true,"input":true,"select":true,"textarea":true,"button":true};var elems=[];var closeElem=null;var findElems=function(node){if(node.nodeType!==1)return;var tagName=node.tagName.toLowerCase();if(focusableElems[tagName]===true){var focusable=true;if(tagName=="input"&&(node.type=="hidden"||node.disabled===true))focusable=false;else if(D2L.LP.Web.UI.Html.Css.GetStyle(node,"display")===
"none")focusable=false;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-dialog-close",node)){closeElem=node;focusable=false}if(focusable)elems.push(node)}for(var i=0;i<node.childNodes.length;i++)findElems(node.childNodes[i])};findElems(dialog);if(elems.length===0&&closeElem!==null)elems.push(closeElem);return elems},GetHandle:function(win){win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-frame",win.parent.document);for(var i=0;i<dialogs.length;i++)if(dialogs[i].contentWindow==
win)return dialogs[i].parentNode.parentNode.d2l_handle;return null},FixSettings:function(settings){if(settings===undefined||settings===null)settings={};if(settings.AutoClose===undefined)settings.AutoClose=false;if(settings.ShimType===undefined)settings.ShimType=1;if(settings.Window===undefined)if(window.parent&&window.parent.frames&&window.parent.frames.length===3)settings.Window=window;return settings},Open:function(openerId,location,settings){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(null,
openerId,location,settings)},OpenHelper:function(opener,location,settings){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmitHelper(null,opener,location,settings)},OpenWithParam:function(openerId,location,params,settings){var evt=new D2L.LP.Web.UI.Events.Event;var serializer=new D2L.LP.Web.Serialization.Serializer;var createHidden=function(name,value){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=name;hidden.value=value;return hidden};var form=document.createElement("form");
D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-method","POST");for(var key in params)serializer.AddMember(key,params[key]);var members=serializer.GetMembers();for(var i=0;i<members.length;i++)form.appendChild(createHidden(members[i][0],members[i][1]));document.body.appendChild(form);var openSubmitEvent=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(form,openerId,location,settings);openSubmitEvent.AddListener(function(result){evt.Trigger(result)});openSubmitEvent.AddReleaseListener(function(){evt.Release()});
return evt},OpenSubmit:function(form,openerId,location,settings){var opener=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(opener===null)throw"Dialog opener not found: "+openerId.GetValue();else if(opener.focus===undefined)throw"Invalid dialog opener: "+openerId.GetValue();return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmitHelper(form,opener,location,settings)},OpenSubmitHelper:function(form,opener,location,settings){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;settings=me.FixSettings(settings);
var evt=new D2L.LP.Web.UI.Events.Event;var rootWin=window;while(true){if(rootWin.parent===rootWin||rootWin.D2L===undefined)break;rootWin=rootWin.parent}if(settings.Window)rootWin=settings.Window;var handle={dialog:null,frame:null,body:null,bodyDiff:50,height:200,heightTimeout:null,inner:null,isResized:false,container:null,onresize:null,ondocumentclick:null,shim:null,win:window,rootWin:rootWin,opener:opener,evt:evt,isDragged:false,settings:settings,nodes:{title:null,heading:null,close:null,footer:null},
width:300};handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs++;me.Build(handle,form,location,settings,rootWin);var appendToDom=function(){rootWin.document.body.appendChild(handle.dialog)};var shim=function(){if(settings.ShimType>0)handle.shim=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(handle.dialog,settings.ShimType==2)};if(form!==null){handle.dialog.style.visibility="hidden";appendToDom();handle.firstLoadEvent.AddListener(function(){D2L.LP.Web.UI.Common.Controls.Form.SubmitToIFrameHelper(form,
handle.frame,location).AddListener(function(result){if(result){shim();handle.dialog.style.visibility="visible"}else me.CloseHelperWithHandle(false,false,undefined,handle)})})}else{shim();appendToDom()}return evt}};D2L.LP.Web.UI.Common.MasterPages.Dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;
D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline={Open:function(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,iconClass,primaryButtonCallback,secondaryButtonCallback,abortCallback,openerId,id){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var rootWin=window;while(true){if(rootWin.parent===rootWin||rootWin.D2L===undefined)break;rootWin=rootWin.parent}var handle={activeElement:document.activeElement,cont:null,shim:null,openerId:openerId,abortCallback:abortCallback,
rootWin:rootWin};var nodes=me.Build(handle,titleText,closeButtonText,iconClass,primaryMessage,secondaryMessage,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,id);handle.cont=nodes.container;handle.shim=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(nodes.container,false);nodes.container.d2l_handle=handle;rootWin.document.body.appendChild(nodes.container);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(rootWin);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(rootWin);
var width=Math.min(nodes.bodyCont.offsetWidth,viewport.width*0.6);nodes.container.style.width=width+"px";nodes.container.style.left=(viewport.width-width)/2+"px";nodes.container.style.top=scroll.top+50+"px";nodes.anchorStart.focus()},Build:function(handle,titleText,closeButtonText,iconClass,primaryMessage,secondaryMessage,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,id){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var titleNodes=me.BuildTitle(handle,
titleText,closeButtonText);var footerNodes=me.BuildFooter(handle,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback);var anchorStart=handle.rootWin.document.createElement("a");anchorStart.onclick="return false;";D2L.LP.Web.UI.Html.Dom.SetAttribute(anchorStart,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchorStart,function(){if(footerNodes.secondaryButton!==null)footerNodes.secondaryButton.focus();else if(footerNodes.primaryButton!==
null)footerNodes.primaryButton.focus();else{var result=D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement(anchorStart);if(result)result.focus();else titleNodes.close.focus()}});var html="";if(primaryMessage!==null&&primaryMessage!==undefined&&primaryMessage.length>0)html="<p><b>"+primaryMessage+"</b></p>";if(secondaryMessage!==null&&secondaryMessage!==undefined&&secondaryMessage.length>0)html+="<p>"+secondaryMessage+"</p>";var bodyCont=handle.rootWin.document.createElement("div");if(iconClass!==null&&
iconClass!==undefined&&iconClass.length>0)iconClass=" d2l-dialog-inline-body-icon "+iconClass;else iconClass=" d2l-dialog-inline-body-noicon";bodyCont.className="d2l-dialog-inline-body"+iconClass;bodyCont.id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();bodyCont.innerHTML=html;var anchorEnd=handle.rootWin.document.createElement("a");anchorEnd.onclick="return false";D2L.LP.Web.UI.Html.Dom.SetAttribute(anchorEnd,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchorEnd,
function(){titleNodes.close.focus()});var inner=handle.rootWin.document.createElement("div");inner.className="d2l-dialog-inner d2l-font";inner.appendChild(anchorStart);inner.appendChild(titleNodes.cont);inner.appendChild(bodyCont);if(footerNodes.cont!==null)inner.appendChild(footerNodes.cont);inner.appendChild(anchorEnd);var cont=handle.rootWin.document.createElement("div");if(id)cont.id=id.GetValue();cont.className="d2l-dialog d2l-dialog-inline";D2L.LP.Web.UI.Html.Aria.SetRole(cont,"alertdialog");
D2L.LP.Web.UI.Html.Aria.SetAttribute(cont,"describedby",bodyCont.id);D2L.LP.Web.UI.Html.Aria.SetAttribute(cont,"labelledby",titleNodes.title.id);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cont,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)me.AbortWithHandle(handle)});cont.appendChild(inner);D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitleHelper({isDragged:false},cont,titleNodes.cont,titleNodes.close,handle.rootWin,handle.rootWin);return{container:cont,
title:titleNodes.title,bodyCont:bodyCont,close:titleNodes.close,anchorStart:anchorStart}},BuildTitle:function(handle,titleText,closeButtonText){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var title=handle.rootWin.document.createElement("h2");title.className="d2l-heading";title.innerHTML=titleText;title.id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();var closeButtonSpan=handle.rootWin.document.createElement("span");closeButtonSpan.className="d2l-offscreen";closeButtonSpan.innerHTML=
closeButtonText;var closeButton=handle.rootWin.document.createElement("a");closeButton.className="d2l-dialog-close";D2L.LP.Web.UI.Html.Aria.SetRole(closeButton,"button");D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,"onclick","return false;");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",closeButton,function(){me.AbortWithHandle(handle)});var innerSpan=handle.rootWin.document.createElement("span");innerSpan.appendChild(closeButtonSpan);
closeButton.appendChild(innerSpan);var cont=handle.rootWin.document.createElement("div");cont.className="d2l-dialog-title";cont.appendChild(title);cont.appendChild(closeButton);return{cont:cont,title:title,close:closeButton}},BuildFooter:function(handle,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback){if((primaryButtonText===undefined||primaryButtonText===null||primaryButtonText.length===0)&&(secondaryButtonText===undefined||secondaryButtonText===null||secondaryButtonText.length===
0))return{cont:null,primaryButton:null,secondaryButton:null};var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var buttonCont=handle.rootWin.document.createElement("div");buttonCont.className="d2l-dialog-buttons";var clear=handle.rootWin.document.createElement("div");clear.className="d2l-clear";var footerCont=handle.rootWin.document.createElement("div");footerCont.className="d2l-dialog-footer";footerCont.appendChild(buttonCont);footerCont.appendChild(clear);var primaryButton=null;if(primaryButtonText!==
undefined&&primaryButtonText!==null&&primaryButtonText.length>0){primaryButton=D2L.LP.Web.UI.Common.Controls.Button.Build(handle.rootWin.document);buttonCont.appendChild(primaryButton);D2L.LP.Web.UI.Common.Controls.Button.Init(primaryButton);D2L.LP.Web.UI.Common.Controls.Button.SetIsPrimaryNode(primaryButton,true);D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(primaryButton,primaryButtonText);D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(primaryButton,function(){me.Close(handle);if(primaryButtonCallback!==
null)primaryButtonCallback()})}var secondaryButton=null;if(secondaryButtonText!==undefined&&secondaryButtonText!==null&&secondaryButtonText.length>0){secondaryButton=D2L.LP.Web.UI.Common.Controls.Button.Build(handle.rootWin.document);buttonCont.appendChild(secondaryButton);D2L.LP.Web.UI.Common.Controls.Button.Init(secondaryButton);D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(secondaryButton,secondaryButtonText);D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(secondaryButton,function(){me.Close(handle);
if(secondaryButtonCallback!==null)secondaryButtonCallback()})}return{cont:footerCont,primaryButton:primaryButton,secondaryButton:secondaryButton}},Close:function(handle){D2L.LP.Web.UI.Html.Dom.RemoveElement(handle.cont);D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(handle.shim);var opener=handle.activeElement;if(handle.openerId!==null)opener=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.openerId);D2L.LP.Web.UI.Html.Dom.FocusNode(opener)},Abort:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);
if(node===null||node.d2l_handle===undefined)return;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.AbortWithHandle(node.d2l_handle)},AbortWithHandle:function(handle){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Close(handle);if(handle.abortCallback!==null)handle.abortCallback()}};
D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InlineDialog=function(openerId,id,titleText,primaryMessage,secondaryMessage,positiveButtonText,negativeButtonText,abortButtonText,iconImageClassName,positiveCallback,negativeCallback,abortCallback,positiveResult,negativeResult,abortResult){var evt=new D2L.LP.Web.UI.Events.Event;positiveResult=positiveResult==null?undefined:positiveResult;negativeResult=negativeResult==null?undefined:negativeResult;abortResult=abortResult==null?undefined:abortResult;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,
primaryMessage,secondaryMessage,positiveButtonText,negativeButtonText,abortButtonText,iconImageClassName,function(){if(positiveCallback)positiveCallback();evt.Trigger(positiveResult)},function(){if(negativeCallback)negativeCallback();evt.Trigger(negativeResult)},function(){if(abortCallback)abortCallback();evt.Trigger(abortResult)},openerId,id);return evt};
D2L.LP.Web.UI.Desktop.Controls.PageButtons={Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.PageButtons;var $node=$(node);var nodeHeight=$node.outerHeight();var $spacer=$('<div class="d2l-page-buttons-spacer"></div>').height(nodeHeight+"px").insertAfter(node);var handle={buttonHeight:$node.height(),extraWidth:$node.outerWidth(true)-$node.width(),$node:$node,$spacer:$spacer,$win:$(window),isFloating:false};var reposition=function(){me.Reposition(handle)};handle.$win.scroll(reposition).resize(reposition);
$(document).ready(reposition);var prevDocumentHeight=document.body.offsetHeight;setInterval(function(){var documentHeight=document.body.offsetHeight;if(prevDocumentHeight!==documentHeight)reposition();prevDocumentHeight=documentHeight},100)},SetIsFloating:function(handle,isFloating){if(handle.isFloating!==isFloating){handle.$spacer.toggleClass("d2l-page-buttons-float",isFloating);handle.$node.toggleClass("d2l-page-buttons-float",isFloating)}if(isFloating){var floatParent=handle.$node.parent();if(handle.$node.offset().top-
50<floatParent.offset().top){handle.$spacer.removeClass("d2l-page-buttons-float");handle.$node.removeClass("d2l-page-buttons-float");handle.isFloating=false;return}var extras=handle.$node.outerWidth(true)-handle.$node.width();var width=floatParent.width()-extras;handle.$node.width(width)}else handle.$node.width("auto");handle.isFloating=isFloating},Reposition:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.PageButtons;var docViewTop=handle.$win.scrollTop();var docViewBottom=docViewTop+handle.$win.height();
var documentHeight=$(document).height();var buttonPosition=handle.isFloating?handle.$spacer.position().top:handle.$node.position().top;if(buttonPosition+handle.buttonHeight+10<=docViewBottom||docViewBottom==documentHeight)me.SetIsFloating(handle,false);else me.SetIsFloating(handle,true)}};
D2L.LP.Web.UI.Desktop.MasterPages.PageMessage={Close:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;node.style.opacity=0;setTimeout(function(){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,false);node.style.opacity=0;node.style.bottom="40px"},1500)},Open:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;node.style.zIndex=D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex()+1E3;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,
true);setTimeout(function(){node.style.opacity=1;node.style.bottom="50px"},100)},Shake:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-page-message-shake",node);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-message-shake",node)},1E3)}};
D2L.LP.Web.UI.Desktop.Controls.ButtonMenu={Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonMenu;var dom=D2L.LP.Web.UI.Html.Dom;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"haspopup","true");D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",node);if(isDisabled)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true");var contextMenuId=dom.GetAttribute(node,
"data-contextMenuId");D2L.LP.Web.UI.Desktop.Controls.ContextMenu.InitPlaceholder(node,contextMenuId,"d2l-button-menu-hover");var onClick=dom.GetAttribute(node,"data-onclick");dom.RemoveAttribute(node,"data-onclick");dom.AddEventListener("click",node,function(){isDisabled=!me.IsEnabledNode(node);if(isDisabled)return;eval(onClick)})},IsEnabledNode:function(node){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",node);return!isDisabled},SetItemIsEnabled:function(id,key,isEnabled){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var contextMenuId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-contextMenuId");D2L.LP.Web.UI.Desktop.Controls.ContextMenu.SetItemIsEnabled(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(contextMenuId),key,isEnabled)},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",node);if(!isEnabled==isDisabled)return;D2L.LP.Web.UI.Html.Aria.SetAttribute(node,
"disabled",!isEnabled);if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-disabled",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-disabled",node);D2L.LP.Web.UI.Desktop.Controls.ContextMenu.SetIsEnabled(id,isEnabled)}};
D2L.LP.Web.UI.Desktop.Controls.CalendarMini={SetFocus:function(id,ariaMessage){var miniCalPlaceholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!miniCalPlaceholder)return;var miniCal=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini",miniCalPlaceholder);if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,"data-restoreColumn")){var startFromBottom=true;if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,"data-startFromBottom")){startFromBottom=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,
"data-startFromBottom");startFromBottom=startFromBottom=="true";D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,"data-startFromBottom")}var restoreColumn=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,"data-restoreColumn")-0;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,"data-restoreColumn");miniCal.navRestoreColumnFocus(restoreColumn,startFromBottom)}else if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,"data-restoreDate")){var restoreDay=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,
"data-restoreDate");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,"data-restoreDate");miniCal.navFocusDay(restoreDay)}else miniCal.navFocusDay(1);if(ariaMessage!==undefined&&ariaMessage!==null)D2L.LP.Web.UI.Html.Aria.LogMessage(ariaMessage)}};D2L.LP.Web.UI.Desktop.Controls.ContainerIcon={SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible)}};
D2L.LP.Web.UI.Desktop.Controls.ContextMenu={Close:function(id){var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(floatingContainerId,true)},CloseAll:function(){for(var i=0;i<D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened.length;i++){var contextMenuId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened[i];D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Close(contextMenuId)}},OnCloseHandler:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.m_openerId!=null){var openerNode=D2L.LP.Web.UI.Html.Dom.GetElementById(node.m_openerId.GetValue());openerNode.m_isClicked=false;D2L.LP.Web.UI.Html.Dom.DispatchEvent("blur",openerNode)}D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetOnCloseEvent(id).Trigger()},GetFloatingContainerHtmlId:function(id){var contextMenuContext=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"Context");return contextMenuContext["floatingContainerId"]},
GetOpener:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node.m_openerId)return null;return D2L.LP.Web.UI.Html.Dom.GetElementById(node.m_openerId.GetValue())},GetOpenerKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.m_openerKey},GetOnCloseEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;if(me.OnCloseEvents[id.GetValue()]===undefined)me.OnCloseEvents[id.GetValue()]=new D2L.LP.Web.UI.Events.Event;return me.OnCloseEvents[id.GetValue()]},
GetSelectedItemNode:function(contextMenuNode){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item-hover",contextMenuNode)[0]||D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item-disabled-hover",contextMenuNode)[0]||null},InstallKeyboardSupport:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var floatingContainerNode=node.parentNode;var contextMenuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item",node);var GetSelectedIndex=
function(){var selected=me.GetSelectedItemNode(node);var selectedIndex=contextMenuItems.length;for(var i=0;i<contextMenuItems.length;i++)if(contextMenuItems[i]===selected)selectedIndex=i;return selectedIndex};var Up=function(){var selectedIndex=GetSelectedIndex();var toSelectNode=null;for(var i=selectedIndex-1;i>=0;i--)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode===null)for(var i=contextMenuItems.length-1;i>selectedIndex;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode!==null)D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(toSelectNode).focus()};var Down=function(){var selectedIndex=GetSelectedIndex();var toSelectNode=null;for(var i=selectedIndex+1;i<contextMenuItems.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode===null)for(var i=0;i<selectedIndex;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode!==null)D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(toSelectNode).focus()};var handleKeyPress=function(arg){if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp)Up();else if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown)Down();else if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){me.Close(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id));if(node.m_openerId!=null)D2L.LP.Web.UI.Html.Dom.Focus(node.m_openerId)}else if(arg.GetKey()==
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){var selectedGetSelectedItem=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetSelectedItemNode(node);if(selectedGetSelectedItem){var anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(selectedGetSelectedItem);D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",anchor)}}else return true;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(arg.GetEventObject());return false};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(floatingContainerNode,handleKeyPress)},
IsOpen:function(id){var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)},Open:function(id,openerId,openerKey,targetId){var isOnDemand=D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),"LoadHandler");if(isOnDemand&&!D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.IsLoaded(id)){var loadRet=D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.Load(id,openerKey);loadRet.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Open(id,
openerId,openerKey,targetId)});return}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());node.m_openerKey=openerKey;node.m_openerId=openerId;var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);var openSettings={Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom};if(targetId!==undefined&&targetId!==null)openSettings.TargetId=targetId;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,openSettings);var floatingContainerNode=
node.parentNode;D2L.LP.Web.UI.Html.Aria.SetAttribute(floatingContainerNode,"labelledby",openerId.GetValue());var contextMenuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item",floatingContainerNode);if(contextMenuItems.length>0)D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(contextMenuItems[0]).focus();D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened.push(id)},Toggle:function(id,openerId,openerKey){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;if(me.IsOpen(id))me.Close(id);
else me.Open(id,openerId,openerKey)},InitPlaceholder:function(node,contextMenuId,hoverClassName){var contextMenu=D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId);var mouseIn=false;var OnOverHandler=function(){if(!mouseIn){D2L.LP.Web.UI.Html.Dom.AddClassName(hoverClassName,node);mouseIn=true}};var OnOutHandler=function(){if(!node.m_isClicked)D2L.LP.Web.UI.Html.Dom.RemoveClassName(hoverClassName,node);mouseIn=false};var OnClickHandler=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt||
window.event);var parentFloatingContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-floating-container",node);if(parentFloatingContainer)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",parentFloatingContainer);else D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",document);node.m_isClicked=true;D2L.LP.Web.UI.Html.Dom.AddClassName(hoverClassName,node)};node.d2l_onOverHandler=OnOverHandler;node.d2l_onOutHandler=OnOutHandler;node.d2l_onClickHandler=OnClickHandler;var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",
node);if(!isDisabled){D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,OnOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,OnOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,OnClickHandler)}D2L.LP.Web.UI.Events.OnClick.AddListener(function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(node,
eventTarget)&&!D2L.LP.Web.UI.Html.Dom.IsAncestor(contextMenu,eventTarget)){node.m_isClicked=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName(hoverClassName,node)}})},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(isEnabled){D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,node.d2l_onOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,node.d2l_onOverHandler);
D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,node.d2l_onClickHandler)}else{D2L.LP.Web.UI.Html.Dom.RemoveEventListener("mouseover",node,node.d2l_onOverHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("mouseout",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",node,node.d2l_onOverHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("blur",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("click",
node,node.d2l_onClickHandler)}},SetItemIsEnabled:function(id,key,isEnabled){var itemId=id.GetValue()+"_"+key;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId);var anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var contextMenuItemContext=D2L.LP.Web.UI.ObjectRepository.Get(itemId);var enabledCssIconClassName=contextMenuItemContext["enabledIconCss"];var disabledCssIconClassName=contextMenuItemContext["disabledIconCss"];if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-disabled",
node);D2L.LP.Web.UI.Html.Dom.AddClassName(enabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Dom.RemoveClassName(disabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Aria.RemoveAttribute(anchor,"disabled")}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-contextmenu-item-disabled",node);D2L.LP.Web.UI.Html.Dom.AddClassName(disabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Dom.RemoveClassName(enabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchor,"disabled","true")}},SetItemIsVisible:function(id,
key,isVisible){var itemId=id.GetValue()+"_"+key;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isVisible)}};D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened=[];D2L.LP.Web.UI.Desktop.Controls.ContextMenu.OnCloseEvents={};
D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem={ClickItemNode:function(node){var onClickFunc=null;var ret=true;var contextMenuItemContext=D2L.LP.Web.UI.ObjectRepository.Get(node.id);if(contextMenuItemContext["onClick"]!==undefined)onClickFunc=contextMenuItemContext["onClick"];var isEnabled=D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem.IsEnabledNode(node);if(onClickFunc!==null&&isEnabled){onClickFunc.call(this);ret=false}if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-hover",
node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-disabled-hover",node);D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Close(node.m_contextMenuId);D2L.LP.Web.UI.Html.Dom.FocusNode(D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetOpener(node.m_contextMenuId))}return ret},Initialize:function(node,contextMenuId){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem;var anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);anchor.tabIndex=-1;node.m_contextMenuId=contextMenuId;D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
anchor,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);return D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem.ClickItemNode(node)});var OnOverHandler=function(e){if(!me.IsEnabledNode(node))D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-contextmenu-item-disabled-hover",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-contextmenu-item-hover",node)};var OnOutHandler=function(e){if(!me.IsEnabledNode(node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-disabled-hover",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-hover",
node)};D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,OnOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchor,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",anchor,OnOutHandler);D2L.LP.Web.UI.Html.Aria.SetRole(node,"presentation");D2L.LP.Web.UI.Html.Aria.SetRole(anchor,"menuitem");if(!me.IsEnabledNode(node))D2L.LP.Web.UI.Html.Aria.SetAttribute(anchor,"disabled","true")},IsEnabledNode:function(node){return!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-contextmenu-item-disabled",
node)}};D2L.LP.Web.UI.Desktop.Controls.DataListItem={};
D2L.LP.Web.UI.Desktop.Controls.DataList={AdjustLastVisibleChild:function(node){var lastVisibleChild=null;var child=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);while(child!==null){var isHidden=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",child);if(!isHidden)lastVisibleChild=child;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-lastchild",child);child=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(child)}if(lastVisibleChild!==null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-lastchild",lastVisibleChild)},
AddItems:function(dataListId,itemId,placeholderId,provider,createPlaceholder){var evt=new D2L.LP.Web.UI.Events.Event;if(dataListId===null||placeholderId===null||provider===null){evt.Release();return evt}if(D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue())===null)createPlaceholder.call(createPlaceholder);var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());if(rc===null)if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),"0",placeholderId.GetValue(),"0")){evt.Release();
return evt}var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var providerRet=provider.call(provider);providerRet.AddReleaseListener(function(){evt.Release()});providerRet.AddListener(function(){var listNode=me.GetListNode(dataListId);me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);var newItemNodes=me.GetNewItemNodesByNode(listNode);me.SetIsNewItems(newItemNodes,false);me.GetOnLoadMoreCompletedEvent(dataListId).Trigger(me.GetHasMoreItems(dataListId),newItemNodes);D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),
"0");evt.Trigger()});return evt},AddItemsAfter:function(dataListId,itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(dataListId===null)dataListId=me.GetDataListIdByItemId(itemId);var listNode=me.GetListNode(dataListId);var evt=me.AddItems(dataListId,itemId,placeholderId,provider,function(){var itemNode;if(itemId!==null)itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());else itemNode=me.GetLastItemNode(dataListId);var placeholderNode=document.createElement("li");
placeholderNode.setAttribute("id",placeholderId.GetValue());placeholderNode.className="d2l-datalist-item-placeholder";if(itemNode!==null)D2L.LP.Web.UI.Html.Dom.InsertElementAfter(placeholderNode,itemNode);else{var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-placeholder-bottom",listNode);if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(placeholderNode,loadMorePlaceholderNode)}else listNode.appendChild(placeholderNode)}});
return evt},AddItemsBefore:function(dataListId,itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(dataListId===null)dataListId=me.GetDataListIdByItemId(itemId);var listNode=me.GetListNode(dataListId);var evt=me.AddItems(dataListId,itemId,placeholderId,provider,function(){var itemNode;if(itemId!==null)itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());else itemNode=me.GetFirstItemNode(dataListId,true);var placeholderNode=document.createElement("li");placeholderNode.setAttribute("id",
placeholderId.GetValue());placeholderNode.className="d2l-datalist-item-placeholder";if(itemNode!==null)itemNode.parentNode.insertBefore(placeholderNode,itemNode);else{var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-placeholder-bottom",listNode);if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(placeholderNode,loadMorePlaceholderNode)}else listNode.appendChild(placeholderNode)}});return evt},AddItemByNode:function(listNode,
itemNode){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-placeholder-bottom",listNode);var sourceList=itemNode.parentNode;if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(itemNode,loadMorePlaceholderNode)}else listNode.appendChild(itemNode);me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);if(sourceList!==listNode){var sourceListId=
new D2L.LP.Web.UI.Html.AbsoluteHtmlId(sourceList.parentNode.getAttribute("id"));me.AdjustLastVisibleChild(sourceList);if(!me.GetHasVisibleItem(sourceListId))me.SetIsEmptyTextVisible(sourceList,true)}},AddItemClassNames:function(node,className){if(node!==undefined&&className.length>0&&node.className.indexOf(className,0)==-1)node.className+=" "+className},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList},GetDataListIdByItemId:function(itemId){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());
return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.parentNode.parentNode.getAttribute("id"))},GetDataListPlaceholder:function(dataListRootNode){var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(dataListRootNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item-placeholder",itemNode))return itemNode;itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return null},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event;
events[id]=evt}return evt},GetFirstItemNode:function(id,includeHidden){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item",listNode);if(itemNode===null)return null;if(includeHidden)return itemNode;else if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",itemNode))return itemNode;return me.GetNextItemNode(itemNode,includeHidden)},GetHasMoreItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;
var listNode=me.GetListNode(id);var placeholderNode=me.GetDataListPlaceholder(listNode);if(placeholderNode===null)return false;if(D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderNode.getAttribute("id"),2))return true;return false},GetHasVisibleItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=me.GetFirstItemNode(id,false);return itemNode!==null},GetItemCount:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var count=0;var itemNode=me.GetFirstItemNode(id,false);
while(itemNode!==null){count+=1;itemNode=me.GetNextItemNode(itemNode,false)}return count},GetItemsNodes:function(id,className){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName(className,listNode)},GetLastItemNode:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var itemNode=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(listNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item",
itemNode))return itemNode;itemNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(itemNode)}return null},GetListNode:function(id){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},GetNewItemNodesByNode:function(listNode){var itemNodes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName("d2l-datalist-newitem",listNode);return itemNodes},GetNextItemNode:function(itemNode,includeHidden){itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);
while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item",itemNode))if(includeHidden)return itemNode;else if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",itemNode))return itemNode;itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return null},GetPage:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKey(dataListId))return;var onGetPage=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,
1);if(onGetPage===null)return;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId);var isReadOnly=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-readonly",node);me.GetOnPageEvent(id).Trigger();me.GetOnLoadEvent(id).Trigger();onGetPage.call(onGetPage).AddListener(function(){if(isReadOnly){var dlNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-readonly",dlNode)}me.TryFocusFirstItem(id);me.GetOnPageCompletedEvent(id).Trigger(me.GetItemsNodes(id,"d2l-datalist-item"))})},
GetOnLoadEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadEvents)},GetOnLoadCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadCompletedEvents)},GetOnLoadMoreCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadMoreCompletedEvents)},GetOnPageEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),
me.OnPageEvents)},GetOnPageCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnPageCompletedEvents)},GetOnRemoveItemEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnRemoveItemEvents)},HighlightItem:function(itemId){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataList.HighlightItemByNode(itemNode)},HighlightItemByNode:function(itemNode){if(!itemNode)return;
D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-highlight-transition-color",itemNode);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-highlight-transition",itemNode);if(D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition())D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-highlight-transition-color",itemNode);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-highlight-transition",itemNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-highlight-transition-color",
itemNode)},1500)},0)},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var placeholderNode=me.GetDataListPlaceholder(listNode);if(placeholderNode===null)return;var placeholderId=placeholderNode.getAttribute("id");var onLoadMore;if(D2L.LP.Web.UI.ObjectRepository.HasKey(placeholderId)){onLoadMore=D2L.LP.Web.UI.ObjectRepository.Get(placeholderId,1);if(onLoadMore!==null){var nextItemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(placeholderNode);
var previousItemNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(placeholderNode);me.GetOnLoadEvent(id).Trigger();onLoadMore.call(onLoadMore).AddListener(function(){var itemNode;var itemNodes=[];if(previousItemNode===null)itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);else itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(previousItemNode);while(itemNode!==null&&itemNode!=nextItemNode){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item-placeholder",itemNode))itemNodes.push(itemNode);
itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}me.SetIsNewItems(itemNodes,false);if(itemNodes.length>0){var focusableElement=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(itemNodes[0]);if(focusableElement&&focusableElement.focus)focusableElement.focus()}me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);me.GetOnLoadMoreCompletedEvent(id).Trigger(me.GetHasMoreItems(id),itemNodes)})}}},MoveItemByNode:function(itemNode,moveToItemNode,isBefore){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;
var newList=moveToItemNode.parentNode;var sourceList=itemNode.parentNode;if(isBefore)newList.insertBefore(itemNode,moveToItemNode);else D2L.LP.Web.UI.Html.Dom.InsertElementAfter(itemNode,moveToItemNode);me.AdjustLastVisibleChild(newList);if(sourceList!==newList){var sourceListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(sourceList.parentNode.getAttribute("id"));me.AdjustLastVisibleChild(sourceList);if(!me.GetHasVisibleItem(sourceListId))me.SetIsEmptyTextVisible(sourceList,true)}},RemoveItem:function(itemId){if(itemId===
null)return;var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());me.RemoveItemByNode(itemNode)},RemoveItemByNode:function(itemNode){if(itemNode===null)return;var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=itemNode.parentNode;var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(listNode.parentNode.getAttribute("id"));listNode.removeChild(itemNode);if(!me.GetHasVisibleItem(dataListId))me.SetIsEmptyTextVisible(listNode,true);
me.AdjustLastVisibleChild(listNode);me.GetOnRemoveItemEvent(dataListId).Trigger(itemNode)},ReplaceItem:function(itemId,placeholderId,provider){if(placeholderId===null||provider===null)return;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode===null)return;itemNode.setAttribute("id",placeholderId.GetValue());var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.parentNode.parentNode.getAttribute("id"));var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());
if(rc===null)if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),"0",placeholderId.GetValue(),"0"))return;var me=D2L.LP.Web.UI.Desktop.Controls.DataList;provider.call(provider).AddListener(function(){var listNode=me.GetListNode(dataListId);me.AdjustLastVisibleChild(listNode);me.GetOnLoadMoreCompletedEvent(dataListId).Trigger(me.GetHasMoreItems(dataListId));D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),"0")})},ReplaceItemContent:function(itemId,placeholderId,provider){var me=
D2L.LP.Web.UI.Desktop.Controls.DataList;if(placeholderId===null||provider===null)return;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode===null)return;var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-content",itemNode);contentNode.setAttribute("id",placeholderId.GetValue());D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-placeholder-inner",contentNode);var dataListId=me.GetDataListIdByItemId(itemId);var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());
if(rc===null)if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),"0",placeholderId.GetValue(),"0"))return;provider.call(provider).AddListener(function(){D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),"0")})},RemoveItemClassNames:function(node,className){if(node!==undefined&&className.length>0)node.className=node.className.replace(" "+className,"")},ScrollToFirstItem:function(dataListId){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=me.GetFirstItemNode(dataListId,
false);if(!itemNode)return;var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisibleInContainer(itemNode);if(isVisible)return;D2L.LP.Web.UI.Html.Dom.ScrollToElement(itemNode,0,false)},SetIsEmptyTextVisible:function(listNode,isVisible){var emptyTextNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(listNode);if(isVisible){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",listNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",emptyTextNode)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",emptyTextNode);
D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",listNode)}},SetItemIsVisible:function(id,isVisible){var item=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(item,isVisible);D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(item.parentNode)},SetIsNewItems:function(itemNodes,isNew){if(isNew)for(var i=0;i<itemNodes.length;i++)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-newitem",itemNodes[i]);else for(var j=0;j<itemNodes.length;j++)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-newitem",
itemNodes[j])},TryFocusFirstItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var firstItemNode=me.GetFirstItemNode(id);if(!firstItemNode)return false;var focusableElements=$(firstItemNode).find(":focusable");if(!focusableElements||focusableElements.length===0)return false;focusableElements[0].focus();return true},TryGetSelectionUpdatedEvent:function(id){var summaryNode=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary.GetSummaryNode(id);if(summaryNode===null)return null;var e=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary.GetSelectionUpdatedEvent(id);
return e},OnLoadEvents:{},OnLoadCompletedEvents:{},OnLoadMoreCompletedEvents:{},OnPageEvents:{},OnPageCompletedEvents:{},OnRemoveItemEvents:{},CaptureOnClickRules:{"A":true,"BUTTON":true,"INPUT":true,"LABEL":true,"SELECT":true,"TEXTAREA":true}};
D2L.LP.Web.UI.Desktop.Controls.DataList.SimpleItems={SetIsSelected:function(itemId,isSelected){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode==null)return;if(isSelected)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-selected",itemNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-selected",itemNode)}};
D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder={Init:function(startId,endId,autoShiftTimes){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var startNodes=ts.GetNodes(startId);var endNodes=ts.GetNodes(endId);startNodes.container.d2l_onChange.AddListener(function(time,prevTime){me.OnStartChange(startNodes,endNodes,time,prevTime,true,autoShiftTimes)});endNodes.container.d2l_onChange.AddListener(function(){me.RenderValidation(startNodes,endNodes,
true)})},OnStartChange:function(startNodes,endNodes,time,prevTime,isSameDay,autoShiftTimes){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var endTime=ts.GetTimeNodes(endNodes);var wasValid=me.Validate(prevTime,endTime);if(isSameDay&&wasValid&&autoShiftTimes){var hourDiff=time.GetHour()-prevTime.GetHour();var minuteDiff=time.GetMinute()-prevTime.GetMinute();var newEndHour=endTime.GetHour()+hourDiff;var newEndMinute=endTime.GetMinute()+minuteDiff;
if(newEndMinute>59){newEndHour++;newEndMinute-=60}else if(newEndMinute<0){newEndHour--;newEndMinute+=60}if(newEndHour>23){newEndHour=23;newEndMinute=59}else if(newEndHour<0){newEndHour=0;newEndMinute=0}ts.SetTimeNodes(endNodes,new D2L.LocalTime(newEndHour,newEndMinute,0))}me.RenderValidation(startNodes,endNodes,isSameDay)},RenderValidation:function(startNodes,endNodes,isSameDay){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(endNodes.edit);var isValid=
me.ValidateNodes(startNodes,endNodes);if(!isSameDay||isValid){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-time-selector-invalid",endNodes.edit);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-time-selector-invalid",startNodes.edit)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-time-selector-invalid",endNodes.edit);if(!isVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-time-selector-invalid",startNodes.edit)}},ValidateIds:function(startId,endId){var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;return D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder.ValidateNodes(ts.GetNodes(startId),
ts.GetNodes(endId))},ValidateNodes:function(startNodes,endNodes){var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var startIsEnabled=ts.IsEnabledNodes(startNodes);var endIsEnabled=ts.IsEnabledNodes(endNodes);if(!startIsEnabled||!endIsEnabled)return true;var startTime=ts.GetTimeNodes(startNodes);var endTime=ts.GetTimeNodes(endNodes);return D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder.Validate(startTime,endTime)},Validate:function(startTime,endTime){if(startTime.GetHour()===endTime.GetHour())return startTime.GetMinute()<
endTime.GetMinute();return startTime.GetHour()<endTime.GetHour()}};
D2L.LP.Web.UI.Desktop.Controls.TimeSelector={IntervalEnum:{Five:5,Ten:10,Fifteen:15,Twenty:20,Thirty:30,Sixty:60},BuildSelectList:function(nodes,timeInterval){if(timeInterval===null||timeInterval==undefined||timeInterval<5||timeInterval>60)timeInterval=30;var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;if(nodes.list===null){nodes.list=document.createElement("ul");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.list,"role","listbox");nodes.list.className="d2l-time-selector-list";nodes.floatingContainer.appendChild(nodes.list)}while(nodes.list.childNodes.length>
0)nodes.list.removeChild(nodes.list.firstChild);var locale=D2L.LP.Globalization.Locale;var dateTimeFormatter=locale.GetDateTimeFormatter();var hour=0;var minute=0;while(hour<24){var time=new D2L.LocalTime(hour,minute,0);var timeStr=dateTimeFormatter.FormatTime(time);var item=document.createElement("li");D2L.LP.Web.UI.Html.Dom.SetAttribute(item,"role","option");var id=new D2L.LP.Web.UI.Html.UniqueHtmlId;item.id=id.GetValue();item.d2l_time=time;item.d2l_index=nodes.list.childNodes.length;item.appendChild(document.createTextNode(timeStr));
nodes.list.appendChild(item);minute+=timeInterval;if(minute>=60){++hour;minute-=60}}},GetNodes:function(id){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"TimeSelector not found: '"+idVal+"'.";return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodesByNode(node)},GetNodesByNode:function(node){var container=node.parentNode;var hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-form-balloon",hour))hour=
D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var minute=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(minute);var floatingContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(isEnabled);var list=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-time-selector-list",floatingContainer);return{container:container,floatingContainer:floatingContainer,hour:hour,minute:minute,isEnabled:isEnabled,edit:node,list:list}},GetTime:function(id){var nodes=
D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(id);return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes)},GetTimeNodes:function(nodes){var hour=parseInt(nodes.hour.value);var minute=parseInt(nodes.minute.value);var result=new D2L.LocalTime(hour,minute,0);return result},IsEnabledNodes:function(nodes){return!nodes.edit.disabled},SetEnforceTimeIntervals:function(id,isEnforced){id.$().data("enforcetimeintervals",isEnforced)},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;
me.SetIsEnabledNodes(me.GetNodes(id),isEnabled)},SetIsEnabledNodes:function(nodes,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;nodes.isEnabled.value=isEnabled?"1":"0";nodes.edit.disabled=!isEnabled;var time=me.GetTimeNodes(nodes);nodes.container.d2l_onChange.Trigger(time,time)},SetIsVisible:function(id,isVisible){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;me.SetIsVisibleNode(me.GetNodes(id).container,isVisible)},SetIsVisibleNode:function(node,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,
isVisible)},SetTime:function(id,time){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var nodes=me.GetNodes(id);me.SetTimeNodes(nodes,time)},SetTimeInterval:function(id,interval){interval=parseInt(interval);if(isNaN(interval))interval=30;var intervalEnum=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.IntervalEnum;for(var timeInterval in intervalEnum){var timeValue=intervalEnum[timeInterval];if(interval<=timeValue){interval=timeValue;break}}if(interval>intervalEnum.Sixty)interval=60;id.$().data("timeinterval",
interval)},SetTimeNodes:function(nodes,time,useInputTime){var prevTime=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes);var locale=D2L.LP.Globalization.Locale;var dateTimeFormatter=locale.GetDateTimeFormatter();if(useInputTime){var dateTimeParser=locale.GetDateTimeParser();var inputtedTime=dateTimeParser.TryParseTime(nodes.edit.value);time=new D2L.LocalTime(inputtedTime.GetHour(),inputtedTime.GetMinute(),inputtedTime.GetSecond())}var timeStr=dateTimeFormatter.FormatTime(time);nodes.edit.value=
timeStr;nodes.hour.value=time.GetHour();nodes.minute.value=time.GetMinute();nodes.container.d2l_onChange.Trigger(time,prevTime)}};
D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector={IsEnabledNodes:function(nodes){return!nodes.edit.disabled},SetHasTime:function(id,hasTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetIsVisibleNode(nodes.timeNodes.container,hasTime);nodes.hasTime.value=hasTime?"1":"0"},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);me.SetIsEnabledNodes(nodes,isEnabled)},
GetIsEnabled:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);return me.IsEnabledNodes(nodes)},SetIsEnabledNodes:function(nodes,isEnabled){nodes.isEnabled.value=isEnabled?"1":"0";nodes.edit.disabled=!isEnabled;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(nodes.calendarLink,isEnabled);D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetIsEnabledNodes(nodes.timeNodes,isEnabled);var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var dateTime=me.GetSelectedDateTimeNodes(nodes);
nodes.container.d2l_onChange.Trigger(dateTime,dateTime)},SetSelectedDateTime:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);me.SetSelectedDateTimeByNode(nodes,selectedDateTime)},SetSelectedDateTimeByNode:function(nodes,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var prevDateTime=me.GetSelectedDateTimeNodes(nodes);var formatter=D2L.LP.Globalization.Locale.GetDateTimeFormatter();nodes.edit.value=formatter.FormatInputDate(selectedDateTime);
nodes.edit.d2l_lastGoodDate=selectedDateTime;nodes.year.value=selectedDateTime.GetYear();nodes.month.value=selectedDateTime.GetMonth();nodes.day.value=selectedDateTime.GetDay();var time=new D2L.LocalTime(selectedDateTime.GetHour(),selectedDateTime.GetMinute());D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetTimeNodes(nodes.timeNodes,time);setTimeout(function(){var miniCalPartialRenderFunction=D2L.LP.Web.UI.ObjectRepository.Get(nodes.edit.id,"CalPartial");me.RefreshMiniCalendar(miniCalPartialRenderFunction)});
nodes.container.d2l_onChange.Trigger(selectedDateTime,prevDateTime)},SetSelectedDateByInputNodeId:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);var dateTime=me.GetSelectedDateTimeNodes(nodes);selectedDateTime=new D2L.LocalDateTime(selectedDateTime.GetYear(),selectedDateTime.GetMonth(),selectedDateTime.GetDay(),dateTime.GetHour(),dateTime.GetMinute(),0);me.SetSelectedDateTimeByNode(nodes,selectedDateTime)},GetSelectedDateTime:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);return me.GetSelectedDateTimeNodes(nodes)},GetSelectedDateTimeNodes:function(nodes){var year=parseInt(nodes.year.value);var month=parseInt(nodes.month.value);var day=parseInt(nodes.day.value);var time=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes.timeNodes);return new D2L.LocalDateTime(year,month,day,time.GetHour(),time.GetMinute(),time.GetSecond())},GetNodes:function(id,phid){var idVal=id.GetValue();var edit=
D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(edit===null)throw"DateTimeSelector not found:'"+idVal+"'.";var container=edit.parentNode.parentNode;var timeContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-time-selector",container);var timeEdit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(timeContainer);var timeNodes=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(timeEdit.id));var hiddens=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datetime-selector-hiddens",
container);var calendarLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datetime-selector-calendar-link",container);var floatingContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-floating-container",container);var placeholderContainer;if(phid==undefined||phid==null)placeholderContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-placeholder",floatingContainer);else{placeholderContainer=D2L.LP.Web.UI.Html.Dom.GetElementById(phid);floatingContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-floating-container",
placeholderContainer)}var miniCalendar;if(placeholderContainer==null||placeholderContainer==undefined)miniCalendar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini",floatingContainer);else miniCalendar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini",placeholderContainer);var year=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddens);var month=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(year);var day=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(month);var hasTime=
D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(day);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hasTime);return{container:container,edit:edit,timeNodes:timeNodes,year:year,month:month,day:day,hasTime:hasTime,isEnabled:isEnabled,calendarLink:calendarLink,floatingContainer:floatingContainer,miniCalendar:miniCalendar}},OpenMiniCalendar:function(floatingContainerId,dateInputId,openerId,focus,focusOnOpenTargetId){if(!D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)){var openerNode=
D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,{AttachToBody:false,AutoCloseExclusions:[openerNode],FocusOnOpen:focus,FocusOnOpenTargetControlId:focusOnOpenTargetId,Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TargetId:dateInputId})}},RefreshMiniCalendar:function(partialRenderFunction){partialRenderFunction.call(partialRenderFunction)},GetHasTimeNodes:function(nodes){var hasTime=nodes.hasTime.value==
"1";return hasTime},ValidateRange:function(id,ignoreTime,earliest,latest){var selectedDate=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTime(id);if(earliest!==null&&latest!==null){var isEarly=D2L.LocalDateTime.Compare(selectedDate,earliest,ignoreTime)<0;var isLate=D2L.LocalDateTime.Compare(selectedDate,latest,ignoreTime)>0;return!isEarly&&!isLate}else if(earliest!==null)return D2L.LocalDateTime.Compare(selectedDate,earliest,ignoreTime)>=0;else return D2L.LocalDateTime.Compare(selectedDate,
latest,ignoreTime)<=0}};
D2L.LP.Web.UI.Desktop.Controls.EditInPlace={Click:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ClickHelper(node,false)},ClickHelper:function(node,autoResize){var id=node.id;$("#"+id).parent().attr("data-isOpen","true");var targetId=D2L.LP.Web.UI.ObjectRepository.TryGet(id);if(targetId==null)return;var targetIdValue=targetId.GetValue();var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetIdValue);target.d2l_opener=node;if(autoResize){var rect=
D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);target.style.width=Math.max(rect.width,100)+"px";target.style.minHeight=rect.height+"px"}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(target,true);if(D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdValue,"edit")){var onEdit=D2L.LP.Web.UI.ObjectRepository.Get(targetIdValue,"edit");onEdit()}},Finish:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target)},
FinishHelper:function(target,doTrigger,isEmpty){var targetIdVal=target.id;var opener=target.d2l_opener;var anchor=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(opener);target.d2l_opener=null;if(isEmpty!==undefined)D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetIsEmptyHelper(opener,isEmpty);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(opener,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(target,false);if(doTrigger){var hasFinish=D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdVal,"finish");if(hasFinish){var onFinish=
D2L.LP.Web.UI.ObjectRepository.Get(targetIdVal,"finish");var ret=onFinish();ret.AddListener(function(){var editable=$(target).prev()[0];D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ModifyAnchors(editable)})}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-editable-changed",opener)}else{var hasAbort=D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdVal,"abort");if(hasAbort){var onAbort=D2L.LP.Web.UI.ObjectRepository.Get(targetIdVal,"abort");onAbort()}}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.FocusNode(anchor)},
0);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-editable-changed",opener)},1500)},GetHtmlEditorContent:function(id){var htmlEditorId=$("#"+id.GetValue()).attr("data-d2l-htmleditorid");var htmlParam=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(htmlEditorId));return htmlParam},IsEditorOpen:function(id){return $("#"+id.GetValue()).attr("data-isOpen")},ModifyAnchors:function(node){$(node).find("a").attr("target","_blank")},SetIsEmpty:function(id,
isEmpty){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetIsEmptyHelper(node,isEmpty)},SetIsEmptyHelper:function(node,isEmpty){var empty=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-editable-empty",node);if(empty!==null)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(empty,isEmpty);var container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-editable-content",node);if(container!==null)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(container,
!isEmpty)}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.Edit={Clear:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-edit",target);D2L.LP.Web.UI.Common.Controls.Edit.ClearValueNode(edit)},OnEdit:function(id){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());edit.d2l_value=edit.value;edit.select()}};
D2L.LP.Web.UI.Desktop.Controls.EditInPlace.EditUrl={OnEdit:function(id){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());edit.d2l_value=edit.value;if(edit.value=="")edit.value="http://";edit.select()}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.LongEdit={Clear:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-longedit",target);D2L.LP.Web.UI.Common.Controls.LongEdit.ClearValueNode(edit)}};
D2L.LP.Web.UI.Desktop.Controls.EditInPlace.HtmlEditor={Cancel:function(editorId,targetId){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId.GetValue());D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetHtml(editorId,target.d2l_html);D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target)},GetHtml:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(target.d2l_html!==undefined)return target.d2l_html;else return""},GetEditorLoadedEvent:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);
var targetId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-targetId");var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId);return target.d2l_editorLoadedEvt},OnEdit:function(id,editorId,html){var targetId=id.GetValue();var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId);if(target.d2l_initialized==true)D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(editorId);else{if(target.d2l_html===undefined)target.d2l_html=html;var evt=target.d2l_editorLoadedEvt;var initializeEditor=D2L.LP.Web.UI.ObjectRepository.TryGet(targetId,
"initializeEditor");if(initializeEditor!=null){initializeEditor.call(initializeEditor).AddListener(function(){evt.Trigger(editorId);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(editorId)});target.d2l_initialized=true}}},Update:function(id,param){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var hasChanged=false;var newHtml=param.GetHtml();if(target.d2l_html!=newHtml){target.d2l_html=newHtml;hasChanged=true}var isEmpty=newHtml==null||newHtml.length==0;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target,
hasChanged,isEmpty)}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileinput",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var id=node.getAttribute("id");var fileInputId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var isMultiple=node.getAttribute("data-d2l-ismultiple")=="true";node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,node.d2l_changeEvent,function(){var ret="";var files=me.GetParam(fileInputId).GetFiles();for(var i=0;i<
files.length;i++)ret+=files[i].GetActionType()+files[i].GetPluginKey()+files[i].GetId();return ret});me.SetAddFileVisibility(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileinput-upload-progress",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"progressbar");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuemin","0");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuemax","100");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuenow","0")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-fileinput");
D2L.LP.Web.UI.Desktop.Controls.FileInput={AddFiles:function(id,files){var evt=new D2L.LP.Web.UI.Events.Event;var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var placeholderNode=me.GetFilePlaceholder(node);var listNode=me.GetFileListNode(node);if(placeholderNode==null){evt.Release();return evt}var placeholderId=placeholderNode.getAttribute("id");var onAddFile=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,1);if(onAddFile==null){evt.Release();
return evt}node.d2l_addFiles=files;onAddFile.call(onAddFile).AddListener(function(){node.d2l_lastAddedFiles=node.d2l_addFiles;var onAddFilesComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute("id"),"OnAddFilesComplete");if(onAddFilesComplete!==null)onAddFilesComplete.call(onAddFilesComplete);node.d2l_addFiles=undefined;me.SetAddFileVisibility(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",listNode);node.d2l_changeEvent.Trigger();evt.Trigger()});return evt},Clear:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var listNode=me.GetFileListNode(node);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-fileinput-placeholder",itemNode))me.RemoveFile(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.getAttribute("id")));itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}me.SetErrorMessageVisibility(node,"d2l-fileinput-filecount-error",
false);me.SetErrorMessageVisibility(node,"d2l-fileinput-filetype-error",false);me.SetErrorMessageVisibility(node,"d2l-fileinput-filesize-error",false);me.SetErrorMessageVisibility(node,"d2l-fileinput-fileupload-error",false)},GetAbortLinkNodeByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(progressBarNode);return abortLinkNode},GetAddButtonsNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-addbuttons",
node)},GetAddFilesByPlaceholderId:function(placeholderId){var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-fileinput",placeholderNode);if(node.d2l_addFiles!==undefined)return node.d2l_addFiles;else return[]},GetFileCount:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var fileCount=0;var listNode=me.GetFileListNode(node);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);
while(itemNode!=null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",itemNode)&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-fileinput-placeholder",itemNode))fileCount++;itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return fileCount},GetFileListNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-filelist",node)},GetFilePlaceholder:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-placeholder",node)},
GetFiles:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var listNode=me.GetFileListNode(node);var files=[];var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){var fileName=itemNode.getAttribute("data-d2l-name");var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);var pluginKeyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var idNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pluginKeyNode);
var fileSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(idNode);files.push(new D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam(fileName,actionTypeNode.value,pluginKeyNode.value,idNode.value,fileSizeNode.value));itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return files},GetLastAddedFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_lastAddedFiles;if(node.d2l_lastAddedFiles===undefined&&node.d2l_lastAddedFiles===null)files=
[];return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(files)},GetParam:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var files=me.GetFiles(id);return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(files)},GetProgressBarNodeByNode:function(node){var progressBarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-upload-progress",node);return progressBarNode},GetRemovedFile:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var removedFile=
[];removedFile.push(node.d2l_removedFile);return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(removedFile)},GetUploadButtonId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var buttons=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetAddButtonsNode(node);var uploadButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(buttons);return uploadButton.id},HideErrorMessages:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;me.HideErrorMessagesByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},
HideErrorMessagesByNode:function(node){var errorsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-errors",node);var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(errorsNode);while(errorNode!=null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",errorNode);errorNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(errorNode)}},OnDropAbort:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.ResetUploadByNode(node)},
OnDropError:function(id,errorNumber){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.ResetUploadByNode(node);if(errorNumber===1)me.SetErrorMessageVisibility(node,"d2l-fileinput-filecount-error",true);else if(errorNumber===2)me.SetErrorMessageVisibility(node,"d2l-fileinput-filetype-error",true);else if(errorNumber===3)me.SetErrorMessageVisibility(node,"d2l-fileinput-filesize-error",true);else if(errorNumber===6)me.SetErrorMessageVisibility(node,
"d2l-fileinput-filenamelength-error",true);else me.SetErrorMessageVisibility(node,"d2l-fileinput-fileupload-error",true)},OnDropFilesComplete:function(id,files){var evt=null;var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(files!=null&&files.length>0){var fileInputFiles=[];for(var i=0;i<files.length;i++)fileInputFiles.push(new D2L.LP.Web.UI.Files.File(files[i].GetId(),files[i].GetFileSystemType(),files[i].GetName(),files[i].GetSize()));
evt=me.AddFiles(id,fileInputFiles)}me.UpdateProgressBarByNode(node.getAttribute("data-d2l-msg-uploadcomplete"),100,me.GetProgressBarNodeByNode(node));me.ResetUploadByNode(node);return evt},OnDropProgress:function(id,progress){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.UpdateProgressBarByNode(progress.GetFileName(),progress.GetTotalPercent(),progressBarNode)},OnDropStarted:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=me.GetAbortLinkNodeByNode(node);node.d2l_isUploading=true;me.HideErrorMessagesByNode(node);me.SetAddFileEnabled(node);me.UpdateProgressBarByNode("",0,progressBarNode);setTimeout(function(){if(node.d2l_isUploading){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",progressBarNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",abortLinkNode)}},500)},RemoveFile:function(itemId){var me=
D2L.LP.Web.UI.Desktop.Controls.FileInput;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());var listNode=itemNode.parentNode;var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);if(actionTypeNode.value==="None")actionTypeNode.value="Remove";else if(actionTypeNode.value==="Add")actionTypeNode.value="AddRemove";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",itemNode);var node=listNode.parentNode;me.SetAddFileVisibility(node);var count=me.GetFileCount(node);if(count===
0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",listNode);var fileName=itemNode.getAttribute("data-d2l-name");var pluginKeyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var idNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pluginKeyNode);var fileSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(idNode);node.d2l_removedFile=new D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam(fileName,actionTypeNode.value,pluginKeyNode.value,idNode.value,fileSizeNode.value);var onRemoveFile=
D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute("id"),"OnRemoveFile");if(onRemoveFile!==null)onRemoveFile.call(onRemoveFile);node.d2l_changeEvent.Trigger()},ResetUploadByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=me.GetAbortLinkNodeByNode(node);node.d2l_isUploading=false;me.SetAddFileEnabled(node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",abortLinkNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",
progressBarNode)},SetAddFileEnabled:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var isEnabled=node.d2l_isAddFileAllowed&&!node.d2l_isUploading;var addButtonsContainer=me.GetAddButtonsNode(node);var addButtonNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("vui-button",addButtonsContainer);for(var i=0;i<addButtonNodes.length;i++)D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(addButtonNodes[i].getAttribute("id")),isEnabled);var browseNode=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filebrowse-label",addButtonsContainer);if(browseNode!=null)D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default.SetIsBrowseLabelEnabled(browseNode,isEnabled)},SetAddFileVisibility:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;node.d2l_isAddFileAllowed=false;if(node.getAttribute("data-d2l-ismultiple")=="true")node.d2l_isAddFileAllowed=true;else node.d2l_isAddFileAllowed=me.GetFileCount(node)==0;var isAddDisplayed=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-fileinput-add",
node);if(node.d2l_isAddFileAllowed==isAddDisplayed)return;D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default.SetIsEnabledByNode(node,node.d2l_isAddFileAllowed);if(node.d2l_isAddFileAllowed)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-fileinput-add",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-fileinput-add",node)},SetErrorMessageVisibility:function(node,className,isVisible){var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(className,node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(errorNode,
isVisible)},UpdateProgressBarByNode:function(text,percent,node){var progressBarTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-upload-progress-bar",node));var progressBarColourNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(progressBarTextNode);var isPercent=!isNaN(percent);if(isPercent)progressBarTextNode.innerHTML=text+" "+percent.toString()+"%";else progressBarTextNode.innerHTML=text+" - Uploading";if(percent==0||!isPercent){progressBarColourNode.style.width=
"0px";progressBarColourNode.style.backgroundColor="transparent"}else{if(progressBarColourNode.parentNode.clientWidth==0)progressBarColourNode.style.width="100%";else progressBarColourNode.style.width=progressBarColourNode.parentNode.clientWidth*percent/100-8+"px";if(progressBarColourNode.style.backgroundColor=="transparent")progressBarColourNode.style.backgroundColor=""}if(isPercent)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuenow",percent.toString())},ValidateRequired:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return me.GetFileCount(node)>0},ValidateUploadInProgress:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_isUploading===undefined||node.d2l_isUploading===false}};
D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam=D2L.Class.Create({Construct:function(fileName,actionType,pluginKey,id,fileSize){if(actionType===undefined)actionType="";if(pluginKey===undefined)pluginKey="";if(id===undefined)id="";if(fileSize===undefined)fileSize="";this.m_fileName=fileName;this.m_actionType=actionType;this.m_pluginKey=pluginKey;this.m_id=id;this.m_fileSize=fileSize},_serialize:function(serializer){serializer.AddMember("actionType",this.m_actionType);serializer.AddMember("pluginKey",
this.m_pluginKey);serializer.AddMember("id",this.m_id)},GetActionType:function(){return this.m_actionType},GetPluginKey:function(){return this.m_pluginKey},GetId:function(){return this.m_id},GetFileName:function(){return this.m_fileName},GetFileSize:function(){return this.m_fileSize}});
D2L.LP.Web.UI.Desktop.Controls.FileInput.Param=D2L.Class.Create({Construct:function(files){if(files===undefined)files=[];this.m_files=files},_serialize:function(serializer){serializer.AddMember("files",this.m_files)},GetFiles:function(){return this.m_files}});
D2L.LP.Web.UI.Desktop.Controls.FileInput.LegacyAddFile={AddFile:function(fileInputId,openFunction){openFunction.call(openFunction).AddListener(function(files){if(files==null||files.length==0)return;var fileInputFiles=[];for(var i=0;i<files.length;i++)fileInputFiles.push(new D2L.LP.Web.UI.Files.File(files[i].FileId,files[i].FileSystemType,files[i].FileName,files[i].Size));D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(fileInputId,fileInputFiles)})}};
D2L.LP.Web.UI.Desktop.Controls.FileInput.RecordAudioFile={SaveAudio:function(id,openFunction){openFunction.call(openFunction).AddListener(function(files){D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(id,files)})}};
D2L.LP.Web.UI.Desktop.Controls.FileInput.RecordVideoFile={AddFile:function(fileInputId,openFunction){openFunction.call(openFunction).AddListener(function(file){if(file==null||file.length==0)return;var fileInputFile=new D2L.LP.Web.UI.Files.File(file.FileId,file.FileSystemType,file.FileName,file.Size);D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(fileInputId,fileInputFile)})}};
D2L.LP.Web.UI.Desktop.Controls.FloatingContainer={Open:function(id,openerId,openSettings){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(elem,openerId,openSettings)},OpenNode:function(elem,openerId,openSettings){var me=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-floating-container-autoclose",elem)){if(elem.onFocusHandler===undefined)elem.onFocusHandler=function(evt){var activeNode=
D2L.LP.Web.UI.Html.Dom.GetActiveElement();var isFrameOrBody=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-dialog-frame",activeNode)||D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-body",activeNode);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(elem,activeNode)&&!isFrameOrBody)me.CloseNode(elem,true)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",document.body,elem.onFocusHandler,true)}openSettings=me.NormalizeOpenSettings(openSettings);var openerElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(openerElem===
null)throw"FloatingContainer opener not found: '"+openerId.GetValue()+"'.";var targetElem=openerElem;if(openSettings.TargetId!=null)targetElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openSettings.TargetId.GetValue());elem.m_previousParent=elem.parentNode;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(elem,true);D2L.LP.Web.UI.Html.Dom.OverlayElement(elem,targetElem,openerElem,openSettings.Position,openSettings.VerticalOffset,openSettings.HorizontalOffset,openSettings.IsAutoPosition,openSettings.IsAutoScroll,
D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-floating-container-attach-to-body",elem)||openSettings.AttachToBody);elem.style.zIndex=1E3;elem.m_openerId=openerId.GetValue();elem.m_isOpen=true;elem.tabIndex=openSettings.TabIndex;elem.m_openSettings=openSettings;elem.m_ignoreAutoHide=true;elem.m_autoCloseExclusions=openSettings.AutoCloseExclusions;setTimeout(function(){elem.m_ignoreAutoHide=false},0);if(openSettings.FocusOnOpen)if(openSettings.FocusOnOpenTargetControlId!==null)try{var focusTargetNode=D2L.LP.Web.UI.Html.Dom.GetElementById(openSettings.FocusOnOpenTargetControlId.GetValue());
focusTargetNode.focus()}catch(e){}else me.Focus(elem)},NormalizeOpenSettings:function(settings){if(settings===undefined||settings===null)settings={};settings.TargetId=settings.TargetId||null;settings.Position=settings.Position||D2L.LP.Web.UI.Html.Style.OverlayPosition.Right;settings.VerticalOffset=settings.VerticalOffset||0;settings.HorizontalOffset=settings.HorizontalOffset||0;settings.IsAutoScroll=settings.IsAutoScroll||false;settings.IsAutoPosition=settings.IsAutoPosition||true;settings.FocusOnOpen=
settings.FocusOnOpen||true;settings.FocusOnOpenTargetControlId=settings.FocusOnOpenTargetControlId||null;settings.TabIndex=settings.TabIndex||0;settings.AttachToBody=settings.AttachToBody||false;settings.AutoCloseExclusions=settings.AutoCloseExclusions||[];return settings},RefreshOpenNode:function(node){if(node.m_isOpen){var openSettings=node.m_openSettings;openSettings.FocusOnOpen=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(node,new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.m_openerId),
openSettings)}},Focus:function(node){var focusableElems={"a":true,"input":true,"select":true,"textarea":true,"button":true};var allNodes=node.all?node.all:node.getElementsByTagName("*");for(var i=0;i<allNodes.length;i++){var cNode=allNodes[i];if(focusableElems[cNode.tagName.toLowerCase()]&&D2L.LP.Web.UI.Html.Css.GetStyle(cNode,"display")!=="none"&&!(cNode.type=="hidden"||cNode.disabled===true)&&cNode.className.indexOf("d2l-floating-container-close")<0){try{cNode.focus()}catch(e){}break}}},Close:function(id,
ignoreFocus){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(elem,ignoreFocus)},CloseNode:function(elem,ignoreFocus){if(!elem.m_isOpen)return;if(elem.d2l_onClose===undefined)elem.d2l_onClose=D2L.LP.Web.UI.ObjectRepository.TryGet(elem.getAttribute("id"),"onClose");if(elem.d2l_onClose!==null)elem.d2l_onClose.call(elem.d2l_onClose);if(elem.onFocusHandler!==undefined)D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",document.body,
elem.onFocusHandler,true);if(ignoreFocus===undefined)ignoreFocus=false;var openerId=elem.m_openerId;var openerElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(elem,false);if(openerElem&&openerElem.focus&&!ignoreFocus)try{openerElem.focus()}catch(e){}elem.m_isOpen=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.MoveToOriginalParent(elem)},MoveToOriginalParent:function(elem){if(elem.m_previousParent)elem.m_previousParent.appendChild(elem)},IsOpen:function(id){var elem=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(elem)},IsOpenNode:function(elem){if(elem.m_isOpen===undefined)return false;return elem.m_isOpen},Toggle:function(id,openerId,openSettings){if(D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(id))D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(id);else D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(id,openerId,openSettings)},Init:function(){var me=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer;
var dom=D2L.LP.Web.UI.Html.Dom;if(me.m_initialized)return;me.m_initialized=true;D2L.LP.Web.UI.Events.OnClick.AddListener(function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var autoCloseContainers=dom.GetElementsByClassName("d2l-floating-container-autoclose");for(var i=0;i<autoCloseContainers.length;i++){var container=autoCloseContainers[i];if(container.m_isOpen&&!container.m_ignoreAutoHide){var exclusions=container.m_autoCloseExclusions||[];var ancestor=dom.IsAncestor(container,
eventTarget);if(!ancestor)for(var j=0;j<exclusions.length;j++)if(exclusions[j]==eventTarget||dom.IsAncestor(exclusions[j],eventTarget)){ancestor=true;break}if(!ancestor)me.CloseNode(container,true)}}});var floatingContainerNodesInsidePartial={};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.AddListener(function(form){var floatingContainerNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-floating-container",form);for(var i=0;i<floatingContainerNodes.length;i++){var fcNode=floatingContainerNodes[i];
if(me.IsOpenNode(fcNode))me.MoveToOriginalParent(fcNode)}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore.AddListener(function(placeholderId){var placeholder=dom.GetElementById(placeholderId.GetValue());floatingContainerNodesInsidePartial[placeholderId.GetValue()]=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-floating-container",placeholder);for(var i=0;i<floatingContainerNodesInsidePartial[placeholderId.GetValue()].length;i++){var fcNode=floatingContainerNodesInsidePartial[placeholderId.GetValue()][i];
if(me.IsOpenNode(fcNode))me.MoveToOriginalParent(fcNode)}});D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(function(placeholderId){for(var i=0;floatingContainerNodesInsidePartial[placeholderId.GetValue()]!==undefined&&i<floatingContainerNodesInsidePartial[placeholderId.GetValue()].length;i++){var fcNode=floatingContainerNodesInsidePartial[placeholderId.GetValue()][i];if(me.IsOpenNode(fcNode))try{me.RefreshOpenNode(fcNode)}catch(e){}}})}};
D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.m_mouseEvent=null;
D2L.LP.Web.UI.Common.Controls.Form.Validate=function(balloonContainer,validators,showErrors){if(showErrors===undefined)showErrors=true;var ret=new D2L.LP.Web.UI.Events.Event;var errors=[];var handleResult=function(result,index,validator){var isError=result===undefined||result===null||result===false;if(isError)errors.push(validator);if(result.AddListener!==undefined)result.AddListener(function(r){handleResult(r,index,validator)});else validate(++index)};var validate=function(index){if(index==validators.length){if(errors.length>
0&&showErrors)D2L.LP.Web.UI.Common.Controls.MessageArea.ShowErrors(errors);ret.Trigger(errors.length===0);return}var validator=validators[index];var result=validator.validation.apply(validator.validation);handleResult(result,index,validator)};D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(balloonContainer);setTimeout(function(){validate(0)},0);return ret};
(function(win){var whiteSpaceRe=/^\s*|\s*$/g,undef,isRegExpBroken="B".replace(/A(.)|B/,"$1")==="$1";var tinymce={majorVersion:"3",minorVersion:"5.6",releaseDate:"2012-07-26",_init:function(){var t=this,d=document,na=navigator,ua=na.userAgent,i,nl,n,base,p,v;t.isOpera=win.opera&&opera.buildNumber;t.isWebKit=/WebKit/.test(ua);t.isIE=!t.isWebKit&&!t.isOpera&&/MSIE/gi.test(ua)&&/Explorer/gi.test(na.appName);t.isIE6=t.isIE&&/MSIE [56]/.test(ua);t.isIE7=t.isIE&&/MSIE [7]/.test(ua);t.isIE8=t.isIE&&/MSIE [8]/.test(ua);
t.isIE9=t.isIE&&/MSIE [9]/.test(ua);t.isGecko=!t.isWebKit&&/Gecko/.test(ua);t.isMac=ua.indexOf("Mac")!=-1;t.isAir=/adobeair/i.test(ua);t.isIDevice=/(iPad|iPhone)/.test(ua);t.isIOS5=t.isIDevice&&ua.match(/AppleWebKit\/(\d*)/)[1]>=534;if(win.tinyMCEPreInit){t.suffix=tinyMCEPreInit.suffix;t.baseURL=tinyMCEPreInit.base;t.query=tinyMCEPreInit.query;return}t.suffix="_src";nl=d.getElementsByTagName("base");for(i=0;i<nl.length;i++){v=nl[i].href;if(v){if(/^https?:\/\/[^\/]+$/.test(v))v+="/";base=v?v.match(/.*\//)[0]:
""}}function getBase(n){if(n.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(n.src)){if(/_(src|dev)\.js/g.test(n.src))t.suffix="_src";if((p=n.src.indexOf("?"))!=-1)t.query=n.src.substring(p+1);t.baseURL=n.src.substring(0,n.src.lastIndexOf("/"));if(base&&t.baseURL.indexOf("://")==-1&&t.baseURL.indexOf("/")!==0)t.baseURL=base+t.baseURL;return t.baseURL}return null}nl=d.getElementsByTagName("script");for(i=0;i<nl.length;i++)if(getBase(nl[i]))return;n=d.getElementsByTagName("head")[0];
if(n){nl=n.getElementsByTagName("script");for(i=0;i<nl.length;i++)if(getBase(nl[i]))return}return},is:function(o,t){if(!t)return o!==undef;if(t=="array"&&o.hasOwnProperty&&o instanceof Array)return true;return typeof o==t},makeMap:function(items,delim,map){var i;items=items||[];delim=delim||",";if(typeof items=="string")items=items.split(delim);map=map||{};i=items.length;while(i--)map[items[i]]={};return map},each:function(o,cb,s){var n,l;if(!o)return 0;s=s||o;if(o.length!==undef)for(n=0,l=o.length;n<
l;n++){if(cb.call(s,o[n],n,o)===false)return 0}else for(n in o)if(o.hasOwnProperty(n))if(cb.call(s,o[n],n,o)===false)return 0;return 1},map:function(a,f){var o=[];tinymce.each(a,function(v){o.push(f(v))});return o},grep:function(a,f){var o=[];tinymce.each(a,function(v){if(!f||f(v))o.push(v)});return o},inArray:function(a,v){var i,l;if(a)for(i=0,l=a.length;i<l;i++)if(a[i]===v)return i;return-1},extend:function(obj,ext){var i,l,name,args=arguments,value;for(i=1,l=args.length;i<l;i++){ext=args[i];for(name in ext)if(ext.hasOwnProperty(name)){value=
ext[name];if(value!==undef)obj[name]=value}}return obj},trim:function(s){return(s?""+s:"").replace(whiteSpaceRe,"")},create:function(s,p,root){var t=this,sp,ns,cn,scn,c,de=0;s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s);cn=s[3].match(/(^|\.)(\w+)$/i)[2];ns=t.createNS(s[3].replace(/\.\w+$/,""),root);if(ns[cn])return;if(s[2]=="static"){ns[cn]=p;if(this.onCreate)this.onCreate(s[2],s[3],ns[cn]);return}if(!p[cn]){p[cn]=function(){};de=1}ns[cn]=p[cn];t.extend(ns[cn].prototype,p);if(s[5]){sp=t.resolve(s[5]).prototype;
scn=s[5].match(/\.(\w+)$/i)[1];c=ns[cn];if(de)ns[cn]=function(){return sp[scn].apply(this,arguments)};else ns[cn]=function(){this.parent=sp[scn];return c.apply(this,arguments)};ns[cn].prototype[cn]=ns[cn];t.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]});t.each(p,function(f,n){if(sp[n])ns[cn].prototype[n]=function(){this.parent=sp[n];return f.apply(this,arguments)};else if(n!=cn)ns[cn].prototype[n]=f})}t.each(p["static"],function(f,n){ns[cn][n]=f});if(this.onCreate)this.onCreate(s[2],s[3],ns[cn].prototype)},
walk:function(o,f,n,s){s=s||this;if(o){if(n)o=o[n];tinymce.each(o,function(o,i){if(f.call(s,o,i,n)===false)return false;tinymce.walk(o,f,n,s)})}},createNS:function(n,o){var i,v;o=o||win;n=n.split(".");for(i=0;i<n.length;i++){v=n[i];if(!o[v])o[v]={};o=o[v]}return o},resolve:function(n,o){var i,l;o=o||win;n=n.split(".");for(i=0,l=n.length;i<l;i++){o=o[n[i]];if(!o)break}return o},addUnload:function(f,s){var t=this,unload;unload=function(){var li=t.unloads,o,n;if(li){for(n in li){o=li[n];if(o&&o.func)o.func.call(o.scope,
1)}if(win.detachEvent){win.detachEvent("onbeforeunload",fakeUnload);win.detachEvent("onunload",unload)}else if(win.removeEventListener)win.removeEventListener("unload",unload,false);t.unloads=o=li=w=unload=0;if(win.CollectGarbage)CollectGarbage()}};function fakeUnload(){var d=document;function stop(){d.detachEvent("onstop",stop);if(unload)unload();d=0}if(d.readyState=="interactive"){if(d)d.attachEvent("onstop",stop);win.setTimeout(function(){if(d)d.detachEvent("onstop",stop)},0)}}f={func:f,scope:s||
this};if(!t.unloads){if(win.attachEvent){win.attachEvent("onunload",unload);win.attachEvent("onbeforeunload",fakeUnload)}else if(win.addEventListener)win.addEventListener("unload",unload,false);t.unloads=[f]}else t.unloads.push(f);return f},removeUnload:function(f){var u=this.unloads,r=null;tinymce.each(u,function(o,i){if(o&&o.func==f){u.splice(i,1);r=f;return false}});return r},explode:function(s,d){if(!s||tinymce.is(s,"array"))return s;return tinymce.map(s.split(d||","),tinymce.trim)},_addVer:function(u){var v;
if(!this.query)return u;v=(u.indexOf("?")==-1?"?":"&")+this.query;if(u.indexOf("#")==-1)return u+v;return u.replace("#",v+"#")},_replace:function(find,replace,str){if(isRegExpBroken)return str.replace(find,function(){var val=replace,args=arguments,i;for(i=0;i<args.length-2;i++)if(args[i]===undef)val=val.replace(new RegExp("\\$"+i,"g"),"");else val=val.replace(new RegExp("\\$"+i,"g"),args[i]);return val});return str.replace(find,replace)}};tinymce._init();win.tinymce=win.tinyMCE=tinymce})(window);
tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,inDispatch:false,Dispatcher:function(scope){this.scope=scope||this;this.listeners=[]},add:function(callback,scope){this.listeners.push({cb:callback,scope:scope||this.scope});return callback},addToTop:function(callback,scope){var self=this,listener={cb:callback,scope:scope||self.scope};if(self.inDispatch)self.listeners=[listener].concat(self.listeners);else self.listeners.unshift(listener);return callback},remove:function(callback){var listeners=
this.listeners,output=null;tinymce.each(listeners,function(listener,i){if(callback==listener.cb){output=listener;listeners.splice(i,1);return false}});return output},dispatch:function(){var self=this,returnValue,args=arguments,i,listeners=self.listeners,listener;self.inDispatch=true;for(i=0;i<listeners.length;i++){listener=listeners[i];returnValue=listener.cb.apply(listener.scope,args.length>0?args:[listener.scope]);if(returnValue===false)break}self.inDispatch=false;return returnValue}});
(function(){var each=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(u,s){var t=this,o,a,b,base_url;u=tinymce.trim(u);s=t.settings=s||{};if(/^([\w\-]+):([^\/]{2})/i.test(u)||/^\s*#/.test(u)){t.source=u;return}if(u.indexOf("/")===0&&u.indexOf("//")!==0)u=(s.base_uri?s.base_uri.protocol||"http":"http")+"://mce_host"+u;if(!/^[\w\-]*:?\/\//.test(u)){base_url=s.base_uri?s.base_uri.path:(new tinymce.util.URI(location.href)).directory;u=(s.base_uri&&s.base_uri.protocol||"http")+"://mce_host"+
t.toAbsPath(base_url,u)}u=u.replace(/@@/g,"(mce_at)");u=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(u);each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(v,i){var s=u[i];if(s)s=s.replace(/\(mce_at\)/g,"@@");t[v]=s});b=s.base_uri;if(b){if(!t.protocol)t.protocol=
b.protocol;if(!t.userInfo)t.userInfo=b.userInfo;if(!t.port&&t.host==="mce_host")t.port=b.port;if(!t.host||t.host==="mce_host")t.host=b.host;t.source=""}},setPath:function(p){var t=this;p=/^(.*?)\/?(\w+)?$/.exec(p);t.path=p[0];t.directory=p[1];t.file=p[2];t.source="";t.getURI()},toRelative:function(u){var t=this,o;if(u==="./")return u;u=new tinymce.util.URI(u,{base_uri:t});if(u.host!="mce_host"&&t.host!=u.host&&u.host||t.port!=u.port||t.protocol!=u.protocol)return u.getURI();var tu=t.getURI(),uu=u.getURI();
if(tu==uu||tu.charAt(tu.length-1)=="/"&&tu.substr(0,tu.length-1)==uu)return tu;o=t.toRelPath(t.path,u.path);if(u.query)o+="?"+u.query;if(u.anchor)o+="#"+u.anchor;return o},toAbsolute:function(u,nh){u=new tinymce.util.URI(u,{base_uri:this});return u.getURI(this.host==u.host&&this.protocol==u.protocol?nh:0)},toRelPath:function(base,path){var items,bp=0,out="",i,l;base=base.substring(0,base.lastIndexOf("/"));base=base.split("/");items=path.split("/");if(base.length>=items.length)for(i=0,l=base.length;i<
l;i++)if(i>=items.length||base[i]!=items[i]){bp=i+1;break}if(base.length<items.length)for(i=0,l=items.length;i<l;i++)if(i>=base.length||base[i]!=items[i]){bp=i+1;break}if(bp===1)return path;for(i=0,l=base.length-(bp-1);i<l;i++)out+="../";for(i=bp-1,l=items.length;i<l;i++)if(i!=bp-1)out+="/"+items[i];else out+=items[i];return out},toAbsPath:function(base,path){var i,nb=0,o=[],tr,outPath;tr=/\/$/.test(path)?"/":"";base=base.split("/");path=path.split("/");each(base,function(k){if(k)o.push(k)});base=
o;for(i=path.length-1,o=[];i>=0;i--){if(path[i].length===0||path[i]===".")continue;if(path[i]===".."){nb++;continue}if(nb>0){nb--;continue}o.push(path[i])}i=base.length-nb;if(i<=0)outPath=o.reverse().join("/");else outPath=base.slice(0,i).join("/")+"/"+o.reverse().join("/");if(outPath.indexOf("/")!==0)outPath="/"+outPath;if(tr&&outPath.lastIndexOf("/")!==outPath.length-1)outPath+=tr;return outPath},getURI:function(nh){var s,t=this;if(!t.source||nh){s="";if(!nh){if(t.protocol)s+=t.protocol+"://";if(t.userInfo)s+=
t.userInfo+"@";if(t.host)s+=t.host;if(t.port)s+=":"+t.port}if(t.path)s+=t.path;if(t.query)s+="?"+t.query;if(t.anchor)s+="#"+t.anchor;t.source=s}return t.source}})})();
(function(){var each=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(n){var v=this.get(n),h;if(v)each(v.split("&"),function(v){v=v.split("=");h=h||{};h[unescape(v[0])]=unescape(v[1])});return h},setHash:function(n,v,e,p,d,s){var o="";each(v,function(v,k){o+=(!o?"":"&")+escape(k)+"="+escape(v)});this.set(n,o,e,p,d,s)},get:function(n){var c=document.cookie,e,p=n+"=",b;if(!c)return;b=c.indexOf("; "+p);if(b==-1){b=c.indexOf(p);if(b!==0)return null}else b+=2;e=c.indexOf(";",
b);if(e==-1)e=c.length;return unescape(c.substring(b+p.length,e))},set:function(n,v,e,p,d,s){document.cookie=n+"="+escape(v)+(e?"; expires="+e.toGMTString():"")+(p?"; path="+escape(p):"")+(d?"; domain="+d:"")+(s?"; secure":"")},remove:function(name,path,domain){var date=new Date;date.setTime(date.getTime()-1E3);this.set(name,"",date,path,domain)}})})();
(function(){function serialize(o,quote){var i,v,t,name;quote=quote||'"';if(o==null)return"null";t=typeof o;if(t=="string"){v="\u0008b\tt\nn\u000cf\rr\"\"''\\\\";return quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){if(quote==='"'&&a==="'")return a;i=v.indexOf(b);if(i+1)return"\\"+v.charAt(i+1);a=b.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+quote}if(t=="object"){if(o.hasOwnProperty&&o instanceof Array){for(i=0,v="[";i<o.length;i++)v+=(i>0?",":"")+serialize(o[i],
quote);return v+"]"}v="{";for(name in o)if(o.hasOwnProperty(name))v+=typeof o[name]!="function"?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):"";return v+"}"}return""+o}tinymce.util.JSON={serialize:serialize,parse:function(s){try{return eval("("+s+")")}catch(ex){}}}})();
tinymce.create("static tinymce.util.XHR",{send:function(o){var x,t,w=window,c=0;function ready(){if(!o.async||x.readyState==4||c++>1E4){if(o.success&&c<1E4&&x.status==200)o.success.call(o.success_scope,""+x.responseText,x,o);else if(o.error)o.error.call(o.error_scope,c>1E4?"TIMED_OUT":"GENERAL",x,o);x=null}else w.setTimeout(ready,10)}o.scope=o.scope||this;o.success_scope=o.success_scope||o.scope;o.error_scope=o.error_scope||o.scope;o.async=o.async===false?false:true;o.data=o.data||"";function get(s){x=
0;try{x=new ActiveXObject(s)}catch(ex){}return x}x=w.XMLHttpRequest?new XMLHttpRequest:get("Microsoft.XMLHTTP")||get("Msxml2.XMLHTTP");if(x){if(x.overrideMimeType)x.overrideMimeType(o.content_type);x.open(o.type||(o.data?"POST":"GET"),o.url,o.async);if(o.content_type)x.setRequestHeader("Content-Type",o.content_type);x.setRequestHeader("X-Requested-With","XMLHttpRequest");x.send(o.data);if(!o.async)return ready();t=w.setTimeout(ready,10)}}});
(function(){var extend=tinymce.extend,JSON=tinymce.util.JSON,XHR=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(s){this.settings=extend({},s);this.count=0},send:function(o){var ecb=o.error,scb=o.success;o=extend(this.settings,o);o.success=function(c,x){c=JSON.parse(c);if(typeof c=="undefined")c={error:"JSON Parse error."};if(c.error)ecb.call(o.error_scope||o.scope,c.error,x);else scb.call(o.success_scope||o.scope,c.result)};o.error=function(ty,x){if(ecb)ecb.call(o.error_scope||
o.scope,ty,x)};o.data=JSON.serialize({id:o.id||"c"+this.count++,method:o.method,params:o.params});o.content_type="application/json";XHR.send(o)},"static":{sendRPC:function(o){return(new tinymce.util.JSONRequest).send(o)}}})})();(function(tinymce){tinymce.VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey},metaKeyPressed:function(e){return tinymce.isMac?e.metaKey:e.ctrlKey&&!e.altKey}}})(tinymce);
tinymce.util.Quirks=function(editor){var VK=tinymce.VK,BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings;function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,false,state)}catch(ex){}}function getDocumentMode(){var documentMode=editor.getDoc().documentMode;return documentMode?documentMode:6}function cleanupStylesWhenDeleting(){function removeMergedFormatSpans(isDelete){var rng,blockElm,node,clonedSpan;rng=selection.getRng();
blockElm=dom.getParent(rng.startContainer,dom.isBlock);if(isDelete)blockElm=dom.getNext(blockElm,dom.isBlock);if(blockElm){node=blockElm.firstChild;while(node&&node.nodeType==3&&node.nodeValue.length===0)node=node.nextSibling;if(node&&node.nodeName==="SPAN")clonedSpan=node.cloneNode(false)}editor.getDoc().execCommand(isDelete?"ForwardDelete":"Delete",false,null);blockElm=dom.getParent(rng.startContainer,dom.isBlock);tinymce.each(dom.select("span.Apple-style-span,font.Apple-style-span",blockElm),function(span){var bm=
selection.getBookmark();if(clonedSpan)dom.replace(clonedSpan.cloneNode(false),span,true);else dom.remove(span,true);selection.moveToBookmark(bm)})}editor.onKeyDown.add(function(editor,e){var isDelete;isDelete=e.keyCode==DELETE;if(!e.isDefaultPrevented()&&(isDelete||e.keyCode==BACKSPACE)&&!VK.modifierPressed(e)){e.preventDefault();removeMergedFormatSpans(isDelete)}});editor.addCommand("Delete",function(){removeMergedFormatSpans()})}function emptyEditorWhenDeleting(){function serializeRng(rng){var body=
dom.create("body");var contents=rng.cloneContents();body.appendChild(contents);return selection.serializer.serialize(body,{format:"html"})}function allContentsSelected(rng){var selection=serializeRng(rng);var allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection}editor.onKeyDown.add(function(editor,e){var keyCode=e.keyCode,isCollapsed;if(!e.isDefaultPrevented()&&(keyCode==DELETE||keyCode==BACKSPACE)){isCollapsed=editor.selection.isCollapsed();
if(isCollapsed&&!dom.isEmpty(editor.getBody()))return;if(tinymce.isIE&&!isCollapsed)return;if(!isCollapsed&&!allContentsSelected(editor.selection.getRng()))return;editor.setContent("");editor.selection.setCursorLocation(editor.getBody(),0);editor.nodeChanged()}})}function selectAll(){editor.onKeyDown.add(function(editor,e){if(e.keyCode==65&&VK.metaKeyPressed(e)){e.preventDefault();editor.execCommand("SelectAll")}})}function inputMethodFocus(){if(!editor.settings.content_editable){dom.bind(editor.getDoc(),
"focusin",function(e){selection.setRng(selection.getRng())});dom.bind(editor.getDoc(),"mousedown",function(e){if(e.target==editor.getDoc().documentElement){editor.getWin().focus();selection.setRng(selection.getRng())}})}}function removeHrOnBackspace(){editor.onKeyDown.add(function(editor,e){if(!e.isDefaultPrevented()&&e.keyCode===BACKSPACE)if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var node=selection.getNode();var previousSibling=node.previousSibling;if(previousSibling&&previousSibling.nodeName&&
previousSibling.nodeName.toLowerCase()==="hr"){dom.remove(previousSibling);tinymce.dom.Event.cancel(e)}}})}function focusBody(){if(!Range.prototype.getClientRects)editor.onMouseDown.add(function(editor,e){if(e.target.nodeName==="HTML"){var body=editor.getBody();body.blur();setTimeout(function(){body.focus()},0)}})}function selectControlElements(){editor.onClick.add(function(editor,e){e=e.target;if(/^(IMG|HR)$/.test(e.nodeName))selection.getSel().setBaseAndExtent(e,0,e,1);if(e.nodeName=="A"&&dom.hasClass(e,
"mceItemAnchor"))selection.select(e);editor.nodeChanged()})}function removeStylesWhenDeletingAccrossBlockElements(){function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(false));return function(){var target=selection.getStart();if(target!==editor.getBody()){dom.setAttrib(target,"style",null);tinymce.each(template,function(attr){target.setAttributeNode(attr.cloneNode(true))})}}}function isSelectionAcrossElements(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),
dom.isBlock)!=dom.getParent(selection.getEnd(),dom.isBlock)}function blockEvent(editor,e){e.preventDefault();return false}editor.onKeyPress.add(function(editor,e){var applyAttributes;if((e.keyCode==8||e.keyCode==46)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();editor.getDoc().execCommand("delete",false,null);applyAttributes();e.preventDefault();return false}});dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;if(isSelectionAcrossElements()){applyAttributes=
getAttributeApplyFunction();editor.onKeyUp.addToTop(blockEvent);setTimeout(function(){applyAttributes();editor.onKeyUp.remove(blockEvent)},0)}})}function selectionChangeNodeChanged(){var lastRng,selectionTimer;dom.bind(editor.getDoc(),"selectionchange",function(){if(selectionTimer){clearTimeout(selectionTimer);selectionTimer=0}selectionTimer=window.setTimeout(function(){var rng=selection.getRng();if(!lastRng||!tinymce.dom.RangeUtils.compareRanges(rng,lastRng)){editor.nodeChanged();lastRng=rng}},50)})}
function ensureBodyHasRoleApplication(){document.body.setAttribute("role","application")}function disableBackspaceIntoATable(){editor.onKeyDown.add(function(editor,e){if(!e.isDefaultPrevented()&&e.keyCode===BACKSPACE)if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==="table")return tinymce.dom.Event.cancel(e)}})}function addNewLinesBeforeBrInPre(){if(getDocumentMode()>
7)return;setEditorCommandState("RespectVisibilityInDesign",true);editor.contentStyles.push(".mceHideBrInPre pre br {display: none}");dom.addClass(editor.getBody(),"mceHideBrInPre");editor.parser.addNodeFilter("pre",function(nodes,name){var i=nodes.length,brNodes,j,brElm,sibling;while(i--){brNodes=nodes[i].getAll("br");j=brNodes.length;while(j--){brElm=brNodes[j];sibling=brElm.prev;if(sibling&&sibling.type===3&&sibling.value.charAt(sibling.value-1)!="\n")sibling.value+="\n";else brElm.parent.insert(new tinymce.html.Node("#text",
3),brElm,true).value="\n"}}});editor.serializer.addNodeFilter("pre",function(nodes,name){var i=nodes.length,brNodes,j,brElm,sibling;while(i--){brNodes=nodes[i].getAll("br");j=brNodes.length;while(j--){brElm=brNodes[j];sibling=brElm.prev;if(sibling&&sibling.type==3)sibling.value=sibling.value.replace(/\r?\n$/,"")}}})}function removePreSerializedStylesWhenSelectingControls(){dom.bind(editor.getBody(),"mouseup",function(e){var value,node=selection.getNode();if(node.nodeName=="IMG"){if(value=dom.getStyle(node,
"width")){dom.setAttrib(node,"width",value.replace(/[^0-9%]+/g,""));dom.setStyle(node,"width","")}if(value=dom.getStyle(node,"height")){dom.setAttrib(node,"height",value.replace(/[^0-9%]+/g,""));dom.setStyle(node,"height","")}}})}function keepInlineElementOnDeleteBackspace(){editor.onKeyDown.add(function(editor,e){var isDelete,rng,container,offset,brElm,sibling,collapsed;isDelete=e.keyCode==DELETE;if(!e.isDefaultPrevented()&&(isDelete||e.keyCode==BACKSPACE)&&!VK.modifierPressed(e)){rng=selection.getRng();
container=rng.startContainer;offset=rng.startOffset;collapsed=rng.collapsed;if(container.nodeType==3&&container.nodeValue.length>0&&(offset===0&&!collapsed||collapsed&&offset===(isDelete?0:1))){nonEmptyElements=editor.schema.getNonEmptyElements();e.preventDefault();brElm=dom.create("br",{id:"__tmp"});container.parentNode.insertBefore(brElm,container);editor.getDoc().execCommand(isDelete?"ForwardDelete":"Delete",false,null);container=selection.getRng().startContainer;sibling=container.previousSibling;
if(sibling&&sibling.nodeType==1&&!dom.isBlock(sibling)&&dom.isEmpty(sibling)&&!nonEmptyElements[sibling.nodeName.toLowerCase()])dom.remove(sibling);dom.remove("__tmp")}}})}function removeBlockQuoteOnBackSpace(){editor.onKeyDown.add(function(editor,e){var rng,container,offset,root,parent;if(e.isDefaultPrevented()||e.keyCode!=VK.BACKSPACE)return;rng=selection.getRng();container=rng.startContainer;offset=rng.startOffset;root=dom.getRoot();parent=container;if(!rng.collapsed||offset!==0)return;while(parent&&
parent.parentNode&&parent.parentNode.firstChild==parent&&parent.parentNode!=root)parent=parent.parentNode;if(parent.tagName==="BLOCKQUOTE"){editor.formatter.toggle("blockquote",null,parent);rng.setStart(container,0);rng.setEnd(container,0);selection.setRng(rng);selection.collapse(false)}})}function setGeckoEditingOptions(){function setOpts(){editor._refreshContentEditable();setEditorCommandState("StyleWithCSS",false);setEditorCommandState("enableInlineTableEditing",false);if(!settings.object_resizing)setEditorCommandState("enableObjectResizing",
false)}if(!settings.readonly){editor.onBeforeExecCommand.add(setOpts);editor.onMouseDown.add(setOpts)}}function addBrAfterLastLinks(){function fixLinks(editor,o){tinymce.each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){while(parentNode&&!dom.isBlock(parentNode)){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})}editor.onExecCommand.add(function(editor,
cmd){if(cmd==="CreateLink")fixLinks(editor)});editor.onSetContent.add(selection.onSetContent.add(fixLinks))}function setDefaultBlockType(){if(settings.forced_root_block)editor.onInit.add(function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})}function removeGhostSelection(){function repaint(sender,args){if(!sender||!args.initial)editor.execCommand("mceRepaint")}editor.onUndo.add(repaint);editor.onRedo.add(repaint);editor.onSetContent.add(repaint)}function deleteControlItemOnBackSpace(){editor.onKeyDown.add(function(editor,
e){var rng;if(!e.isDefaultPrevented()&&e.keyCode==BACKSPACE){rng=editor.getDoc().selection.createRange();if(rng&&rng.item){e.preventDefault();editor.undoManager.beforeChange();dom.remove(rng.item(0));editor.undoManager.add()}}})}function renderEmptyBlocksFix(){var emptyBlocksCSS;if(getDocumentMode()>=10){emptyBlocksCSS="";tinymce.each("p div h1 h2 h3 h4 h5 h6".split(" "),function(name,i){emptyBlocksCSS+=(i>0?",":"")+name+":empty"});editor.contentStyles.push(emptyBlocksCSS+"{padding-right: 1px !important}")}}
function fakeImageResize(){var selectedElmX,selectedElmY,selectedElm,selectedElmGhost,selectedHandle,startX,startY,startW,startH,ratio,resizeHandles,width,height,rootDocument=document,editableDoc=editor.getDoc();if(!settings.object_resizing||settings.webkit_fake_resize===false)return;setEditorCommandState("enableObjectResizing",false);resizeHandles={n:[0.5,0,0,-1],e:[1,0.5,1,0],s:[0.5,1,0,1],w:[0,0.5,-1,0],nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};function resizeElement(e){var deltaX,
deltaY;deltaX=e.screenX-startX;deltaY=e.screenY-startY;width=deltaX*selectedHandle[2]+startW;height=deltaY*selectedHandle[3]+startH;width=width<5?5:width;height=height<5?5:height;if(VK.modifierPressed(e)||selectedElm.nodeName=="IMG"&&selectedHandle[2]*selectedHandle[3]!==0){width=Math.round(height/ratio);height=Math.round(width*ratio)}dom.setStyles(selectedElmGhost,{width:width,height:height});if(selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width)dom.setStyle(selectedElmGhost,"left",selectedElmX+
(startW-width));if(selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height)dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height))}function endResize(){function setSizeProp(name,value){if(value)if(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name))dom.setStyle(selectedElm,name,value);else dom.setAttrib(selectedElm,name,value)}setSizeProp("width",width);setSizeProp("height",height);dom.unbind(editableDoc,"mousemove",resizeElement);dom.unbind(editableDoc,
"mouseup",endResize);if(rootDocument!=editableDoc){dom.unbind(rootDocument,"mousemove",resizeElement);dom.unbind(rootDocument,"mouseup",endResize)}dom.remove(selectedElmGhost);showResizeRect(selectedElm)}function showResizeRect(targetElm){var position,targetWidth,targetHeight;hideResizeRect();position=dom.getPos(targetElm);selectedElmX=position.x;selectedElmY=position.y;targetWidth=targetElm.offsetWidth;targetHeight=targetElm.offsetHeight;if(selectedElm!=targetElm){selectedElm=targetElm;width=height=
0}tinymce.each(resizeHandles,function(handle,name){var handleElm;handleElm=dom.get("mceResizeHandle"+name);if(!handleElm){handleElm=dom.add(editableDoc.documentElement,"div",{id:"mceResizeHandle"+name,"class":"mceResizeHandle",style:"cursor:"+name+"-resize; margin:0; padding:0"});dom.bind(handleElm,"mousedown",function(e){e.preventDefault();endResize();startX=e.screenX;startY=e.screenY;startW=selectedElm.clientWidth;startH=selectedElm.clientHeight;ratio=startH/startW;selectedHandle=handle;selectedElmGhost=
selectedElm.cloneNode(true);dom.addClass(selectedElmGhost,"mceClonedResizable");dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0});editableDoc.documentElement.appendChild(selectedElmGhost);dom.bind(editableDoc,"mousemove",resizeElement);dom.bind(editableDoc,"mouseup",endResize);if(rootDocument!=editableDoc){dom.bind(rootDocument,"mousemove",resizeElement);dom.bind(rootDocument,"mouseup",endResize)}})}else dom.show(handleElm);dom.setStyles(handleElm,{left:targetWidth*handle[0]+
selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2})});if(!tinymce.isOpera&&selectedElm.nodeName=="IMG")selectedElm.setAttribute("data-mce-selected","1")}function hideResizeRect(){if(selectedElm)selectedElm.removeAttribute("data-mce-selected");for(var name in resizeHandles)dom.hide("mceResizeHandle"+name)}editor.contentStyles.push(".mceResizeHandle {"+"position: absolute;"+"border: 1px solid black;"+"background: #FFF;"+"width: 5px;"+"height: 5px;"+
"z-index: 10000"+"}"+".mceResizeHandle:hover {"+"background: #000"+"}"+"img[data-mce-selected] {"+"outline: 1px solid black"+"}"+"img.mceClonedResizable, table.mceClonedResizable {"+"position: absolute;"+"outline: 1px dashed black;"+"opacity: .5;"+"z-index: 10000"+"}");function updateResizeRect(){var controlElm=dom.getParent(selection.getNode(),"table,img");tinymce.each(dom.select("img[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")});if(controlElm)showResizeRect(controlElm);
else hideResizeRect()}editor.onNodeChange.add(updateResizeRect);dom.bind(editableDoc,"selectionchange",updateResizeRect);editor.serializer.addAttributeFilter("data-mce-selected",function(nodes,name){var i=nodes.length;while(i--)nodes[i].attr(name,null)})}disableBackspaceIntoATable();removeBlockQuoteOnBackSpace();emptyEditorWhenDeleting();if(tinymce.isWebKit){keepInlineElementOnDeleteBackspace();cleanupStylesWhenDeleting();inputMethodFocus();selectControlElements();setDefaultBlockType();if(tinymce.isIDevice)selectionChangeNodeChanged();
else{fakeImageResize();selectAll()}}if(tinymce.isIE){removeHrOnBackspace();ensureBodyHasRoleApplication();addNewLinesBeforeBrInPre();removePreSerializedStylesWhenSelectingControls();deleteControlItemOnBackSpace();renderEmptyBlocksFix()}if(tinymce.isGecko){removeHrOnBackspace();focusBody();removeStylesWhenDeletingAccrossBlockElements();setGeckoEditingOptions();addBrAfterLastLinks();removeGhostSelection()}if(tinymce.isOpera)fakeImageResize()};
(function(tinymce){var namedEntities,baseEntities,reverseEntities,attrsCharsRegExp=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&(#x|#)?([\w]+);/g,asciiMap={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",
148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};function nativeDecode(text){var elm;elm=document.createElement("div");elm.innerHTML=text;return elm.textContent||elm.innerText||text}function buildEntitiesLookup(items,radix){var i,chr,entity,lookup={};if(items){items=
items.split(",");radix=radix||10;for(i=0;i<items.length;i+=2){chr=String.fromCharCode(parseInt(items[i],radix));if(!baseEntities[chr]){entity="&"+items[i+1]+";";lookup[chr]=entity;lookup[entity]=chr}}return lookup}}namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,"+"5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,"+"5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,"+
"5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,"+"68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,"+"6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,"+"6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,"+"75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,"+"7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,"+
"7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,"+"sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,"+"st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,"+"t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,"+"tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,"+"u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,"+
"81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,"+"8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,"+"8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,"+"8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,"+"8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,"+"nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,"+
"rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,"+"Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,"+"80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,"+"811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);tinymce.html=tinymce.html||{};tinymce.html.Entities={encodeRaw:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||
chr})},encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(chr.length>1)return"&#"+((chr.charCodeAt(0)-55296)*1024+(chr.charCodeAt(1)-56320)+65536)+";";return baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed:function(text,attr,entities){entities=entities||namedEntities;return text.replace(attr?attrsCharsRegExp:textCharsRegExp,
function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc:function(name,entities){var Entities=tinymce.html.Entities;entities=buildEntitiesLookup(entities)||namedEntities;function encodeNamedAndNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||"&#"+chr.charCodeAt(0)+";"||chr})}function encodeCustomNamed(text,attr){return Entities.encodeNamed(text,attr,entities)}name=tinymce.makeMap(name.replace(/\+/g,
","));if(name.named&&name.numeric)return encodeNamedAndNumeric;if(name.named){if(entities)return encodeCustomNamed;return Entities.encodeNamed}if(name.numeric)return Entities.encodeNumeric;return Entities.encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric,value){if(numeric){value=parseInt(value,numeric.length===2?16:10);if(value>65535){value-=65536;return String.fromCharCode(55296+(value>>10),56320+(value&1023))}else return asciiMap[value]||String.fromCharCode(value)}return reverseEntities[all]||
namedEntities[all]||nativeDecode(all)})}}})(tinymce);
tinymce.html.Styles=function(settings,schema){var rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,urlColorRegExp=/rgb/,undef,i,encodingLookup={},encodingItems;settings=settings||{};encodingItems="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(i=0;i<encodingItems.length;i++){encodingLookup[encodingItems[i]]=
"\ufeff"+i;encodingLookup["\ufeff"+i]=encodingItems[i]}function toHex(match,r,g,b){function hex(val){val=parseInt(val).toString(16);return val.length>1?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){var styles={},matches,name,value,isEncoded,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this;function compress(prefix,suffix){var top,right,bottom,left;top=styles[prefix+"-top"+suffix];
if(!top)return;right=styles[prefix+"-right"+suffix];if(top!=right)return;bottom=styles[prefix+"-bottom"+suffix];if(right!=bottom)return;left=styles[prefix+"-left"+suffix];if(bottom!=left)return;styles[prefix+suffix]=left;delete styles[prefix+"-top"+suffix];delete styles[prefix+"-right"+suffix];delete styles[prefix+"-bottom"+suffix];delete styles[prefix+"-left"+suffix]}function canCompress(key){var value=styles[key],i;if(!value||value.indexOf(" ")<0)return;value=value.split(" ");i=value.length;while(i--)if(value[i]!==
value[0])return false;styles[key]=value[0];return true}function compress2(target,a,b,c){if(!canCompress(a))return;if(!canCompress(b))return;if(!canCompress(c))return;styles[target]=styles[a]+" "+styles[b]+" "+styles[c];delete styles[a];delete styles[b];delete styles[c]}function encode(str){isEncoded=true;return encodingLookup[str]}function decode(str,keep_slashes){if(isEncoded)str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]});if(!keep_slashes)str=str.replace(/\\([\'\";:])/g,
"$1");return str}function processUrl(match,url,url2,url3,str,str2){str=str||str2;if(str){str=decode(str);return"'"+str.replace(/\'/g,"\\'")+"'"}url=decode(url||url2||url3);if(urlConverter)url=urlConverter.call(urlConverterScope,url,"style");return"url('"+url.replace(/\'/g,"\\'")+"')"}if(css){css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});while(matches=styleRegExp.exec(css)){name=matches[1].replace(trimRightRegExp,"").toLowerCase();
value=matches[2].replace(trimRightRegExp,"");if(name&&value.length>0){if(name==="font-weight"&&value==="700")value="bold";else if(name==="color"||name==="background-color")value=value.toLowerCase();value=value.replace(rgbRegExp,toHex);value=value.replace(urlOrStrRegExp,processUrl);styles[name]=isEncoded?decode(value,true):value}styleRegExp.lastIndex=matches.index+matches[0].length}compress("border","");compress("border","-width");compress("border","-color");compress("border","-style");compress("padding",
"");compress("margin","");compress2("border","border-width","border-style","border-color");if(styles.border==="medium none")delete styles.border}return styles},serialize:function(styles,element_name){var css="",name,value;function serializeStyles(name){var styleList,i,l,value;styleList=schema.styles[name];if(styleList)for(i=0,l=styleList.length;i<l;i++){name=styleList[i];value=styles[name];if(value!==undef&&value.length>0)css+=(css.length>0?" ":"")+name+": "+value+";"}}if(element_name&&schema&&schema.styles){serializeStyles("*");
serializeStyles(element_name)}else for(name in styles){value=styles[name];if(value!==undef&&value.length>0)css+=(css.length>0?" ":"")+name+": "+value+";"}return css}}};
(function(tinymce){var mapCache={},makeMap=tinymce.makeMap,each=tinymce.each;function split(str,delim){return str.split(delim||",")}function unpack(lookup,data){var key,elements={};function replace(value){return value.replace(/[A-Z]+/g,function(key){return replace(lookup[key])})}for(key in lookup)if(lookup.hasOwnProperty(key))lookup[key]=replace(lookup[key]);replace(data).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(str,name,attributes,children){attributes=split(attributes,
"|");elements[name]={attributes:makeMap(attributes),attributesOrder:attributes,children:makeMap(children,"|",{"#comment":{}})}});return elements}function getHTML5(){var html5=mapCache.html5;if(!html5)html5=mapCache.html5=unpack({A:"id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|"+
"meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video|wbr",C:"#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|"+"figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|"+"p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video"},
"html[A|manifest][body|head]"+"head[A][base|command|link|meta|noscript|script|style|title]"+"title[A][#]"+"base[A|href|target][]"+"link[A|href|rel|media|type|sizes][]"+"meta[A|http-equiv|name|content|charset][]"+"style[A|type|media|scoped][#]"+"script[A|charset|type|src|defer|async][#]"+"noscript[A][C]"+"body[A][C]"+"section[A][C]"+"nav[A][C]"+"article[A][C]"+"aside[A][C]"+"h1[A][B]"+"h2[A][B]"+"h3[A][B]"+"h4[A][B]"+"h5[A][B]"+"h6[A][B]"+"hgroup[A][h1|h2|h3|h4|h5|h6]"+"header[A][C]"+"footer[A][C]"+
"address[A][C]"+"p[A][B]"+"br[A][]"+"pre[A][B]"+"dialog[A][dd|dt]"+"blockquote[A|cite][C]"+"ol[A|start|reversed][li]"+"ul[A][li]"+"li[A|value][C]"+"dl[A][dd|dt]"+"dt[A][B]"+"dd[A][C]"+"a[A|href|target|ping|rel|media|type][B]"+"em[A][B]"+"strong[A][B]"+"small[A][B]"+"cite[A][B]"+"q[A|cite][B]"+"dfn[A][B]"+"abbr[A][B]"+"code[A][B]"+"var[A][B]"+"samp[A][B]"+"kbd[A][B]"+"sub[A][B]"+"sup[A][B]"+"i[A][B]"+"b[A][B]"+"mark[A][B]"+"progress[A|value|max][B]"+"meter[A|value|min|max|low|high|optimum][B]"+"time[A|datetime][B]"+
"ruby[A][B|rt|rp]"+"rt[A][B]"+"rp[A][B]"+"bdo[A][B]"+"span[A][B]"+"ins[A|cite|datetime][B]"+"del[A|cite|datetime][B]"+"figure[A][C|legend|figcaption]"+"figcaption[A][C]"+"img[A|alt|src|height|width|usemap|ismap][]"+"iframe[A|name|src|height|width|sandbox|seamless][]"+"embed[A|src|height|width|type][]"+"object[A|data|type|height|width|usemap|name|form|classid][param]"+"param[A|name|value][]"+"details[A|open][C|legend]"+"command[A|type|label|icon|disabled|checked|radiogroup][]"+"menu[A|type|label][C|li]"+
"legend[A][C|B]"+"div[A][C]"+"source[A|src|type|media][]"+"audio[A|src|autobuffer|autoplay|loop|controls][source]"+"video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]"+"hr[A][]"+"form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]"+"fieldset[A|disabled|form|name][C|legend]"+"label[A|form|for][B]"+"input[A|type|accept|alt|autocomplete|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|"+
"multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value|name][]"+"button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]"+"select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]"+"datalist[A][B|option]"+"optgroup[A|disabled|label][option]"+"option[A|disabled|selected|label|value][]"+"textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]"+"keygen[A|autofocus|challenge|disabled|form|keytype|name][]"+
"output[A|for|form|name][B]"+"canvas[A|width|height][]"+"map[A|name][B|C]"+"area[A|shape|coords|href|alt|target|media|rel|ping|type][]"+"mathml[A][]"+"svg[A][]"+"table[A|border][caption|colgroup|thead|tfoot|tbody|tr]"+"caption[A][C]"+"colgroup[A|span][col]"+"col[A|span][]"+"thead[A][tr]"+"tfoot[A][tr]"+"tbody[A][tr]"+"tr[A][th|td]"+"th[A|headers|rowspan|colspan|scope][B]"+"td[A|headers|rowspan|colspan][C]"+"wbr[A][]");return html5}function getHTML4(){var html4=mapCache.html4;if(!html4)html4=mapCache.html4=
unpack({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",
O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]"+"style[B|id|type|media|title|xml:space][]"+
"object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]"+"param[id|name|value|valuetype|type][]"+"p[E|align][#|S]"+"a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]"+"br[A|clear][]"+"span[E][#|S]"+"bdo[A|C|B][#|S]"+"applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]"+"h1[E|align][#|S]"+"img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]"+
"map[B|C|A|name][X|form|Q|area]"+"h2[E|align][#|S]"+"iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]"+"h3[E|align][#|S]"+"tt[E][#|S]"+"i[E][#|S]"+"b[E][#|S]"+"u[E][#|S]"+"s[E][#|S]"+"strike[E][#|S]"+"big[E][#|S]"+"small[E][#|S]"+"font[A|B|size|color|face][#|S]"+"basefont[id|size|color|face][]"+"em[E][#|S]"+"strong[E][#|S]"+"dfn[E][#|S]"+"code[E][#|S]"+"q[E|cite][#|S]"+"samp[E][#|S]"+"kbd[E][#|S]"+"var[E][#|S]"+"cite[E][#|S]"+"abbr[E][#|S]"+"acronym[E][#|S]"+
"sub[E][#|S]"+"sup[E][#|S]"+"input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]"+"select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]"+"optgroup[E|disabled|label][option]"+"option[E|selected|disabled|label|value][]"+"textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]"+"label[E|for|accesskey|onfocus|onblur][#|S]"+"button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]"+
"h4[E|align][#|S]"+"ins[E|cite|datetime][#|Y]"+"h5[E|align][#|S]"+"del[E|cite|datetime][#|Y]"+"h6[E|align][#|S]"+"div[E|align][#|Y]"+"ul[E|type|compact][li]"+"li[E|type|value][#|Y]"+"ol[E|type|compact|start][li]"+"dl[E|compact][dt|dd]"+"dt[E][#|S]"+"dd[E][#|Y]"+"menu[E|compact][li]"+"dir[E|compact][li]"+"pre[E|width|xml:space][#|ZA]"+"hr[E|align|noshade|size|width][]"+"blockquote[E|cite][#|Y]"+"address[E][#|S|p]"+"center[E][#|Y]"+"noframes[E][#|Y]"+"isindex[A|B|prompt][]"+"fieldset[E][#|legend|Y]"+
"legend[E|accesskey|align][#|S]"+"table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]"+"caption[E|align][#|S]"+"col[ZG][]"+"colgroup[ZG][col]"+"thead[ZF][tr]"+"tr[ZF|bgcolor][th|td]"+"th[E|ZE][#|Y]"+"form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]"+"noscript[E][#|Y]"+"td[E|ZE][#|Y]"+"tfoot[ZF][tr]"+"tbody[ZF][tr]"+"area[E|D|shape|coords|href|nohref|alt|target][]"+"base[id|href|target][]"+
"body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]");return html4}tinymce.html.Schema=function(settings){var self=this,elements={},children={},patternElements=[],validStyles,schemaItems;var whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,blockElementsMap,nonEmptyElementsMap,customElementsMap={};function createLookupTable(option,default_value,extend){var value=settings[option];if(!value){value=mapCache[option];if(!value){value=makeMap(default_value,
" ",makeMap(default_value.toUpperCase()," "));value=tinymce.extend(value,extend);mapCache[option]=value}}else value=makeMap(value,",",makeMap(value.toUpperCase()," "));return value}settings=settings||{};schemaItems=settings.schema=="html5"?getHTML5():getHTML4();if(settings.verify_html===false)settings.valid_elements="*[*]";if(settings.valid_styles){validStyles={};each(settings.valid_styles,function(value,key){validStyles[key]=tinymce.explode(value)})}whiteSpaceElementsMap=createLookupTable("whitespace_elements",
"pre script style textarea");selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr");boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");nonEmptyElementsMap=createLookupTable("non_empty_elements",
"td th iframe video audio object",shortEndedElementsMap);blockElementsMap=createLookupTable("block_elements","h1 h2 h3 h4 h5 h6 hr p div address pre form table tbody thead tfoot "+"th tr td li ol ul caption blockquote center dl dt dd dir fieldset "+"noscript menu isindex samp header footer article section hgroup aside nav figure option datalist select optgroup");function patternToRegExp(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")}function addValidElements(valid_elements){var ei,
el,ai,al,yl,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,transElement,key,childKey,value,elementRuleRegExp=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(valid_elements){valid_elements=split(valid_elements);if(elements["@"]){globalAttributes=elements["@"].attributes;globalAttributesOrder=elements["@"].attributesOrder}for(ei=
0,el=valid_elements.length;ei<el;ei++){matches=elementRuleRegExp.exec(valid_elements[ei]);if(matches){prefix=matches[1];elementName=matches[2];outputName=matches[3];attrData=matches[4];attributes={};attributesOrder=[];element={attributes:attributes,attributesOrder:attributesOrder};if(prefix==="#")element.paddEmpty=true;if(prefix==="-")element.removeEmpty=true;if(globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData){attrData=
split(attrData,"|");for(ai=0,al=attrData.length;ai<al;ai++){matches=attrRuleRegExp.exec(attrData[ai]);if(matches){attr={};attrType=matches[1];attrName=matches[2].replace(/::/g,":");prefix=matches[3];value=matches[4];if(attrType==="!"){element.attributesRequired=element.attributesRequired||[];element.attributesRequired.push(attrName);attr.required=true}if(attrType==="-"){delete attributes[attrName];attributesOrder.splice(tinymce.inArray(attributesOrder,attrName),1);continue}if(prefix){if(prefix===
"="){element.attributesDefault=element.attributesDefault||[];element.attributesDefault.push({name:attrName,value:value});attr.defaultValue=value}if(prefix===":"){element.attributesForced=element.attributesForced||[];element.attributesForced.push({name:attrName,value:value});attr.forcedValue=value}if(prefix==="<")attr.validValues=makeMap(value,"?")}if(hasPatternsRegExp.test(attrName)){element.attributePatterns=element.attributePatterns||[];attr.pattern=patternToRegExp(attrName);element.attributePatterns.push(attr)}else{if(!attributes[attrName])attributesOrder.push(attrName);
attributes[attrName]=attr}}}}if(!globalAttributes&&elementName=="@"){globalAttributes=attributes;globalAttributesOrder=attributesOrder}if(outputName){element.outputName=elementName;elements[outputName]=element}if(hasPatternsRegExp.test(elementName)){element.pattern=patternToRegExp(elementName);patternElements.push(element)}else elements[elementName]=element}}}}function setValidElements(valid_elements){elements={};patternElements=[];addValidElements(valid_elements);each(schemaItems,function(element,
name){children[name]=element.children})}function addCustomElements(custom_elements){var customElementRegExp=/^(~)?(.+)$/;if(custom_elements)each(split(custom_elements),function(rule){var matches=customElementRegExp.exec(rule),inline=matches[1]==="~",cloneName=inline?"span":"div",name=matches[2];children[name]=children[cloneName];customElementsMap[name]=cloneName;if(!inline)blockElementsMap[name]={};each(children,function(element,child){if(element[cloneName])element[name]=element[cloneName]})})}function addValidChildren(valid_children){var childRuleRegExp=
/^([+\-]?)(\w+)\[([^\]]+)\]$/;if(valid_children)each(split(valid_children),function(rule){var matches=childRuleRegExp.exec(rule),parent,prefix;if(matches){prefix=matches[1];if(prefix)parent=children[matches[2]];else parent=children[matches[2]]={"#comment":{}};parent=children[matches[2]];each(split(matches[3],"|"),function(child){if(prefix==="-")delete parent[child];else parent[child]={}})}})}function getElementRule(name){var element=elements[name],i;if(element)return element;i=patternElements.length;
while(i--){element=patternElements[i];if(element.pattern.test(name))return element}}if(!settings.valid_elements){each(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder};children[name]=element.children});if(settings.schema!="html5")each(split("strong/b,em/i"),function(item){item=split(item,"/");elements[item[1]].outputName=item[0]});elements.img.attributesDefault=[{name:"alt",value:""}];each(split("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i"),
function(name){if(elements[name])elements[name].removeEmpty=true});each(split("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(name){elements[name].paddEmpty=true})}else setValidElements(settings.valid_elements);addCustomElements(settings.custom_elements);addValidChildren(settings.valid_children);addValidElements(settings.extended_valid_elements);addValidChildren("+ol[ul|ol],+ul[ul|ol]");if(settings.invalid_elements)tinymce.each(tinymce.explode(settings.invalid_elements),function(item){if(elements[item])delete elements[item]});
if(!getElementRule("span"))addValidElements("span[!data-mce-type|*]");self.children=children;self.styles=validStyles;self.getBoolAttrs=function(){return boolAttrMap};self.getBlockElements=function(){return blockElementsMap};self.getShortEndedElements=function(){return shortEndedElementsMap};self.getSelfClosingElements=function(){return selfClosingElementsMap};self.getNonEmptyElements=function(){return nonEmptyElementsMap};self.getWhiteSpaceElements=function(){return whiteSpaceElementsMap};self.isValidChild=
function(name,child){var parent=children[name];return!!(parent&&parent[child])};self.isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule)if(attr){if(rule.attributes[attr])return true;attrPatterns=rule.attributePatterns;if(attrPatterns){i=attrPatterns.length;while(i--)if(attrPatterns[i].pattern.test(name))return true}}else return true;return false};self.getElementRule=getElementRule;self.getCustomElements=function(){return customElementsMap};self.addValidElements=addValidElements;
self.setValidElements=setValidElements;self.addCustomElements=addCustomElements;self.addValidChildren=addValidChildren}})(tinymce);
(function(tinymce){tinymce.html.SaxParser=function(settings,schema){var self=this,noop=function(){};settings=settings||{};self.schema=schema=schema||new tinymce.html.Schema;if(settings.fix_self_closing!==false)settings.fix_self_closing=true;tinymce.each("comment cdata text start end pi doctype".split(" "),function(name){if(name)self[name]=settings[name]||noop});self.parse=function(html){var self=this,matches,index=0,value,endRegExp,stack=[],attrList,i,text,name,isInternalElement,removeInternalElements,
shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,invalidPrefixRegExp,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,idCount=0,decode=tinymce.html.Entities.decode,fixSelfClosing,isIE;function processEndTag(name){var pos,i;pos=stack.length;while(pos--)if(stack[pos].name===name)break;if(pos>=0){for(i=stack.length-1;i>=pos;i--){name=stack[i];if(name.valid)self.end(name.name)}stack.length=
pos}}function parseAttribute(match,name,value,val2,val3){var attrRule,i;name=name.toLowerCase();value=name in fillAttrsMap?name:decode(value||val2||val3||"");if(validate&&!isInternalElement&&name.indexOf("data-")!==0){attrRule=validAttributesMap[name];if(!attrRule&&validAttributePatterns){i=validAttributePatterns.length;while(i--){attrRule=validAttributePatterns[i];if(attrRule.pattern.test(name))break}if(i===-1)attrRule=null}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}attrList.map[name]=
value;attrList.push({name:name,value:value})}tokenRegExp=new RegExp("<(?:"+"(?:!--([\\w\\W]*?)--\>)|"+"(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|"+"(?:!DOCTYPE([\\w\\W]*?)>)|"+"(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|"+"(?:\\/([^>]+)>)|"+"(?:([A-Za-z0-9\\-\\:]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>)"+")","g");attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;specialElements={"script":/<\/script[^>]*>/gi,"style":/<\/style[^>]*>/gi,
"noscript":/<\/noscript[^>]*>/gi};shortEndedElements=schema.getShortEndedElements();selfClosing=settings.self_closing_elements||schema.getSelfClosingElements();fillAttrsMap=schema.getBoolAttrs();validate=settings.validate;removeInternalElements=settings.remove_internals;fixSelfClosing=settings.fix_self_closing;isIE=tinymce.isIE;invalidPrefixRegExp=/^:/;while(matches=tokenRegExp.exec(html)){if(index<matches.index)self.text(decode(html.substr(index,matches.index-index)));if(value=matches[6]){value=
value.toLowerCase();if(isIE&&invalidPrefixRegExp.test(value))value=value.substr(1);processEndTag(value)}else if(value=matches[7]){value=value.toLowerCase();if(isIE&&invalidPrefixRegExp.test(value))value=value.substr(1);isShortEnded=value in shortEndedElements;if(fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value)processEndTag(value);if(!validate||(elementRule=schema.getElementRule(value))){isValidElement=true;if(validate){validAttributesMap=elementRule.attributes;
validAttributePatterns=elementRule.attributePatterns}if(attribsValue=matches[8]){isInternalElement=attribsValue.indexOf("data-mce-type")!==-1;if(isInternalElement&&removeInternalElements)isValidElement=false;attrList=[];attrList.map={};attribsValue.replace(attrRegExp,parseAttribute)}else{attrList=[];attrList.map={}}if(validate&&!isInternalElement){attributesRequired=elementRule.attributesRequired;attributesDefault=elementRule.attributesDefault;attributesForced=elementRule.attributesForced;if(attributesForced){i=
attributesForced.length;while(i--){attr=attributesForced[i];name=attr.name;attrValue=attr.value;if(attrValue==="{$uid}")attrValue="mce_"+idCount++;attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}if(attributesDefault){i=attributesDefault.length;while(i--){attr=attributesDefault[i];name=attr.name;if(!(name in attrList.map)){attrValue=attr.value;if(attrValue==="{$uid}")attrValue="mce_"+idCount++;attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}}if(attributesRequired){i=
attributesRequired.length;while(i--)if(attributesRequired[i]in attrList.map)break;if(i===-1)isValidElement=false}if(attrList.map["data-mce-bogus"])isValidElement=false}if(isValidElement)self.start(value,attrList,isShortEnded)}else isValidElement=false;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length;if(matches=endRegExp.exec(html)){if(isValidElement)text=html.substr(index,matches.index-index);index=matches.index+matches[0].length}else{text=html.substr(index);
index=html.length}if(isValidElement&&text.length>0)self.text(text,true);if(isValidElement)self.end(value);tokenRegExp.lastIndex=index;continue}if(!isShortEnded)if(!attribsValue||attribsValue.indexOf("/")!=attribsValue.length-1)stack.push({name:value,valid:isValidElement});else if(isValidElement)self.end(value)}else if(value=matches[1])self.comment(value);else if(value=matches[2])self.cdata(value);else if(value=matches[3])self.doctype(value);else if(value=matches[4])self.pi(value,matches[5]);index=
matches.index+matches[0].length}if(index<html.length)self.text(decode(html.substr(index)));for(i=stack.length-1;i>=0;i--){value=stack[i];if(value.valid)self.end(value.name)}}}})(tinymce);
(function(tinymce){var whiteSpaceRegExp=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};function walk(node,root_node,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root_node){sibling=node[siblingName];if(sibling)return sibling;for(parent=node.parent;parent&&parent!==root_node;parent=parent.parent){sibling=parent[siblingName];if(sibling)return sibling}}}
function Node(name,type){this.name=name;this.type=type;if(type===1){this.attributes=[];this.attributes.map={}}}tinymce.extend(Node.prototype,{replace:function(node){var self=this;if(node.parent)node.remove();self.insert(node,self);self.remove();return self},attr:function(name,value){var self=this,attrs,i,undef;if(typeof name!=="string"){for(i in name)self.attr(i,name[i]);return self}if(attrs=self.attributes)if(value!==undef){if(value===null){if(name in attrs.map){delete attrs.map[name];i=attrs.length;
while(i--)if(attrs[i].name===name){attrs=attrs.splice(i,1);return self}}return self}if(name in attrs.map){i=attrs.length;while(i--)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});attrs.map[name]=value;return self}else return attrs.map[name]},clone:function(){var self=this,clone=new Node(self.name,self.type),i,l,selfAttrs,selfAttr,cloneAttrs;if(selfAttrs=self.attributes){cloneAttrs=[];cloneAttrs.map={};for(i=0,l=selfAttrs.length;i<l;i++){selfAttr=selfAttrs[i];
if(selfAttr.name!=="id"){cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value};cloneAttrs.map[selfAttr.name]=selfAttr.value}}clone.attributes=cloneAttrs}clone.value=self.value;clone.shortEnded=self.shortEnded;return clone},wrap:function(wrapper){var self=this;self.parent.insert(wrapper,self);wrapper.append(self);return self},unwrap:function(){var self=this,node,next;for(node=self.firstChild;node;){next=node.next;self.insert(node,self,true);node=next}self.remove()},remove:function(){var self=
this,parent=self.parent,next=self.next,prev=self.prev;if(parent){if(parent.firstChild===self){parent.firstChild=next;if(next)next.prev=null}else prev.next=next;if(parent.lastChild===self){parent.lastChild=prev;if(prev)prev.next=null}else next.prev=prev;self.parent=self.next=self.prev=null}return self},append:function(node){var self=this,last;if(node.parent)node.remove();last=self.lastChild;if(last){last.next=node;node.prev=last;self.lastChild=node}else self.lastChild=self.firstChild=node;node.parent=
self;return node},insert:function(node,ref_node,before){var parent;if(node.parent)node.remove();parent=ref_node.parent||this;if(before){if(ref_node===parent.firstChild)parent.firstChild=node;else ref_node.prev.next=node;node.prev=ref_node.prev;node.next=ref_node;ref_node.prev=node}else{if(ref_node===parent.lastChild)parent.lastChild=node;else ref_node.next.prev=node;node.next=ref_node.next;node.prev=ref_node;ref_node.next=node}node.parent=parent;return node},getAll:function(name){var self=this,node,
collection=[];for(node=self.firstChild;node;node=walk(node,self))if(node.name===name)collection.push(node);return collection},empty:function(){var self=this,nodes,i,node;if(self.firstChild){nodes=[];for(node=self.firstChild;node;node=walk(node,self))nodes.push(node);i=nodes.length;while(i--){node=nodes[i];node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}}self.firstChild=self.lastChild=null;return self},isEmpty:function(elements){var self=this,node=self.firstChild,i,name;if(node){do{if(node.type===
1){if(node.attributes.map["data-mce-bogus"])continue;if(elements[node.name])return false;i=node.attributes.length;while(i--){name=node.attributes[i].name;if(name==="name"||name.indexOf("data-")===0)return false}}if(node.type===8)return false;if(node.type===3&&!whiteSpaceRegExp.test(node.value))return false}while(node=walk(node,self))}return true},walk:function(prev){return walk(this,null,prev)}});tinymce.extend(Node,{create:function(name,attrs){var node,attrName;node=new Node(name,typeLookup[name]||
1);if(attrs)for(attrName in attrs)node.attr(attrName,attrs[attrName]);return node}});tinymce.html.Node=Node})(tinymce);
(function(tinymce){var Node=tinymce.html.Node;tinymce.html.DomParser=function(settings,schema){var self=this,nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{};settings.validate="validate"in settings?settings.validate:true;settings.root_name=settings.root_name||"body";self.schema=schema=schema||new tinymce.html.Schema;function fixInvalidChildren(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,childClone,nonEmptyElements,nonSplitableElements,
sibling,nextNode;nonSplitableElements=tinymce.makeMap("tr,td,th,tbody,thead,tfoot,table");nonEmptyElements=schema.getNonEmptyElements();for(ni=0;ni<nodes.length;ni++){node=nodes[ni];if(!node.parent)continue;parents=[node];for(parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&parents.length>1){parents.reverse();newParent=currentNode=self.filterNode(parents[0].clone());for(i=0;i<parents.length-
1;i++){if(schema.isValidChild(currentNode.name,parents[i].name)){tempNode=self.filterNode(parents[i].clone());currentNode.append(tempNode)}else tempNode=currentNode;for(childNode=parents[i].firstChild;childNode&&childNode!=parents[i+1];){nextNode=childNode.next;tempNode.append(childNode);childNode=nextNode}currentNode=tempNode}if(!newParent.isEmpty(nonEmptyElements)){parent.insert(newParent,parents[0],true);parent.insert(node,newParent)}else parent.insert(node,parents[0],true);parent=parents[0];if(parent.isEmpty(nonEmptyElements)||
parent.firstChild===parent.lastChild&&parent.firstChild.name==="br")parent.empty().remove()}else if(node.parent){if(node.name==="li"){sibling=node.prev;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.append(node);continue}sibling=node.next;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.insert(node,sibling.firstChild,true);continue}node.wrap(self.filterNode(new Node("ul",1)));continue}if(schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name))node.wrap(self.filterNode(new Node("div",
1)));else if(node.name==="style"||node.name==="script")node.empty().remove();else node.unwrap()}}}self.filterNode=function(node){var i,name,list;if(name in nodeFilters){list=matchedNodes[name];if(list)list.push(node);else matchedNodes[name]=[node]}i=attributeFilters.length;while(i--){name=attributeFilters[i].name;if(name in node.attributes.map){list=matchedAttributes[name];if(list)list.push(node);else matchedAttributes[name]=[node]}}return node};self.addNodeFilter=function(name,callback){tinymce.each(tinymce.explode(name),
function(name){var list=nodeFilters[name];if(!list)nodeFilters[name]=list=[];list.push(callback)})};self.addAttributeFilter=function(name,callback){tinymce.each(tinymce.explode(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name){attributeFilters[i].callbacks.push(callback);return}attributeFilters.push({name:name,callbacks:[callback]})})};self.parse=function(html,args){var parser,rootNode,node,nodes,i,l,fi,fl,list,name,validate,blockElements,startWhiteSpaceRegExp,
invalidChildren=[],isInWhiteSpacePreservedElement,endWhiteSpaceRegExp,allWhiteSpaceRegExp,isAllWhiteSpaceRegExp,whiteSpaceElements,children,nonEmptyElements,rootBlockName;args=args||{};matchedNodes={};matchedAttributes={};blockElements=tinymce.extend(tinymce.makeMap("script,style,head,html,body,title,meta,param"),schema.getBlockElements());nonEmptyElements=schema.getNonEmptyElements();children=schema.children;validate=settings.validate;rootBlockName="forced_root_block"in args?args.forced_root_block:
settings.forced_root_block;whiteSpaceElements=schema.getWhiteSpaceElements();startWhiteSpaceRegExp=/^[ \t\r\n]+/;endWhiteSpaceRegExp=/[ \t\r\n]+$/;allWhiteSpaceRegExp=/[ \t\r\n]+/g;isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;function addRootBlocks(){var node=rootNode.firstChild,next,rootBlockNode;while(node){next=node.next;if(node.type==3||node.type==1&&node.name!=="p"&&!blockElements[node.name]&&!node.attr("data-mce-type"))if(!rootBlockNode){rootBlockNode=createNode(rootBlockName,1);rootNode.insert(rootBlockNode,
node);rootBlockNode.append(node)}else rootBlockNode.append(node);else rootBlockNode=null;node=next}}function createNode(name,type){var node=new Node(name,type),list;if(name in nodeFilters){list=matchedNodes[name];if(list)list.push(node);else matchedNodes[name]=[node]}return node}function removeWhitespaceBefore(node){var textNode,textVal,sibling;for(textNode=node.prev;textNode&&textNode.type===3;){textVal=textNode.value.replace(endWhiteSpaceRegExp,"");if(textVal.length>0){textNode.value=textVal;textNode=
textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling}}}function cloneAndExcludeBlocks(input){var name,output={};for(name in input)if(name!=="li"&&name!="p")output[name]=input[name];return output}parser=new tinymce.html.SaxParser({validate:validate,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;if(!isInWhiteSpacePreservedElement){text=text.replace(allWhiteSpaceRegExp,
" ");if(node.lastChild&&blockElements[node.lastChild.name])text=text.replace(startWhiteSpaceRegExp,"")}if(text.length!==0){textNode=createNode("#text",3);textNode.raw=!!raw;node.append(textNode).value=text}},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text;removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10));newNode.value=text;removeWhitespaceBefore(node)},
start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,textNode,attrName,text,sibling,parent;elementRule=validate?schema.getElementRule(name):{};if(elementRule){newNode=createNode(elementRule.outputName||name,1);newNode.attributes=attrs;newNode.shortEnded=empty;node.append(newNode);parent=children[node.name];if(parent&&children[newNode.name]&&!parent[newNode.name])invalidChildren.push(newNode);attrFiltersLen=attributeFilters.length;while(attrFiltersLen--){attrName=attributeFilters[attrFiltersLen].name;
if(attrName in attrs.map){list=matchedAttributes[attrName];if(list)list.push(newNode);else matchedAttributes[attrName]=[newNode]}}if(blockElements[name])removeWhitespaceBefore(newNode);if(!empty)node=newNode;if(!isInWhiteSpacePreservedElement&&whiteSpaceElements[name])isInWhiteSpacePreservedElement=true}},end:function(name){var textNode,elementRule,text,sibling,tempNode;elementRule=validate?schema.getElementRule(name):{};if(elementRule){if(blockElements[name]){if(!isInWhiteSpacePreservedElement){textNode=
node.firstChild;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,"");if(text.length>0){textNode.value=text;textNode=textNode.next}else{sibling=textNode.next;textNode.remove();textNode=sibling}while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.next;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}textNode=node.lastChild;if(textNode&&textNode.type===3){text=textNode.value.replace(endWhiteSpaceRegExp,
"");if(text.length>0){textNode.value=text;textNode=textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling}while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.prev;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}}textNode=node.prev;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,"");if(text.length>0)textNode.value=text;else textNode.remove()}}if(isInWhiteSpacePreservedElement&&
whiteSpaceElements[name])isInWhiteSpacePreservedElement=false;if(elementRule.removeEmpty||elementRule.paddEmpty)if(node.isEmpty(nonEmptyElements))if(elementRule.paddEmpty)node.empty().append(new Node("#text","3")).value="\u00a0";else if(!node.attributes.map.name&&!node.attributes.map.id){tempNode=node.parent;node.empty().remove();node=tempNode;return}node=node.parent}}},schema);rootNode=node=new Node(args.context||settings.root_name,11);parser.parse(html);if(validate&&invalidChildren.length)if(!args.context)fixInvalidChildren(invalidChildren);
else args.invalid=true;if(rootBlockName&&rootNode.name=="body")addRootBlocks();if(!args.invalid){for(name in matchedNodes){list=nodeFilters[name];nodes=matchedNodes[name];fi=nodes.length;while(fi--)if(!nodes[fi].parent)nodes.splice(fi,1);for(i=0,l=list.length;i<l;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;i<l;i++){list=attributeFilters[i];if(list.name in matchedAttributes){nodes=matchedAttributes[list.name];fi=nodes.length;while(fi--)if(!nodes[fi].parent)nodes.splice(fi,1);for(fi=
0,fl=list.callbacks.length;fi<fl;fi++)list.callbacks[fi](nodes,list.name,args)}}}return rootNode};if(settings.remove_trailing_brs)self.addNodeFilter("br",function(nodes,name){var i,l=nodes.length,node,blockElements=tinymce.extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),parent,lastParent,prev,prevName;blockElements.body=1;for(i=0;i<l;i++){node=nodes[i];parent=node.parent;if(blockElements[node.parent.name]&&node===parent.lastChild){prev=node.prev;while(prev){prevName=
prev.name;if(prevName!=="span"||prev.attr("data-mce-type")!=="bookmark"){if(prevName!=="br")break;if(prevName==="br"){node=null;break}}prev=prev.prev}if(node){node.remove();if(parent.isEmpty(nonEmptyElements)){elementRule=schema.getElementRule(parent.name);if(elementRule)if(elementRule.removeEmpty)parent.remove();else if(elementRule.paddEmpty)parent.empty().append(new tinymce.html.Node("#text",3)).value="\u00a0"}}}else{lastParent=node;while(parent.firstChild===lastParent&&parent.lastChild===lastParent){lastParent=
parent;if(blockElements[parent.name])break;parent=parent.parent}if(lastParent===parent){textNode=new tinymce.html.Node("#text",3);textNode.value="\u00a0";node.replace(textNode)}}}});if(!settings.allow_html_in_named_anchor)self.addAttributeFilter("id,name",function(nodes,name){var i=nodes.length,sibling,prevSibling,parent,node;while(i--){node=nodes[i];if(node.name==="a"&&node.firstChild&&!node.attr("href")){parent=node.parent;sibling=node.lastChild;do{prevSibling=sibling.prev;parent.insert(sibling,
node);sibling=prevSibling}while(sibling)}}})}})(tinymce);
tinymce.html.Writer=function(settings){var html=[],indent,indentBefore,indentAfter,encode,htmlOutput;settings=settings||{};indent=settings.indent;indentBefore=tinymce.makeMap(settings.indent_before||"");indentAfter=tinymce.makeMap(settings.indent_after||"");encode=tinymce.html.Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities);htmlOutput=settings.element_format=="html";return{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0){value=
html[html.length-1];if(value.length>0&&value!=="\n")html.push("\n")}html.push("<",name);if(attrs)for(i=0,l=attrs.length;i<l;i++){attr=attrs[i];html.push(" ",attr.name,'="',encode(attr.value,true),'"')}if(!empty||htmlOutput)html[html.length]=">";else html[html.length]=" />";if(empty&&indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n")html.push("\n")}},end:function(name){var value;html.push("</",name,">");if(indent&&indentAfter[name]&&html.length>0){value=
html[html.length-1];if(value.length>0&&value!=="\n")html.push("\n")}},text:function(text,raw){if(text.length>0)html[html.length]=raw?text:encode(text)},cdata:function(text){html.push("<![CDATA[",text,"]]\>")},comment:function(text){html.push("<\!--",text,"--\>")},pi:function(name,text){if(text)html.push("<?",name," ",text,"?>");else html.push("<?",name,"?>");if(indent)html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,
"")}}};
(function(tinymce){tinymce.html.Serializer=function(settings,schema){var self=this,writer=new tinymce.html.Writer(settings);settings=settings||{};settings.validate="validate"in settings?settings.validate:true;self.schema=schema=schema||new tinymce.html.Schema;self.writer=writer;self.serialize=function(node){var handlers,validate;validate=settings.validate;handlers={3:function(node,raw){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},
10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild){do walk(node);while(node=node.next)}}};writer.reset();function walk(node){var handler=handlers[node.type],name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule;if(!handler){name=node.name;isEmpty=node.shortEnded;attrs=node.attributes;if(validate&&attrs&&attrs.length>1){sortedAttrs=[];sortedAttrs.map={};elementRule=schema.getElementRule(node.name);for(i=0,
l=elementRule.attributesOrder.length;i<l;i++){attrName=elementRule.attributesOrder[i];if(attrName in attrs.map){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}for(i=0,l=attrs.length;i<l;i++){attrName=attrs[i].name;if(!(attrName in sortedAttrs.map)){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}attrs=sortedAttrs}writer.start(node.name,attrs,isEmpty);if(!isEmpty){if(node=
node.firstChild){do walk(node);while(node=node.next)}writer.end(name)}}else handler(node)}if(node.type==1&&!settings.inner)walk(node);else handlers[11](node);return writer.getContent()}}})(tinymce);tinymce.dom={};
(function(namespace,expando){var w3cEventModel=!!document.addEventListener;function addEvent(target,name,callback,capture){if(target.addEventListener)target.addEventListener(name,callback,capture||false);else if(target.attachEvent)target.attachEvent("on"+name,callback)}function removeEvent(target,name,callback,capture){if(target.removeEventListener)target.removeEventListener(name,callback,capture||false);else if(target.detachEvent)target.detachEvent("on"+name,callback)}function fix(original_event,
data){var name,event=data||{};function returnFalse(){return false}function returnTrue(){return true}for(name in original_event)if(name!=="layerX"&&name!=="layerY")event[name]=original_event[name];if(!event.target)event.target=event.srcElement||document;event.preventDefault=function(){event.isDefaultPrevented=returnTrue;if(original_event)if(original_event.preventDefault)original_event.preventDefault();else original_event.returnValue=false};event.stopPropagation=function(){event.isPropagationStopped=
returnTrue;if(original_event)if(original_event.stopPropagation)original_event.stopPropagation();else original_event.cancelBubble=true};event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue;event.stopPropagation()};if(!event.isDefaultPrevented){event.isDefaultPrevented=returnFalse;event.isPropagationStopped=returnFalse;event.isImmediatePropagationStopped=returnFalse}return event}function bindOnReady(win,callback,event_utils){var doc=win.document,event={type:"ready"};
function readyHandler(){if(!event_utils.domLoaded){event_utils.domLoaded=true;callback(event)}}if(w3cEventModel)addEvent(win,"DOMContentLoaded",readyHandler);else{addEvent(doc,"readystatechange",function(){if(doc.readyState==="complete"){removeEvent(doc,"readystatechange",arguments.callee);readyHandler()}});if(doc.documentElement.doScroll&&win===win.top)(function(){try{doc.documentElement.doScroll("left")}catch(ex){setTimeout(arguments.callee,0);return}readyHandler()})()}addEvent(win,"load",readyHandler)}
function EventUtils(proxy){var self=this,events={},count,isFocusBlurBound,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave;hasMouseEnterLeave="onmouseenter"in document.documentElement;hasFocusIn="onfocusin"in document.documentElement;mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"};count=1;self.domLoaded=false;self.events=events;function executeHandlers(evt,id){var callbackList,i,l,callback;callbackList=events[id][evt.type];if(callbackList)for(i=0,l=callbackList.length;i<l;i++){callback=
callbackList[i];if(callback&&callback.func.call(callback.scope,evt)===false)evt.preventDefault();if(evt.isImmediatePropagationStopped())return}}self.bind=function(target,names,callback,scope){var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window;function defaultNativeHandler(evt){executeHandlers(fix(evt||win.event),id)}if(!target||target.nodeType===3||target.nodeType===8)return;if(!target[expando]){id=count++;target[expando]=id;events[id]={}}else{id=target[expando];if(!events[id])events[id]=
{}}scope=scope||target;names=names.split(" ");i=names.length;while(i--){name=names[i];nativeHandler=defaultNativeHandler;fakeName=capture=false;if(name==="DOMContentLoaded")name="ready";if((self.domLoaded||target.readyState=="complete")&&name==="ready"){self.domLoaded=true;callback.call(scope,fix({type:name}));continue}if(!hasMouseEnterLeave){fakeName=mouseEnterLeave[name];if(fakeName)nativeHandler=function(evt){var current,related;current=evt.currentTarget;related=evt.relatedTarget;if(related&&current.contains)related=
current.contains(related);else while(related&&related!==current)related=related.parentNode;if(!related){evt=fix(evt||win.event);evt.type=evt.type==="mouseout"?"mouseleave":"mouseenter";evt.target=current;executeHandlers(evt,id)}}}if(!hasFocusIn&&(name==="focusin"||name==="focusout")){capture=true;fakeName=name==="focusin"?"focus":"blur";nativeHandler=function(evt){evt=fix(evt||win.event);evt.type=evt.type==="focus"?"focusin":"focusout";executeHandlers(evt,id)}}callbackList=events[id][name];if(!callbackList){events[id][name]=
callbackList=[{func:callback,scope:scope}];callbackList.fakeName=fakeName;callbackList.capture=capture;callbackList.nativeHandler=nativeHandler;if(!w3cEventModel)callbackList.proxyHandler=proxy(id);if(name==="ready")bindOnReady(target,nativeHandler,self);else addEvent(target,fakeName||name,w3cEventModel?nativeHandler:callbackList.proxyHandler,capture)}else callbackList.push({func:callback,scope:scope})}target=callbackList=0;return callback};self.unbind=function(target,names,callback){var id,callbackList,
i,ci,name,eventMap;if(!target||target.nodeType===3||target.nodeType===8)return self;id=target[expando];if(id){eventMap=events[id];if(names){names=names.split(" ");i=names.length;while(i--){name=names[i];callbackList=eventMap[name];if(callbackList){if(callback){ci=callbackList.length;while(ci--)if(callbackList[ci].func===callback)callbackList.splice(ci,1)}if(!callback||callbackList.length===0){delete eventMap[name];removeEvent(target,callbackList.fakeName||name,w3cEventModel?callbackList.nativeHandler:
callbackList.proxyHandler,callbackList.capture)}}}}else{for(name in eventMap){callbackList=eventMap[name];removeEvent(target,callbackList.fakeName||name,w3cEventModel?callbackList.nativeHandler:callbackList.proxyHandler,callbackList.capture)}eventMap={}}for(name in eventMap)return self;delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self};self.fire=function(target,name,args){var id,event;if(!target||target.nodeType===3||target.nodeType===8)return self;event=fix(null,
args);event.type=name;do{id=target[expando];if(id)executeHandlers(event,id);target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow}while(target&&!event.isPropagationStopped());return self};self.clean=function(target){var i,children,unbind=self.unbind;if(!target||target.nodeType===3||target.nodeType===8)return self;if(target[expando])unbind(target);if(!target.getElementsByTagName)target=target.document;if(target&&target.getElementsByTagName){unbind(target);children=
target.getElementsByTagName("*");i=children.length;while(i--){target=children[i];if(target[expando])unbind(target)}}return self};self.callNativeHandler=function(id,evt){if(events)events[id][evt.type].nativeHandler(evt)};self.destory=function(){events={}};self.add=function(target,events,func,scope){if(typeof target==="string")target=document.getElementById(target);if(target&&target instanceof Array){var i=target.length;while(i--)self.add(target[i],events,func,scope);return}if(events==="init")events=
"ready";return self.bind(target,events instanceof Array?events.join(" "):events,func,scope)};self.remove=function(target,events,func,scope){if(!target)return self;if(typeof target==="string")target=document.getElementById(target);if(target instanceof Array){var i=target.length;while(i--)self.remove(target[i],events,func,scope);return self}return self.unbind(target,events instanceof Array?events.join(" "):events,func)};self.clear=function(target){if(typeof target==="string")target=document.getElementById(target);
return self.clean(target)};self.cancel=function(e){if(e){self.prevent(e);self.stop(e)}return false};self.prevent=function(e){if(!e.preventDefault)e=fix(e);e.preventDefault();return false};self.stop=function(e){if(!e.stopPropagation)e=fix(e);e.stopPropagation();return false}}namespace.EventUtils=EventUtils;namespace.Event=new EventUtils(function(id){return function(evt){tinymce.dom.Event.callNativeHandler(id,evt)}});namespace.Event.bind(window,"ready",function(){});namespace=0})(tinymce.dom,"data-mce-expando");
tinymce.dom.TreeWalker=function(start_node,root_node){var node=start_node;function findSibling(node,start_name,sibling_name,shallow){var sibling,parent;if(node){if(!shallow&&node[start_name])return node[start_name];if(node!=root_node){sibling=node[sibling_name];if(sibling)return sibling;for(parent=node.parentNode;parent&&parent!=root_node;parent=parent.parentNode){sibling=parent[sibling_name];if(sibling)return sibling}}}}this.current=function(){return node};this.next=function(shallow){return node=
findSibling(node,"firstChild","nextSibling",shallow)};this.prev=function(shallow){return node=findSibling(node,"lastChild","previousSibling",shallow)}};
(function(tinymce){var each=tinymce.each,is=tinymce.is,isWebKit=tinymce.isWebKit,isIE=tinymce.isIE,Entities=tinymce.html.Entities,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp=/^[ \t\r\n]*$/;tinymce.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",
id:"id",name:"name",type:"type"},DOMUtils:function(d,s){var t=this,globalStyle,name,blockElementsMap;t.doc=d;t.win=window;t.files={};t.cssFlicker=false;t.counter=0;t.stdMode=!tinymce.isIE||d.documentMode>=8;t.boxModel=!tinymce.isIE||d.compatMode=="CSS1Compat"||t.stdMode;t.hasOuterHTML="outerHTML"in d.createElement("a");t.settings=s=tinymce.extend({keep_values:false,hex_colors:1},s);t.schema=s.schema;t.styles=new tinymce.html.Styles({url_converter:s.url_converter,url_converter_scope:s.url_converter_scope},
s.schema);if(tinymce.isIE6)try{d.execCommand("BackgroundImageCache",false,true)}catch(e){t.cssFlicker=true}t.fixDoc(d);t.events=s.ownEvents?new tinymce.dom.EventUtils(s.proxy):tinymce.dom.Event;tinymce.addUnload(t.destroy,t);blockElementsMap=s.schema?s.schema.getBlockElements():{};t.isBlock=function(node){var type=node.nodeType;if(type)return!!(type===1&&blockElementsMap[node.nodeName]);return!!blockElementsMap[node]}},fixDoc:function(doc){var settings=this.settings,name;if(isIE&&settings.schema){("abbr article aside audio canvas "+
"details figcaption figure footer "+"header hgroup mark menu meter nav "+"output progress section summary "+"time video").replace(/\w+/g,function(name){doc.createElement(name)});for(name in settings.schema.getCustomElements())doc.createElement(name)}},clone:function(node,deep){var self=this,clone,doc;if(!isIE||node.nodeType!==1||deep)return node.cloneNode(deep);doc=self.doc;if(!deep){clone=doc.createElement(node.nodeName);each(self.getAttribs(node),function(attr){self.setAttrib(clone,attr.nodeName,
self.getAttrib(node,attr.nodeName))});return clone}return clone.firstChild},getRoot:function(){var t=this,s=t.settings;return s&&t.get(s.root_element)||t.doc.body},getViewPort:function(w){var d,b;w=!w?this.win:w;d=w.document;b=this.boxModel?d.documentElement:d.body;return{x:w.pageXOffset||b.scrollLeft,y:w.pageYOffset||b.scrollTop,w:w.innerWidth||b.clientWidth,h:w.innerHeight||b.clientHeight}},getRect:function(e){var p,t=this,sr;e=t.get(e);p=t.getPos(e);sr=t.getSize(e);return{x:p.x,y:p.y,w:sr.w,h:sr.h}},
getSize:function(e){var t=this,w,h;e=t.get(e);w=t.getStyle(e,"width");h=t.getStyle(e,"height");if(w.indexOf("px")===-1)w=0;if(h.indexOf("px")===-1)h=0;return{w:parseInt(w,10)||e.offsetWidth||e.clientWidth,h:parseInt(h,10)||e.offsetHeight||e.clientHeight}},getParent:function(n,f,r){return this.getParents(n,f,r,false)},getParents:function(n,f,r,c){var t=this,na,se=t.settings,o=[];n=t.get(n);c=c===undefined;if(se.strict_root)r=r||t.getRoot();if(is(f,"string")){na=f;if(f==="*")f=function(n){return n.nodeType==
1};else f=function(n){return t.is(n,na)}}while(n){if(n==r||!n.nodeType||n.nodeType===9)break;if(!f||f(n))if(c)o.push(n);else return n;n=n.parentNode}return c?o:null},get:function(e){var n;if(e&&this.doc&&typeof e=="string"){n=e;e=this.doc.getElementById(e);if(e&&e.id!==n)return this.doc.getElementsByName(n)[1]}return e},getNext:function(node,selector){return this._findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return this._findSib(node,selector,"previousSibling")},select:function(pa,
s){var t=this;return tinymce.dom.Sizzle(pa,t.get(s)||t.get(t.settings.root_element)||t.doc,[])},is:function(n,selector){var i;if(n.length===undefined){if(selector==="*")return n.nodeType==1;if(simpleSelectorRe.test(selector)){selector=selector.toLowerCase().split(/,/);n=n.nodeName.toLowerCase();for(i=selector.length-1;i>=0;i--)if(selector[i]==n)return true;return false}}return tinymce.dom.Sizzle.matches(selector,n.nodeType?[n]:n).length>0},add:function(p,n,a,h,c){var t=this;return this.run(p,function(p){var e,
k;e=is(n,"string")?t.doc.createElement(n):n;t.setAttribs(e,a);if(h)if(h.nodeType)e.appendChild(h);else t.setHTML(e,h);return!c?p.appendChild(e):e})},create:function(n,a,h){return this.add(this.doc.createElement(n),n,a,h,1)},createHTML:function(n,a,h){var o="",t=this,k;o+="<"+n;for(k in a)if(a.hasOwnProperty(k))o+=" "+k+'="'+t.encode(a[k])+'"';if(typeof h!="undefined")return o+">"+h+"</"+n+">";return o+" />"},remove:function(node,keep_children){return this.run(node,function(node){var child,parent=
node.parentNode;if(!parent)return null;if(keep_children)while(child=node.firstChild)if(!tinymce.isIE||child.nodeType!==3||child.nodeValue)parent.insertBefore(child,node);else node.removeChild(child);return parent.removeChild(node)})},setStyle:function(n,na,v){var t=this;return t.run(n,function(e){var s,i;s=e.style;na=na.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(t.pixelStyles.test(na)&&(tinymce.is(v,"number")||/^[\-0-9\.]+$/.test(v)))v+="px";switch(na){case "opacity":if(isIE){s.filter=
v===""?"":"alpha(opacity="+v*100+")";if(!n.currentStyle||!n.currentStyle.hasLayout)s.display="inline-block"}s[na]=s["-moz-opacity"]=s["-khtml-opacity"]=v||"";break;case "float":isIE?s.styleFloat=v:s.cssFloat=v;break;default:s[na]=v||""}if(t.settings.update_styles)t.setAttrib(e,"data-mce-style")})},getStyle:function(n,na,c){n=this.get(n);if(!n)return;if(this.doc.defaultView&&c){na=na.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(n,null).getPropertyValue(na)}catch(ex){return null}}na=
na.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(na=="float")na=isIE?"styleFloat":"cssFloat";if(n.currentStyle&&c)return n.currentStyle[na];return n.style?n.style[na]:undefined},setStyles:function(e,o){var t=this,s=t.settings,ol;ol=s.update_styles;s.update_styles=0;each(o,function(v,n){t.setStyle(e,n,v)});s.update_styles=ol;if(s.update_styles)t.setAttrib(e,s.cssText)},removeAllAttribs:function(e){return this.run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--)e.removeAttributeNode(attrs.item(i))})},
setAttrib:function(e,n,v){var t=this;if(!e||!n)return;if(t.settings.strict)n=n.toLowerCase();return this.run(e,function(e){var s=t.settings;var originalValue=e.getAttribute(n);if(v!==null)switch(n){case "style":if(!is(v,"string")){each(v,function(v,n){t.setStyle(e,n,v)});return}if(s.keep_values)if(v&&!t._isRes(v))e.setAttribute("data-mce-style",v,2);else e.removeAttribute("data-mce-style",2);e.style.cssText=v;break;case "class":e.className=v||"";break;case "src":case "href":if(s.keep_values){if(s.url_converter)v=
s.url_converter.call(s.url_converter_scope||t,v,n,e);t.setAttrib(e,"data-mce-"+n,v,2)}break;case "shape":e.setAttribute("data-mce-style",v);break}if(is(v)&&v!==null&&v.length!==0)e.setAttribute(n,""+v,2);else e.removeAttribute(n,2);if(tinyMCE.activeEditor&&originalValue!=v){var ed=tinyMCE.activeEditor;ed.onSetAttrib.dispatch(ed,e,n,v)}})},setAttribs:function(e,o){var t=this;return this.run(e,function(e){each(o,function(v,n){t.setAttrib(e,n,v)})})},getAttrib:function(e,n,dv){var v,t=this,undef;e=t.get(e);
if(!e||e.nodeType!==1)return dv===undef?false:dv;if(!is(dv))dv="";if(/^(src|href|style|coords|shape)$/.test(n)){v=e.getAttribute("data-mce-"+n);if(v)return v}if(isIE&&t.props[n]){v=e[t.props[n]];v=v&&v.nodeValue?v.nodeValue:v}if(!v)v=e.getAttribute(n,2);if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(n)){if(e[t.props[n]]===true&&v==="")return n;return v?n:""}if(e.nodeName==="FORM"&&e.getAttributeNode(n))return e.getAttributeNode(n).nodeValue;
if(n==="style"){v=v||e.style.cssText;if(v){v=t.serializeStyle(t.parseStyle(v),e.nodeName);if(t.settings.keep_values&&!t._isRes(v))e.setAttribute("data-mce-style",v)}}if(isWebKit&&n==="class"&&v)v=v.replace(/(apple|webkit)\-[a-z\-]+/gi,"");if(isIE)switch(n){case "rowspan":case "colspan":if(v===1)v="";break;case "size":if(v==="+0"||v===20||v===0)v="";break;case "width":case "height":case "vspace":case "checked":case "disabled":case "readonly":if(v===0)v="";break;case "hspace":if(v===-1)v="";break;case "maxlength":case "tabindex":if(v===
32768||v===2147483647||v==="32768")v="";break;case "multiple":case "compact":case "noshade":case "nowrap":if(v===65535)return n;return dv;case "shape":v=v.toLowerCase();break;default:if(n.indexOf("on")===0&&v)v=tinymce._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+v)}return v!==undef&&v!==null&&v!==""?""+v:dv},getPos:function(n,ro){var t=this,x=0,y=0,e,d=t.doc,r;n=t.get(n);ro=ro||d.body;if(n){if(n.getBoundingClientRect){n=n.getBoundingClientRect();e=t.boxModel?d.documentElement:d.body;
x=n.left+(d.documentElement.scrollLeft||d.body.scrollLeft)-e.clientTop;y=n.top+(d.documentElement.scrollTop||d.body.scrollTop)-e.clientLeft;return{x:x,y:y}}r=n;while(r&&r!=ro&&r.nodeType){x+=r.offsetLeft||0;y+=r.offsetTop||0;r=r.offsetParent}r=n.parentNode;while(r&&r!=ro&&r.nodeType){x-=r.scrollLeft||0;y-=r.scrollTop||0;r=r.parentNode}}return{x:x,y:y}},parseStyle:function(st){return this.styles.parse(st)},serializeStyle:function(o,name){return this.styles.serialize(o,name)},addStyle:function(cssText){var doc=
this.doc,head;styleElm=doc.getElementById("mceDefaultStyles");if(!styleElm){styleElm=doc.createElement("style"),styleElm.id="mceDefaultStyles";styleElm.type="text/css";head=doc.getElementsByTagName("head")[0];if(head.firstChild)head.insertBefore(styleElm,head.firstChild);else head.appendChild(styleElm)}if(styleElm.styleSheet)styleElm.styleSheet.cssText+=cssText;else styleElm.appendChild(doc.createTextNode(cssText))},loadCSS:function(u){var t=this,d=t.doc,head;if(!u)u="";head=d.getElementsByTagName("head")[0];
each(u.split(","),function(u){var link;if(t.files[u])return;t.files[u]=true;link=t.create("link",{rel:"stylesheet",href:tinymce._addVer(u)});if(isIE&&d.documentMode&&d.recalc)link.onload=function(){if(d.recalc)d.recalc();link.onload=null};head.appendChild(link)})},addClass:function(e,c){return this.run(e,function(e){var o;if(!c)return 0;if(this.hasClass(e,c))return e.className;o=this.removeClass(e,c);return e.className=(o!=""?o+" ":"")+c})},removeClass:function(e,c){var t=this,re;return t.run(e,function(e){var v;
if(t.hasClass(e,c)){if(!re)re=new RegExp("(^|\\s+)"+c+"(\\s+|$)","g");v=e.className.replace(re," ");v=tinymce.trim(v!=" "?v:"");e.className=v;if(!v){e.removeAttribute("class");e.removeAttribute("className")}return v}return e.className})},hasClass:function(n,c){n=this.get(n);if(!n||!c)return false;return(" "+n.className+" ").indexOf(" "+c+" ")!==-1},show:function(e){return this.setStyle(e,"display","block")},hide:function(e){return this.setStyle(e,"display","none")},isHidden:function(e){e=this.get(e);
return!e||e.style.display=="none"||this.getStyle(e,"display")=="none"},uniqueId:function(p){return(!p?"mce_":p)+this.counter++},setHTML:function(element,html){var self=this;return self.run(element,function(element){if(isIE){while(element.firstChild)element.removeChild(element.firstChild);try{element.innerHTML="<br />"+html;element.removeChild(element.firstChild)}catch(ex){var newElement=self.create("div");newElement.innerHTML="<br />"+html;each(tinymce.grep(newElement.childNodes),function(node,i){if(i&&
element.canHaveHTML)element.appendChild(node)})}}else element.innerHTML=html;return html})},getOuterHTML:function(elm){var doc,self=this;elm=self.get(elm);if(!elm)return null;if(elm.nodeType===1&&self.hasOuterHTML)return elm.outerHTML;doc=(elm.ownerDocument||self.doc).createElement("body");doc.appendChild(elm.cloneNode(true));return doc.innerHTML},setOuterHTML:function(e,h,d){var t=this;function setHTML(e,h,d){var n,tp;tp=d.createElement("body");tp.innerHTML=h;n=tp.lastChild;while(n){t.insertAfter(n.cloneNode(true),
e);n=n.previousSibling}t.remove(e)}return this.run(e,function(e){e=t.get(e);if(e.nodeType==1){d=d||e.ownerDocument||t.doc;if(isIE)try{if(isIE&&e.nodeType==1)e.outerHTML=h;else setHTML(e,h,d)}catch(ex){setHTML(e,h,d)}else setHTML(e,h,d)}})},decode:Entities.decode,encode:Entities.encodeAllRaw,insertAfter:function(node,reference_node){reference_node=this.get(reference_node);return this.run(node,function(node){var parent,nextSibling;parent=reference_node.parentNode;nextSibling=reference_node.nextSibling;
if(nextSibling)parent.insertBefore(node,nextSibling);else parent.appendChild(node);return node})},replace:function(n,o,k){var t=this;if(is(o,"array"))n=n.cloneNode(true);return t.run(o,function(o){if(k)each(tinymce.grep(o.childNodes),function(c){n.appendChild(c)});return o.parentNode.replaceChild(n,o)})},rename:function(elm,name){var t=this,newElm;if(elm.nodeName!=name.toUpperCase()){newElm=t.create(name);each(t.getAttribs(elm),function(attr_node){t.setAttrib(newElm,attr_node.nodeName,t.getAttrib(elm,
attr_node.nodeName))});t.replace(newElm,elm,1)}return newElm||elm},findCommonAncestor:function(a,b){var ps=a,pe;while(ps){pe=b;while(pe&&ps!=pe)pe=pe.parentNode;if(ps==pe)break;ps=ps.parentNode}if(!ps&&a.ownerDocument)return a.ownerDocument.documentElement;return ps},toHex:function(s){var c=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(s);function hex(s){s=parseInt(s,10).toString(16);return s.length>1?s:"0"+s}if(c){s="#"+hex(c[1])+hex(c[2])+hex(c[3]);return s}return s},
getClasses:function(){var t=this,cl=[],i,lo={},f=t.settings.class_filter,ov;if(t.classes)return t.classes;function addClasses(s){each(s.imports,function(r){addClasses(r)});each(s.cssRules||s.rules,function(r){switch(r.type||1){case 1:if(r.selectorText)each(r.selectorText.split(","),function(v){v=v.replace(/^\s*|\s*$|^\s\./g,"");if(/\.mce/.test(v)||!/\.[\w\-]+$/.test(v))return;ov=v;v=tinymce._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",v);if(f&&!(v=f(v,ov)))return;if(!lo[v]){cl.push({"class":v});lo[v]=1}});
break;case 3:addClasses(r.styleSheet);break}})}try{each(t.doc.styleSheets,addClasses)}catch(ex){}if(cl.length>0)t.classes=cl;return cl},run:function(e,f,s){var t=this,o;if(t.doc&&typeof e==="string")e=t.get(e);if(!e)return false;s=s||this;if(!e.nodeType&&(e.length||e.length===0)){o=[];each(e,function(e,i){if(e){if(typeof e=="string")e=t.doc.getElementById(e);o.push(f.call(s,e,i))}});return o}return f.call(s,e)},getAttribs:function(n){var o;n=this.get(n);if(!n)return[];if(isIE){o=[];if(n.nodeName==
"OBJECT")return n.attributes;if(n.nodeName==="OPTION"&&this.getAttrib(n,"selected"))o.push({specified:1,nodeName:"selected"});n.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(a){o.push({specified:1,nodeName:a})});return o}return n.attributes},isEmpty:function(node,elements){var self=this,i,attributes,type,walker,name,brCount=0;node=node.firstChild;if(node){walker=new tinymce.dom.TreeWalker(node,node.parentNode);elements=
elements||self.schema?self.schema.getNonEmptyElements():null;do{type=node.nodeType;if(type===1){if(node.getAttribute("data-mce-bogus"))continue;name=node.nodeName.toLowerCase();if(elements&&elements[name]){if(name==="br"){brCount++;continue}return false}attributes=self.getAttribs(node);i=node.attributes.length;while(i--){name=node.attributes[i].nodeName;if(name==="name"||name==="data-mce-bookmark")return false}}if(type==8)return false;if(type===3&&!whiteSpaceRegExp.test(node.nodeValue))return false}while(node=
walker.next())}return brCount<=1},destroy:function(s){var t=this;t.win=t.doc=t.root=t.events=t.frag=null;if(!s)tinymce.removeUnload(t.destroy)},createRng:function(){var d=this.doc;return d.createRange?d.createRange():new tinymce.dom.Range(this)},nodeIndex:function(node,normalized){var idx=0,lastNodeType,lastNode,nodeType;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling,lastNode=node;node;node=node.previousSibling){nodeType=node.nodeType;if(normalized&&nodeType==3)if(nodeType==lastNodeType||
!node.nodeValue.length)continue;idx++;lastNodeType=nodeType}return idx},split:function(pe,e,re){var t=this,r=t.createRng(),bef,aft,pa;function trim(node){var i,children=node.childNodes,type=node.nodeType;function surroundedBySpans(node){var previousIsSpan=node.previousSibling&&node.previousSibling.nodeName=="SPAN";var nextIsSpan=node.nextSibling&&node.nextSibling.nodeName=="SPAN";return previousIsSpan&&nextIsSpan}if(type==1&&node.getAttribute("data-mce-type")=="bookmark")return;for(i=children.length-
1;i>=0;i--)trim(children[i]);if(type!=9){if(type==3&&node.nodeValue.length>0){var trimmedLength=tinymce.trim(node.nodeValue).length;if(!t.isBlock(node.parentNode)||trimmedLength>0||trimmedLength===0&&surroundedBySpans(node))return}else if(type==1){children=node.childNodes;if(children.length==1&&children[0]&&children[0].nodeType==1&&children[0].getAttribute("data-mce-type")=="bookmark")node.parentNode.insertBefore(children[0],node);if(children.length||/^(br|hr|input|img)$/i.test(node.nodeName))return}t.remove(node)}return node}
if(pe&&e){r.setStart(pe.parentNode,t.nodeIndex(pe));r.setEnd(e.parentNode,t.nodeIndex(e));bef=r.extractContents();r=t.createRng();r.setStart(e.parentNode,t.nodeIndex(e)+1);r.setEnd(pe.parentNode,t.nodeIndex(pe)+1);aft=r.extractContents();pa=pe.parentNode;pa.insertBefore(trim(bef),pe);if(re)pa.replaceChild(re,e);else pa.insertBefore(e,pe);pa.insertBefore(trim(aft),pe);t.remove(pe);return re||e}},bind:function(target,name,func,scope){return this.events.add(target,name,func,scope||this)},unbind:function(target,
name,func){return this.events.remove(target,name,func)},fire:function(target,name,evt){return this.events.fire(target,name,evt)},getContentEditable:function(node){var contentEditable;if(node.nodeType!=1)return null;contentEditable=node.getAttribute("data-mce-contenteditable");if(contentEditable&&contentEditable!=="inherit")return contentEditable;return node.contentEditable!=="inherit"?node.contentEditable:null},_findSib:function(node,selector,name){var t=this,f=selector;if(node){if(is(f,"string"))f=
function(node){return t.is(node,selector)};for(node=node[name];node;node=node[name])if(f(node))return node}return null},_isRes:function(c){return/^(top|left|bottom|right|width|height)/i.test(c)||/;\s*(top|left|bottom|right|width|height)/i.test(c)}});tinymce.DOM=new tinymce.dom.DOMUtils(document,{process_html:0})})(tinymce);
(function(ns){function Range(dom){var t=this,doc=dom.doc,EXTRACT=0,CLONE=1,DELETE=2,TRUE=true,FALSE=false,START_OFFSET="startOffset",START_CONTAINER="startContainer",END_CONTAINER="endContainer",END_OFFSET="endOffset",extend=tinymce.extend,nodeIndex=dom.nodeIndex;extend(t,{startContainer:doc,startOffset:0,endContainer:doc,endOffset:0,collapsed:TRUE,commonAncestorContainer:doc,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:setStart,setEnd:setEnd,setStartBefore:setStartBefore,
setStartAfter:setStartAfter,setEndBefore:setEndBefore,setEndAfter:setEndAfter,collapse:collapse,selectNode:selectNode,selectNodeContents:selectNodeContents,compareBoundaryPoints:compareBoundaryPoints,deleteContents:deleteContents,extractContents:extractContents,cloneContents:cloneContents,insertNode:insertNode,surroundContents:surroundContents,cloneRange:cloneRange,toStringIE:toStringIE});function createDocumentFragment(){return doc.createDocumentFragment()}function setStart(n,o){_setEndPoint(TRUE,
n,o)}function setEnd(n,o){_setEndPoint(FALSE,n,o)}function setStartBefore(n){setStart(n.parentNode,nodeIndex(n))}function setStartAfter(n){setStart(n.parentNode,nodeIndex(n)+1)}function setEndBefore(n){setEnd(n.parentNode,nodeIndex(n))}function setEndAfter(n){setEnd(n.parentNode,nodeIndex(n)+1)}function collapse(ts){if(ts){t[END_CONTAINER]=t[START_CONTAINER];t[END_OFFSET]=t[START_OFFSET]}else{t[START_CONTAINER]=t[END_CONTAINER];t[START_OFFSET]=t[END_OFFSET]}t.collapsed=TRUE}function selectNode(n){setStartBefore(n);
setEndAfter(n)}function selectNodeContents(n){setStart(n,0);setEnd(n,n.nodeType===1?n.childNodes.length:n.nodeValue.length)}function compareBoundaryPoints(h,r){var sc=t[START_CONTAINER],so=t[START_OFFSET],ec=t[END_CONTAINER],eo=t[END_OFFSET],rsc=r.startContainer,rso=r.startOffset,rec=r.endContainer,reo=r.endOffset;if(h===0)return _compareBoundaryPoints(sc,so,rsc,rso);if(h===1)return _compareBoundaryPoints(ec,eo,rsc,rso);if(h===2)return _compareBoundaryPoints(ec,eo,rec,reo);if(h===3)return _compareBoundaryPoints(sc,
so,rec,reo)}function deleteContents(){_traverse(DELETE)}function extractContents(){return _traverse(EXTRACT)}function cloneContents(){return _traverse(CLONE)}function insertNode(n){var startContainer=this[START_CONTAINER],startOffset=this[START_OFFSET],nn,o;if((startContainer.nodeType===3||startContainer.nodeType===4)&&startContainer.nodeValue)if(!startOffset)startContainer.parentNode.insertBefore(n,startContainer);else if(startOffset>=startContainer.nodeValue.length)dom.insertAfter(n,startContainer);
else{nn=startContainer.splitText(startOffset);startContainer.parentNode.insertBefore(n,nn)}else{if(startContainer.childNodes.length>0)o=startContainer.childNodes[startOffset];if(o)startContainer.insertBefore(n,o);else startContainer.appendChild(n)}}function surroundContents(n){var f=t.extractContents();t.insertNode(n);n.appendChild(f);t.selectNode(n)}function cloneRange(){return extend(new Range(dom),{startContainer:t[START_CONTAINER],startOffset:t[START_OFFSET],endContainer:t[END_CONTAINER],endOffset:t[END_OFFSET],
collapsed:t.collapsed,commonAncestorContainer:t.commonAncestorContainer})}function _getSelectedNode(container,offset){var child;if(container.nodeType==3)return container;if(offset<0)return container;child=container.firstChild;while(child&&offset>0){--offset;child=child.nextSibling}if(child)return child;return container}function _isCollapsed(){return t[START_CONTAINER]==t[END_CONTAINER]&&t[START_OFFSET]==t[END_OFFSET]}function _compareBoundaryPoints(containerA,offsetA,containerB,offsetB){var c,offsetC,
n,cmnRoot,childA,childB;if(containerA==containerB){if(offsetA==offsetB)return 0;if(offsetA<offsetB)return-1;return 1}c=containerB;while(c&&c.parentNode!=containerA)c=c.parentNode;if(c){offsetC=0;n=containerA.firstChild;while(n!=c&&offsetC<offsetA){offsetC++;n=n.nextSibling}if(offsetA<=offsetC)return-1;return 1}c=containerA;while(c&&c.parentNode!=containerB)c=c.parentNode;if(c){offsetC=0;n=containerB.firstChild;while(n!=c&&offsetC<offsetB){offsetC++;n=n.nextSibling}if(offsetC<offsetB)return-1;return 1}cmnRoot=
dom.findCommonAncestor(containerA,containerB);childA=containerA;while(childA&&childA.parentNode!=cmnRoot)childA=childA.parentNode;if(!childA)childA=cmnRoot;childB=containerB;while(childB&&childB.parentNode!=cmnRoot)childB=childB.parentNode;if(!childB)childB=cmnRoot;if(childA==childB)return 0;n=cmnRoot.firstChild;while(n){if(n==childA)return-1;if(n==childB)return 1;n=n.nextSibling}}function _setEndPoint(st,n,o){var ec,sc;if(st){t[START_CONTAINER]=n;t[START_OFFSET]=o}else{t[END_CONTAINER]=n;t[END_OFFSET]=
o}ec=t[END_CONTAINER];while(ec.parentNode)ec=ec.parentNode;sc=t[START_CONTAINER];while(sc.parentNode)sc=sc.parentNode;if(sc==ec){if(_compareBoundaryPoints(t[START_CONTAINER],t[START_OFFSET],t[END_CONTAINER],t[END_OFFSET])>0)t.collapse(st)}else t.collapse(st);t.collapsed=_isCollapsed();t.commonAncestorContainer=dom.findCommonAncestor(t[START_CONTAINER],t[END_CONTAINER])}function _traverse(how){var c,endContainerDepth=0,startContainerDepth=0,p,depthDiff,startNode,endNode,sp,ep;if(t[START_CONTAINER]==
t[END_CONTAINER])return _traverseSameContainer(how);for(c=t[END_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[START_CONTAINER])return _traverseCommonStartContainer(c,how);++endContainerDepth}for(c=t[START_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[END_CONTAINER])return _traverseCommonEndContainer(c,how);++startContainerDepth}depthDiff=startContainerDepth-endContainerDepth;startNode=t[START_CONTAINER];while(depthDiff>0){startNode=startNode.parentNode;depthDiff--}endNode=t[END_CONTAINER];
while(depthDiff<0){endNode=endNode.parentNode;depthDiff++}for(sp=startNode.parentNode,ep=endNode.parentNode;sp!=ep;sp=sp.parentNode,ep=ep.parentNode){startNode=sp;endNode=ep}return _traverseCommonAncestors(startNode,endNode,how)}function _traverseSameContainer(how){var frag,s,sub,n,cnt,sibling,xferNode,start,len;if(how!=DELETE)frag=createDocumentFragment();if(t[START_OFFSET]==t[END_OFFSET])return frag;if(t[START_CONTAINER].nodeType==3){s=t[START_CONTAINER].nodeValue;sub=s.substring(t[START_OFFSET],
t[END_OFFSET]);if(how!=CLONE){n=t[START_CONTAINER];start=t[START_OFFSET];len=t[END_OFFSET]-t[START_OFFSET];if(start===0&&len>=n.nodeValue.length-1)n.parentNode.removeChild(n);else n.deleteData(start,len);t.collapse(TRUE)}if(how==DELETE)return;if(sub.length>0)frag.appendChild(doc.createTextNode(sub));return frag}n=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]);cnt=t[END_OFFSET]-t[START_OFFSET];while(n&&cnt>0){sibling=n.nextSibling;xferNode=_traverseFullySelected(n,how);if(frag)frag.appendChild(xferNode);
--cnt;n=sibling}if(how!=CLONE)t.collapse(TRUE);return frag}function _traverseCommonStartContainer(endAncestor,how){var frag,n,endIdx,cnt,sibling,xferNode;if(how!=DELETE)frag=createDocumentFragment();n=_traverseRightBoundary(endAncestor,how);if(frag)frag.appendChild(n);endIdx=nodeIndex(endAncestor);cnt=endIdx-t[START_OFFSET];if(cnt<=0){if(how!=CLONE){t.setEndBefore(endAncestor);t.collapse(FALSE)}return frag}n=endAncestor.previousSibling;while(cnt>0){sibling=n.previousSibling;xferNode=_traverseFullySelected(n,
how);if(frag)frag.insertBefore(xferNode,frag.firstChild);--cnt;n=sibling}if(how!=CLONE){t.setEndBefore(endAncestor);t.collapse(FALSE)}return frag}function _traverseCommonEndContainer(startAncestor,how){var frag,startIdx,n,cnt,sibling,xferNode;if(how!=DELETE)frag=createDocumentFragment();n=_traverseLeftBoundary(startAncestor,how);if(frag)frag.appendChild(n);startIdx=nodeIndex(startAncestor);++startIdx;cnt=t[END_OFFSET]-startIdx;n=startAncestor.nextSibling;while(n&&cnt>0){sibling=n.nextSibling;xferNode=
_traverseFullySelected(n,how);if(frag)frag.appendChild(xferNode);--cnt;n=sibling}if(how!=CLONE){t.setStartAfter(startAncestor);t.collapse(TRUE)}return frag}function _traverseCommonAncestors(startAncestor,endAncestor,how){var n,frag,commonParent,startOffset,endOffset,cnt,sibling,nextSibling;if(how!=DELETE)frag=createDocumentFragment();n=_traverseLeftBoundary(startAncestor,how);if(frag)frag.appendChild(n);commonParent=startAncestor.parentNode;startOffset=nodeIndex(startAncestor);endOffset=nodeIndex(endAncestor);
++startOffset;cnt=endOffset-startOffset;sibling=startAncestor.nextSibling;while(cnt>0){nextSibling=sibling.nextSibling;n=_traverseFullySelected(sibling,how);if(frag)frag.appendChild(n);sibling=nextSibling;--cnt}n=_traverseRightBoundary(endAncestor,how);if(frag)frag.appendChild(n);if(how!=CLONE){t.setStartAfter(startAncestor);t.collapse(TRUE)}return frag}function _traverseRightBoundary(root,how){var next=_getSelectedNode(t[END_CONTAINER],t[END_OFFSET]-1),parent,clonedParent,prevSibling,clonedChild,
clonedGrandParent,isFullySelected=next!=t[END_CONTAINER];if(next==root)return _traverseNode(next,isFullySelected,FALSE,how);parent=next.parentNode;clonedParent=_traverseNode(parent,FALSE,FALSE,how);while(parent){while(next){prevSibling=next.previousSibling;clonedChild=_traverseNode(next,isFullySelected,FALSE,how);if(how!=DELETE)clonedParent.insertBefore(clonedChild,clonedParent.firstChild);isFullySelected=TRUE;next=prevSibling}if(parent==root)return clonedParent;next=parent.previousSibling;parent=
parent.parentNode;clonedGrandParent=_traverseNode(parent,FALSE,FALSE,how);if(how!=DELETE)clonedGrandParent.appendChild(clonedParent);clonedParent=clonedGrandParent}}function _traverseLeftBoundary(root,how){var next=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]),isFullySelected=next!=t[START_CONTAINER],parent,clonedParent,nextSibling,clonedChild,clonedGrandParent;if(next==root)return _traverseNode(next,isFullySelected,TRUE,how);parent=next.parentNode;clonedParent=_traverseNode(parent,FALSE,TRUE,
how);while(parent){while(next){nextSibling=next.nextSibling;clonedChild=_traverseNode(next,isFullySelected,TRUE,how);if(how!=DELETE)clonedParent.appendChild(clonedChild);isFullySelected=TRUE;next=nextSibling}if(parent==root)return clonedParent;next=parent.nextSibling;parent=parent.parentNode;clonedGrandParent=_traverseNode(parent,FALSE,TRUE,how);if(how!=DELETE)clonedGrandParent.appendChild(clonedParent);clonedParent=clonedGrandParent}}function _traverseNode(n,isFullySelected,isLeft,how){var txtValue,
newNodeValue,oldNodeValue,offset,newNode;if(isFullySelected)return _traverseFullySelected(n,how);if(n.nodeType==3){txtValue=n.nodeValue;if(isLeft){offset=t[START_OFFSET];newNodeValue=txtValue.substring(offset);oldNodeValue=txtValue.substring(0,offset)}else{offset=t[END_OFFSET];newNodeValue=txtValue.substring(0,offset);oldNodeValue=txtValue.substring(offset)}if(how!=CLONE)n.nodeValue=oldNodeValue;if(how==DELETE)return;newNode=dom.clone(n,FALSE);newNode.nodeValue=newNodeValue;return newNode}if(how==
DELETE)return;return dom.clone(n,FALSE)}function _traverseFullySelected(n,how){if(how!=DELETE)return how==CLONE?dom.clone(n,TRUE):n;n.parentNode.removeChild(n)}function toStringIE(){return dom.create("body",null,cloneContents()).outerText}return t}ns.Range=Range;Range.prototype.toString=function(){return this.toStringIE()}})(tinymce.dom);
(function(){function Selection(selection){var self=this,dom=selection.dom,TRUE=true,FALSE=false;function getPosition(rng,start){var checkRng,startIndex=0,endIndex,inside,children,child,offset,index,position=-1,parent;checkRng=rng.duplicate();checkRng.collapse(start);parent=checkRng.parentElement();if(parent.ownerDocument!==selection.dom.doc)return;while(parent.contentEditable==="false")parent=parent.parentNode;if(!parent.hasChildNodes())return{node:parent,inside:1};children=parent.children;endIndex=
children.length-1;while(startIndex<=endIndex){index=Math.floor((startIndex+endIndex)/2);child=children[index];checkRng.moveToElementText(child);position=checkRng.compareEndPoints(start?"StartToStart":"EndToEnd",rng);if(position>0)endIndex=index-1;else if(position<0)startIndex=index+1;else return{node:child}}if(position<0){if(!child){checkRng.moveToElementText(parent);checkRng.collapse(true);child=parent;inside=true}else checkRng.collapse(false);offset=0;while(checkRng.compareEndPoints(start?"StartToStart":
"StartToEnd",rng)!==0){if(checkRng.move("character",1)===0||parent!=checkRng.parentElement())break;offset++}}else{checkRng.collapse(true);offset=0;while(checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)!==0){if(checkRng.move("character",-1)===0||parent!=checkRng.parentElement())break;offset++}}return{node:child,position:position,offset:offset,inside:inside}}function getRange(){var ieRange=selection.getRng(),domRange=dom.createRng(),element,collapsed,tmpRange,element2,bookmark,fail;
element=ieRange.item?ieRange.item(0):ieRange.parentElement();if(element.ownerDocument!=dom.doc)return domRange;collapsed=selection.isCollapsed();if(ieRange.item){domRange.setStart(element.parentNode,dom.nodeIndex(element));domRange.setEnd(domRange.startContainer,domRange.startOffset+1);return domRange}function findEndPoint(start){var endPoint=getPosition(ieRange,start),container,offset,textNodeOffset=0,sibling,undef,nodeValue;container=endPoint.node;offset=endPoint.offset;if(endPoint.inside&&!container.hasChildNodes()){domRange[start?
"setStart":"setEnd"](container,0);return}if(offset===undef){domRange[start?"setStartBefore":"setEndAfter"](container);return}if(endPoint.position<0){sibling=endPoint.inside?container.firstChild:container.nextSibling;if(!sibling){domRange[start?"setStartAfter":"setEndAfter"](container);return}if(!offset){if(sibling.nodeType==3)domRange[start?"setStart":"setEnd"](sibling,0);else domRange[start?"setStartBefore":"setEndBefore"](sibling);return}while(sibling){nodeValue=sibling.nodeValue;textNodeOffset+=
nodeValue.length;if(textNodeOffset>=offset){container=sibling;textNodeOffset-=offset;textNodeOffset=nodeValue.length-textNodeOffset;break}sibling=sibling.nextSibling}}else{sibling=container.previousSibling;if(!sibling)return domRange[start?"setStartBefore":"setEndBefore"](container);if(!offset){if(container.nodeType==3)domRange[start?"setStart":"setEnd"](sibling,container.nodeValue.length);else domRange[start?"setStartAfter":"setEndAfter"](sibling);return}while(sibling){textNodeOffset+=sibling.nodeValue.length;
if(textNodeOffset>=offset){container=sibling;textNodeOffset-=offset;break}sibling=sibling.previousSibling}}domRange[start?"setStart":"setEnd"](container,textNodeOffset)}try{findEndPoint(true);if(!collapsed)findEndPoint()}catch(ex){if(ex.number==-2147024809){bookmark=self.getBookmark(2);tmpRange=ieRange.duplicate();tmpRange.collapse(true);element=tmpRange.parentElement();if(!collapsed){tmpRange=ieRange.duplicate();tmpRange.collapse(false);element2=tmpRange.parentElement();element2.innerHTML=element2.innerHTML}element.innerHTML=
element.innerHTML;self.moveToBookmark(bookmark);ieRange=selection.getRng();findEndPoint(true);if(!collapsed)findEndPoint()}else throw ex;}return domRange}this.getBookmark=function(type){var rng=selection.getRng(),start,end,bookmark={};function getIndexes(node){var parent,root,children,i,indexes=[];parent=node.parentNode;root=dom.getRoot().parentNode;while(parent!=root&&parent.nodeType!==9){children=parent.children;i=children.length;while(i--)if(node===children[i]){indexes.push(i);break}node=parent;
parent=parent.parentNode}return indexes}function getBookmarkEndPoint(start){var position;position=getPosition(rng,start);if(position)return{position:position.position,offset:position.offset,indexes:getIndexes(position.node),inside:position.inside}}if(type===2)if(!rng.item){bookmark.start=getBookmarkEndPoint(true);if(!selection.isCollapsed())bookmark.end=getBookmarkEndPoint()}else bookmark.start={ctrl:true,indexes:getIndexes(rng.item(0))};return bookmark};this.moveToBookmark=function(bookmark){var rng,
body=dom.doc.body;function resolveIndexes(indexes){var node,i,idx,children;node=dom.getRoot();for(i=indexes.length-1;i>=0;i--){children=node.children;idx=indexes[i];if(idx<=children.length-1)node=children[idx]}return node}function setBookmarkEndPoint(start){var endPoint=bookmark[start?"start":"end"],moveLeft,moveRng,undef;if(endPoint){moveLeft=endPoint.position>0;moveRng=body.createTextRange();moveRng.moveToElementText(resolveIndexes(endPoint.indexes));offset=endPoint.offset;if(offset!==undef){moveRng.collapse(endPoint.inside||
moveLeft);moveRng.moveStart("character",moveLeft?-offset:offset)}else moveRng.collapse(start);rng.setEndPoint(start?"StartToStart":"EndToStart",moveRng);if(start)rng.collapse(true)}}if(bookmark.start)if(bookmark.start.ctrl){rng=body.createControlRange();rng.addElement(resolveIndexes(bookmark.start.indexes));rng.select()}else{rng=body.createTextRange();setBookmarkEndPoint(true);setBookmarkEndPoint();rng.select()}};this.addRange=function(rng){var ieRng,ctrlRng,startContainer,startOffset,endContainer,
endOffset,sibling,doc=selection.dom.doc,body=doc.body,nativeRng,ctrlElm;function setEndPoint(start){var container,offset,marker,tmpRng,nodes;marker=dom.create("a");container=start?startContainer:endContainer;offset=start?startOffset:endOffset;tmpRng=ieRng.duplicate();if(container==doc||container==doc.documentElement){container=body;offset=0}if(container.nodeType==3){container.parentNode.insertBefore(marker,container);tmpRng.moveToElementText(marker);tmpRng.moveStart("character",offset);dom.remove(marker);
ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng)}else{nodes=container.childNodes;if(nodes.length){if(offset>=nodes.length)dom.insertAfter(marker,nodes[nodes.length-1]);else container.insertBefore(marker,nodes[offset]);tmpRng.moveToElementText(marker)}else if(container.canHaveHTML){container.innerHTML="<span>\ufeff</span>";marker=container.firstChild;tmpRng.moveToElementText(marker);tmpRng.collapse(FALSE)}ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng);dom.remove(marker)}}startContainer=
rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset;ieRng=body.createTextRange();if(startContainer==endContainer&&startContainer.nodeType==1){if(startOffset==endOffset&&!startContainer.hasChildNodes())if(startContainer.canHaveHTML){sibling=startContainer.previousSibling;if(sibling&&!sibling.hasChildNodes()&&dom.isBlock(sibling))sibling.innerHTML="\ufeff";else sibling=null;startContainer.innerHTML="<span>\ufeff</span><span>\ufeff</span>";ieRng.moveToElementText(startContainer.lastChild);
ieRng.select();dom.doc.selection.clear();startContainer.innerHTML="";if(sibling)sibling.innerHTML="";return}else{startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode}if(startOffset==endOffset-1)try{ctrlElm=startContainer.childNodes[startOffset];ctrlRng=body.createControlRange();ctrlRng.addElement(ctrlElm);ctrlRng.select();nativeRng=selection.getRng();if(nativeRng.item&&ctrlElm===nativeRng.item(0))return}catch(ex){}}setEndPoint(true);setEndPoint();ieRng.select()};this.getRangeAt=
getRange}tinymce.dom.TridentSelection=Selection})();
(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,expando="sizcache",done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rReturn=/\r\n/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==
1&&context.nodeType!==9)return[];if(!selector||typeof selector!=="string")return results;var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector))if(parts.length===2&&Expr.relative[parts[0]])set=posProcess(parts[0]+parts[1],context,seed);else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),
context);while(parts.length){selector=parts.shift();if(Expr.relative[selector])selector+=parts.shift();set=posProcess(selector,set,seed)}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]===
"~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0)checkSet=makeArray(set);else prune=false;while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur])cur="";else pop=parts.pop();if(pop==null)pop=context;Expr.relative[cur](checkSet,pop,contextXML)}}else checkSet=parts=[]}if(!checkSet)checkSet=set;if(!checkSet)Sizzle.error(cur||selector);if(toString.call(checkSet)==="[object Array]")if(!prune)results.push.apply(results,
checkSet);else if(context&&context.nodeType===1)for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i])))results.push(set[i])}else for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1)results.push(set[i])}else makeArray(checkSet,results);if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;
results.sort(sortOrder);if(hasDuplicate)for(var i=1;i<results.length;i++)if(results[i]===results[i-1])results.splice(i--,1)}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set,i,len,match,type,left;if(!expr)return[];for(i=0,len=Expr.order.length;i<len;i++){type=Expr.order[i];if(match=Expr.leftMatch[type].exec(expr)){left=match[1];
match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set)set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[];return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,type,found,item,filter,left,i,pass,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);
while(expr&&set.length){for(type in Expr.filter)if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){filter=Expr.filter[type];left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\")continue;if(curLoop===result)result=[];if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match)anyFound=found=true;else if(match===true)continue}if(match)for(i=0;(item=curLoop[i])!=null;i++)if(item){found=filter(item,match,i,curLoop);
pass=not^found;if(inplace&&found!=null)if(pass)anyFound=true;else curLoop[i]=false;else if(pass){result.push(item);anyFound=true}}if(found!==undefined){if(!inplace)curLoop=result;expr=expr.replace(Expr.match[type],"");if(!anyFound)return[];break}}if(expr===old)if(anyFound==null)Sizzle.error(expr);else break;old=expr}return curLoop};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};var getText=Sizzle.getText=function(elem){var i,node,nodeType=elem.nodeType,
ret="";if(nodeType)if(nodeType===1||nodeType===9||nodeType===11)if(typeof elem.textContent==="string")return elem.textContent;else if(typeof elem.innerText==="string")return elem.innerText.replace(rReturn,"");else for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem);else{if(nodeType===3||nodeType===4)return elem.nodeValue}else for(i=0;node=elem[i];i++)if(node.nodeType!==8)ret+=getText(node);return ret};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,
CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},
leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag)part=part.toLowerCase();for(var i=0,l=checkSet.length,elem;i<l;i++)if(elem=checkSet[i]){while((elem=elem.previousSibling)&&elem.nodeType!==1);checkSet[i]=isPartStrNotTag||
elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}if(isPartStrNotTag)Sizzle.filter(part,checkSet,true)},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem)checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===
part}if(isPartStr)Sizzle.filter(part,checkSet,true)}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",
part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++)if(results[i].getAttribute("name")===match[1])ret.push(results[i]);return ret.length===0?null:ret}},TAG:function(match,context){if(typeof context.getElementsByTagName!==
"undefined")return context.getElementsByTagName(match[1])}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML)return match;for(var i=0,elem;(elem=curLoop[i])!=null;i++)if(elem)if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace)result.push(elem)}else if(inplace)curLoop[i]=false;return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,
"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2])Sizzle.error(match[0]);match[2]=match[2].replace(/^\+|\s*/g,"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=test[1]+(test[2]||1)-0;match[3]=test[3]-0}else if(match[2])Sizzle.error(match[0]);match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,
"");if(!isXML&&Expr.attrMap[name])match[1]=Expr.attrMap[name];match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~=")match[4]=" "+match[4]+" ";return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not")if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3]))match[3]=Sizzle(match[3],null,null,curLoop);else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace)result.push.apply(result,ret);return false}else if(Expr.match.POS.test(match[0])||
Expr.match.CHILD.test(match[0]))return true;return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode)elem.parentNode.selectedIndex;return elem.selected===true},parent:function(elem){return!!elem.firstChild},empty:function(elem){return!elem.firstChild},has:function(elem,
i,match){return!!Sizzle(match[3],elem).length},header:function(elem){return/h\d/i.test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()===
"input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();
return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName)},focus:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,
i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter)return filter(elem,i,match,array);else if(name==="contains")return(elem.textContent||elem.innerText||getText([elem])||"").indexOf(match[3])>=0;else if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++)if(not[j]===elem)return false;return true}else Sizzle.error(name)},CHILD:function(elem,match){var first,last,
doneName,parent,cache,count,diff,type=match[1],node=elem;switch(type){case "only":case "first":while(node=node.previousSibling)if(node.nodeType===1)return false;if(type==="first")return true;node=elem;case "last":while(node=node.nextSibling)if(node.nodeType===1)return false;return true;case "nth":first=match[2];last=match[3];if(first===1&&last===0)return true;doneName=match[0];parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.nodeIndex)){count=0;for(node=parent.firstChild;node;node=
node.nextSibling)if(node.nodeType===1)node.nodeIndex=++count;parent[expando]=doneName}diff=elem.nodeIndex-last;if(first===0)return diff===0;else return diff%first===0&&diff/first>=0}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return match==="*"&&elem.nodeType===1||!!elem.nodeName&&elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,
match){var name=match[1],result=Sizzle.attr?Sizzle.attr(elem,name):Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":!type&&Sizzle.attr?result!=null:type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-
check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter)return filter(elem,i,match,array)}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,
fescape))}Expr.match.globalPOS=origPOS;var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]")Array.prototype.push.apply(ret,array);else if(typeof array.length==="number")for(var l=array.length;i<l;i++)ret.push(array[i]);
else for(;array[i];i++)ret.push(array[i]);return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition)sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1};else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var al,bl,ap=[],bp=[],aup=a.parentNode,
bup=b.parentNode,cur=aup;if(aup===bup)return siblingCheck(a,b);else if(!aup)return-1;else if(!bup)return 1;while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++)if(ap[i]!==bp[i])return siblingCheck(ap[i],bp[i]);return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b)return ret;var cur=a.nextSibling;while(cur){if(cur===b)return-1;cur=cur.nextSibling}return 1}}(function(){var form=
document.createElement("div"),id="script"+(new Date).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=
typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0)Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++)if(results[i].nodeType===1)tmp.push(results[i]);results=
tmp}return results};div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#")Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)};div=null})();if(document.querySelectorAll)(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0)return;Sizzle=function(query,context,
extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9))if(match[1])return makeArray(context.getElementsByTagName(query),extra);else if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName)return makeArray(context.getElementsByClassName(match[2]),extra);if(context.nodeType===9){if(query==="body"&&context.body)return makeArray([context.body],extra);else if(match&&match[3]){var elem=
context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3])return makeArray([elem],extra)}else return makeArray([],extra)}try{return makeArray(context.querySelectorAll(query),extra)}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old)context.setAttribute("id",nid);else nid=nid.replace(/'/g,
"\\$&");if(relativeHierarchySelector&&hasParent)context=context.parentNode;try{if(!relativeHierarchySelector||hasParent)return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}catch(pseudoError){}finally{if(!old)oldContext.removeAttribute("id")}}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle)Sizzle[prop]=oldSizzle[prop];div=null})();(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||
html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node))try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==
11)return ret}}catch(e){}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0)return;div.lastChild.className="e";if(div.getElementsByClassName("e").length===1)return;Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML)return context.getElementsByClassName(match[1])};
div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem[expando]=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<
l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem[expando]=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains)Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)};else if(document.documentElement.compareDocumentPosition)Sizzle.contains=
function(a,b){return!!(a.compareDocumentPosition(b)&16)};else Sizzle.contains=function(){return false};Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context,seed){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while(match=Expr.match.PSEUDO.exec(selector)){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?
selector+"*":selector;for(var i=0,l=root.length;i<l;i++)Sizzle(selector,root[i],tmpSet,seed);return Sizzle.filter(later,tmpSet)};window.tinymce.dom.Sizzle=Sizzle})();
(function(tinymce){tinymce.dom.Element=function(id,settings){var t=this,dom,el;t.settings=settings=settings||{};t.id=id;t.dom=dom=settings.dom||tinymce.DOM;if(!tinymce.isIE)el=dom.get(t.id);tinymce.each(("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,"+"setAttrib,setAttribs,getAttrib,addClass,removeClass,"+"hasClass,getOuterHTML,setOuterHTML,remove,show,hide,"+"isHidden,setHTML,get").split(/,/),function(k){t[k]=function(){var a=[id],i;for(i=0;i<arguments.length;i++)a.push(arguments[i]);
a=dom[k].apply(dom,a);t.update(k);return a}});tinymce.extend(t,{on:function(n,f,s){return tinymce.dom.Event.add(t.id,n,f,s)},getXY:function(){return{x:parseInt(t.getStyle("left")),y:parseInt(t.getStyle("top"))}},getSize:function(){var n=dom.get(t.id);return{w:parseInt(t.getStyle("width")||n.clientWidth),h:parseInt(t.getStyle("height")||n.clientHeight)}},moveTo:function(x,y){t.setStyles({left:x,top:y})},moveBy:function(x,y){var p=t.getXY();t.moveTo(p.x+x,p.y+y)},resizeTo:function(w,h){t.setStyles({width:w,
height:h})},resizeBy:function(w,h){var s=t.getSize();t.resizeTo(s.w+w,s.h+h)},update:function(k){var b;if(tinymce.isIE6&&settings.blocker){k=k||"";if(k.indexOf("get")===0||k.indexOf("has")===0||k.indexOf("is")===0)return;if(k=="remove"){dom.remove(t.blocker);return}if(!t.blocker){t.blocker=dom.uniqueId();b=dom.add(settings.container||dom.getRoot(),"iframe",{id:t.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'});dom.setStyle(b,"opacity",0)}else b=dom.get(t.blocker);dom.setStyles(b,
{left:t.getStyle("left",1),top:t.getStyle("top",1),width:t.getStyle("width",1),height:t.getStyle("height",1),display:t.getStyle("display",1),zIndex:parseInt(t.getStyle("zIndex",1)||0)-1})}}})}})(tinymce);
(function(tinymce){function trimNl(s){return s.replace(/[\n\r]+/g,"")}var is=tinymce.is,isIE=tinymce.isIE,each=tinymce.each,TreeWalker=tinymce.dom.TreeWalker;tinymce.create("tinymce.dom.Selection",{Selection:function(dom,win,serializer,editor){var t=this;t.dom=dom;t.win=win;t.serializer=serializer;t.editor=editor;each(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(e){t[e]=new tinymce.util.Dispatcher(t)});if(!t.win.getSelection)t.tridentSel=new tinymce.dom.TridentSelection(t);
if(tinymce.isIE&&dom.boxModel)this._fixIESelection();tinymce.addUnload(t.destroy,t)},setCursorLocation:function(node,offset){var t=this;var r=t.dom.createRng();r.setStart(node,offset);r.setEnd(node,offset);t.setRng(r);t.collapse(false)},getContent:function(s){var t=this,r=t.getRng(),e=t.dom.create("body"),se=t.getSel(),wb,wa,n;s=s||{};wb=wa="";s.get=true;s.format=s.format||"html";s.forced_root_block="";t.onBeforeGetContent.dispatch(t,s);if(s.format=="text")return t.isCollapsed()?"":r.text||(se.toString?
se.toString():"");if(r.cloneContents){n=r.cloneContents();if(n)e.appendChild(n)}else if(is(r.item)||is(r.htmlText)){e.innerHTML="<br>"+(r.item?r.item(0).outerHTML:r.htmlText);e.removeChild(e.firstChild)}else e.innerHTML=r.toString();if(/^\s/.test(e.innerHTML))wb=" ";if(/\s+$/.test(e.innerHTML))wa=" ";s.getInner=true;s.content=t.isCollapsed()?"":wb+t.serializer.serialize(e,s)+wa;t.onGetContent.dispatch(t,s);return s.content},setContent:function(content,args){var self=this,rng=self.getRng(),caretNode,
doc=self.win.document,frag,temp;args=args||{format:"html"};args.set=true;content=args.content=content;if(!args.no_events)self.onBeforeSetContent.dispatch(self,args);content=args.content;if(rng.insertNode){content+='<span id="__caret">_</span>';if(rng.startContainer==doc&&rng.endContainer==doc)doc.body.innerHTML=content;else{rng.deleteContents();if(doc.body.childNodes.length===0)doc.body.innerHTML=content;else if(rng.createContextualFragment)rng.insertNode(rng.createContextualFragment(content));else{frag=
doc.createDocumentFragment();temp=doc.createElement("div");frag.appendChild(temp);temp.outerHTML=content;rng.insertNode(frag)}}caretNode=self.dom.get("__caret");rng=doc.createRange();rng.setStartBefore(caretNode);rng.setEndBefore(caretNode);self.setRng(rng);self.dom.remove("__caret");try{self.setRng(rng)}catch(ex){}}else{if(rng.item){doc.execCommand("Delete",false,null);rng=self.getRng()}if(/^\s+/.test(content)){rng.pasteHTML('<span id="__mce_tmp">_</span>'+content);self.dom.remove("__mce_tmp")}else rng.pasteHTML(content)}if(!args.no_events)self.onSetContent.dispatch(self,
args)},getStart:function(){var self=this,rng=self.getRng(),startElement,parentElement,checkRng,node;if(rng.duplicate||rng.item){if(rng.item)return rng.item(0);checkRng=rng.duplicate();checkRng.collapse(1);startElement=checkRng.parentElement();if(startElement.ownerDocument!==self.dom.doc)startElement=self.dom.getRoot();parentElement=node=rng.parentElement();while(node=node.parentNode)if(node==startElement){startElement=parentElement;break}return startElement}else{startElement=rng.startContainer;if(startElement.nodeType==
1&&startElement.hasChildNodes())startElement=startElement.childNodes[Math.min(startElement.childNodes.length-1,rng.startOffset)];if(startElement&&startElement.nodeType==3)return startElement.parentNode;return startElement}},getEnd:function(){var self=this,rng=self.getRng(),endElement,endOffset;if(rng.duplicate||rng.item){if(rng.item)return rng.item(0);rng=rng.duplicate();rng.collapse(0);endElement=rng.parentElement();if(endElement.ownerDocument!==self.dom.doc)endElement=self.dom.getRoot();if(endElement&&
endElement.nodeName=="BODY")return endElement.lastChild||endElement;return endElement}else{endElement=rng.endContainer;endOffset=rng.endOffset;if(endElement.nodeType==1&&endElement.hasChildNodes())endElement=endElement.childNodes[endOffset>0?endOffset-1:endOffset];if(endElement&&endElement.nodeType==3)return endElement.parentNode;return endElement}},getBookmark:function(type,normalized){var t=this,dom=t.dom,rng,rng2,id,collapsed,name,element,index,chr="\ufeff",styles;function findIndex(name,element){var index=
0;each(dom.select(name),function(node,i){if(node==element)index=i});return index}function normalizeTableCellSelection(rng){function moveEndPoint(start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"];offset=rng[prefix+"Offset"];if(container.nodeType==1&&container.nodeName=="TR"){childNodes=container.childNodes;container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)];if(container){offset=start?0:container.childNodes.length;rng["set"+(start?
"Start":"End")](container,offset)}}}moveEndPoint(true);moveEndPoint();return rng}function getLocation(){var rng=t.getRng(true),root=dom.getRoot(),bookmark={};function getPoint(rng,start){var container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],node,childNodes,after=0;if(container.nodeType==3){if(normalized)for(node=container.previousSibling;node&&node.nodeType==3;node=node.previousSibling)offset+=node.nodeValue.length;point.push(offset)}else{childNodes=
container.childNodes;if(offset>=childNodes.length&&childNodes.length){after=1;offset=Math.max(0,childNodes.length-1)}point.push(t.dom.nodeIndex(childNodes[offset],normalized)+after)}for(;container&&container!=root;container=container.parentNode)point.push(t.dom.nodeIndex(container,normalized));return point}bookmark.start=getPoint(rng,true);if(!t.isCollapsed())bookmark.end=getPoint(rng);return bookmark}if(type==2){if(t.tridentSel)return t.tridentSel.getBookmark(type);return getLocation()}if(type)return{rng:t.getRng()};
rng=t.getRng();id=dom.uniqueId();collapsed=tinyMCE.activeEditor.selection.isCollapsed();styles="overflow:hidden;line-height:0px";if(rng.duplicate||rng.item)if(!rng.item){rng2=rng.duplicate();try{rng.collapse();rng.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_start" style="'+styles+'">'+chr+"</span>");if(!collapsed){rng2.collapse(false);rng.moveToElementText(rng2.parentElement());if(rng.compareEndPoints("StartToEnd",rng2)===0)rng2.move("character",-1);rng2.pasteHTML('<span data-mce-type="bookmark" id="'+
id+'_end" style="'+styles+'">'+chr+"</span>")}}catch(ex){return null}}else{element=rng.item(0);name=element.nodeName;return{name:name,index:findIndex(name,element)}}else{element=t.getNode();name=element.nodeName;if(name=="IMG")return{name:name,index:findIndex(name,element)};rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(false);rng2.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_end",style:styles},chr))}rng=normalizeTableCellSelection(rng);rng.collapse(true);
rng.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_start",style:styles},chr))}t.moveToBookmark({id:id,keep:1});return{id:id}},moveToBookmark:function(bookmark){var t=this,dom=t.dom,marker1,marker2,rng,root,startContainer,endContainer,startOffset,endOffset;function setEndPoint(start){var point=bookmark[start?"start":"end"],i,node,offset,children;if(point){offset=point[0];for(node=root,i=point.length-1;i>=1;i--){children=node.childNodes;if(point[i]>children.length-1)return;node=children[point[i]]}if(node.nodeType===
3)offset=Math.min(point[0],node.nodeValue.length);if(node.nodeType===1)offset=Math.min(point[0],node.childNodes.length);if(start)rng.setStart(node,offset);else rng.setEnd(node,offset)}return true}function restoreEndPoint(suffix){var marker=dom.get(bookmark.id+"_"+suffix),node,idx,next,prev,keep=bookmark.keep;if(marker){node=marker.parentNode;if(suffix=="start"){if(!keep)idx=dom.nodeIndex(marker);else{node=marker.firstChild;idx=1}startContainer=endContainer=node;startOffset=endOffset=idx}else{if(!keep)idx=
dom.nodeIndex(marker);else{node=marker.firstChild;idx=1}endContainer=node;endOffset=idx}if(!keep){prev=marker.previousSibling;next=marker.nextSibling;each(tinymce.grep(marker.childNodes),function(node){if(node.nodeType==3)node.nodeValue=node.nodeValue.replace(/\uFEFF/g,"")});while(marker=dom.get(bookmark.id+"_"+suffix))dom.remove(marker,1);if(prev&&next&&prev.nodeType==next.nodeType&&prev.nodeType==3&&!tinymce.isOpera){idx=prev.nodeValue.length;prev.appendData(next.nodeValue);dom.remove(next);if(suffix==
"start"){startContainer=endContainer=prev;startOffset=endOffset=idx}else{endContainer=prev;endOffset=idx}}}}}function addBogus(node){if(dom.isBlock(node)&&!node.innerHTML&&!isIE)node.innerHTML='<br data-mce-bogus="1" />';return node}if(bookmark)if(bookmark.start){rng=dom.createRng();root=dom.getRoot();if(t.tridentSel)return t.tridentSel.moveToBookmark(bookmark);if(setEndPoint(true)&&setEndPoint())t.setRng(rng)}else if(bookmark.id){restoreEndPoint("start");restoreEndPoint("end");if(startContainer){rng=
dom.createRng();rng.setStart(addBogus(startContainer),startOffset);rng.setEnd(addBogus(endContainer),endOffset);t.setRng(rng)}}else if(bookmark.name)t.select(dom.select(bookmark.name)[bookmark.index]);else if(bookmark.rng)t.setRng(bookmark.rng)},select:function(node,content){var t=this,dom=t.dom,rng=dom.createRng(),idx;function setPoint(node,start){var walker=new TreeWalker(node,node);do{if(node.nodeType==3&&tinymce.trim(node.nodeValue).length!==0){if(start)rng.setStart(node,0);else rng.setEnd(node,
node.nodeValue.length);return}if(node.nodeName=="BR"){if(start)rng.setStartBefore(node);else rng.setEndBefore(node);return}}while(node=start?walker.next():walker.prev())}if(node){idx=dom.nodeIndex(node);rng.setStart(node.parentNode,idx);rng.setEnd(node.parentNode,idx+1);if(content){setPoint(node,1);setPoint(node)}t.setRng(rng)}return node},isCollapsed:function(){var t=this,r=t.getRng(),s=t.getSel();if(!r||r.item)return false;if(r.compareEndPoints)return r.compareEndPoints("StartToEnd",r)===0;return!s||
r.collapsed},collapse:function(to_start){var self=this,rng=self.getRng(),node;if(rng.item){node=rng.item(0);rng=self.win.document.body.createTextRange();rng.moveToElementText(node)}rng.collapse(!!to_start);self.setRng(rng)},getSel:function(){var t=this,w=this.win;return w.getSelection?w.getSelection():w.document.selection},getRng:function(w3c){var self=this,selection,rng,elm,doc=self.win.document;if(w3c&&self.tridentSel)return self.tridentSel.getRangeAt(0);try{if(selection=self.getSel())rng=selection.rangeCount>
0?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange()}catch(ex){}if(tinymce.isIE&&rng&&rng.setStart&&doc.selection.createRange().item){elm=doc.selection.createRange().item(0);rng=doc.createRange();rng.setStartBefore(elm);rng.setEndAfter(elm)}if(!rng)rng=doc.createRange?doc.createRange():doc.body.createTextRange();if(rng.setStart&&rng.startContainer.nodeType===9&&rng.collapsed){elm=self.dom.getRoot();rng.setStart(elm,0);rng.setEnd(elm,0)}if(self.selectedRange&&self.explicitRange)if(rng.compareBoundaryPoints(rng.START_TO_START,
self.selectedRange)===0&&rng.compareBoundaryPoints(rng.END_TO_END,self.selectedRange)===0)rng=self.explicitRange;else{self.selectedRange=null;self.explicitRange=null}return rng},setRng:function(r,forward){var s,t=this;if(!t.tridentSel){s=t.getSel();if(s){t.explicitRange=r;try{s.removeAllRanges()}catch(ex){}s.addRange(r);if(forward===false&&s.extend){s.collapse(r.endContainer,r.endOffset);s.extend(r.startContainer,r.startOffset)}t.selectedRange=s.rangeCount>0?s.getRangeAt(0):null}}else{if(r.cloneRange)try{t.tridentSel.addRange(r);
return}catch(ex){}try{r.select()}catch(ex){}}},setNode:function(n){var t=this;t.setContent(t.dom.getOuterHTML(n));return n},getNode:function(){var t=this,rng=t.getRng(),sel=t.getSel(),elm,start=rng.startContainer,end=rng.endContainer;function skipEmptyTextNodes(n,forwards){var orig=n;while(n&&n.nodeType===3&&n.length===0)n=forwards?n.nextSibling:n.previousSibling;return n||orig}if(!rng)return t.dom.getRoot();if(rng.setStart){elm=rng.commonAncestorContainer;if(!rng.collapsed){if(rng.startContainer==
rng.endContainer)if(rng.endOffset-rng.startOffset<2)if(rng.startContainer.hasChildNodes())elm=rng.startContainer.childNodes[rng.startOffset];if(start.nodeType===3&&end.nodeType===3){if(start.length===rng.startOffset)start=skipEmptyTextNodes(start.nextSibling,true);else start=start.parentNode;if(rng.endOffset===0)end=skipEmptyTextNodes(end.previousSibling,false);else end=end.parentNode;if(start&&start===end)return start}}if(elm&&elm.nodeType==3)return elm.parentNode;return elm}return rng.item?rng.item(0):
rng.parentElement()},getSelectedBlocks:function(st,en){var t=this,dom=t.dom,sb,eb,n,bl=[];sb=dom.getParent(st||t.getStart(),dom.isBlock);eb=dom.getParent(en||t.getEnd(),dom.isBlock);if(sb)bl.push(sb);if(sb&&eb&&sb!=eb){n=sb;var walker=new TreeWalker(sb,dom.getRoot());while((n=walker.next())&&n!=eb)if(dom.isBlock(n))bl.push(n)}if(eb&&sb!=eb)bl.push(eb);return bl},isForward:function(){var dom=this.dom,sel=this.getSel(),anchorRange,focusRange;if(!sel||sel.anchorNode==null||sel.focusNode==null)return true;
anchorRange=dom.createRng();anchorRange.setStart(sel.anchorNode,sel.anchorOffset);anchorRange.collapse(true);focusRange=dom.createRng();focusRange.setStart(sel.focusNode,sel.focusOffset);focusRange.collapse(true);return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0},normalize:function(){var self=this,rng,normalized,collapsed,node,sibling;function normalizeEndPoint(start){var container,offset,walker,dom=self.dom,body=dom.getRoot(),node,nonEmptyElementsMap,nodeName;function hasBrBeforeAfter(node,
left){var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||body);while(node=walker[left?"prev":"next"]())if(node.nodeName==="BR")return true}function findTextNodeRelative(left,startNode){var walker,lastInlineElement;startNode=startNode||container;walker=new TreeWalker(startNode,dom.getParent(startNode.parentNode,dom.isBlock)||body);while(node=walker[left?"prev":"next"]()){if(node.nodeType===3&&node.nodeValue.length>0){container=node;offset=left?node.nodeValue.length:0;normalized=
true;return}if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return;lastInlineElement=node}if(collapsed&&lastInlineElement){container=lastInlineElement;normalized=true;offset=0}}container=rng[(start?"start":"end")+"Container"];offset=rng[(start?"start":"end")+"Offset"];nonEmptyElementsMap=dom.schema.getNonEmptyElements();if(container.nodeType===9){container=dom.getRoot();offset=0}if(container===body){if(start){node=container.childNodes[offset>0?offset-1:0];if(node){nodeName=
node.nodeName.toLowerCase();if(nonEmptyElementsMap[node.nodeName]||node.nodeName=="TABLE")return}}if(container.hasChildNodes()){container=container.childNodes[Math.min(!start&&offset>0?offset-1:offset,container.childNodes.length-1)];offset=0;if(container.hasChildNodes()&&!/TABLE/.test(container.nodeName)){node=container;walker=new TreeWalker(container,body);do{if(node.nodeType===3&&node.nodeValue.length>0){offset=start?0:node.nodeValue.length;container=node;normalized=true;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){offset=
dom.nodeIndex(node);container=node.parentNode;if(node.nodeName=="IMG"&&!start)offset++;normalized=true;break}}while(node=start?walker.next():walker.prev())}}}if(collapsed){if(container.nodeType===3&&offset===0)findTextNodeRelative(true);if(container.nodeType===1){node=container.childNodes[offset];if(node&&node.nodeName==="BR"&&!hasBrBeforeAfter(node)&&!hasBrBeforeAfter(node,true))findTextNodeRelative(true,container.childNodes[offset])}}if(start&&!collapsed&&container.nodeType===3&&offset===container.nodeValue.length)findTextNodeRelative(false);
if(normalized)rng["set"+(start?"Start":"End")](container,offset)}if(tinymce.isIE)return;rng=self.getRng();collapsed=rng.collapsed;normalizeEndPoint(true);if(!collapsed)normalizeEndPoint();if(normalized){if(collapsed)rng.collapse(true);self.setRng(rng,self.isForward())}},selectorChanged:function(selector,callback){var self=this,currentSelectors;if(!self.selectorChangedData){self.selectorChangedData={};currentSelectors={};self.editor.onNodeChange.addToTop(function(ed,cm,node){var dom=self.dom,parents=
dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each(self.selectorChangedData,function(callbacks,selector){each(parents,function(node){if(dom.is(node,selector)){if(!currentSelectors[selector]){each(callbacks,function(callback){callback(true,{node:node,selector:selector,parents:parents})});currentSelectors[selector]=callbacks}matchedSelectors[selector]=callbacks;return false}})});each(currentSelectors,function(callbacks,selector){if(!matchedSelectors[selector]){delete currentSelectors[selector];
each(callbacks,function(callback){callback(false,{node:node,selector:selector,parents:parents})})}})})}if(!self.selectorChangedData[selector])self.selectorChangedData[selector]=[];self.selectorChangedData[selector].push(callback);return self},destroy:function(manual){var self=this;self.win=null;if(!manual)tinymce.removeUnload(self.destroy)},_fixIESelection:function(){var dom=this.dom,doc=dom.doc,body=doc.body,started,startRng,htmlElm;function rngFromPoint(x,y){var rng=body.createTextRange();try{rng.moveToPoint(x,
y)}catch(ex){rng=null}return rng}function selectionChange(e){var pointRng;if(e.button){pointRng=rngFromPoint(e.x,e.y);if(pointRng){if(pointRng.compareEndPoints("StartToStart",startRng)>0)pointRng.setEndPoint("StartToStart",startRng);else pointRng.setEndPoint("EndToEnd",startRng);pointRng.select()}}else endSelection()}function endSelection(){var rng=doc.selection.createRange();if(startRng&&!rng.item&&rng.compareEndPoints("StartToEnd",rng)===0)startRng.select();dom.unbind(doc,"mouseup",endSelection);
dom.unbind(doc,"mousemove",selectionChange);startRng=started=0}doc.documentElement.unselectable=true;dom.bind(doc,["mousedown","contextmenu"],function(e){if(e.target.nodeName==="HTML"){if(started)endSelection();htmlElm=doc.documentElement;if(htmlElm.scrollHeight>htmlElm.clientHeight)return;started=1;startRng=rngFromPoint(e.x,e.y);if(startRng){dom.bind(doc,"mouseup",endSelection);dom.bind(doc,"mousemove",selectionChange);dom.win.focus();startRng.select()}}})}})})(tinymce);
(function(tinymce){tinymce.dom.Serializer=function(settings,dom,schema){var onPreProcess,onPostProcess,isIE=tinymce.isIE,each=tinymce.each,htmlParser;if(!settings.apply_source_formatting)settings.indent=false;dom=dom||tinymce.DOM;schema=schema||new tinymce.html.Schema(settings);settings.entity_encoding=settings.entity_encoding||"named";settings.remove_trailing_brs="remove_trailing_brs"in settings?settings.remove_trailing_brs:true;onPreProcess=new tinymce.util.Dispatcher(self);onPostProcess=new tinymce.util.Dispatcher(self);
htmlParser=new tinymce.html.DomParser(settings,schema);htmlParser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,value,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope,undef;while(i--){node=nodes[i];value=node.attributes.map[internalName];if(value!==undef){node.attr(name,value.length>0?value:null);node.attr(internalName,null)}else{value=node.attributes.map[name];if(name==="style")value=dom.serializeStyle(dom.parseStyle(value),
node.name);else if(urlConverter)value=urlConverter.call(urlConverterScope,value,name,node.name);node.attr(name,value.length>0?value:null)}}});htmlParser.addAttributeFilter("class",function(nodes,name){var i=nodes.length,node,value;while(i--){node=nodes[i];value=node.attr("class").replace(/(?:^|\s)mce(Item\w+|Selected)(?!\S)/g,"");node.attr("class",value.length>0?value:null)}});htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){var i=nodes.length,node;while(i--){node=nodes[i];
if(node.attributes.map["data-mce-type"]==="bookmark"&&!args.cleanup)node.remove()}});htmlParser.addAttributeFilter("data-mce-expando",function(nodes,name,args){var i=nodes.length;while(i--)nodes[i].attr(name,null)});htmlParser.addNodeFilter("script,style",function(nodes,name){var i=nodes.length,node,value;function trim(value){return value.replace(/(<\!--\[CDATA\[|\]\]--\>)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<\!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<\!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<\!--|\/\*\s*<\!--\s*\*\/)\s*[\r\n]*/gi,
"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(--\>)?|\s*\/\/\s*\]\]>(--\>)?|\/\/\s*(--\>)?|\]\]>|\/\*\s*--\>\s*\*\/|\s*--\>\s*)\s*$/g,"")}while(i--){node=nodes[i];value=node.firstChild?node.firstChild.value:"";if(name==="script"){node.attr("type",(node.attr("type")||"text/javascript").replace(/^mce\-/,""));if(value.length>0)node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]\>"}else if(value.length>0)node.firstChild.value="<\!--\n"+trim(value)+"\n--\>"}});htmlParser.addNodeFilter("#comment",function(nodes,
name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.value.indexOf("[CDATA[")===0){node.name="#cdata";node.type=4;node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(node.value.indexOf("mce:protected ")===0){node.name="#text";node.type=3;node.raw=true;node.value=unescape(node.value).substr(14)}}});htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.type===7)node.remove();else if(node.type===1)if(name==="input"&&
!("type"in node.attributes.map))node.attr("type","text")}});if(settings.fix_list_elements)htmlParser.addNodeFilter("ul,ol",function(nodes,name){var i=nodes.length,node,parentNode;while(i--){node=nodes[i];parentNode=node.parent;if(parentNode.name==="ul"||parentNode.name==="ol")if(node.prev&&node.prev.name==="li")node.prev.append(node)}});htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(nodes,name){var i=nodes.length;while(i--)nodes[i].attr(name,null)});return{schema:schema,
addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,onPreProcess:onPreProcess,onPostProcess:onPostProcess,serialize:function(node,args){var impl,doc,oldDoc,htmlSerializer,content;if(isIE&&dom.select("script,style,select,map").length>0){content=node.innerHTML;node=node.cloneNode(false);dom.setHTML(node,content)}else node=node.cloneNode(true);impl=node.ownerDocument.implementation;if(impl.createHTMLDocument){doc=impl.createHTMLDocument("");each(node.nodeName=="BODY"?
node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,true))});if(node.nodeName!="BODY")node=doc.body.firstChild;else node=doc.body;oldDoc=dom.doc;dom.doc=doc}args=args||{};args.format=args.format||"html";if(!args.no_events){args.node=node;onPreProcess.dispatch(self,args)}htmlSerializer=new tinymce.html.Serializer(settings,schema);args.content=htmlSerializer.serialize(htmlParser.parse(tinymce.trim(args.getInner?node.innerHTML:dom.getOuterHTML(node)),args));if(!args.cleanup)args.content=
args.content.replace(/\uFEFF/g,"");if(!args.no_events)onPostProcess.dispatch(self,args);if(oldDoc)dom.doc=oldDoc;args.node=null;return args.content},addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)}}}})(tinymce);
(function(tinymce){tinymce.dom.ScriptLoader=function(settings){var QUEUED=0,LOADING=1,LOADED=2,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0,undef;function loadScript(url,callback){var t=this,dom=tinymce.DOM,elm,uri,loc,id;function done(){dom.remove(id);if(elm)elm.onreadystatechange=elm.onload=elm=null;callback()}function error(){if(typeof console!=="undefined"&&console.log)console.log("Failed to load: "+url)}id=dom.uniqueId();if(tinymce.isIE6){uri=new tinymce.util.URI(url);
loc=location;if(uri.host==loc.hostname&&uri.port==loc.port&&uri.protocol+":"==loc.protocol&&uri.protocol.toLowerCase()!="file"){tinymce.util.XHR.send({url:tinymce._addVer(uri.getURI()),success:function(content){var script=dom.create("script",{type:"text/javascript"});script.text=content;document.getElementsByTagName("head")[0].appendChild(script);dom.remove(script);done()},error:error});return}}elm=document.createElement("script");elm.id=id;elm.type="text/javascript";elm.src=tinymce._addVer(url);
if(!tinymce.isIE)elm.onload=done;elm.onerror=error;if(!tinymce.isOpera)elm.onreadystatechange=function(){var state=elm.readyState;if(state=="complete"||state=="loaded")done()};(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)}this.isDone=function(url){return states[url]==LOADED};this.markDone=function(url){states[url]=LOADED};this.add=this.load=function(url,callback,scope){var item,state=states[url];if(state==undef){queue.push(url);states[url]=QUEUED}if(callback){if(!scriptLoadedCallbacks[url])scriptLoadedCallbacks[url]=
[];scriptLoadedCallbacks[url].push({func:callback,scope:scope||this})}};this.loadQueue=function(callback,scope){this.loadScripts(queue,callback,scope)};this.loadScripts=function(scripts,callback,scope){var loadScripts;function execScriptLoadedCallbacks(url){tinymce.each(scriptLoadedCallbacks[url],function(callback){callback.func.call(callback.scope)});scriptLoadedCallbacks[url]=undef}queueLoadedCallbacks.push({func:callback,scope:scope||this});loadScripts=function(){var loadingScripts=tinymce.grep(scripts);
scripts.length=0;tinymce.each(loadingScripts,function(url){if(states[url]==LOADED){execScriptLoadedCallbacks(url);return}if(states[url]!=LOADING){states[url]=LOADING;loading++;loadScript(url,function(){states[url]=LOADED;loading--;execScriptLoadedCallbacks(url);loadScripts()})}});if(!loading){tinymce.each(queueLoadedCallbacks,function(callback){callback.func.call(callback.scope)});queueLoadedCallbacks.length=0}};loadScripts()}};tinymce.ScriptLoader=new tinymce.dom.ScriptLoader})(tinymce);
(function(tinymce){tinymce.dom.RangeUtils=function(dom){var INVISIBLE_CHAR="\ufeff";this.walk=function(rng,callback){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,ancestor,startPoint,endPoint,node,parent,siblings,nodes;nodes=dom.select("td.mceSelected,th.mceSelected");if(nodes.length>0){tinymce.each(nodes,function(node){callback([node])});return}function exclude(nodes){var node;node=nodes[0];if(node.nodeType===3&&node===startContainer&&
startOffset>=node.nodeValue.length)nodes.splice(0,1);node=nodes[nodes.length-1];if(endOffset===0&&nodes.length>0&&node===endContainer&&node.nodeType===3)nodes.splice(nodes.length-1,1);return nodes}function collectSiblings(node,name,end_node){var siblings=[];for(;node&&node!=end_node;node=node[name])siblings.push(node);return siblings}function findEndPoint(node,root){do{if(node.parentNode==root)return node;node=node.parentNode}while(node)}function walkBoundary(start_node,end_node,next){var siblingName=
next?"nextSibling":"previousSibling";for(node=start_node,parent=node.parentNode;node&&node!=end_node;node=parent){parent=node.parentNode;siblings=collectSiblings(node==start_node?node:node[siblingName],siblingName);if(siblings.length){if(!next)siblings.reverse();callback(exclude(siblings))}}}if(startContainer.nodeType==1&&startContainer.hasChildNodes())startContainer=startContainer.childNodes[startOffset];if(endContainer.nodeType==1&&endContainer.hasChildNodes())endContainer=endContainer.childNodes[Math.min(endOffset-
1,endContainer.childNodes.length-1)];if(startContainer==endContainer)return callback(exclude([startContainer]));ancestor=dom.findCommonAncestor(startContainer,endContainer);for(node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,true);if(node===ancestor)break}for(node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}startPoint=findEndPoint(startContainer,
ancestor)||startContainer;endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,true);siblings=collectSiblings(startPoint==startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint==endContainer?endPoint.nextSibling:endPoint);if(siblings.length)callback(exclude(siblings));walkBoundary(endContainer,endPoint)};this.split=function(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;
function splitText(node,offset){return node.splitText(offset)}if(startContainer==endContainer&&startContainer.nodeType==3){if(startOffset>0&&startOffset<startContainer.nodeValue.length){endContainer=splitText(startContainer,startOffset);startContainer=endContainer.previousSibling;if(endOffset>startOffset){endOffset=endOffset-startOffset;startContainer=endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;startOffset=0}else endOffset=0}}else{if(startContainer.nodeType==
3&&startOffset>0&&startOffset<startContainer.nodeValue.length){startContainer=splitText(startContainer,startOffset);startOffset=0}if(endContainer.nodeType==3&&endOffset>0&&endOffset<endContainer.nodeValue.length){endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length}}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}};tinymce.dom.RangeUtils.compareRanges=function(rng1,rng2){if(rng1&&rng2)if(rng1.item||
rng1.duplicate){if(rng1.item&&rng2.item&&rng1.item(0)===rng2.item(0))return true;if(rng1.isEqual&&rng2.isEqual&&rng2.isEqual(rng1))return true}else return rng1.startContainer==rng2.startContainer&&rng1.startOffset==rng2.startOffset;return false}})(tinymce);
(function(tinymce){var Event=tinymce.dom.Event,each=tinymce.each;tinymce.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(settings,dom){var t=this,root=settings.root,items=settings.items,enableUpDown=settings.enableUpDown,enableLeftRight=settings.enableLeftRight||!settings.enableUpDown,excludeFromTabOrder=settings.excludeFromTabOrder,itemFocussed,itemBlurred,rootKeydown,rootFocussed,focussedId;dom=dom||tinymce.DOM;itemFocussed=function(evt){focussedId=evt.target.id};itemBlurred=
function(evt){dom.setAttrib(evt.target.id,"tabindex","-1")};rootFocussed=function(evt){var item=dom.get(focussedId);dom.setAttrib(item,"tabindex","0");item.focus()};t.focus=function(){dom.get(focussedId).focus()};t.destroy=function(){each(items,function(item){var elm=dom.get(item.id);dom.unbind(elm,"focus",itemFocussed);dom.unbind(elm,"blur",itemBlurred)});var rootElm=dom.get(root);dom.unbind(rootElm,"focus",rootFocussed);dom.unbind(rootElm,"keydown",rootKeydown);items=dom=root=t.focus=itemFocussed=
itemBlurred=rootKeydown=rootFocussed=null;t.destroy=function(){}};t.moveFocus=function(dir,evt){var idx=-1,controls=t.controls,newFocus;if(!focussedId)return;each(items,function(item,index){if(item.id===focussedId){idx=index;return false}});idx+=dir;if(idx<0)idx=items.length-1;else if(idx>=items.length)idx=0;newFocus=items[idx];dom.setAttrib(focussedId,"tabindex","-1");dom.setAttrib(newFocus.id,"tabindex","0");dom.get(newFocus.id).focus();if(settings.actOnFocus)settings.onAction(newFocus.id);if(evt)Event.cancel(evt)};
rootKeydown=function(evt){var DOM_VK_LEFT=37,DOM_VK_RIGHT=39,DOM_VK_UP=38,DOM_VK_DOWN=40,DOM_VK_ESCAPE=27,DOM_VK_ENTER=14,DOM_VK_RETURN=13,DOM_VK_SPACE=32;switch(evt.keyCode){case DOM_VK_LEFT:if(enableLeftRight)t.moveFocus(-1);break;case DOM_VK_RIGHT:if(enableLeftRight)t.moveFocus(1);break;case DOM_VK_UP:if(enableUpDown)t.moveFocus(-1);break;case DOM_VK_DOWN:if(enableUpDown)t.moveFocus(1);break;case DOM_VK_ESCAPE:if(settings.onCancel){settings.onCancel();Event.cancel(evt)}break;case DOM_VK_ENTER:case DOM_VK_RETURN:case DOM_VK_SPACE:if(settings.onAction){settings.onAction(focussedId);
Event.cancel(evt)}break}};each(items,function(item,idx){var tabindex,elm;if(!item.id)item.id=dom.uniqueId("_mce_item_");elm=dom.get(item.id);if(excludeFromTabOrder){dom.bind(elm,"blur",itemBlurred);tabindex="-1"}else tabindex=idx===0?"0":"-1";elm.setAttribute("tabindex",tabindex);dom.bind(elm,"focus",itemFocussed)});if(items[0])focussedId=items[0].id;dom.setAttrib(root,"tabindex","-1");var rootElm=dom.get(root);dom.bind(rootElm,"focus",rootFocussed);dom.bind(rootElm,"keydown",rootKeydown)}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,is=tinymce.is;tinymce.create("tinymce.ui.Control",{Control:function(id,s,editor){this.id=id;this.settings=s=s||{};this.rendered=false;this.onRender=new tinymce.util.Dispatcher(this);this.classPrefix="";this.scope=s.scope||this;this.disabled=0;this.active=0;this.editor=editor},setAriaProperty:function(property,value){var element=DOM.get(this.id+"_aria")||DOM.get(this.id);if(element)DOM.setAttrib(element,"aria-"+property,!!value)},focus:function(){DOM.get(this.id).focus()},
setDisabled:function(s){if(s!=this.disabled){this.setAriaProperty("disabled",s);this.setState("Disabled",s);this.setState("Enabled",!s);this.disabled=s}},isDisabled:function(){return this.disabled},setActive:function(s){if(s!=this.active){this.setState("Active",s);this.active=s;this.setAriaProperty("pressed",s)}},isActive:function(){return this.active},setState:function(c,s){var n=DOM.get(this.id);c=this.classPrefix+c;if(s)DOM.addClass(n,c);else DOM.removeClass(n,c)},isRendered:function(){return this.rendered},
renderHTML:function(){},renderTo:function(n){DOM.setHTML(n,this.renderHTML())},postRender:function(){var t=this,b;if(is(t.disabled)){b=t.disabled;t.disabled=-1;t.setDisabled(b)}if(is(t.active)){b=t.active;t.active=-1;t.setActive(b)}},remove:function(){DOM.remove(this.id);this.destroy()},destroy:function(){tinymce.dom.Event.clear(this.id)}})})(tinymce);
tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(id,s,editor){this.parent(id,s,editor);this.controls=[];this.lookup={}},add:function(c){this.lookup[c.id]=c;this.controls.push(c);return c},get:function(n){return this.lookup[n]}});
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(id,s){this.parent(id,s);this.classPrefix="mceSeparator";this.setDisabled(true)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});
(function(tinymce){var is=tinymce.is,DOM=tinymce.DOM,each=tinymce.each,walk=tinymce.walk;tinymce.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(id,s){this.parent(id,s);this.classPrefix="mceMenuItem"},setSelected:function(s){this.setState("Selected",s);this.setAriaProperty("checked",!!s);this.selected=s},isSelected:function(){return this.selected},postRender:function(){var t=this;t.parent();if(is(t.selected))t.setSelected(t.selected)}})})(tinymce);
(function(tinymce){var is=tinymce.is,DOM=tinymce.DOM,each=tinymce.each,walk=tinymce.walk;tinymce.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(id,s){var t=this;t.parent(id,s);t.items={};t.collapsed=false;t.menuCount=0;t.onAddItem=new tinymce.util.Dispatcher(this)},expand:function(d){var t=this;if(d)walk(t,function(o){if(o.expand)o.expand()},"items",t);t.collapsed=false},collapse:function(d){var t=this;if(d)walk(t,function(o){if(o.collapse)o.collapse()},"items",t);t.collapsed=true},isCollapsed:function(){return this.collapsed},
add:function(o){if(!o.settings)o=new tinymce.ui.MenuItem(o.id||DOM.uniqueId(),o);this.onAddItem.dispatch(this,o);return this.items[o.id]=o},addSeparator:function(){return this.add({separator:true})},addMenu:function(o){if(!o.collapse)o=this.createMenu(o);this.menuCount++;return this.add(o)},hasMenus:function(){return this.menuCount!==0},remove:function(o){delete this.items[o.id]},removeAll:function(){var t=this;walk(t,function(o){if(o.removeAll)o.removeAll();else o.remove();o.destroy()},"items",t);
t.items={}},createMenu:function(o){var m=new tinymce.ui.Menu(o.id||DOM.uniqueId(),o);m.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return m}})})(tinymce);
(function(tinymce){var is=tinymce.is,DOM=tinymce.DOM,each=tinymce.each,Event=tinymce.dom.Event,Element=tinymce.dom.Element;tinymce.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(id,s){s=s||{};s.container=s.container||DOM.doc.body;s.offset_x=s.offset_x||0;s.offset_y=s.offset_y||0;s.vp_offset_x=s.vp_offset_x||0;s.vp_offset_y=s.vp_offset_y||0;if(is(s.icons)&&!s.icons)s["class"]+=" mceNoIcons";this.parent(id,s);this.onShowMenu=new tinymce.util.Dispatcher(this);this.onHideMenu=new tinymce.util.Dispatcher(this);
this.classPrefix="mceMenu"},createMenu:function(s){var t=this,cs=t.settings,m;s.container=s.container||cs.container;s.parent=t;s.constrain=s.constrain||cs.constrain;s["class"]=s["class"]||cs["class"];s.vp_offset_x=s.vp_offset_x||cs.vp_offset_x;s.vp_offset_y=s.vp_offset_y||cs.vp_offset_y;s.keyboard_focus=cs.keyboard_focus;m=new tinymce.ui.DropMenu(s.id||DOM.uniqueId(),s);m.onAddItem.add(t.onAddItem.dispatch,t.onAddItem);return m},focus:function(){var t=this;if(t.keyboardNav)t.keyboardNav.focus()},
update:function(){var t=this,s=t.settings,tb=DOM.get("menu_"+t.id+"_tbl"),co=DOM.get("menu_"+t.id+"_co"),tw,th;tw=s.max_width?Math.min(tb.offsetWidth,s.max_width):tb.offsetWidth;th=s.max_height?Math.min(tb.offsetHeight,s.max_height):tb.offsetHeight;if(!DOM.boxModel)t.element.setStyles({width:tw+2,height:th+2});else t.element.setStyles({width:tw,height:th});if(s.max_width)DOM.setStyle(co,"width",tw);if(s.max_height){DOM.setStyle(co,"height",th);if(tb.clientHeight<s.max_height)DOM.setStyle(co,"overflow",
"hidden")}},showMenu:function(x,y,px){var t=this,s=t.settings,co,vp=DOM.getViewPort(),w,h,mx,my,ot=2,dm,tb,cp=t.classPrefix;t.collapse(1);if(t.isMenuVisible)return;if(!t.rendered){co=DOM.add(t.settings.container,t.renderNode());each(t.items,function(o){o.postRender()});t.element=new Element("menu_"+t.id,{blocker:1,container:s.container})}else co=DOM.get("menu_"+t.id);if(!tinymce.isOpera)DOM.setStyles(co,{left:-65535,top:-65535});DOM.show(co);t.update();x+=s.offset_x||0;y+=s.offset_y||0;vp.w-=4;vp.h-=
4;if(s.constrain){w=co.clientWidth-ot;h=co.clientHeight-ot;mx=vp.x+vp.w;my=vp.y+vp.h;if(x+s.vp_offset_x+w>mx)x=px?px-w:Math.max(0,mx-s.vp_offset_x-w);if(y+s.vp_offset_y+h>my)y=Math.max(0,my-s.vp_offset_y-h)}DOM.setStyles(co,{left:x,top:y});t.element.update();t.isMenuVisible=1;t.mouseClickFunc=Event.add(co,"click",function(e){var m;e=e.target;if(e&&(e=DOM.getParent(e,"tr"))&&!DOM.hasClass(e,cp+"ItemSub")){m=t.items[e.id];if(m.isDisabled())return;dm=t;while(dm){if(dm.hideMenu)dm.hideMenu();dm=dm.settings.parent}if(m.settings.onclick)m.settings.onclick(e);
return false}});if(t.hasMenus())t.mouseOverFunc=Event.add(co,"mouseover",function(e){var m,r,mi;e=e.target;if(e&&(e=DOM.getParent(e,"tr"))){m=t.items[e.id];if(t.lastMenu)t.lastMenu.collapse(1);if(m.isDisabled())return;if(e&&DOM.hasClass(e,cp+"ItemSub")){r=DOM.getRect(e);m.showMenu(r.x+r.w-ot,r.y-ot,r.x);t.lastMenu=m;DOM.addClass(DOM.get(m.id).firstChild,cp+"ItemActive")}}});Event.add(co,"keydown",t._keyHandler,t);t.onShowMenu.dispatch(t);if(s.keyboard_focus)t._setupKeyboardNav()},hideMenu:function(c){var t=
this,co=DOM.get("menu_"+t.id),e;if(!t.isMenuVisible)return;if(t.keyboardNav)t.keyboardNav.destroy();Event.remove(co,"mouseover",t.mouseOverFunc);Event.remove(co,"click",t.mouseClickFunc);Event.remove(co,"keydown",t._keyHandler);DOM.hide(co);t.isMenuVisible=0;if(!c)t.collapse(1);if(t.element)t.element.hide();if(e=DOM.get(t.id))DOM.removeClass(e.firstChild,t.classPrefix+"ItemActive");t.onHideMenu.dispatch(t)},add:function(o){var t=this,co;o=t.parent(o);if(t.isRendered&&(co=DOM.get("menu_"+t.id)))t._add(DOM.select("tbody",
co)[0],o);return o},collapse:function(d){this.parent(d);this.hideMenu(1)},remove:function(o){DOM.remove(o.id);this.destroy();return this.parent(o)},destroy:function(){var t=this,co=DOM.get("menu_"+t.id);if(t.keyboardNav)t.keyboardNav.destroy();Event.remove(co,"mouseover",t.mouseOverFunc);Event.remove(DOM.select("a",co),"focus",t.mouseOverFunc);Event.remove(co,"click",t.mouseClickFunc);Event.remove(co,"keydown",t._keyHandler);if(t.element)t.element.remove();DOM.remove(co)},renderNode:function(){var t=
this,s=t.settings,n,tb,co,w;w=DOM.create("div",{role:"listbox",id:"menu_"+t.id,"class":s["class"],"style":"position:absolute;left:0;top:0;z-index:200000;outline:0"});if(t.settings.parent)DOM.setAttrib(w,"aria-parent","menu_"+t.settings.parent.id);co=DOM.add(w,"div",{role:"presentation",id:"menu_"+t.id+"_co","class":t.classPrefix+(s["class"]?" "+s["class"]:"")});t.element=new Element("menu_"+t.id,{blocker:1,container:s.container});if(s.menu_line)DOM.add(co,"span",{"class":t.classPrefix+"Line"});n=
DOM.add(co,"table",{role:"presentation",id:"menu_"+t.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});tb=DOM.add(n,"tbody");each(t.items,function(o){t._add(tb,o)});t.rendered=true;return w},_setupKeyboardNav:function(){var contextMenu,menuItems,t=this;contextMenu=DOM.get("menu_"+t.id);menuItems=DOM.select("a[role=option]","menu_"+t.id);menuItems.splice(0,0,contextMenu);t.keyboardNav=new tinymce.ui.KeyboardNavigation({root:"menu_"+t.id,items:menuItems,onCancel:function(){t.hideMenu()},enableUpDown:true});
contextMenu.focus()},_keyHandler:function(evt){var t=this,e;switch(evt.keyCode){case 37:if(t.settings.parent){t.hideMenu();t.settings.parent.focus();Event.cancel(evt)}break;case 39:if(t.mouseOverFunc)t.mouseOverFunc(evt);break}},_add:function(tb,o){var n,s=o.settings,a,ro,it,cp=this.classPrefix,ic;if(s.separator){ro=DOM.add(tb,"tr",{id:o.id,"class":cp+"ItemSeparator"});DOM.add(ro,"td",{"class":cp+"ItemSeparator"});if(n=ro.previousSibling)DOM.addClass(n,"mceLast");return}n=ro=DOM.add(tb,"tr",{id:o.id,
"class":cp+"Item "+cp+"ItemEnabled"});n=it=DOM.add(n,s.titleItem?"th":"td");n=a=DOM.add(n,"a",{id:o.id+"_aria",role:s.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"});if(s.parent){DOM.setAttrib(a,"aria-haspopup","true");DOM.setAttrib(a,"aria-owns","menu_"+o.id)}DOM.addClass(it,s["class"]);ic=DOM.add(n,"span",{"class":"mceIcon"+(s.icon?" mce_"+s.icon:"")});if(s.icon_src)DOM.add(ic,"img",{src:s.icon_src,alt:""});n=DOM.add(n,s.element||"span",
{"class":"mceText",title:o.settings.title},o.settings.title);if(o.settings.style){if(typeof o.settings.style=="function")o.settings.style=o.settings.style();DOM.setAttrib(n,"style",o.settings.style)}if(tb.childNodes.length==1)DOM.addClass(ro,"mceFirst");if((n=ro.previousSibling)&&DOM.hasClass(n,cp+"ItemSeparator"))DOM.addClass(ro,"mceFirst");if(o.collapse)DOM.addClass(ro,cp+"ItemSub");if(n=ro.previousSibling)DOM.removeClass(n,"mceLast");DOM.addClass(ro,"mceLast")}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM;tinymce.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(id,s,ed){this.parent(id,s,ed);this.classPrefix="mceButton"},renderHTML:function(){var cp=this.classPrefix,s=this.settings,h,l;l=DOM.encode(s.label||"");h='<a role="button" id="'+this.id+'" href="javascript://" class="'+cp+" "+cp+"Enabled "+s["class"]+(l?" "+cp+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+DOM.encode(s.title)+
'">';if(s.image&&!(this.editor&&this.editor.forcedHighContrastMode))h+='<span class="mceIcon '+s["class"]+'"><img class="mceIcon" src="'+s.image+'" alt="'+DOM.encode(s.title)+'" /></span>'+(l?'<span class="'+cp+'Label">'+l+"</span>":"");else h+='<span class="mceIcon '+s["class"]+'"></span>'+(l?'<span class="'+cp+'Label">'+l+"</span>":"");h+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+s.title+"</span>";h+="</a>";return h},postRender:function(){var t=this,
s=t.settings,imgBookmark;if(tinymce.isIE&&t.editor)tinymce.dom.Event.add(t.id,"mousedown",function(e){var nodeName=t.editor.selection.getNode().nodeName;imgBookmark=nodeName==="IMG"?t.editor.selection.getBookmark():null});tinymce.dom.Event.add(t.id,"click",function(e){if(!t.isDisabled()){if(tinymce.isIE&&t.editor&&imgBookmark!==null)t.editor.selection.moveToBookmark(imgBookmark);return s.onclick.call(s.scope,e)}});tinymce.dom.Event.add(t.id,"keyup",function(e){if(!t.isDisabled()&&e.keyCode==tinymce.VK.SPACEBAR)return s.onclick.call(s.scope,
e)})}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each,Dispatcher=tinymce.util.Dispatcher,undef;tinymce.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(id,s,ed){var t=this;t.parent(id,s,ed);t.items=[];t.onChange=new Dispatcher(t);t.onPostRender=new Dispatcher(t);t.onAdd=new Dispatcher(t);t.onRenderMenu=new tinymce.util.Dispatcher(this);t.classPrefix="mceListBox";t.marked={}},select:function(va){var t=this,fv,f;t.marked={};if(va==undef)return t.selectByIndex(-1);if(va&&
typeof va=="function")f=va;else f=function(v){return v==va};if(va!=t.selectedValue){each(t.items,function(o,i){if(f(o.value)){fv=1;t.selectByIndex(i);return false}});if(!fv)t.selectByIndex(-1)}},selectByIndex:function(idx){var t=this,e,o,label;t.marked={};if(idx!=t.selectedIndex){e=DOM.get(t.id+"_text");label=DOM.get(t.id+"_voiceDesc");o=t.items[idx];if(o){t.selectedValue=o.value;t.selectedIndex=idx;DOM.setHTML(e,DOM.encode(o.title));DOM.setHTML(label,t.settings.title+" - "+o.title);DOM.removeClass(e,
"mceTitle");DOM.setAttrib(t.id,"aria-valuenow",o.title)}else{DOM.setHTML(e,DOM.encode(t.settings.title));DOM.setHTML(label,DOM.encode(t.settings.title));DOM.addClass(e,"mceTitle");t.selectedValue=t.selectedIndex=null;DOM.setAttrib(t.id,"aria-valuenow",t.settings.title)}e=0}},mark:function(value){this.marked[value]=true},add:function(n,v,o){var t=this;o=o||{};o=tinymce.extend(o,{title:n,value:v});t.items.push(o);t.onAdd.dispatch(t,o)},getLength:function(){return this.items.length},renderHTML:function(){var h=
"",t=this,s=t.settings,cp=t.classPrefix;h='<span role="listbox" aria-haspopup="true" aria-labelledby="'+t.id+'_voiceDesc" aria-describedby="'+t.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+t.id+'" cellpadding="0" cellspacing="0" class="'+cp+" "+cp+"Enabled"+(s["class"]?" "+s["class"]:"")+'"><tbody><tr>';h+="<td>"+DOM.createHTML("span",{id:t.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},t.settings.title);h+=DOM.createHTML("a",{id:t.id+"_text",tabindex:-1,href:"javascript:;",
"class":"mceText",onclick:"return false;",onmousedown:"return false;"},DOM.encode(t.settings.title))+"</td>";h+="<td>"+DOM.createHTML("a",{id:t.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span></span>')+"</td>";h+="</tr></tbody></table></span>";return h},showMenu:function(){var t=this,p2,e=DOM.get(this.id),m;if(t.isDisabled()||t.items.length===0)return;
if(t.menu&&t.menu.isMenuVisible)return t.hideMenu();if(!t.isMenuRendered){t.renderMenu();t.isMenuRendered=true}p2=DOM.getPos(e);m=t.menu;m.settings.offset_x=p2.x;m.settings.offset_y=p2.y;m.settings.keyboard_focus=!tinymce.isOpera;each(t.items,function(o){if(m.items[o.id])m.items[o.id].setSelected(0)});each(t.items,function(o){if(m.items[o.id]&&t.marked[o.value])m.items[o.id].setSelected(1);if(o.value===t.selectedValue)m.items[o.id].setSelected(1)});m.showMenu(0,e.clientHeight);Event.add(DOM.doc,"mousedown",
t.hideMenu,t);DOM.addClass(t.id,t.classPrefix+"Selected")},hideMenu:function(e){var t=this;if(t.menu&&t.menu.isMenuVisible){DOM.removeClass(t.id,t.classPrefix+"Selected");if(e&&e.type=="mousedown"&&(e.target.id==t.id+"_text"||e.target.id==t.id+"_open"))return;if(!e||!DOM.getParent(e.target,".mceMenu")){DOM.removeClass(t.id,t.classPrefix+"Selected");Event.remove(DOM.doc,"mousedown",t.hideMenu,t);t.menu.hideMenu()}}},renderMenu:function(){var t=this,m;m=t.settings.control_manager.createDropMenu(t.id+
"_menu",{menu_line:1,"class":t.classPrefix+"Menu mceNoIcons",max_width:250,max_height:150});m.onHideMenu.add(function(){t.hideMenu();t.focus()});m.add({title:t.settings.title,"class":"mceMenuItemTitle",onclick:function(){if(t.settings.onselect("")!==false)t.select("")}});each(t.items,function(o){if(o.value===undef)m.add({title:o.title,role:"option","class":"mceMenuItemTitle",onclick:function(){if(t.settings.onselect("")!==false)t.select("")}});else{o.id=DOM.uniqueId();o.role="option";o.onclick=function(){if(t.settings.onselect(o.value)!==
false)t.select(o.value)};m.add(o)}});t.onRenderMenu.dispatch(t,m);t.menu=m},postRender:function(){var t=this,cp=t.classPrefix;Event.add(t.id,"click",t.showMenu,t);Event.add(t.id,"keydown",function(evt){if(evt.keyCode==32){t.showMenu(evt);Event.cancel(evt)}});Event.add(t.id,"focus",function(){if(!t._focused){t.keyDownHandler=Event.add(t.id,"keydown",function(e){if(e.keyCode==40){t.showMenu();Event.cancel(e)}});t.keyPressHandler=Event.add(t.id,"keypress",function(e){var v;if(e.keyCode==13){v=t.selectedValue;
t.selectedValue=null;Event.cancel(e);t.settings.onselect(v)}})}t._focused=1});Event.add(t.id,"blur",function(){Event.remove(t.id,"keydown",t.keyDownHandler);Event.remove(t.id,"keypress",t.keyPressHandler);t._focused=0});if(tinymce.isIE6||!DOM.boxModel){Event.add(t.id,"mouseover",function(){if(!DOM.hasClass(t.id,cp+"Disabled"))DOM.addClass(t.id,cp+"Hover")});Event.add(t.id,"mouseout",function(){if(!DOM.hasClass(t.id,cp+"Disabled"))DOM.removeClass(t.id,cp+"Hover")})}t.onPostRender.dispatch(t,DOM.get(t.id))},
destroy:function(){this.parent();Event.clear(this.id+"_text");Event.clear(this.id+"_open")}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each,Dispatcher=tinymce.util.Dispatcher,undef;tinymce.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(id,s){this.parent(id,s);this.classPrefix="mceNativeListBox"},setDisabled:function(s){DOM.get(this.id).disabled=s;this.setAriaProperty("disabled",s)},isDisabled:function(){return DOM.get(this.id).disabled},select:function(va){var t=this,fv,f;if(va==undef)return t.selectByIndex(-1);if(va&&typeof va==
"function")f=va;else f=function(v){return v==va};if(va!=t.selectedValue){each(t.items,function(o,i){if(f(o.value)){fv=1;t.selectByIndex(i);return false}});if(!fv)t.selectByIndex(-1)}},selectByIndex:function(idx){DOM.get(this.id).selectedIndex=idx+1;this.selectedValue=this.items[idx]?this.items[idx].value:null},add:function(n,v,a){var o,t=this;a=a||{};a.value=v;if(t.isRendered())DOM.add(DOM.get(this.id),"option",a,n);o={title:n,value:v,attribs:a};t.items.push(o);t.onAdd.dispatch(t,o)},getLength:function(){return this.items.length},
renderHTML:function(){var h,t=this;h=DOM.createHTML("option",{value:""},"-- "+t.settings.title+" --");each(t.items,function(it){h+=DOM.createHTML("option",{value:it.value},it.title)});h=DOM.createHTML("select",{id:t.id,"class":"mceNativeListBox","aria-labelledby":t.id+"_aria"},h);h+=DOM.createHTML("span",{id:t.id+"_aria","style":"display: none"},t.settings.title);return h},postRender:function(){var t=this,ch,changeListenerAdded=true;t.rendered=true;function onChange(e){var v=t.items[e.target.selectedIndex-
1];if(v&&(v=v.value)){t.onChange.dispatch(t,v);if(t.settings.onselect)t.settings.onselect(v)}}Event.add(t.id,"change",onChange);Event.add(t.id,"keydown",function(e){var bf;Event.remove(t.id,"change",ch);changeListenerAdded=false;bf=Event.add(t.id,"blur",function(){if(changeListenerAdded)return;changeListenerAdded=true;Event.add(t.id,"change",onChange);Event.remove(t.id,"blur",bf)});if(tinymce.isWebKit&&(e.keyCode==37||e.keyCode==39))return Event.prevent(e);if(e.keyCode==13||e.keyCode==32){onChange(e);
return Event.cancel(e)}});t.onPostRender.dispatch(t,DOM.get(t.id))}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each;tinymce.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(id,s,ed){this.parent(id,s,ed);this.onRenderMenu=new tinymce.util.Dispatcher(this);s.menu_container=s.menu_container||DOM.doc.body},showMenu:function(){var t=this,p1,p2,e=DOM.get(t.id),m;if(t.isDisabled())return;if(!t.isMenuRendered){t.renderMenu();t.isMenuRendered=true}if(t.isMenuVisible)return t.hideMenu();p1=DOM.getPos(t.settings.menu_container);
p2=DOM.getPos(e);m=t.menu;m.settings.offset_x=p2.x;m.settings.offset_y=p2.y;m.settings.vp_offset_x=p2.x;m.settings.vp_offset_y=p2.y;m.settings.keyboard_focus=t._focused;m.showMenu(0,e.firstChild.clientHeight);Event.add(DOM.doc,"mousedown",t.hideMenu,t);t.setState("Selected",1);t.isMenuVisible=1},renderMenu:function(){var t=this,m;m=t.settings.control_manager.createDropMenu(t.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:t.settings.icons});m.onHideMenu.add(function(){t.hideMenu();t.focus()});
t.onRenderMenu.dispatch(t,m);t.menu=m},hideMenu:function(e){var t=this;if(e&&e.type=="mousedown"&&DOM.getParent(e.target,function(e){return e.id===t.id||e.id===t.id+"_open"}))return;if(!e||!DOM.getParent(e.target,".mceMenu")){t.setState("Selected",0);Event.remove(DOM.doc,"mousedown",t.hideMenu,t);if(t.menu)t.menu.hideMenu()}t.isMenuVisible=0},postRender:function(){var t=this,s=t.settings;Event.add(t.id,"click",function(){if(!t.isDisabled()){if(s.onclick)s.onclick(t.value);t.showMenu()}})}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each;tinymce.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(id,s,ed){this.parent(id,s,ed);this.classPrefix="mceSplitButton"},renderHTML:function(){var h,t=this,s=t.settings,h1;h="<tbody><tr>";if(s.image)h1=DOM.createHTML("img ",{src:s.image,role:"presentation","class":"mceAction "+s["class"]});else h1=DOM.createHTML("span",{"class":"mceAction "+s["class"]},"");h1+=DOM.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",
id:t.id+"_voice",style:"display:none;"},s.title);h+="<td >"+DOM.createHTML("a",{role:"button",id:t.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+s["class"],onclick:"return false;",onmousedown:"return false;",title:s.title},h1)+"</td>";h1=DOM.createHTML("span",{"class":"mceOpen "+s["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span>');h+="<td >"+DOM.createHTML("a",{role:"button",id:t.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+
s["class"],onclick:"return false;",onmousedown:"return false;",title:s.title},h1)+"</td>";h+="</tr></tbody>";h=DOM.createHTML("table",{role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+s["class"],cellpadding:"0",cellspacing:"0",title:s.title},h);return DOM.createHTML("div",{id:t.id,role:"button",tabindex:"0","aria-labelledby":t.id+"_voice","aria-haspopup":"true"},h)},postRender:function(){var t=this,s=t.settings,activate;if(s.onclick){activate=function(evt){if(!t.isDisabled()){s.onclick(t.value);
Event.cancel(evt)}};Event.add(t.id+"_action","click",activate);Event.add(t.id,["click","keydown"],function(evt){var DOM_VK_SPACE=32,DOM_VK_ENTER=14,DOM_VK_RETURN=13,DOM_VK_UP=38,DOM_VK_DOWN=40;if((evt.keyCode===32||evt.keyCode===13||evt.keyCode===14)&&!evt.altKey&&!evt.ctrlKey&&!evt.metaKey){activate();Event.cancel(evt)}else if(evt.type==="click"||evt.keyCode===DOM_VK_DOWN){t.showMenu();Event.cancel(evt)}})}Event.add(t.id+"_open","click",function(evt){t.showMenu();Event.cancel(evt)});Event.add([t.id,
t.id+"_open"],"focus",function(){t._focused=1});Event.add([t.id,t.id+"_open"],"blur",function(){t._focused=0});if(tinymce.isIE6||!DOM.boxModel){Event.add(t.id,"mouseover",function(){if(!DOM.hasClass(t.id,"mceSplitButtonDisabled"))DOM.addClass(t.id,"mceSplitButtonHover")});Event.add(t.id,"mouseout",function(){if(!DOM.hasClass(t.id,"mceSplitButtonDisabled"))DOM.removeClass(t.id,"mceSplitButtonHover")})}},destroy:function(){this.parent();Event.clear(this.id+"_action");Event.clear(this.id+"_open");Event.clear(this.id)}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,is=tinymce.is,each=tinymce.each;tinymce.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(id,s,ed){var t=this;t.parent(id,s,ed);t.settings=s=tinymce.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",
grid_width:8,default_color:"#888888"},t.settings);t.onShowMenu=new tinymce.util.Dispatcher(t);t.onHideMenu=new tinymce.util.Dispatcher(t);t.value=s.default_color},showMenu:function(){var t=this,r,p,e,p2;if(t.isDisabled())return;if(!t.isMenuRendered){t.renderMenu();t.isMenuRendered=true}if(t.isMenuVisible)return t.hideMenu();e=DOM.get(t.id);DOM.show(t.id+"_menu");DOM.addClass(e,"mceSplitButtonSelected");p2=DOM.getPos(e);DOM.setStyles(t.id+"_menu",{left:p2.x,top:p2.y+e.firstChild.clientHeight,zIndex:2E5});
e=0;Event.add(DOM.doc,"mousedown",t.hideMenu,t);t.onShowMenu.dispatch(t);if(t._focused){t._keyHandler=Event.add(t.id+"_menu","keydown",function(e){if(e.keyCode==27)t.hideMenu()});DOM.select("a",t.id+"_menu")[0].focus()}t.keyboardNav=new tinymce.ui.KeyboardNavigation({root:t.id+"_menu",items:DOM.select("a",t.id+"_menu"),onCancel:function(){t.hideMenu();t.focus()}});t.keyboardNav.focus();t.isMenuVisible=1},hideMenu:function(e){var t=this;if(t.isMenuVisible){if(e&&e.type=="mousedown"&&DOM.getParent(e.target,
function(e){return e.id===t.id+"_open"}))return;if(!e||!DOM.getParent(e.target,".mceSplitButtonMenu")){DOM.removeClass(t.id,"mceSplitButtonSelected");Event.remove(DOM.doc,"mousedown",t.hideMenu,t);Event.remove(t.id+"_menu","keydown",t._keyHandler);DOM.hide(t.id+"_menu")}t.isMenuVisible=0;t.onHideMenu.dispatch();t.keyboardNav.destroy()}},renderMenu:function(){var t=this,m,i=0,s=t.settings,n,tb,tr,w,context;w=DOM.add(s.menu_container,"div",{role:"listbox",id:t.id+"_menu","class":s.menu_class+" "+s["class"],
style:"position:absolute;left:0;top:-1000px;"});m=DOM.add(w,"div",{"class":s["class"]+" mceSplitButtonMenu"});DOM.add(m,"span",{"class":"mceMenuLine"});n=DOM.add(m,"table",{role:"presentation","class":"mceColorSplitMenu"});tb=DOM.add(n,"tbody");i=0;each(is(s.colors,"array")?s.colors:s.colors.split(","),function(c){c=c.replace(/^#/,"");if(!i--){tr=DOM.add(tb,"tr");i=s.grid_width-1}n=DOM.add(tr,"td");var settings={href:"javascript:;",style:{backgroundColor:"#"+c},"title":t.editor.getLang("colors."+
c,c),"data-mce-color":"#"+c};if(!tinymce.isIE)settings.role="option";n=DOM.add(n,"a",settings);if(t.editor.forcedHighContrastMode){n=DOM.add(n,"canvas",{width:16,height:16,"aria-hidden":"true"});if(n.getContext&&(context=n.getContext("2d"))){context.fillStyle="#"+c;context.fillRect(0,0,16,16)}else DOM.remove(n)}});if(s.more_colors_func){n=DOM.add(tb,"tr");n=DOM.add(n,"td",{colspan:s.grid_width,"class":"mceMoreColors"});n=DOM.add(n,"a",{role:"option",id:t.id+"_more",href:"javascript:;",onclick:"return false;",
"class":"mceMoreColors"},s.more_colors_title);Event.add(n,"click",function(e){s.more_colors_func.call(s.more_colors_scope||this);return Event.cancel(e)})}DOM.addClass(m,"mceColorSplitMenu");Event.add(t.id+"_menu","mousedown",function(e){return Event.cancel(e)});Event.add(t.id+"_menu","click",function(e){var c;e=DOM.getParent(e.target,"a",tb);if(e&&e.nodeName.toLowerCase()=="a"&&(c=e.getAttribute("data-mce-color")))t.setColor(c);return false});return w},setColor:function(c){this.displayColor(c);this.hideMenu();
this.settings.onselect(c)},displayColor:function(c){var t=this;DOM.setStyle(t.id+"_preview","backgroundColor",c);t.value=c},postRender:function(){var t=this,id=t.id;t.parent();DOM.add(id+"_action","div",{id:id+"_preview","class":"mceColorPreview"});DOM.setStyle(t.id+"_preview","backgroundColor",t.value)},destroy:function(){var self=this;self.parent();Event.clear(self.id+"_menu");Event.clear(self.id+"_more");DOM.remove(self.id+"_menu");if(self.keyboardNav)self.keyboardNav.destroy()}})})(tinymce);
(function(tinymce){var dom=tinymce.DOM,each=tinymce.each,Event=tinymce.dom.Event;tinymce.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var t=this,h=[],controls=t.controls,each=tinymce.each,settings=t.settings;h.push('<div id="'+t.id+'" role="group" aria-labelledby="'+t.id+'_voice">');h.push("<span role='application'>");h.push('<span id="'+t.id+'_voice" class="mceVoiceLabel" style="display:none;">'+dom.encode(settings.name)+"</span>");each(controls,function(toolbar){h.push(toolbar.renderHTML())});
h.push("</span>");h.push("</div>");return h.join("")},focus:function(){var t=this;dom.get(t.id).focus()},postRender:function(){var t=this,items=[];each(t.controls,function(toolbar){each(toolbar.controls,function(control){if(control.id)items.push(control)})});t.keyNav=new tinymce.ui.KeyboardNavigation({root:t.id,items:items,onCancel:function(){if(tinymce.isWebKit)dom.get(t.editor.id+"_ifr").focus();t.editor.focus()},excludeFromTabOrder:!t.settings.tab_focus_toolbar})},destroy:function(){var self=this;
self.parent();self.keyNav.destroy();Event.clear(self.id)}})})(tinymce);
(function(tinymce){var dom=tinymce.DOM,each=tinymce.each;tinymce.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var t=this,h="",c,co,s=t.settings,i,pr,nx,cl;cl=t.controls;for(i=0;i<cl.length;i++){co=cl[i];pr=cl[i-1];nx=cl[i+1];if(i===0){c="mceToolbarStart";if(co.Button)c+=" mceToolbarStartButton";else if(co.SplitButton)c+=" mceToolbarStartSplitButton";else if(co.ListBox)c+=" mceToolbarStartListBox";h+=dom.createHTML("td",{"class":c},dom.createHTML("span",null,"<\!-- IE --\>"))}if(pr&&
co.ListBox)if(pr.Button||pr.SplitButton)h+=dom.createHTML("td",{"class":"mceToolbarEnd"},dom.createHTML("span",null,"<\!-- IE --\>"));if(dom.stdMode)h+='<td style="position: relative">'+co.renderHTML()+"</td>";else h+="<td>"+co.renderHTML()+"</td>";if(nx&&co.ListBox)if(nx.Button||nx.SplitButton)h+=dom.createHTML("td",{"class":"mceToolbarStart"},dom.createHTML("span",null,"<\!-- IE --\>"))}c="mceToolbarEnd";if(co.Button)c+=" mceToolbarEndButton";else if(co.SplitButton)c+=" mceToolbarEndSplitButton";
else if(co.ListBox)c+=" mceToolbarEndListBox";h+=dom.createHTML("td",{"class":c},dom.createHTML("span",null,"<\!-- IE --\>"));return dom.createHTML("table",{id:t.id,"class":"mceToolbar"+(s["class"]?" "+s["class"]:""),cellpadding:"0",cellspacing:"0",align:t.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+h+"</tr></tbody>")}})})(tinymce);
(function(tinymce){var Dispatcher=tinymce.util.Dispatcher,each=tinymce.each;tinymce.create("tinymce.AddOnManager",{AddOnManager:function(){var self=this;self.items=[];self.urls={};self.lookup={};self.onAdd=new Dispatcher(self)},get:function(n){if(this.lookup[n])return this.lookup[n].instance;else return undefined},dependencies:function(n){var result;if(this.lookup[n])result=this.lookup[n].dependencies;return result||[]},requireLangPack:function(n){var s=tinymce.settings;if(s&&s.language&&s.language_load!==
false)tinymce.ScriptLoader.add(this.urls[n]+"/langs/"+s.language+".js")},add:function(id,o,dependencies){this.items.push(o);this.lookup[id]={instance:o,dependencies:dependencies};this.onAdd.dispatch(this,id,o);return o},createUrl:function(baseUrl,dep){if(typeof dep==="object")return dep;else return{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents:function(pluginName,scripts){var pluginUrl=this.urls[pluginName];tinymce.each(scripts,function(script){tinymce.ScriptLoader.add(pluginUrl+
"/"+script)})},load:function(n,u,cb,s){var t=this,url=u;function loadDependencies(){var dependencies=t.dependencies(n);tinymce.each(dependencies,function(dep){var newUrl=t.createUrl(u,dep);t.load(newUrl.resource,newUrl,undefined,undefined)});if(cb)if(s)cb.call(s);else cb.call(tinymce.ScriptLoader)}if(t.urls[n])return;if(typeof u==="object")url=u.prefix+u.resource+u.suffix;if(url.indexOf("/")!==0&&url.indexOf("://")==-1)url=tinymce.baseURL+"/"+url;t.urls[n]=url.substring(0,url.lastIndexOf("/"));if(t.lookup[n])loadDependencies();
else tinymce.ScriptLoader.add(url,loadDependencies,s)}});tinymce.PluginManager=new tinymce.AddOnManager;tinymce.ThemeManager=new tinymce.AddOnManager})(tinymce);
(function(tinymce){var each=tinymce.each,extend=tinymce.extend,DOM=tinymce.DOM,Event=tinymce.dom.Event,ThemeManager=tinymce.ThemeManager,PluginManager=tinymce.PluginManager,explode=tinymce.explode,Dispatcher=tinymce.util.Dispatcher,undef,instanceCounter=0;tinymce.documentBaseURL=window.location.href.replace(window.location.pathname,"/d2l/common/tiny_mce");if(!/[\/\\]$/.test(tinymce.documentBaseURL))tinymce.documentBaseURL+="/";tinymce.baseURL=(new tinymce.util.URI(tinymce.documentBaseURL)).toAbsolute(tinymce.baseURL);
tinymce.baseURI=new tinymce.util.URI(tinymce.baseURL);tinymce.onBeforeUnload=new Dispatcher(tinymce);Event.add(window,"beforeunload",function(e){tinymce.onBeforeUnload.dispatch(tinymce,e)});tinymce.onAddEditor=new Dispatcher(tinymce);tinymce.onRemoveEditor=new Dispatcher(tinymce);tinymce.EditorManager=extend(tinymce,{editors:[],i18n:{},activeEditor:null,init:function(s){var t=this,pl,sl=tinymce.ScriptLoader,e,el=[],ed;function createId(elm){var id=elm.id;if(!id){id=elm.name;if(id&&!DOM.get(id))id=
elm.name;else id=DOM.uniqueId();elm.setAttribute("id",id)}return id}function execCallback(se,n,s){var f=se[n];if(!f)return;if(tinymce.is(f,"string")){s=f.replace(/\.\w+$/,"");s=s?tinymce.resolve(s):0;f=tinymce.resolve(f)}return f.apply(s||this,Array.prototype.slice.call(arguments,2))}function hasClass(n,c){return c.constructor===RegExp?c.test(n.className):DOM.hasClass(n,c)}t.settings=s;Event.bind(window,"ready",function(){var l,co;execCallback(s,"onpageload");switch(s.mode){case "exact":l=s.elements||
"";if(l.length>0)each(explode(l),function(v){if(DOM.get(v)){ed=new tinymce.Editor(v,s);el.push(ed);ed.render(1)}else each(document.forms,function(f){each(f.elements,function(e){if(e.name===v){v="mce_editor_"+instanceCounter++;DOM.setAttrib(e,"id",v);ed=new tinymce.Editor(v,s);el.push(ed);ed.render(1)}})})});break;case "textareas":case "specific_textareas":each(DOM.select("textarea"),function(elm){if(s.editor_deselector&&hasClass(elm,s.editor_deselector))return;if(!s.editor_selector||hasClass(elm,
s.editor_selector)){ed=new tinymce.Editor(createId(elm),s);el.push(ed);ed.render(1)}});break;default:if(s.types)each(s.types,function(type){each(DOM.select(type.selector),function(elm){var editor=new tinymce.Editor(createId(elm),tinymce.extend({},s,type));el.push(editor);editor.render(1)})});else if(s.selector)each(DOM.select(s.selector),function(elm){var editor=new tinymce.Editor(createId(elm),s);el.push(editor);editor.render(1)})}if(s.oninit){l=co=0;each(el,function(ed){co++;if(!ed.initialized)ed.onInit.add(function(){l++;
if(l==co)execCallback(s,"oninit")});else l++;if(l==co)execCallback(s,"oninit")})}})},get:function(id){if(id===undef)return this.editors;return this.editors[id]},getInstanceById:function(id){return this.get(id)},add:function(editor){var self=this,editors=self.editors;editors[editor.id]=editor;editors.push(editor);self._setActive(editor);self.onAddEditor.dispatch(self,editor);return editor},remove:function(editor){var t=this,i,editors=t.editors;if(!editors[editor.id])return null;delete editors[editor.id];
for(i=0;i<editors.length;i++)if(editors[i]==editor){editors.splice(i,1);break}if(t.activeEditor==editor)t._setActive(editors[0]);editor.destroy();t.onRemoveEditor.dispatch(t,editor);return editor},execCommand:function(c,u,v){var t=this,ed=t.get(v),w;function clr(){ed.destroy();w.detachEvent("onunload",clr);w=w.tinyMCE=w.tinymce=null}switch(c){case "mceFocus":ed.focus();return true;case "mceAddEditor":case "mceAddControl":if(!t.get(v))(new tinymce.Editor(v,t.settings)).render();return true;case "mceAddFrameControl":w=
v.window;w.tinyMCE=tinyMCE;w.tinymce=tinymce;tinymce.DOM.doc=w.document;tinymce.DOM.win=w;ed=new tinymce.Editor(v.element_id,v);ed.render();if(tinymce.isIE)w.attachEvent("onunload",clr);v.page_window=null;return true;case "mceRemoveEditor":case "mceRemoveControl":if(ed)ed.remove();return true;case "mceToggleEditor":if(!ed){t.execCommand("mceAddControl",0,v);return true}if(ed.isHidden())ed.show();else ed.hide();return true}if(t.activeEditor)return t.activeEditor.execCommand(c,u,v);return false},execInstanceCommand:function(id,
c,u,v){var ed=this.get(id);if(ed)return ed.execCommand(c,u,v);return false},triggerSave:function(){each(this.editors,function(e){e.save()})},addI18n:function(p,o){var lo,i18n=this.i18n;if(!tinymce.is(p,"string"))each(p,function(o,lc){each(o,function(o,g){each(o,function(o,k){if(g==="common")i18n[lc+"."+k]=o;else i18n[lc+"."+g+"."+k]=o})})});else each(o,function(o,k){i18n[p+"."+k]=o})},_setActive:function(editor){this.selectedInstance=this.activeEditor=editor}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,extend=tinymce.extend,each=tinymce.each,isGecko=tinymce.isGecko,isIE=tinymce.isIE,isWebKit=tinymce.isWebKit,is=tinymce.is,ThemeManager=tinymce.ThemeManager,PluginManager=tinymce.PluginManager,explode=tinymce.explode;tinymce.create("tinymce.Editor",{Editor:function(id,settings){var self=this,TRUE=true;self.settings=settings=extend({id:id,language:"en",theme:"advanced",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",
document_base_url:tinymce.documentBaseURL,add_form_submit_trigger:TRUE,submit_patch:TRUE,add_unload_trigger:TRUE,convert_urls:TRUE,relative_urls:TRUE,remove_script_host:TRUE,table_inline_editing:false,object_resizing:TRUE,accessibility_focus:TRUE,doctype:tinymce.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual:TRUE,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",
apply_source_formatting:TRUE,directionality:"ltr",forced_root_block:"p",hidden_input:TRUE,padd_empty_editor:TRUE,render_ui:TRUE,indentation:"30px",fix_table_elements:TRUE,inline_styles:TRUE,convert_fonts_to_spans:TRUE,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",
validate:TRUE,entity_encoding:"named",url_converter:self.convertURL,url_converter_scope:self,ie7_compat:TRUE},settings);self.id=self.editorId=id;self.isNotDirty=false;self.plugins={};self.documentBaseURI=new tinymce.util.URI(settings.document_base_url||tinymce.documentBaseURL,{base_uri:tinyMCE.baseURI});self.baseURI=tinymce.baseURI;self.contentCSS=[];self.contentStyles=[];self.setupEvents();self.execCommands={};self.queryStateCommands={};self.queryValueCommands={};self.execCallback("setup",self)},
render:function(nst){var t=this,s=t.settings,id=t.id,sl=tinymce.ScriptLoader;if(!Event.domLoaded){Event.add(window,"ready",function(){t.render()});return}tinyMCE.settings=s;if(!t.getElement())return;if(tinymce.isIDevice&&!tinymce.isIOS5)return;if(!/TEXTAREA|INPUT/i.test(t.getElement().nodeName)&&s.hidden_input&&DOM.getParent(id,"form"))DOM.insertAfter(DOM.create("input",{type:"hidden",name:id}),id);if(!s.content_editable){t.orgVisibility=t.getElement().style.visibility;t.getElement().style.visibility=
"hidden"}if(tinymce.WindowManager)t.windowManager=new tinymce.WindowManager(t);if(s.encoding=="xml")t.onGetContent.add(function(ed,o){if(o.save)o.content=DOM.encode(o.content)});if(s.add_form_submit_trigger)t.onSubmit.addToTop(function(){if(t.initialized){t.save();t.isNotDirty=1}});if(s.add_unload_trigger)t._beforeUnload=tinyMCE.onBeforeUnload.add(function(){if(t.initialized&&!t.destroyed&&!t.isHidden())t.save({format:"raw",no_events:true})});tinymce.addUnload(t.destroy,t);if(s.submit_patch)t.onBeforeRenderUI.add(function(){var n=
t.getElement().form;if(!n)return;if(n._mceOldSubmit)return;if(!n.submit.nodeType&&!n.submit.length){t.formElement=n;n._mceOldSubmit=n.submit;n.submit=function(){tinymce.triggerSave();t.isNotDirty=1;return t.formElement._mceOldSubmit(t.formElement)}}n=null});function loadScripts(){if(s.language&&s.language_load!==false)sl.add(tinymce.baseURL+"/langs/"+s.language+".js");if(s.theme&&typeof s.theme!="function"&&s.theme.charAt(0)!="-"&&!ThemeManager.urls[s.theme])ThemeManager.load(s.theme,"themes/"+s.theme+
"/editor_template"+tinymce.suffix+".js");each(explode(s.plugins),function(p){if(p&&!PluginManager.urls[p])if(p.charAt(0)=="-"){p=p.substr(1,p.length);var dependencies=PluginManager.dependencies(p);each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/editor_plugin"+tinymce.suffix+".js"};dep=PluginManager.createUrl(defaultSettings,dep);PluginManager.load(dep.resource,dep)})}else{if(p=="safari")return;PluginManager.load(p,{prefix:"plugins/",resource:p,suffix:"/editor_plugin"+
tinymce.suffix+".js"})}});sl.loadQueue(function(){if(!t.removed)t.init()})}loadScripts()},init:function(){var n,t=this,s=t.settings,w,h,mh,e=t.getElement(),o,ti,u,bi,bc,re,i,initializedPlugins=[];tinymce.add(t);s.aria_label=s.aria_label||DOM.getAttrib(e,"aria-label",t.getLang("aria.rich_text_area"));if(s.theme)if(typeof s.theme!="function"){s.theme=s.theme.replace(/-/,"");o=ThemeManager.get(s.theme);t.theme=new o;if(t.theme.init)t.theme.init(t,ThemeManager.urls[s.theme]||tinymce.documentBaseURL.replace(/\/$/,
""))}else t.theme=s.theme;function initPlugin(p){var c=PluginManager.get(p),u=PluginManager.urls[p]||tinymce.documentBaseURL.replace(/\/$/,""),po;if(c&&tinymce.inArray(initializedPlugins,p)===-1){each(PluginManager.dependencies(p),function(dep){initPlugin(dep)});po=new c(t,u);t.plugins[p]=po;if(po.init){po.init(t,u);initializedPlugins.push(p)}}}each(explode(s.plugins.replace(/\-/g,"")),initPlugin);if(s.popup_css!==false)if(s.popup_css)s.popup_css=t.documentBaseURI.toAbsolute(s.popup_css);else s.popup_css=
t.baseURI.toAbsolute("themes/"+s.theme+"/skins/"+s.skin+"/dialog.css");if(s.popup_css_add)s.popup_css+=","+t.documentBaseURI.toAbsolute(s.popup_css_add);t.controlManager=new tinymce.ControlManager(t);t.onBeforeRenderUI.dispatch(t,t.controlManager);if(s.render_ui&&t.theme){t.orgDisplay=e.style.display;if(typeof s.theme!="function"){w=s.width||e.style.width||e.offsetWidth;h=s.height||e.style.height||e.offsetHeight;mh=s.min_height||100;re=/^[0-9\.]+(|px)$/i;if(re.test(""+w))w=Math.max(parseInt(w,10)+
(o.deltaWidth||0),100);if(re.test(""+h))h=Math.max(parseInt(h,10)+(o.deltaHeight||0),mh);o=t.theme.renderUI({targetNode:e,width:w,height:h,deltaWidth:s.delta_width,deltaHeight:s.delta_height});DOM.setStyles(o.sizeContainer||o.editorContainer,{width:w,height:h});h=(o.iframeHeight||h)+(typeof h=="number"?o.deltaHeight||0:"");if(h<mh)h=mh}else{o=s.theme(t,e);if(o.editorContainer.nodeType)o.editorContainer=o.editorContainer.id=o.editorContainer.id||t.id+"_parent";if(o.iframeContainer.nodeType)o.iframeContainer=
o.iframeContainer.id=o.iframeContainer.id||t.id+"_iframecontainer";h=o.iframeHeight||e.offsetHeight;if(isIE)t.onInit.add(function(ed){ed.dom.bind(ed.getBody(),"beforedeactivate keydown",function(){ed.lastIERng=ed.selection.getRng()})})}t.editorContainer=o.editorContainer}if(s.content_css)each(explode(s.content_css),function(u){t.contentCSS.push(t.documentBaseURI.toAbsolute(u))});if(s.content_style)t.contentStyles.push(s.content_style);if(s.content_editable){e=n=o=null;return t.initContentBody()}if(document.domain&&
location.hostname!=document.domain)tinymce.relaxedDomain=document.domain;t.iframeHTML=s.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';if(s.document_base_url!=tinymce.documentBaseURL)t.iframeHTML+='<base href="'+t.documentBaseURI.getURI()+'" />';if(s.ie7_compat)t.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />';else t.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=edge" />';t.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';
for(i=0;i<t.contentCSS.length;i++)t.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+t.contentCSS[i]+'" />';t.contentCSS=[];bi=s.body_id||"tinymce";if(bi.indexOf("=")!=-1){bi=t.getParam("body_id","","hash");bi=bi[t.id]||bi}bc=s.body_class||"";if(bc.indexOf("=")!=-1){bc=t.getParam("body_class","","hash");bc=bc[t.id]||""}t.iframeHTML+='</head><body id="'+bi+'" class="mceContentBody '+bc+'" onload="window.parent.tinyMCE.get(\''+t.id+"').onLoad.dispatch();\"><br></body></html>";if(tinymce.relaxedDomain&&
(isIE||tinymce.isOpera&&parseFloat(opera.version())<11))u='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+t.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody();})()';n=DOM.add(o.iframeContainer,"iframe",{id:t.id+"_ifr",src:u||'javascript:""',frameBorder:"0",allowTransparency:"true",title:s.aria_label,style:{width:"100%",height:h,display:"block"}});t.contentAreaContainer=o.iframeContainer;if(o.editorContainer)DOM.get(o.editorContainer).style.display=
t.orgDisplay;e.style.visibility=t.orgVisibility;DOM.get(t.id).style.display="none";DOM.setAttrib(t.id,"aria-hidden",true);if(!tinymce.relaxedDomain||!u)t.initContentBody();e=n=o=null},initContentBody:function(){var self=this,settings=self.settings,targetElm=DOM.get(self.id),doc=self.getDoc(),html,body,contentCssText;if((!isIE||!tinymce.relaxedDomain)&&!settings.content_editable){doc.open();doc.write(self.iframeHTML);doc.close();if(tinymce.relaxedDomain)doc.domain=tinymce.relaxedDomain}if(settings.content_editable){DOM.addClass(targetElm,
"mceContentBody");self.contentDocument=doc=settings.content_document||document;self.contentWindow=settings.content_window||window;self.bodyElement=targetElm;settings.content_document=settings.content_window=null}body=self.getBody();body.disabled=true;if(!settings.readonly)body.contentEditable=self.getParam("content_editable_state",true);body.disabled=false;self.schema=new tinymce.html.Schema(settings);self.dom=new tinymce.dom.DOMUtils(doc,{keep_values:true,url_converter:self.convertURL,url_converter_scope:self,
hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:true,root_element:settings.content_editable?self.id:null,schema:self.schema});self.parser=new tinymce.html.DomParser(settings,self.schema);self.parser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,dom=self.dom,value,internalName;while(i--){node=nodes[i];value=node.attr(name);internalName="data-mce-"+name;if(!node.attributes.map[internalName])if(name==="style")node.attr(internalName,
dom.serializeStyle(dom.parseStyle(value),node.name));else node.attr(internalName,self.convertURL(value,name,node.name))}});self.parser.addNodeFilter("script",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];node.attr("type","mce-"+(node.attr("type")||"text/javascript"))}});self.parser.addNodeFilter("#cdata",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];node.type=8;node.name="#comment";node.value="[CDATA["+node.value+"]]"}});self.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",
function(nodes,name){var i=nodes.length,node,nonEmptyElements=self.schema.getNonEmptyElements();while(i--){node=nodes[i];if(node.isEmpty(nonEmptyElements))node.empty().append(new tinymce.html.Node("br",1)).shortEnded=true}});self.serializer=new tinymce.dom.Serializer(settings,self.dom,self.schema);self.selection=new tinymce.dom.Selection(self.dom,self.getWin(),self.serializer,self);self.formatter=new tinymce.Formatter(self);self.undoManager=new tinymce.UndoManager(self);self.forceBlocks=new tinymce.ForceBlocks(self);
self.enterKey=new tinymce.EnterKey(self);self.editorCommands=new tinymce.EditorCommands(self);self.onExecCommand.add(function(editor,command){if(!/^(FontName|FontSize)$/.test(command))self.nodeChanged()});self.serializer.onPreProcess.add(function(se,o){return self.onPreProcess.dispatch(self,o,se)});self.serializer.onPostProcess.add(function(se,o){return self.onPostProcess.dispatch(self,o,se)});self.onPreInit.dispatch(self);if(!settings.browser_spellcheck&&!settings.gecko_spellcheck)doc.body.spellcheck=
false;if(!settings.readonly)self.bindNativeEvents();self.controlManager.onPostRender.dispatch(self,self.controlManager);self.onPostRender.dispatch(self);self.quirks=tinymce.util.Quirks(self);if(settings.directionality)body.dir=settings.directionality;if(settings.nowrap)body.style.whiteSpace="nowrap";if(settings.protect)self.onBeforeSetContent.add(function(ed,o){each(settings.protect,function(pattern){o.content=o.content.replace(pattern,function(str){return"<\!--mce:protected "+escape(str)+"--\>"})})});
self.onSetContent.add(function(){self.addVisual(self.getBody())});if(settings.padd_empty_editor)self.onPostProcess.add(function(ed,o){o.content=o.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")});self.load({initial:true,format:"html"});self.startContent=self.getContent({format:"raw"});self.initialized=true;self.onInit.dispatch(self);self.execCallback("setupcontent_callback",self.id,body,doc);self.execCallback("init_instance_callback",self);self.focus(true);
self.nodeChanged({initial:true});if(self.contentStyles.length>0){contentCssText="";each(self.contentStyles,function(style){contentCssText+=style+"\r\n"});self.dom.addStyle(contentCssText)}each(self.contentCSS,function(url){self.dom.loadCSS(url)});if(settings.auto_focus)setTimeout(function(){var ed=tinymce.get(settings.auto_focus);ed.selection.select(ed.getBody(),1);ed.selection.collapse(1);ed.getBody().focus();ed.getWin().focus()},100);targetElm=doc=body=null},focus:function(skip_focus){var oed,self=
this,selection=self.selection,contentEditable=self.settings.content_editable,ieRng,controlElm,doc=self.getDoc(),body;if(!skip_focus){if(self.lastIERng)selection.setRng(self.lastIERng);ieRng=selection.getRng();if(ieRng.item)controlElm=ieRng.item(0);self._refreshContentEditable();if(!contentEditable)self.getWin().focus();if(tinymce.isGecko||contentEditable){body=self.getBody();if(body.setActive)body.setActive();else body.focus();if(contentEditable)selection.normalize()}if(controlElm&&controlElm.ownerDocument==
doc){ieRng=doc.body.createControlRange();ieRng.addElement(controlElm);ieRng.select()}}if(tinymce.activeEditor!=self){if((oed=tinymce.activeEditor)!=null)oed.onDeactivate.dispatch(oed,self);self.onActivate.dispatch(self,oed)}tinymce._setActive(self)},execCallback:function(n){var t=this,f=t.settings[n],s;if(!f)return;if(t.callbackLookup&&(s=t.callbackLookup[n])){f=s.func;s=s.scope}if(is(f,"string")){s=f.replace(/\.\w+$/,"");s=s?tinymce.resolve(s):0;f=tinymce.resolve(f);t.callbackLookup=t.callbackLookup||
{};t.callbackLookup[n]={func:f,scope:s}}return f.apply(s||t,Array.prototype.slice.call(arguments,1))},translate:function(s){var c=this.settings.language||"en",i18n=tinymce.i18n;if(!s)return"";return i18n[c+"."+s]||s.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n[c+"."+b]||"{#"+b+"}"})},getLang:function(n,dv){return tinymce.i18n[(this.settings.language||"en")+"."+n]||(is(dv)?dv:"{#"+n+"}")},getParam:function(n,dv,ty){var tr=tinymce.trim,v=is(this.settings[n])?this.settings[n]:dv,o;if(ty==="hash"){o=
{};if(is(v,"string"))each(v.indexOf("=")>0?v.split(/[;,](?![^=;,]*(?:[;,]|$))/):v.split(","),function(v){v=v.split("=");if(v.length>1)o[tr(v[0])]=tr(v[1]);else o[tr(v[0])]=tr(v)});else o=v;return o}return v},nodeChanged:function(o){var self=this,selection=self.selection,node;if(self.initialized){o=o||{};node=selection.getStart()||self.getBody();node=isIE&&node.ownerDocument!=self.getDoc()?self.getBody():node;o.parents=[];self.dom.getParent(node,function(node){if(node.nodeName=="BODY")return true;
o.parents.push(node)});self.onNodeChange.dispatch(self,o?o.controlManager||self.controlManager:self.controlManager,node,selection.isCollapsed(),o)}},addButton:function(name,settings){var self=this;self.buttons=self.buttons||{};self.buttons[name]=settings},addCommand:function(name,callback,scope){this.execCommands[name]={func:callback,scope:scope||this}},addQueryStateHandler:function(name,callback,scope){this.queryStateCommands[name]={func:callback,scope:scope||this}},addQueryValueHandler:function(name,
callback,scope){this.queryValueCommands[name]={func:callback,scope:scope||this}},addShortcut:function(pa,desc,cmd_func,sc){var t=this,c;if(t.settings.custom_shortcuts===false)return false;t.shortcuts=t.shortcuts||{};if(is(cmd_func,"string")){c=cmd_func;cmd_func=function(){t.execCommand(c,false,null)}}if(is(cmd_func,"object")){c=cmd_func;cmd_func=function(){t.execCommand(c[0],c[1],c[2])}}each(explode(pa),function(pa){var o={func:cmd_func,scope:sc||this,desc:t.translate(desc),alt:false,ctrl:false,shift:false};
each(explode(pa,"+"),function(v){switch(v){case "alt":case "ctrl":case "shift":o[v]=true;break;default:o.charCode=v.charCodeAt(0);o.keyCode=v.toUpperCase().charCodeAt(0)}});t.shortcuts[(o.ctrl?"ctrl":"")+","+(o.alt?"alt":"")+","+(o.shift?"shift":"")+","+o.keyCode]=o});return true},execCommand:function(cmd,ui,val,a){var t=this,s=0,o,st;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(cmd)&&(!a||!a.skip_focus))t.focus();a=extend({},a);t.onBeforeExecCommand.dispatch(t,
cmd,ui,val,a);if(a.terminate)return false;if(t.execCallback("execcommand_callback",t.id,t.selection.getNode(),cmd,ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);return true}if(o=t.execCommands[cmd]){st=o.func.call(o.scope,ui,val);if(st!==true){t.onExecCommand.dispatch(t,cmd,ui,val,a);return st}}each(t.plugins,function(p){if(p.execCommand&&p.execCommand(cmd,ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);s=1;return false}});if(s)return true;if(t.theme&&t.theme.execCommand&&t.theme.execCommand(cmd,
ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);return true}if(t.editorCommands.execCommand(cmd,ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);return true}t.getDoc().execCommand(cmd,ui,val);t.onExecCommand.dispatch(t,cmd,ui,val,a)},queryCommandState:function(cmd){var t=this,o,s;if(t._isHidden())return;if(o=t.queryStateCommands[cmd]){s=o.func.call(o.scope);if(s!==true)return s}o=t.editorCommands.queryCommandState(cmd);if(o!==-1)return o;try{return this.getDoc().queryCommandState(cmd)}catch(ex){}},
queryCommandValue:function(c){var t=this,o,s;if(t._isHidden())return;if(o=t.queryValueCommands[c]){s=o.func.call(o.scope);if(s!==true)return s}o=t.editorCommands.queryCommandValue(c);if(is(o))return o;try{return this.getDoc().queryCommandValue(c)}catch(ex){}},show:function(){var self=this;DOM.show(self.getContainer());DOM.hide(self.id);self.load()},hide:function(){var self=this,doc=self.getDoc();if(isIE&&doc)doc.execCommand("SelectAll");self.save();DOM.hide(self.getContainer());DOM.setStyle(self.id,
"display",self.orgDisplay)},isHidden:function(){return!DOM.isHidden(this.id)},setProgressState:function(b,ti,o){this.onSetProgressState.dispatch(this,b,ti,o);return b},load:function(o){var t=this,e=t.getElement(),h;if(e){o=o||{};o.load=true;h=t.setContent(is(e.value)?e.value:e.innerHTML,o);o.element=e;if(!o.no_events)t.onLoadContent.dispatch(t,o);o.element=e=null;return h}},save:function(o){var t=this,e=t.getElement(),h,f;if(!e||!t.initialized)return;o=o||{};o.save=true;o.element=e;h=o.content=t.getContent(o);
if(!o.no_events)t.onSaveContent.dispatch(t,o);h=o.content;if(!/TEXTAREA|INPUT/i.test(e.nodeName)){e.innerHTML=h;if(f=DOM.getParent(t.id,"form"))each(f.elements,function(e){if(e.name==t.id){e.value=h;return false}})}else e.value=h;o.element=e=null;return h},setContent:function(content,args){var self=this,rootNode,body=self.getBody(),forcedRootBlockName;args=args||{};args.format=args.format||"html";args.set=true;args.content=content;if(!args.no_events)self.onBeforeSetContent.dispatch(self,args);content=
args.content;if(!tinymce.isIE&&(content.length===0||/^\s+$/.test(content))){forcedRootBlockName=self.settings.forced_root_block;if(forcedRootBlockName)content="<"+forcedRootBlockName+'><br data-mce-bogus="1"></'+forcedRootBlockName+">";else content='<br data-mce-bogus="1">';body.innerHTML=content;self.selection.select(body,true);self.selection.collapse(true);return}if(args.format!=="raw")content=(new tinymce.html.Serializer({},self.schema)).serialize(self.parser.parse(content));args.content=tinymce.trim(content);
self.dom.setHTML(body,args.content);if(!args.no_events)self.onSetContent.dispatch(self,args);if(!self.settings.content_editable||document.activeElement===self.getBody())self.selection.normalize();return args.content},getContent:function(args){var self=this,content,body=self.getBody();args=args||{};args.format=args.format||"html";args.get=true;args.getInner=true;if(!args.no_events)self.onBeforeGetContent.dispatch(self,args);if(args.format=="raw")content=body.innerHTML;else if(args.format=="text")content=
body.innerText||body.textContent;else content=self.serializer.serialize(body,args);if(args.format!="text")args.content=tinymce.trim(content);else args.content=content;if(!args.no_events)self.onGetContent.dispatch(self,args);return args.content},isDirty:function(){var self=this;return tinymce.trim(self.startContent)!=tinymce.trim(self.getContent({format:"raw",no_events:1}))&&!self.isNotDirty},getContainer:function(){var self=this;if(!self.container)self.container=DOM.get(self.editorContainer||self.id+
"_parent");return self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return DOM.get(this.settings.content_element||this.id)},getWin:function(){var self=this,elm;if(!self.contentWindow){elm=DOM.get(self.id+"_ifr");if(elm)self.contentWindow=elm.contentWindow}return self.contentWindow},getDoc:function(){var self=this,win;if(!self.contentDocument){win=self.getWin();if(win)self.contentDocument=win.document}return self.contentDocument},getBody:function(){return this.bodyElement||
this.getDoc().body},convertURL:function(url,name,elm){var self=this,settings=self.settings;if(settings.urlconverter_callback)return self.execCallback("urlconverter_callback",url,elm,true,name);if(!settings.convert_urls||elm&&elm.nodeName=="LINK"||url.indexOf("file:")===0)return url;if(settings.relative_urls)return self.documentBaseURI.toRelative(url);url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host);return url},addVisual:function(elm){var self=this,settings=self.settings,dom=self.dom,
cls;elm=elm||self.getBody();if(!is(self.hasVisual))self.hasVisual=settings.visual;each(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case "TABLE":cls=settings.visual_table_class||"mceItemTable";value=dom.getAttrib(elm,"border");if(!value||value=="0")if(self.hasVisual)dom.addClass(elm,cls);else dom.removeClass(elm,cls);return;case "A":if(!dom.getAttrib(elm,"href",false)){value=dom.getAttrib(elm,"name")||elm.id;cls="mceItemAnchor";if(value)if(self.hasVisual)dom.addClass(elm,
cls);else dom.removeClass(elm,cls)}return}});self.onVisualAid.dispatch(self,elm,self.hasVisual)},remove:function(){var self=this,elm=self.getContainer();if(!self.removed){self.removed=1;self.hide();if(!self.settings.content_editable){Event.unbind(self.getWin());Event.unbind(self.getDoc())}Event.unbind(self.getBody());Event.clear(elm);self.execCallback("remove_instance_callback",self);self.onRemove.dispatch(self);self.onExecCommand.listeners=[];tinymce.remove(self);DOM.remove(elm)}},destroy:function(s){var t=
this;if(t.destroyed)return;if(isGecko){Event.unbind(t.getDoc());Event.unbind(t.getWin());Event.unbind(t.getBody())}if(!s){tinymce.removeUnload(t.destroy);tinyMCE.onBeforeUnload.remove(t._beforeUnload);if(t.theme&&t.theme.destroy)t.theme.destroy();t.controlManager.destroy();t.selection.destroy();t.dom.destroy()}if(t.formElement){t.formElement.submit=t.formElement._mceOldSubmit;t.formElement._mceOldSubmit=null}t.contentAreaContainer=t.formElement=t.container=t.settings.content_element=t.bodyElement=
t.contentDocument=t.contentWindow=null;if(t.selection)t.selection=t.selection.win=t.selection.dom=t.selection.dom.doc=null;t.destroyed=1},_refreshContentEditable:function(){var self=this,body,parent;if(self._isHidden()){body=self.getBody();parent=body.parentNode;parent.removeChild(body);parent.appendChild(body);body.focus()}},_isHidden:function(){var s;if(!isGecko)return 0;s=this.selection.getSel();return!s||!s.rangeCount||s.rangeCount===0}})})(tinymce);
(function(tinymce){var each=tinymce.each;tinymce.Editor.prototype.setupEvents=function(){var self=this,settings=self.settings;each(["onPreInit","onBeforeRenderUI","onPostRender","onLoad","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp","onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent",
"onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState","onSetAttrib"],function(name){self[name]=new tinymce.util.Dispatcher(self)});if(settings.cleanup_callback){self.onBeforeSetContent.add(function(ed,o){o.content=ed.execCallback("cleanup_callback","insert_to_editor",o.content,o)});self.onPreProcess.add(function(ed,o){if(o.set)ed.execCallback("cleanup_callback","insert_to_editor_dom",o.node,o);if(o.get)ed.execCallback("cleanup_callback",
"get_from_editor_dom",o.node,o)});self.onPostProcess.add(function(ed,o){if(o.set)o.content=ed.execCallback("cleanup_callback","insert_to_editor",o.content,o);if(o.get)o.content=ed.execCallback("cleanup_callback","get_from_editor",o.content,o)})}if(settings.save_callback)self.onGetContent.add(function(ed,o){if(o.save)o.content=ed.execCallback("save_callback",ed.id,o.content,ed.getBody())});if(settings.handle_event_callback)self.onEvent.add(function(ed,e,o){if(self.execCallback("handle_event_callback",
e,ed,o)===false){e.preventDefault();e.stopPropagation()}});if(settings.handle_node_change_callback)self.onNodeChange.add(function(ed,cm,n){ed.execCallback("handle_node_change_callback",ed.id,n,-1,-1,true,ed.selection.isCollapsed())});if(settings.save_callback)self.onSaveContent.add(function(ed,o){var h=ed.execCallback("save_callback",ed.id,o.content,ed.getBody());if(h)o.content=h});if(settings.onchange_callback)self.onChange.add(function(ed,l){ed.execCallback("onchange_callback",ed,l)})};tinymce.Editor.prototype.bindNativeEvents=
function(){var self=this,i,settings=self.settings,dom=self.dom,nativeToDispatcherMap;nativeToDispatcherMap={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};function eventHandler(evt,args){var type=evt.type;if(self.removed)return;if(self.onEvent.dispatch(self,evt,args)!==false)self[nativeToDispatcherMap[evt.fakeType||evt.type]].dispatch(self,
evt,args)}function doOperaFocus(e){self.focus(true)}function nodeChanged(ed,e){if(e.keyCode!=65||!tinymce.VK.metaKeyPressed(e))self.selection.normalize();self.nodeChanged()}each(nativeToDispatcherMap,function(dispatcherName,nativeName){var root=settings.content_editable?self.getBody():self.getDoc();switch(nativeName){case "contextmenu":dom.bind(root,nativeName,eventHandler);break;case "paste":dom.bind(self.getBody(),nativeName,eventHandler);break;case "submit":case "reset":dom.bind(self.getElement().form||
tinymce.DOM.getParent(self.id,"form"),nativeName,eventHandler);break;default:dom.bind(root,nativeName,eventHandler)}});dom.bind(settings.content_editable?self.getBody():tinymce.isGecko?self.getDoc():self.getWin(),"focus",function(e){self.focus(true)});if(settings.content_editable&&tinymce.isOpera){dom.bind(self.getBody(),"click",doOperaFocus);dom.bind(self.getBody(),"keydown",doOperaFocus)}self.onMouseUp.add(nodeChanged);self.onKeyUp.add(function(ed,e){var keyCode=e.keyCode;if(keyCode>=33&&keyCode<=
36||keyCode>=37&&keyCode<=40||keyCode==13||keyCode==45||keyCode==46||keyCode==8||tinymce.isMac&&(keyCode==91||keyCode==93)||e.ctrlKey)nodeChanged(ed,e)});self.onReset.add(function(){self.setContent(self.startContent,{format:"raw"})});function handleShortcut(e,execute){if(e.altKey||e.ctrlKey||e.metaKey)each(self.shortcuts,function(shortcut){var ctrlState=tinymce.isMac?e.metaKey:e.ctrlKey;if(shortcut.ctrl!=ctrlState||shortcut.alt!=e.altKey||shortcut.shift!=e.shiftKey)return;if(e.keyCode==shortcut.keyCode||
e.charCode&&e.charCode==shortcut.charCode){e.preventDefault();if(execute)shortcut.func.call(shortcut.scope);return true}})}self.onKeyUp.add(function(ed,e){handleShortcut(e)});self.onKeyPress.add(function(ed,e){handleShortcut(e)});self.onKeyDown.add(function(ed,e){handleShortcut(e,true)});if(tinymce.isOpera)self.onClick.add(function(ed,e){e.preventDefault()})}})(tinymce);
(function(tinymce){var each=tinymce.each,undef,TRUE=true,FALSE=false;tinymce.EditorCommands=function(editor){var dom=editor.dom,selection=editor.selection,commands={state:{},exec:{},value:{}},settings=editor.settings,formatter=editor.formatter,bookmark;function execCommand(command,ui,value){var func;command=command.toLowerCase();if(func=commands.exec[command]){func(command,ui,value);return TRUE}return FALSE}function queryCommandState(command){var func;command=command.toLowerCase();if(func=commands.state[command])return func(command);
return-1}function queryCommandValue(command){var func;command=command.toLowerCase();if(func=commands.value[command])return func(command);return FALSE}function addCommands(command_list,type){type=type||"exec";each(command_list,function(callback,command){each(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})}tinymce.extend(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,addCommands:addCommands});function execNativeCommand(command,
ui,value){if(ui===undef)ui=FALSE;if(value===undef)value=null;return editor.getDoc().execCommand(command,ui,value)}function isFormatMatch(name){return formatter.match(name)}function toggleFormat(name,value){formatter.toggle(name,value?{value:value}:undef)}function storeSelection(type){bookmark=selection.getBookmark(type)}function restoreSelection(){selection.moveToBookmark(bookmark)}addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},
"Cut,Copy,Paste":function(command){var doc=editor.getDoc(),failed;try{execNativeCommand(command)}catch(ex){failed=TRUE}if(failed||!doc.queryCommandSupported(command))if(tinymce.isGecko)editor.windowManager.confirm(editor.getLang("clipboard_msg"),function(state){if(state)open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")});else editor.windowManager.alert(editor.getLang("clipboard_no_support"))},unlink:function(command){if(selection.isCollapsed())selection.select(selection.getNode());
execNativeCommand(command);selection.collapse(FALSE)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var align=command.substring(7);each("left,center,right,full".split(","),function(name){if(align!=name)formatter.remove("align"+name)});toggleFormat("align"+align);execCommand("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command);listElm=dom.getParent(selection.getNode(),"ol,ul");if(listElm){listParent=listElm.parentNode;
if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)){storeSelection();dom.split(listParent,listElm);restoreSelection()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor,FontName":function(command,ui,value){toggleFormat(command,value)},FontSize:function(command,ui,value){var fontClasses,fontSizes;if(value>=1&&value<=7){fontSizes=tinymce.explode(settings.font_size_style_values);fontClasses=tinymce.explode(settings.font_size_classes);
if(fontClasses)value=fontClasses[value-1]||value;else value=fontSizes[value-1]||value}toggleFormat(command,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(command){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent({cleanup:TRUE}),{cleanup:TRUE});selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,
value){var node=value||selection.getNode();if(node!=editor.getBody()){storeSelection();editor.dom.remove(node,TRUE);restoreSelection()}},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){if(node.nodeType==1&&counter++==value){selection.select(node);return FALSE}},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){var parser,serializer,parentNode,rootNode,fragment,
args,marker,nodeRect,viewPortRect,rng,node,node2,bookmarkHtml,viewportBodyElement;parser=editor.parser;serializer=new tinymce.html.Serializer({},editor.schema);bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">\ufeff</span>';args={content:value,format:"html"};selection.onBeforeSetContent.dispatch(selection,args);value=args.content;if(value.indexOf("{$caret}")==-1)value+="{$caret}";value=value.replace(/\{\$caret\}/,bookmarkHtml);if(!selection.isCollapsed())editor.getDoc().execCommand("Delete",
false,null);parentNode=selection.getNode();args={context:parentNode.nodeName.toLowerCase()};fragment=parser.parse(value,args);node=fragment.lastChild;if(node.attr("id")=="mce_marker"){marker=node;for(node=node.prev;node;node=node.walk(true))if(node.type==3||!dom.isBlock(node.name)){node.parent.insert(marker,node,node.name==="br");break}}if(!args.invalid){value=serializer.serialize(fragment);node=parentNode.firstChild;node2=parentNode.lastChild;if(!node||node===node2&&node.nodeName==="BR")dom.setHTML(parentNode,
value);else selection.setContent(value)}else{selection.setContent(bookmarkHtml);parentNode=selection.getNode();rootNode=editor.getBody();if(parentNode.nodeType==9)parentNode=node=rootNode;else node=parentNode;while(node!==rootNode){parentNode=node;node=node.parentNode}value=parentNode==rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode);value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)})));
if(parentNode==rootNode)dom.setHTML(rootNode,value);else dom.setOuterHTML(parentNode,value)}marker=dom.get("mce_marker");nodeRect=dom.getRect(marker);viewPortRect=dom.getViewPort(editor.getWin());if(nodeRect.y+nodeRect.h>viewPortRect.y+viewPortRect.h||nodeRect.y<viewPortRect.y||nodeRect.x>viewPortRect.x+viewPortRect.w||nodeRect.x<viewPortRect.x){viewportBodyElement=tinymce.isIE?editor.getDoc().documentElement:editor.getBody();viewportBodyElement.scrollLeft=nodeRect.x;viewportBodyElement.scrollTop=
nodeRect.y-viewPortRect.h+25}rng=dom.createRng();node=marker.previousSibling;if(node&&node.nodeType==3)rng.setStart(node,node.nodeValue.length);else{rng.setStartBefore(marker);rng.setEndBefore(marker)}dom.remove(marker);selection.setRng(rng);selection.onSetContent.dispatch(selection,args);editor.addVisual()},mceInsertRawHTML:function(command,ui,value){selection.setContent("tiny_mce_marker");editor.setContent(editor.getContent().replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,
ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){var intentValue,indentUnit,value;intentValue=settings.indentation;indentUnit=/[a-z%]+$/i.exec(intentValue);intentValue=parseInt(intentValue);if(!queryCommandState("InsertUnorderedList")&&!queryCommandState("InsertOrderedList")){if(!settings.forced_root_block&&!dom.getParent(selection.getNode(),dom.isBlock))formatter.apply("div");each(selection.getSelectedBlocks(),function(element){if(command==
"outdent"){value=Math.max(0,parseInt(element.style.paddingLeft||0)-intentValue);dom.setStyle(element,"paddingLeft",value?value+indentUnit:"")}else dom.setStyle(element,"paddingLeft",parseInt(element.style.paddingLeft||0)+intentValue+indentUnit)})}else execNativeCommand(command)},mceRepaint:function(){var bookmark;if(tinymce.isGecko)try{storeSelection(TRUE);if(selection.getSel())selection.getSel().selectAllChildren(editor.getBody());selection.collapse(TRUE);restoreSelection()}catch(ex){}},mceToggleFormat:function(command,
ui,value){formatter.toggle(value)},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual;editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",false,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;if(typeof value=="string")value={href:value};anchor=dom.getParent(selection.getNode(),
"a");value.href=value.href.replace(" ","%20");if(!anchor||!value.href)formatter.remove("link");if(value.href)formatter.apply("link",value,anchor)},selectAll:function(){var root=dom.getRoot(),rng=dom.createRng();if(selection.getRng().setStart){rng.setStart(root,0);rng.setEnd(root,root.childNodes.length);selection.setRng(rng)}else execNativeCommand("SelectAll")}});addCommands({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var name="align"+command.substring(7);var nodes=selection.isCollapsed()?
[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks();var matches=tinymce.map(nodes,function(node){return!!formatter.matchNode(node,name)});return tinymce.inArray(matches,TRUE)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft)>
0)return TRUE;if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft)>0)return TRUE}return queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&(command==="insertunorderedlist"&&list.tagName==="UL"||command==="insertorderedlist"&&list.tagName===
"OL")}},"state");addCommands({"FontSize,FontName":function(command){var value=0,parent;if(parent=dom.getParent(selection.getNode(),"span"))if(command=="fontsize")value=parent.style.fontSize;else value=parent.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return value}},"value");addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}})}})(tinymce);
(function(tinymce){var Dispatcher=tinymce.util.Dispatcher;tinymce.UndoManager=function(editor){var self,index=0,data=[],beforeBookmark,onAdd,onUndo,onRedo;function getContent(){return tinymce.trim(editor.getContent({format:"raw",no_events:1}).replace(/<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\/span>/g,""))}function addNonTypingUndoLevel(){self.typing=false;self.add()}onBeforeAdd=new Dispatcher(self);onAdd=new Dispatcher(self);onUndo=new Dispatcher(self);onRedo=new Dispatcher(self);onAdd.add(function(undoman,
level){if(undoman.hasUndo())return editor.onChange.dispatch(editor,level,undoman)});onUndo.add(function(undoman,level){return editor.onUndo.dispatch(editor,level,undoman)});onRedo.add(function(undoman,level){return editor.onRedo.dispatch(editor,level,undoman)});editor.onInit.add(function(){self.add()});editor.onBeforeExecCommand.add(function(ed,cmd,ui,val,args){if(cmd!="Undo"&&cmd!="Redo"&&cmd!="mceRepaint"&&(!args||!args.skip_undo))self.beforeChange()});editor.onExecCommand.add(function(ed,cmd,ui,
val,args){if(cmd!="Undo"&&cmd!="Redo"&&cmd!="mceRepaint"&&(!args||!args.skip_undo))self.add()});editor.onSaveContent.add(addNonTypingUndoLevel);editor.dom.bind(editor.dom.getRoot(),"dragend",addNonTypingUndoLevel);editor.dom.bind(editor.getDoc(),tinymce.isGecko?"blur":"focusout",function(e){if(!editor.removed&&self.typing)addNonTypingUndoLevel()});editor.onKeyUp.add(function(editor,e){var keyCode=e.keyCode;if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode==45||keyCode==13||e.ctrlKey)addNonTypingUndoLevel()});
editor.onKeyDown.add(function(editor,e){var keyCode=e.keyCode;if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode==45){if(self.typing)addNonTypingUndoLevel();return}if((keyCode<16||keyCode>20)&&keyCode!=224&&keyCode!=91&&!self.typing){self.beforeChange();self.typing=true;self.add()}});editor.onMouseDown.add(function(editor,e){if(self.typing)addNonTypingUndoLevel()});editor.addShortcut("ctrl+z","undo_desc","Undo");editor.addShortcut("ctrl+y","redo_desc","Redo");self={data:data,typing:false,
onBeforeAdd:onBeforeAdd,onAdd:onAdd,onUndo:onUndo,onRedo:onRedo,beforeChange:function(){beforeBookmark=editor.selection.getBookmark(2,true)},add:function(level){var i,settings=editor.settings,lastLevel;level=level||{};level.content=getContent();self.onBeforeAdd.dispatch(self,level);lastLevel=data[index];if(lastLevel&&lastLevel.content==level.content)return null;if(data[index])data[index].beforeBookmark=beforeBookmark;if(settings.custom_undo_redo_levels)if(data.length>settings.custom_undo_redo_levels){for(i=
0;i<data.length-1;i++)data[i]=data[i+1];data.length--;index=data.length}level.bookmark=editor.selection.getBookmark(2,true);if(index<data.length-1)data.length=index+1;data.push(level);index=data.length-1;self.onAdd.dispatch(self,level);editor.isNotDirty=0;return level},undo:function(){var level,i;if(self.typing){self.add();self.typing=false}if(index>0){level=data[--index];editor.setContent(level.content,{format:"raw"});editor.selection.moveToBookmark(level.beforeBookmark);self.onUndo.dispatch(self,
level)}return level},redo:function(){var level;if(index<data.length-1){level=data[++index];editor.setContent(level.content,{format:"raw"});editor.selection.moveToBookmark(level.bookmark);self.onRedo.dispatch(self,level)}return level},clear:function(){data=[];index=0;self.typing=false},hasUndo:function(){return index>0||this.typing},hasRedo:function(){return index<data.length-1&&!this.typing}};return self}})(tinymce);
tinymce.ForceBlocks=function(editor){var settings=editor.settings,dom=editor.dom,selection=editor.selection,blockElements=editor.schema.getBlockElements();function addRootBlocks(){var node=selection.getStart(),rootNode=editor.getBody(),rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,offset=-16777215,wrapped,isInEditorDocument;if(!node||node.nodeType!==1||!settings.forced_root_block)return;while(node&&node!=rootNode){if(blockElements[node.nodeName])return;node=node.parentNode}rng=
selection.getRng();if(rng.setStart){startContainer=rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset}else{if(rng.item){node=rng.item(0);rng=editor.getDoc().body.createTextRange();rng.moveToElementText(node)}isInEditorDocument=rng.parentElement().ownerDocument===editor.getDoc();tmpRng=rng.duplicate();tmpRng.collapse(true);startOffset=tmpRng.move("character",offset)*-1;if(!tmpRng.collapsed){tmpRng=rng.duplicate();tmpRng.collapse(false);endOffset=tmpRng.move("character",
offset)*-1-startOffset}}node=rootNode.firstChild;while(node)if(node.nodeType===3||node.nodeType==1&&!blockElements[node.nodeName]){if(node.nodeType===3&&node.nodeValue.length==0){tempNode=node;node=node.nextSibling;dom.remove(tempNode);continue}if(!rootBlockNode){rootBlockNode=dom.create(settings.forced_root_block);node.parentNode.insertBefore(rootBlockNode,node);wrapped=true}tempNode=node;node=node.nextSibling;rootBlockNode.appendChild(tempNode)}else{rootBlockNode=null;node=node.nextSibling}if(wrapped){if(rng.setStart){rng.setStart(startContainer,
startOffset);rng.setEnd(endContainer,endOffset);selection.setRng(rng)}else if(isInEditorDocument)try{rng=editor.getDoc().body.createTextRange();rng.moveToElementText(rootNode);rng.collapse(true);rng.moveStart("character",startOffset);if(endOffset>0)rng.moveEnd("character",endOffset);rng.select()}catch(ex){}editor.nodeChanged()}}if(settings.forced_root_block){editor.onKeyUp.add(addRootBlocks);editor.onNodeChange.add(addRootBlocks)}};
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each,extend=tinymce.extend;tinymce.create("tinymce.ControlManager",{ControlManager:function(ed,s){var t=this,i;s=s||{};t.editor=ed;t.controls={};t.onAdd=new tinymce.util.Dispatcher(t);t.onPostRender=new tinymce.util.Dispatcher(t);t.prefix=s.prefix||ed.id+"_";t._cls={};t.onPostRender.add(function(){each(t.controls,function(c){c.postRender()})})},get:function(id){return this.controls[this.prefix+id]||this.controls[id]},setActive:function(id,
s){var c=null;if(c=this.get(id))c.setActive(s);return c},setDisabled:function(id,s){var c=null;if(c=this.get(id))c.setDisabled(s);return c},add:function(c){var t=this;if(c){t.controls[c.id]=c;t.onAdd.dispatch(c,t)}return c},createControl:function(name){var ctrl,i,l,self=this,editor=self.editor,factories,ctrlName;if(!self.controlFactories){self.controlFactories=[];each(editor.plugins,function(plugin){if(plugin.createControl)self.controlFactories.push(plugin)})}factories=self.controlFactories;for(i=
0,l=factories.length;i<l;i++){ctrl=factories[i].createControl(name,self);if(ctrl)return self.add(ctrl)}if(name==="|"||name==="separator")return self.createSeparator();if(editor.buttons&&(ctrl=editor.buttons[name]))return self.createButton(name,ctrl);return self.add(ctrl)},createDropMenu:function(id,s,cc){var t=this,ed=t.editor,c,bm,v,cls;s=extend({"class":"mceDropDown",constrain:ed.settings.constrain_menus},s);s["class"]=s["class"]+" "+ed.getParam("skin")+"Skin";if(v=ed.getParam("skin_variant"))s["class"]+=
" "+ed.getParam("skin")+"Skin"+v.substring(0,1).toUpperCase()+v.substring(1);s["class"]+=ed.settings.directionality=="rtl"?" mceRtl":"";id=t.prefix+id;cls=cc||t._cls.dropmenu||tinymce.ui.DropMenu;c=t.controls[id]=new cls(id,s);c.onAddItem.add(function(c,o){var s=o.settings;s.title=ed.getLang(s.title,s.title);if(!s.onclick)s.onclick=function(v){if(s.cmd)ed.execCommand(s.cmd,s.ui||false,s.value)}});ed.onRemove.add(function(){c.destroy()});if(tinymce.isIE){c.onShowMenu.add(function(){ed.focus();bm=ed.selection.getBookmark(1)});
c.onHideMenu.add(function(){if(bm){ed.selection.moveToBookmark(bm);bm=0}})}return t.add(c)},createListBox:function(id,s,cc){var t=this,ed=t.editor,cmd,c,cls;if(t.get(id))return null;s.title=ed.translate(s.title);s.scope=s.scope||ed;if(!s.onselect)s.onselect=function(v){ed.execCommand(s.cmd,s.ui||false,v||s.value)};s=extend({title:s.title,"class":"mce_"+id,scope:s.scope,control_manager:t},s);id=t.prefix+id;function useNativeListForAccessibility(ed){return ed.settings.use_accessible_selects&&!tinymce.isGecko}
if(ed.settings.use_native_selects||useNativeListForAccessibility(ed))c=new tinymce.ui.NativeListBox(id,s);else{cls=cc||t._cls.listbox||tinymce.ui.ListBox;c=new cls(id,s,ed)}t.controls[id]=c;if(tinymce.isWebKit)c.onPostRender.add(function(c,n){Event.add(n,"mousedown",function(){ed.bookmark=ed.selection.getBookmark(1)});Event.add(n,"focus",function(){ed.selection.moveToBookmark(ed.bookmark);ed.bookmark=null})});if(c.hideMenu)ed.onMouseDown.add(c.hideMenu,c);return t.add(c)},createButton:function(id,
s,cc){var t=this,ed=t.editor,o,c,cls;if(t.get(id))return null;s.title=ed.translate(s.title);s.label=ed.translate(s.label);s.scope=s.scope||ed;if(!s.onclick&&!s.menu_button)s.onclick=function(){ed.execCommand(s.cmd,s.ui||false,s.value)};s=extend({title:s.title,"class":"mce_"+id,unavailable_prefix:ed.getLang("unavailable",""),scope:s.scope,control_manager:t},s);id=t.prefix+id;if(s.menu_button){cls=cc||t._cls.menubutton||tinymce.ui.MenuButton;c=new cls(id,s,ed);ed.onMouseDown.add(c.hideMenu,c)}else{cls=
t._cls.button||tinymce.ui.Button;c=new cls(id,s,ed)}return t.add(c)},createMenuButton:function(id,s,cc){s=s||{};s.menu_button=1;return this.createButton(id,s,cc)},createSplitButton:function(id,s,cc){var t=this,ed=t.editor,cmd,c,cls;if(t.get(id))return null;s.title=ed.translate(s.title);s.scope=s.scope||ed;if(!s.onclick)s.onclick=function(v){ed.execCommand(s.cmd,s.ui||false,v||s.value)};if(!s.onselect)s.onselect=function(v){ed.execCommand(s.cmd,s.ui||false,v||s.value)};s=extend({title:s.title,"class":"mce_"+
id,scope:s.scope,control_manager:t},s);id=t.prefix+id;cls=cc||t._cls.splitbutton||tinymce.ui.SplitButton;c=t.add(new cls(id,s,ed));ed.onMouseDown.add(c.hideMenu,c);return c},createColorSplitButton:function(id,s,cc){var t=this,ed=t.editor,cmd,c,cls,bm;if(t.get(id))return null;s.title=ed.translate(s.title);s.scope=s.scope||ed;if(!s.onclick)s.onclick=function(v){if(tinymce.isIE)bm=ed.selection.getBookmark(1);ed.execCommand(s.cmd,s.ui||false,v||s.value)};if(!s.onselect)s.onselect=function(v){ed.execCommand(s.cmd,
s.ui||false,v||s.value)};s=extend({title:s.title,"class":"mce_"+id,"menu_class":ed.getParam("skin")+"Skin",scope:s.scope,more_colors_title:ed.getLang("more_colors")},s);id=t.prefix+id;cls=cc||t._cls.colorsplitbutton||tinymce.ui.ColorSplitButton;c=new cls(id,s,ed);ed.onMouseDown.add(c.hideMenu,c);ed.onRemove.add(function(){c.destroy()});if(tinymce.isIE){c.onShowMenu.add(function(){ed.focus();bm=ed.selection.getBookmark(1)});c.onHideMenu.add(function(){if(bm){ed.selection.moveToBookmark(bm);bm=0}})}return t.add(c)},
createToolbar:function(id,s,cc){var c,t=this,cls;id=t.prefix+id;cls=cc||t._cls.toolbar||tinymce.ui.Toolbar;c=new cls(id,s,t.editor);if(t.get(id))return null;return t.add(c)},createToolbarGroup:function(id,s,cc){var c,t=this,cls;id=t.prefix+id;cls=cc||this._cls.toolbarGroup||tinymce.ui.ToolbarGroup;c=new cls(id,s,t.editor);if(t.get(id))return null;return t.add(c)},createSeparator:function(cc){var cls=cc||this._cls.separator||tinymce.ui.Separator;return new cls},setControlType:function(n,c){return this._cls[n.toLowerCase()]=
c},destroy:function(){each(this.controls,function(c){c.destroy()});this.controls=null}})})(tinymce);
(function(tinymce){var Dispatcher=tinymce.util.Dispatcher,each=tinymce.each,isIE=tinymce.isIE,isOpera=tinymce.isOpera;tinymce.create("tinymce.WindowManager",{WindowManager:function(ed){var t=this;t.editor=ed;t.onOpen=new Dispatcher(t);t.onClose=new Dispatcher(t);t.params={};t.features={}},open:function(s,p){var t=this,f="",x,y,mo=t.editor.settings.dialog_type=="modal",w,sw,sh,vp=tinymce.DOM.getViewPort(),u;s=s||{};p=p||{};sw=isOpera?vp.w:screen.width;sh=isOpera?vp.h:screen.height;s.name=s.name||"mc_"+
(new Date).getTime();s.width=parseInt(s.width||320);s.height=parseInt(s.height||240);s.resizable=true;s.left=s.left||parseInt(sw/2)-s.width/2;s.top=s.top||parseInt(sh/2)-s.height/2;p.inline=false;p.mce_width=s.width;p.mce_height=s.height;p.mce_auto_focus=s.auto_focus;if(mo)if(isIE){s.center=true;s.help=false;s.dialogWidth=s.width+"px";s.dialogHeight=s.height+"px";s.scroll=s.scrollbars||false}each(s,function(v,k){if(tinymce.is(v,"boolean"))v=v?"yes":"no";if(!/^(name|url)$/.test(k))if(isIE&&mo)f+=(f?
";":"")+k+":"+v;else f+=(f?",":"")+k+"="+v});t.features=s;t.params=p;t.onOpen.dispatch(t,s,p);u=s.url||s.file;u=tinymce._addVer(u);try{if(isIE&&mo){w=1;window.showModalDialog(u,window,f)}else w=window.open(u,s.name,f)}catch(ex){}if(!w)alert(t.editor.getLang("popup_blocked"))},close:function(w){w.close();this.onClose.dispatch(this)},createInstance:function(cl,a,b,c,d,e){var f=tinymce.resolve(cl);return new f(a,b,c,d,e)},confirm:function(t,cb,s,w){w=w||window;cb.call(s||this,w.confirm(this._decode(this.editor.getLang(t,
t))))},alert:function(tx,cb,s,w){var t=this;w=w||window;w.alert(t._decode(t.editor.getLang(tx,tx)));if(cb)cb.call(s||t)},resizeBy:function(dw,dh,win){win.resizeBy(dw,dh)},_decode:function(s){return tinymce.DOM.decode(s).replace(/\\n/g,"\n")}})})(tinymce);
(function(tinymce){tinymce.Formatter=function(ed){var formats={},each=tinymce.each,dom=ed.dom,selection=ed.selection,TreeWalker=tinymce.dom.TreeWalker,rangeUtils=new tinymce.dom.RangeUtils(dom),isValid=ed.schema.isValidChild,isBlock=dom.isBlock,forcedRootBlock=ed.settings.forced_root_block,nodeIndex=dom.nodeIndex,INVISIBLE_CHAR="\ufeff",MCE_ATTR_RE=/^(src|href|style)$/,FALSE=false,TRUE=true,formatChangeData,undef,getContentEditable=dom.getContentEditable;function isArray(obj){return obj instanceof
Array}function getParents(node,selector){return dom.getParents(node,selector,dom.getRoot())}function isCaretNode(node){return node.nodeType===1&&node.id==="_mce_caret"}function defaultFormats(){register({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},
{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],alignfull:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",
remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},
wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(node){return true},onformat:function(elm,fmt,vars){each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",
remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});each("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(name){register(name,{block:name,remove:"all"})});register(ed.settings.formats)}function addKeyboardShortcuts(){ed.addShortcut("ctrl+b","bold_desc","Bold");ed.addShortcut("ctrl+i",
"italic_desc","Italic");ed.addShortcut("ctrl+u","underline_desc","Underline");for(var i=1;i<=6;i++)ed.addShortcut("ctrl+"+i,"",["FormatBlock",false,"h"+i]);ed.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);ed.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);ed.addShortcut("ctrl+9","",["FormatBlock",false,"address"])}function get(name){return name?formats[name]:formats}function register(name,format){if(name)if(typeof name!=="string")each(name,function(format,name){register(name,format)});else{format=
format.length?format:[format];each(format,function(format){if(format.deep===undef)format.deep=!format.selector;if(format.split===undef)format.split=!format.selector||format.inline;if(format.remove===undef&&format.selector&&!format.inline)format.remove="none";if(format.selector&&format.inline){format.mixed=true;format.block_expand=true}if(typeof format.classes==="string")format.classes=format.classes.split(/\s+/)});formats[name]=format}}var getTextDecoration=function(node){var decoration;ed.dom.getParent(node,
function(n){decoration=ed.dom.getStyle(n,"text-decoration");return decoration&&decoration!=="none"});return decoration};var processUnderlineAndColor=function(node){var textDecoration;if(node.nodeType===1&&node.parentNode&&node.parentNode.nodeType===1){textDecoration=getTextDecoration(node.parentNode);if(ed.dom.getStyle(node,"color")&&textDecoration)ed.dom.setStyle(node,"text-decoration",textDecoration);else if(ed.dom.getStyle(node,"textdecoration")===textDecoration)ed.dom.setStyle(node,"text-decoration",
null)}};function apply(name,vars,node){var formatList=get(name),format=formatList[0],bookmark,rng,i,isCollapsed=selection.isCollapsed();function setElementFormat(elm,fmt){fmt=fmt||format;if(elm){if(fmt.onformat)fmt.onformat(elm,fmt,vars,node);each(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))});each(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))});each(fmt.classes,function(value){value=replaceVars(value,vars);if(!dom.hasClass(elm,
value))dom.addClass(elm,value)})}}function adjustSelectionToVisibleSelection(){function findSelectionEnd(start,end){var walker=new TreeWalker(end);for(node=walker.current();node;node=walker.prev())if(node.childNodes.length>1||node==start||node.tagName=="BR")return node}var rng=ed.selection.getRng();var start=rng.startContainer;var end=rng.endContainer;if(start!=end&&rng.endOffset===0){var newEnd=findSelectionEnd(start,end);var endOffset=newEnd.nodeType==3?newEnd.length:newEnd.childNodes.length;rng.setEnd(newEnd,
endOffset)}return rng}function applyStyleToList(node,bookmark,wrapElm,newWrappers,process){var nodes=[],listIndex=-1,list,startIndex=-1,endIndex=-1,currentWrapElm;each(node.childNodes,function(n,index){if(n.nodeName==="UL"||n.nodeName==="OL"){listIndex=index;list=n;return false}});each(node.childNodes,function(n,index){if(n.nodeName==="SPAN"&&dom.getAttrib(n,"data-mce-type")=="bookmark")if(n.id==bookmark.id+"_start")startIndex=index;else if(n.id==bookmark.id+"_end")endIndex=index});if(listIndex<=
0||startIndex<listIndex&&endIndex>listIndex){each(tinymce.grep(node.childNodes),process);return 0}else{currentWrapElm=dom.clone(wrapElm,FALSE);each(tinymce.grep(node.childNodes),function(n,index){if(startIndex<listIndex&&index<listIndex||startIndex>listIndex&&index>listIndex){nodes.push(n);n.parentNode.removeChild(n)}});if(startIndex<listIndex)node.insertBefore(currentWrapElm,list);else if(startIndex>listIndex)node.insertBefore(currentWrapElm,list.nextSibling);newWrappers.push(currentWrapElm);each(nodes,
function(node){currentWrapElm.appendChild(node)});return currentWrapElm}}function applyRngStyle(rng,bookmark,node_specific){var newWrappers=[],wrapName,wrapElm,contentEditable=true;wrapName=format.inline||format.block;wrapElm=dom.create(wrapName);setElementFormat(wrapElm);rangeUtils.walk(rng,function(nodes){var currentWrapElm;function process(node){var nodeName,parentName,found,hasContentEditableState,lastContentEditable;lastContentEditable=contentEditable;nodeName=node.nodeName.toLowerCase();parentName=
node.parentNode.nodeName.toLowerCase();if(node.nodeType===1&&getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=getContentEditable(node)==="true";hasContentEditableState=true}if(isEq(nodeName,"br")){currentWrapElm=0;if(format.block)dom.remove(node);return}if(format.wrapper&&matchNode(node,name,vars)){currentWrapElm=0;return}if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock(nodeName)){node=dom.rename(node,wrapName);setElementFormat(node);
newWrappers.push(node);currentWrapElm=0;return}if(format.selector){each(formatList,function(format){if("collapsed"in format&&format.collapsed!==isCollapsed)return;if(dom.is(node,format.selector)&&!isCaretNode(node)){setElementFormat(node,format);found=true}});if(!format.inline||found){currentWrapElm=0;return}}if(contentEditable&&!hasContentEditableState&&isValid(wrapName,nodeName)&&isValid(parentName,wrapName)&&!(!node_specific&&node.nodeType===3&&node.nodeValue.length===1&&node.nodeValue.charCodeAt(0)===
65279)&&!isCaretNode(node)){if(!currentWrapElm){currentWrapElm=dom.clone(wrapElm,FALSE);node.parentNode.insertBefore(currentWrapElm,node);newWrappers.push(currentWrapElm)}currentWrapElm.appendChild(node)}else if(nodeName=="li"&&bookmark)currentWrapElm=applyStyleToList(node,bookmark,wrapElm,newWrappers,process);else{currentWrapElm=0;each(tinymce.grep(node.childNodes),process);if(hasContentEditableState)contentEditable=lastContentEditable;currentWrapElm=0}}each(nodes,process)});if(format.wrap_links===
false)each(newWrappers,function(node){function process(node){var i,currentWrapElm,children;if(node.nodeName==="A"){currentWrapElm=dom.clone(wrapElm,FALSE);newWrappers.push(currentWrapElm);children=tinymce.grep(node.childNodes);for(i=0;i<children.length;i++)currentWrapElm.appendChild(children[i]);node.appendChild(currentWrapElm)}each(tinymce.grep(node.childNodes),process)}process(node)});each(newWrappers,function(node){var childCount;function getChildCount(node){var count=0;each(node.childNodes,function(node){if(!isWhiteSpaceNode(node)&&
!isBookmarkNode(node))count++});return count}function mergeStyles(node){var child,clone;each(node.childNodes,function(node){if(node.nodeType==1&&!isBookmarkNode(node)&&!isCaretNode(node)){child=node;return FALSE}});if(child&&matchName(child,format)){clone=dom.clone(child,FALSE);setElementFormat(clone);dom.replace(clone,node,TRUE);dom.remove(child,1)}return clone||node}childCount=getChildCount(node);if((newWrappers.length>1||!isBlock(node))&&childCount===0){dom.remove(node,1);return}if(format.inline||
format.wrapper){if(!format.exact&&childCount===1)node=mergeStyles(node);each(formatList,function(format){each(dom.select(format.inline,node),function(child){var parent;if(format.wrap_links===false){parent=child.parentNode;do if(parent.nodeName==="A")return;while(parent=parent.parentNode)}removeFormat(format,vars,child,format.exact?child:null)})});if(matchNode(node.parentNode,name,vars)){dom.remove(node,1);node=0;return TRUE}if(format.merge_with_parents)dom.getParent(node.parentNode,function(parent){if(matchNode(parent,
name,vars)){dom.remove(node,1);node=0;return TRUE}});if(node&&format.merge_siblings!==false){node=mergeSiblings(getNonWhiteSpaceSibling(node),node);node=mergeSiblings(node,getNonWhiteSpaceSibling(node,TRUE))}}})}if(format)if(node)if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);applyRngStyle(expandRng(rng,formatList),null,true)}else applyRngStyle(node,null,true);else if(!isCollapsed||!format.inline||dom.select("td.mceSelected,th.mceSelected").length){var curSelNode=
ed.selection.getNode();if(!forcedRootBlock&&formatList[0].defaultBlock&&!dom.getParent(curSelNode,dom.isBlock))apply(formatList[0].defaultBlock);ed.selection.setRng(adjustSelectionToVisibleSelection());bookmark=selection.getBookmark();applyRngStyle(expandRng(selection.getRng(TRUE),formatList),bookmark);if(format.styles&&(format.styles.color||format.styles.textDecoration)){tinymce.walk(curSelNode,processUnderlineAndColor,"childNodes");processUnderlineAndColor(curSelNode)}selection.moveToBookmark(bookmark);
moveStart(selection.getRng(TRUE));ed.nodeChanged()}else performCaretAction("apply",name,vars)}function remove(name,vars,node){var formatList=get(name),format=formatList[0],bookmark,i,rng,contentEditable=true;function process(node){var children,i,l,localContentEditable,lastContentEditable,hasContentEditableState;if(node.nodeType===1&&getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=getContentEditable(node)==="true";hasContentEditableState=true}children=tinymce.grep(node.childNodes);
if(contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;i<l;i++)if(removeFormat(formatList[i],vars,node,node))break;if(format.deep)if(children.length){for(i=0,l=children.length;i<l;i++)process(children[i]);if(hasContentEditableState)contentEditable=lastContentEditable}}function findFormatRoot(container){var formatRoot;each(getParents(container.parentNode).reverse(),function(parent){var format;if(!formatRoot&&parent.id!="_start"&&parent.id!="_end"){format=matchNode(parent,name,vars);
if(format&&format.split!==false)formatRoot=parent}});return formatRoot}function wrapAndSplit(format_root,container,target,split){var parent,clone,lastClone,firstClone,i,formatRootParent;if(format_root){formatRootParent=format_root.parentNode;for(parent=container.parentNode;parent&&parent!=formatRootParent;parent=parent.parentNode){clone=dom.clone(parent,FALSE);for(i=0;i<formatList.length;i++)if(removeFormat(formatList[i],vars,clone,clone)){clone=0;break}if(clone){if(lastClone)clone.appendChild(lastClone);
if(!firstClone)firstClone=clone;lastClone=clone}}if(split&&(!format.mixed||!isBlock(format_root)))container=dom.split(format_root,container);if(lastClone){target.parentNode.insertBefore(lastClone,target);firstClone.appendChild(target)}}return container}function splitToFormatRoot(container){return wrapAndSplit(findFormatRoot(container),container,container,true)}function unwrap(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];if(isBookmarkNode(out))out=out[start?
"firstChild":"lastChild"];dom.remove(node,true);return out}function removeRngStyle(rng){var startContainer,endContainer,node;rng=expandRng(rng,formatList,TRUE);if(format.split){startContainer=getContainer(rng,TRUE);endContainer=getContainer(rng);if(startContainer!=endContainer){if(/^(TR|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild)startContainer=(startContainer.nodeName=="TD"?startContainer.firstChild:startContainer.firstChild.firstChild)||startContainer;startContainer=wrap(startContainer,
"span",{id:"_start","data-mce-type":"bookmark"});endContainer=wrap(endContainer,"span",{id:"_end","data-mce-type":"bookmark"});splitToFormatRoot(startContainer);splitToFormatRoot(endContainer);startContainer=unwrap(TRUE);endContainer=unwrap()}else startContainer=endContainer=splitToFormatRoot(startContainer);rng.startContainer=startContainer.parentNode;rng.startOffset=nodeIndex(startContainer);rng.endContainer=endContainer.parentNode;rng.endOffset=nodeIndex(endContainer)+1}rangeUtils.walk(rng,function(nodes){each(nodes,
function(node){process(node);if(node.nodeType===1&&ed.dom.getStyle(node,"text-decoration")==="underline"&&node.parentNode&&getTextDecoration(node.parentNode)==="underline")removeFormat({"deep":false,"exact":true,"inline":"span","styles":{"textDecoration":"underline"}},null,node)})})}if(node){if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);removeRngStyle(rng)}else removeRngStyle(node);return}if(!selection.isCollapsed()||!format.inline||dom.select("td.mceSelected,th.mceSelected").length){bookmark=
selection.getBookmark();removeRngStyle(selection.getRng(TRUE));selection.moveToBookmark(bookmark);if(format.inline&&match(name,vars,selection.getStart()))moveStart(selection.getRng(true));ed.nodeChanged()}else performCaretAction("remove",name,vars)}function toggle(name,vars,node){var fmt=get(name);if(match(name,vars,node)&&(!("toggle"in fmt[0])||fmt[0].toggle))remove(name,vars,node);else apply(name,vars,node)}function matchNode(node,name,vars,similar){var formatList=get(name),format,i,classes;function matchItems(node,
format,item_name){var key,value,items=format[item_name],i;if(format.onmatch)return format.onmatch(node,format,item_name);if(items)if(items.length===undef)for(key in items){if(items.hasOwnProperty(key)){if(item_name==="attributes")value=dom.getAttrib(node,key);else value=getStyle(node,key);if(similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq(value,replaceVars(items[key],vars)))return}}else for(i=0;i<items.length;i++)if(item_name==="attributes"?dom.getAttrib(node,items[i]):getStyle(node,
items[i]))return format;return format}if(formatList&&node)for(i=0;i<formatList.length;i++){format=formatList[i];if(matchName(node,format)&&matchItems(node,format,"attributes")&&matchItems(node,format,"styles")){if(classes=format.classes)for(i=0;i<classes.length;i++)if(!dom.hasClass(node,classes[i]))return;return format}}}function match(name,vars,node){var startNode;function matchParents(node){node=dom.getParent(node,function(node){return!!matchNode(node,name,vars,true)});return matchNode(node,name,
vars)}if(node)return matchParents(node);node=selection.getNode();if(matchParents(node))return TRUE;startNode=selection.getStart();if(startNode!=node)if(matchParents(startNode))return TRUE;return FALSE}function matchAll(names,vars){var startElement,matchedFormatNames=[],checkedMap={},i,ni,name;startElement=selection.getStart();dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++){name=names[i];if(!checkedMap[name]&&matchNode(node,name,vars)){checkedMap[name]=true;matchedFormatNames.push(name)}}},
dom.getRoot());return matchedFormatNames}function canApply(name){var formatList=get(name),startNode,parents,i,x,selector;if(formatList){startNode=selection.getStart();parents=getParents(startNode);for(x=formatList.length-1;x>=0;x--){selector=formatList[x].selector;if(!selector)return TRUE;for(i=parents.length-1;i>=0;i--)if(dom.is(parents[i],selector))return TRUE}}return FALSE}function formatChanged(formats,callback,similar){var currentFormats;if(!formatChangeData){formatChangeData={};currentFormats=
{};ed.onNodeChange.addToTop(function(ed,cm,node){var parents=getParents(node),matchedFormats={};each(formatChangeData,function(callbacks,format){each(parents,function(node){if(matchNode(node,format,{},callbacks.similar)){if(!currentFormats[format]){each(callbacks,function(callback){callback(true,{node:node,format:format,parents:parents})});currentFormats[format]=callbacks}matchedFormats[format]=callbacks;return false}})});each(currentFormats,function(callbacks,format){if(!matchedFormats[format]){delete currentFormats[format];
each(callbacks,function(callback){callback(false,{node:node,format:format,parents:parents})})}})})}each(formats.split(","),function(format){if(!formatChangeData[format]){formatChangeData[format]=[];formatChangeData[format].similar=similar}formatChangeData[format].push(callback)});return this}tinymce.extend(this,{get:get,register:register,apply:apply,remove:remove,toggle:toggle,match:match,matchAll:matchAll,matchNode:matchNode,canApply:canApply,formatChanged:formatChanged});defaultFormats();addKeyboardShortcuts();
function matchName(node,format){if(isEq(node,format.inline))return TRUE;if(isEq(node,format.block))return TRUE;if(format.selector)return dom.is(node,format.selector)}function isEq(str1,str2){str1=str1||"";str2=str2||"";str1=""+(str1.nodeName||str1);str2=""+(str2.nodeName||str2);return str1.toLowerCase()==str2.toLowerCase()}function getStyle(node,name){var styleVal=dom.getStyle(node,name);if(name=="color"||name=="backgroundColor")styleVal=dom.toHex(styleVal);if(name=="fontWeight"&&styleVal==700)styleVal=
"bold";return""+styleVal}function replaceVars(value,vars){if(typeof value!="string")value=value(vars);else if(vars)value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str});return value}function isWhiteSpaceNode(node){return node&&node.nodeType===3&&/^([\t \r\n]+|)$/.test(node.nodeValue)}function wrap(node,name,attrs){var wrapper=dom.create(name,attrs);node.parentNode.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper}function expandRng(rng,format,remove){var sibling,
lastIdx,leaf,endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;function findParentContainer(start){var container,parent,child,sibling,siblingName,root;container=parent=start?startContainer:endContainer;siblingName=start?"previousSibling":"nextSibling";root=dom.getRoot();if(container.nodeType==3&&!isWhiteSpaceNode(container))if(start?startOffset>0:endOffset<container.nodeValue.length)return container;for(;;){if(!format[0].block_expand&&
isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode(sibling)&&!isWhiteSpaceNode(sibling))return parent;if(parent.parentNode==root){container=parent;break}parent=parent.parentNode}return container}function findLeaf(node,offset){if(offset===undef)offset=node.nodeType===3?node.length:node.childNodes.length;while(node&&node.hasChildNodes()){node=node.childNodes[offset];if(node)offset=node.nodeType===3?node.length:node.childNodes.length}return{node:node,
offset:offset}}if(startContainer.nodeType==1&&startContainer.hasChildNodes()){lastIdx=startContainer.childNodes.length-1;startContainer=startContainer.childNodes[startOffset>lastIdx?lastIdx:startOffset];if(startContainer.nodeType==3)startOffset=0}if(endContainer.nodeType==1&&endContainer.hasChildNodes()){lastIdx=endContainer.childNodes.length-1;endContainer=endContainer.childNodes[endOffset>lastIdx?lastIdx:endOffset-1];if(endContainer.nodeType==3)endOffset=endContainer.nodeValue.length}function findParentContentEditable(node){var parent=
node;while(parent){if(parent.nodeType===1&&getContentEditable(parent))return getContentEditable(parent)==="false"?parent:node;parent=parent.parentNode}return node}function findWordEndPoint(container,offset,start){var walker,node,pos,lastTextNode;function findSpace(node,offset){var pos,pos2,str=node.nodeValue;if(typeof offset=="undefined")offset=start?str.length:0;if(start){pos=str.lastIndexOf(" ",offset);pos2=str.lastIndexOf("\u00a0",offset);pos=pos>pos2?pos:pos2;if(pos!==-1&&!remove)pos++}else{pos=
str.indexOf(" ",offset);pos2=str.indexOf("\u00a0",offset);pos=pos!==-1&&(pos2===-1||pos<pos2)?pos:pos2}return pos}if(container.nodeType===3){pos=findSpace(container,offset);if(pos!==-1)return{container:container,offset:pos};lastTextNode=container}walker=new TreeWalker(container,dom.getParent(container,isBlock)||ed.getBody());while(node=walker[start?"prev":"next"]())if(node.nodeType===3){lastTextNode=node;pos=findSpace(node);if(pos!==-1)return{container:node,offset:pos}}else if(isBlock(node))break;
if(lastTextNode){if(start)offset=0;else offset=lastTextNode.length;return{container:lastTextNode,offset:offset}}}function findSelectorEndPoint(container,sibling_name){var parents,i,y,curFormat;if(container.nodeType==3&&container.nodeValue.length===0&&container[sibling_name])container=container[sibling_name];parents=getParents(container);for(i=0;i<parents.length;i++)for(y=0;y<format.length;y++){curFormat=format[y];if("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)continue;if(dom.is(parents[i],
curFormat.selector))return parents[i]}return container}function findBlockEndPoint(container,sibling_name,sibling_name2){var node;if(!format[0].wrapper)node=dom.getParent(container,format[0].block);if(!node)node=dom.getParent(container.nodeType==3?container.parentNode:container,isBlock);if(node&&format[0].wrapper)node=getParents(node,"ul,ol").reverse()[0]||node;if(!node){node=container;while(node[sibling_name]&&!isBlock(node[sibling_name])){node=node[sibling_name];if(isEq(node,"br"))break}}return node||
container}startContainer=findParentContentEditable(startContainer);endContainer=findParentContentEditable(endContainer);if(isBookmarkNode(startContainer.parentNode)||isBookmarkNode(startContainer)){startContainer=isBookmarkNode(startContainer)?startContainer:startContainer.parentNode;startContainer=startContainer.nextSibling||startContainer;if(startContainer.nodeType==3)startOffset=0}if(isBookmarkNode(endContainer.parentNode)||isBookmarkNode(endContainer)){endContainer=isBookmarkNode(endContainer)?
endContainer:endContainer.parentNode;endContainer=endContainer.previousSibling||endContainer;if(endContainer.nodeType==3)endOffset=endContainer.length}if(format[0].inline){if(rng.collapsed){endPoint=findWordEndPoint(startContainer,startOffset,true);if(endPoint){startContainer=endPoint.container;startOffset=endPoint.offset}endPoint=findWordEndPoint(endContainer,endOffset);if(endPoint){endContainer=endPoint.container;endOffset=endPoint.offset}}leaf=findLeaf(endContainer,endOffset);if(leaf.node){while(leaf.node&&
leaf.offset===0&&leaf.node.previousSibling)leaf=findLeaf(leaf.node.previousSibling);if(leaf.node&&leaf.offset>0&&leaf.node.nodeType===3&&leaf.node.nodeValue.charAt(leaf.offset-1)===" ")if(leaf.offset>1){endContainer=leaf.node;endContainer.splitText(leaf.offset-1)}}}if(format[0].inline||format[0].block_expand){if(!format[0].inline||startContainer.nodeType!=3||startOffset===0)startContainer=findParentContainer(true);if(!format[0].inline||endContainer.nodeType!=3||endOffset===endContainer.nodeValue.length)endContainer=
findParentContainer()}if(format[0].selector&&format[0].expand!==FALSE&&!format[0].inline){startContainer=findSelectorEndPoint(startContainer,"previousSibling");endContainer=findSelectorEndPoint(endContainer,"nextSibling")}if(format[0].block||format[0].selector){startContainer=findBlockEndPoint(startContainer,"previousSibling");endContainer=findBlockEndPoint(endContainer,"nextSibling");if(format[0].block){if(!isBlock(startContainer))startContainer=findParentContainer(true);if(!isBlock(endContainer))endContainer=
findParentContainer()}}if(startContainer.nodeType==1){startOffset=nodeIndex(startContainer);startContainer=startContainer.parentNode}if(endContainer.nodeType==1){endOffset=nodeIndex(endContainer)+1;endContainer=endContainer.parentNode}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function removeFormat(format,vars,node,compare_node){var i,attrs,stylesModified;if(!matchName(node,format))return FALSE;if(format.remove!="all"){each(format.styles,
function(value,name){value=replaceVars(value,vars);if(typeof name==="number"){name=value;compare_node=0}if(!compare_node||isEq(getStyle(compare_node,name),value))dom.setStyle(node,name,"");stylesModified=1});if(stylesModified&&dom.getAttrib(node,"style")==""){node.removeAttribute("style");node.removeAttribute("data-mce-style")}each(format.attributes,function(value,name){var valueOut;value=replaceVars(value,vars);if(typeof name==="number"){name=value;compare_node=0}if(!compare_node||isEq(dom.getAttrib(compare_node,
name),value)){if(name=="class"){value=dom.getAttrib(node,name);if(value){valueOut="";each(value.split(/\s+/),function(cls){if(/mce\w+/.test(cls))valueOut+=(valueOut?" ":"")+cls});if(valueOut){dom.setAttrib(node,name,valueOut);return}}}if(name=="class")node.removeAttribute("className");if(MCE_ATTR_RE.test(name))node.removeAttribute("data-mce-"+name);node.removeAttribute(name)}});each(format.classes,function(value){value=replaceVars(value,vars);if(!compare_node||dom.hasClass(compare_node,value))dom.removeClass(node,
value)});attrs=dom.getAttribs(node);for(i=0;i<attrs.length;i++)if(attrs[i].nodeName.indexOf("_")!==0)return FALSE}if(format.remove!="none"){removeNode(node,format);return TRUE}}function removeNode(node,format){var parentNode=node.parentNode,rootBlockElm;function find(node,next,inc){node=getNonWhiteSpaceSibling(node,next,inc);return!node||node.nodeName=="BR"||isBlock(node)}if(format.block)if(!forcedRootBlock){if(isBlock(node)&&!isBlock(parentNode)){if(!find(node,FALSE)&&!find(node.firstChild,TRUE,
1))node.insertBefore(dom.create("br"),node.firstChild);if(!find(node,TRUE)&&!find(node.lastChild,FALSE,1))node.appendChild(dom.create("br"))}}else if(parentNode==dom.getRoot())if(!format.list_block||!isEq(node,format.list_block))each(tinymce.grep(node.childNodes),function(node){if(isValid(forcedRootBlock,node.nodeName.toLowerCase()))if(!rootBlockElm)rootBlockElm=wrap(node,forcedRootBlock);else rootBlockElm.appendChild(node);else rootBlockElm=0});if(format.selector&&format.inline&&!isEq(format.inline,
node))return;dom.remove(node,1)}function getNonWhiteSpaceSibling(node,next,inc){if(node){next=next?"nextSibling":"previousSibling";for(node=inc?node:node[next];node;node=node[next])if(node.nodeType==1||!isWhiteSpaceNode(node))return node}}function isBookmarkNode(node){return node&&node.nodeType==1&&node.getAttribute("data-mce-type")=="bookmark"}function mergeSiblings(prev,next){var marker,sibling,tmpSibling;function compareElements(node1,node2){if(node1.nodeName!=node2.nodeName)return FALSE;function getAttribs(node){var attribs=
{};each(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();if(name.indexOf("_")!==0&&name!=="style")attribs[name]=dom.getAttrib(node,name)});return attribs}function compareObjects(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){value=obj2[name];if(value===undef)return FALSE;if(obj1[name]!=value)return FALSE;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return FALSE;return TRUE}if(!compareObjects(getAttribs(node1),getAttribs(node2)))return FALSE;
if(!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style"))))return FALSE;return TRUE}function findElementSibling(node,sibling_name){for(sibling=node;sibling;sibling=sibling[sibling_name]){if(sibling.nodeType==3&&sibling.nodeValue.length!==0)return node;if(sibling.nodeType==1&&!isBookmarkNode(sibling))return sibling}return node}if(prev&&next){prev=findElementSibling(prev,"previousSibling");next=findElementSibling(next,"nextSibling");if(compareElements(prev,
next)){for(sibling=prev.nextSibling;sibling&&sibling!=next;){tmpSibling=sibling;sibling=sibling.nextSibling;prev.appendChild(tmpSibling)}dom.remove(next);each(tinymce.grep(next.childNodes),function(node){prev.appendChild(node)});return prev}}return next}function isTextBlock(name){return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(name)}function getContainer(rng,start){var container,offset,lastIdx,walker;container=rng[start?"startContainer":"endContainer"];offset=rng[start?"startOffset":"endOffset"];
if(container.nodeType==1){lastIdx=container.childNodes.length-1;if(!start&&offset)offset--;container=container.childNodes[offset>lastIdx?lastIdx:offset]}if(container.nodeType===3&&start&&offset>=container.nodeValue.length)container=(new TreeWalker(container,ed.getBody())).next()||container;if(container.nodeType===3&&!start&&offset===0)container=(new TreeWalker(container,ed.getBody())).prev()||container;return container}function performCaretAction(type,name,vars){var caretContainerId="_mce_caret",
debug=ed.settings.caret_debug;function createCaretContainer(fill){var caretContainer=dom.create("span",{id:caretContainerId,"data-mce-bogus":true,style:debug?"color:red":""});if(fill)caretContainer.appendChild(ed.getDoc().createTextNode(INVISIBLE_CHAR));return caretContainer}function isCaretContainerEmpty(node,nodes){while(node){if(node.nodeType===3&&node.nodeValue!==INVISIBLE_CHAR||node.childNodes.length>1)return false;if(nodes&&node.nodeType===1)nodes.push(node);node=node.firstChild}return true}
function getParentCaretContainer(node){while(node){if(node.id===caretContainerId)return node;node=node.parentNode}}function findFirstTextNode(node){var walker;if(node){walker=new TreeWalker(node,node);for(node=walker.current();node;node=walker.next())if(node.nodeType===3)return node}}function removeCaretContainer(node,move_caret){var child,rng;if(!node){node=getParentCaretContainer(selection.getStart());if(!node)while(node=dom.get(caretContainerId))removeCaretContainer(node,false)}else{rng=selection.getRng(true);
if(isCaretContainerEmpty(node)){if(move_caret!==false){rng.setStartBefore(node);rng.setEndBefore(node)}dom.remove(node)}else{child=findFirstTextNode(node);if(child.nodeValue.charAt(0)===INVISIBLE_CHAR)child=child.deleteData(0,1);dom.remove(node,1)}selection.setRng(rng)}}function applyCaretFormat(){var rng,caretContainer,textNode,offset,bookmark,container,text;rng=selection.getRng(true);offset=rng.startOffset;container=rng.startContainer;text=container.nodeValue;caretContainer=getParentCaretContainer(selection.getStart());
if(caretContainer)textNode=findFirstTextNode(caretContainer);if(text&&offset>0&&offset<text.length&&/\w/.test(text.charAt(offset))&&/\w/.test(text.charAt(offset-1))){bookmark=selection.getBookmark();rng.collapse(true);rng=expandRng(rng,get(name));rng=rangeUtils.split(rng);apply(name,vars,rng);selection.moveToBookmark(bookmark)}else{if(!caretContainer||textNode.nodeValue!==INVISIBLE_CHAR){caretContainer=createCaretContainer(true);textNode=caretContainer.firstChild;rng.insertNode(caretContainer);offset=
1;apply(name,vars,caretContainer)}else apply(name,vars,caretContainer);selection.setCursorLocation(textNode,offset)}}function removeCaretFormat(){var rng=selection.getRng(true),container,offset,bookmark,hasContentAfter,node,formatNode,parents=[],i,caretContainer;container=rng.startContainer;offset=rng.startOffset;node=container;if(container.nodeType==3){if(offset!=container.nodeValue.length||container.nodeValue===INVISIBLE_CHAR)hasContentAfter=true;node=node.parentNode}while(node){if(matchNode(node,
name,vars)){formatNode=node;break}if(node.nextSibling)hasContentAfter=true;parents.push(node);node=node.parentNode}if(!formatNode)return;if(hasContentAfter){bookmark=selection.getBookmark();rng.collapse(true);rng=expandRng(rng,get(name),true);rng=rangeUtils.split(rng);remove(name,vars,rng);selection.moveToBookmark(bookmark)}else{caretContainer=createCaretContainer();node=caretContainer;for(i=parents.length-1;i>=0;i--){node.appendChild(dom.clone(parents[i],false));node=node.firstChild}node.appendChild(dom.doc.createTextNode(INVISIBLE_CHAR));
node=node.firstChild;dom.insertAfter(caretContainer,formatNode);selection.setCursorLocation(node,1)}}function unmarkBogusCaretParents(){var i,caretContainer,node;caretContainer=getParentCaretContainer(selection.getStart());if(caretContainer&&!dom.isEmpty(caretContainer))tinymce.walk(caretContainer,function(node){if(node.nodeType==1&&node.id!==caretContainerId&&!dom.isEmpty(node))dom.setAttrib(node,"data-mce-bogus",null)},"childNodes")}if(!self._hasCaretEvents){ed.onBeforeGetContent.addToTop(function(){var nodes=
[],i;if(isCaretContainerEmpty(getParentCaretContainer(selection.getStart()),nodes)){i=nodes.length;while(i--)dom.setAttrib(nodes[i],"data-mce-bogus","1")}});tinymce.each("onMouseUp onKeyUp".split(" "),function(name){ed[name].addToTop(function(){removeCaretContainer();unmarkBogusCaretParents()})});ed.onKeyDown.addToTop(function(ed,e){var keyCode=e.keyCode;if(keyCode==8||keyCode==37||keyCode==39)removeCaretContainer(getParentCaretContainer(selection.getStart()));unmarkBogusCaretParents()});selection.onSetContent.add(unmarkBogusCaretParents);
self._hasCaretEvents=true}if(type=="apply")applyCaretFormat();else removeCaretFormat()}function moveStart(rng){var container=rng.startContainer,offset=rng.startOffset,isAtEndOfText,walker,node,nodes,tmpNode;if(container.nodeType==3&&offset>=container.nodeValue.length){offset=nodeIndex(container);container=container.parentNode;isAtEndOfText=true}if(container.nodeType==1){nodes=container.childNodes;container=nodes[Math.min(offset,nodes.length-1)];walker=new TreeWalker(container,dom.getParent(container,
dom.isBlock));if(offset>nodes.length-1||isAtEndOfText)walker.next();for(node=walker.current();node;node=walker.next())if(node.nodeType==3&&!isWhiteSpaceNode(node)){tmpNode=dom.create("a",null,INVISIBLE_CHAR);node.parentNode.insertBefore(tmpNode,node);rng.setStart(node,0);selection.setRng(rng);dom.remove(tmpNode);return}}}}})(tinymce);
tinymce.onAddEditor.add(function(tinymce,ed){var filters,fontSizes,dom,settings=ed.settings;function replaceWithSpan(node,styles){tinymce.each(styles,function(value,name){if(value)dom.setStyle(node,name,value)});dom.rename(node,"span")}function convert(editor,params){dom=editor.dom;if(settings.convert_fonts_to_spans)tinymce.each(dom.select("font,u,strike",params.node),function(node){filters[node.nodeName.toLowerCase()](ed.dom,node)})}if(settings.inline_styles){fontSizes=tinymce.explode(settings.font_size_legacy_values);
filters={font:function(dom,node){replaceWithSpan(node,{backgroundColor:node.style.backgroundColor,color:node.color,fontFamily:node.face,fontSize:fontSizes[parseInt(node.size,10)-1]})},u:function(dom,node){replaceWithSpan(node,{textDecoration:"underline"})},strike:function(dom,node){replaceWithSpan(node,{textDecoration:"line-through"})}};ed.onPreProcess.add(convert);ed.onSetContent.add(convert);ed.onInit.add(function(){ed.selection.onSetContent.add(convert)})}});
(function(tinymce){var TreeWalker=tinymce.dom.TreeWalker;tinymce.EnterKey=function(editor){var dom=editor.dom,selection=editor.selection,settings=editor.settings,undoManager=editor.undoManager,nonEmptyElementsMap=editor.schema.getNonEmptyElements();function handleEnterKey(evt){var rng=selection.getRng(true),tmpRng,editableRoot,container,offset,parentBlock,documentMode,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;function canSplitBlock(node){return node&&
dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&dom.getContentEditable(node)!=="true"}function renderBlockOnIE(block){var oldRng;if(tinymce.isIE&&dom.isBlock(block)){oldRng=selection.getRng();block.appendChild(dom.create("span",null,"\u00a0"));selection.select(block);block.lastChild.outerHTML="";selection.setRng(oldRng)}}function trimInlineElementsOnLeftSideOfBlock(block){var node=block,firstChilds=[],i;while(node=node.firstChild){if(dom.isBlock(node))return;
if(node.nodeType==1&&!nonEmptyElementsMap[node.nodeName.toLowerCase()])firstChilds.push(node)}i=firstChilds.length;while(i--){node=firstChilds[i];if(!node.hasChildNodes()||node.firstChild==node.lastChild&&node.firstChild.nodeValue==="")dom.remove(node);else if(node.nodeName=="A"&&(node.innerText||node.textContent)===" ")dom.remove(node)}}function moveToCaretPosition(root){var walker,node,rng,y,viewPort,lastNode=root,tempElm;rng=dom.createRng();if(root.hasChildNodes()){walker=new TreeWalker(root,root);
while(node=walker.current()){if(node.nodeType==3){rng.setStart(node,0);rng.setEnd(node,0);break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node);rng.setEndBefore(node);break}lastNode=node;node=walker.next()}if(!node){rng.setStart(lastNode,0);rng.setEnd(lastNode,0)}}else if(root.nodeName=="BR")if(root.nextSibling&&dom.isBlock(root.nextSibling)){if(!documentMode||documentMode<9){tempElm=dom.create("br");root.parentNode.insertBefore(tempElm,root)}rng.setStartBefore(root);
rng.setEndBefore(root)}else{rng.setStartAfter(root);rng.setEndAfter(root)}else{rng.setStart(root,0);rng.setEnd(root,0)}selection.setRng(rng);dom.remove(tempElm);viewPort=dom.getViewPort(editor.getWin());y=dom.getPos(root).y;if(y<viewPort.y||y+25>viewPort.y+viewPort.h)editor.getWin().scrollTo(0,y<viewPort.y?y:y-viewPort.h+25)}function createNewBlock(name){var node=container,block,clonedNode,caretNode;block=name||parentBlockName=="TABLE"?dom.create(name||newBlockName):parentBlock.cloneNode(false);caretNode=
block;if(settings.keep_styles!==false){do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(node.nodeName)){clonedNode=node.cloneNode(false);dom.setAttrib(clonedNode,"id","");if(block.hasChildNodes()){clonedNode.appendChild(block.firstChild);block.appendChild(clonedNode)}else{caretNode=clonedNode;block.appendChild(clonedNode)}}while(node=node.parentNode)}if(!tinymce.isIE)caretNode.innerHTML="<br>";return block}function isCaretAtStartOrEndOfBlock(start){var walker,node,name;if(container.nodeType==3&&
(start?offset>0:offset<container.nodeValue.length))return false;if(container.parentNode==parentBlock&&isAfterLastNodeInContainer&&!start)return true;if(start&&container.nodeType==1&&container==parentBlock.firstChild)return true;if(container.nodeName==="TABLE"||container.previousSibling&&container.previousSibling.nodeName=="TABLE")return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;walker=new TreeWalker(container,parentBlock);if(container.nodeType==3)if(start&&offset==0)walker.prev();
else if(!start&&offset==container.nodeValue.length)walker.next();while(node=walker.current()){if(node.nodeType===1){if(!node.getAttribute("data-mce-bogus")){name=node.nodeName.toLowerCase();if(nonEmptyElementsMap[name]&&name!=="br")return false}}else if(node.nodeType===3&&!/^[ \t\r\n]*$/.test(node.nodeValue))return false;if(start)walker.prev();else walker.next()}return true}function wrapSelfAndSiblingsInDefaultBlock(container,offset){var newBlock,parentBlock,startNode,node,next,blockName=newBlockName||
"P";parentBlock=dom.getParent(container,dom.isBlock);if(!parentBlock||!canSplitBlock(parentBlock)){parentBlock=parentBlock||editableRoot;if(!parentBlock.hasChildNodes()){newBlock=dom.create(blockName);parentBlock.appendChild(newBlock);rng.setStart(newBlock,0);rng.setEnd(newBlock,0);return newBlock}node=container;while(node.parentNode!=parentBlock)node=node.parentNode;while(node&&!dom.isBlock(node)){startNode=node;node=node.previousSibling}if(startNode){newBlock=dom.create(blockName);startNode.parentNode.insertBefore(newBlock,
startNode);node=startNode;while(node&&!dom.isBlock(node)){next=node.nextSibling;newBlock.appendChild(node);node=next}rng.setStart(container,offset);rng.setEnd(container,offset)}}return container}function handleEmptyListItem(){function isFirstOrLastLi(first){var node=containerBlock[first?"firstChild":"lastChild"];while(node){if(node.nodeType==1)break;node=node[first?"nextSibling":"previousSibling"]}return node===parentBlock}newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(true)&&
isFirstOrLastLi())dom.replace(newBlock,containerBlock);else if(isFirstOrLastLi(true))containerBlock.parentNode.insertBefore(newBlock,containerBlock);else if(isFirstOrLastLi()){dom.insertAfter(newBlock,containerBlock);renderBlockOnIE(newBlock)}else{tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock);tmpRng.setEndAfter(containerBlock);fragment=tmpRng.extractContents();dom.insertAfter(fragment,containerBlock);dom.insertAfter(newBlock,containerBlock)}dom.remove(parentBlock);moveToCaretPosition(newBlock);
undoManager.add()}function hasRightSideBr(){var walker=new TreeWalker(container,parentBlock),node;while(node=walker.current()){if(node.nodeName=="BR")return true;node=walker.next()}}function insertBr(){var brElm,extraBr;if(container&&container.nodeType==3&&offset>=container.nodeValue.length)if(!tinymce.isIE&&!hasRightSideBr()){brElm=dom.create("br");rng.insertNode(brElm);rng.setStartAfter(brElm);rng.setEndAfter(brElm);extraBr=true}brElm=dom.create("br");rng.insertNode(brElm);if(tinymce.isIE&&parentBlockName==
"PRE"&&(!documentMode||documentMode<8))brElm.parentNode.insertBefore(dom.doc.createTextNode("\r"),brElm);if(!extraBr){rng.setStartAfter(brElm);rng.setEndAfter(brElm)}else{rng.setStartBefore(brElm);rng.setEndBefore(brElm)}selection.setRng(rng);undoManager.add()}function trimLeadingLineBreaks(node){do{if(node.nodeType===3)node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"");node=node.firstChild}while(node)}function getEditableRoot(node){var root=dom.getRoot(),parent,editableRoot;parent=node;while(parent!==
root&&dom.getContentEditable(parent)!=="false"){if(dom.getContentEditable(parent)==="true")editableRoot=parent;parent=parent.parentNode}return parent!==root?editableRoot:root}function addBrToBlockIfNeeded(block){var lastChild;if(!tinymce.isIE){block.normalize();lastChild=block.lastChild;if(!lastChild||/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",true)))dom.add(block,"br")}}if(!rng.collapsed){editor.execCommand("Delete");return}if(evt.isDefaultPrevented())return;container=rng.startContainer;
offset=rng.startOffset;newBlockName=(settings.force_p_newlines?"p":"")||settings.forced_root_block;newBlockName=newBlockName?newBlockName.toUpperCase():"";documentMode=dom.doc.documentMode;shiftKey=evt.shiftKey;if(container.nodeType==1&&container.hasChildNodes()){isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&container.nodeType==3)offset=container.nodeValue.length;
else offset=0}editableRoot=getEditableRoot(container);if(!editableRoot)return;undoManager.beforeChange();if(!dom.isBlock(editableRoot)&&editableRoot!=dom.getRoot()){if(!newBlockName||shiftKey)insertBr();return}if(newBlockName&&!shiftKey||!newBlockName&&shiftKey)container=wrapSelfAndSiblingsInDefaultBlock(container,offset);parentBlock=dom.getParent(container,dom.isBlock);containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():
"";containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"";if(parentBlockName=="LI"){if(!newBlockName&&shiftKey){insertBr();return}if(dom.isEmpty(parentBlock)){if(/^(UL|OL|LI)$/.test(containerBlock.parentNode.nodeName))return false;handleEmptyListItem();return}}if(parentBlockName=="PRE"&&settings.br_in_pre!==false){if(!shiftKey){insertBr();return}}else if(!newBlockName&&!shiftKey&&parentBlockName!="LI"||newBlockName&&shiftKey){insertBr();return}newBlockName=newBlockName||"P";if(isCaretAtStartOrEndOfBlock()){if(/^(H[1-6]|PRE)$/.test(parentBlockName)&&
containerBlockName!="HGROUP")newBlock=createNewBlock(newBlockName);else newBlock=createNewBlock();if(settings.end_container_on_empty_block&&canSplitBlock(containerBlock)&&dom.isEmpty(parentBlock))newBlock=dom.split(containerBlock,parentBlock);else dom.insertAfter(newBlock,parentBlock);moveToCaretPosition(newBlock)}else if(isCaretAtStartOrEndOfBlock(true)){newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock);renderBlockOnIE(newBlock)}else{tmpRng=rng.cloneRange();tmpRng.setEndAfter(parentBlock);
fragment=tmpRng.extractContents();trimLeadingLineBreaks(fragment);newBlock=fragment.firstChild;dom.insertAfter(fragment,parentBlock);trimInlineElementsOnLeftSideOfBlock(newBlock);addBrToBlockIfNeeded(parentBlock);moveToCaretPosition(newBlock)}dom.setAttrib(newBlock,"id","");undoManager.add()}editor.onKeyDown.add(function(ed,evt){if(evt.keyCode==13)if(handleEnterKey(evt)!==false)evt.preventDefault()})}})(tinymce);
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor={ActionIdMap:{},AppendHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);var isInline=me.IsInlineByNode(node);node.d2l_control.AppendHtml(editorId,html,isInline)},ExecuteCommand:function(editorId,name,value){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.ExecuteCommand(editorId,name,value)},Focus:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=me.GetEditor(id);node.d2l_control.FocusByNode(node)},GetActionId:function(editorId,actionName){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var actionIdMap=me.GetActionIdMap(editorId);return actionIdMap[actionName]},GetActionIdMap:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var actionIdMap=me.ActionIdMap[editorId];if(actionIdMap===undefined){actionIdMap={};me.ActionIdMap[editorId]=actionIdMap}return actionIdMap},GetComputedStyle:function(editorId,styleAttribute){var me=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetComputedStyle(editorId,styleAttribute)},GetControlManager:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetControlManager(editorId)},GetEditor:function(editorId){return D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue())},GetEditorInstanceById:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=
me.GetEditor(editorId);return node.d2l_control.GetEditorInstanceByNode(node)},GetFileAdded:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var files=node.d2l_files;if(files.length===0||files.length<node.d2l_files_queued)return;var file=files[files.length-node.d2l_files_queued];node.d2l_files_queued-=1;return new D2L.LP.Web.UI.Files.File(file.GetId(),file.GetFileSystemType(),file.GetName(),file.GetSize())},GetHtml:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());me.UpdateFilesNodeByNode(node);var files=node.d2l_files;return new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param(editorId.GetValue(),node.d2l_control.GetHtml(editorId),node.getAttribute("data-d2l-htmlorgunitid"),files)},GetOnChangeEvent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetOnChangeEventByNode(node)},GetSelectedNode:function(editorId){var me=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSelectedNode(editorId)},GetSelectionContent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSelectionContent(editorId)},GetSpellcheckText:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSpellcheckText(editorId)},IsDirty:function(editorId){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_control.IsDirty(editorId)},IsEmpty:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var html=node.d2l_control.GetHtml(editorId);if(html==null)return true;if(D2L.LP.Web.UI.Html.JavaScript.TrimString(0,html).length<1)return true;return false},InsertDelayed:function(editorId,delayedFunction,selectionProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;me.PasteDelayed(editorId,delayedFunction,
selectionProvider)},IsInline:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return me.IsInlineByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},IsInlineByNode:function(node){return node.getAttribute("data-d2l-editor-isinline")==="true"},MoveToStart:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_control.MoveToStart(editorId)},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=me.GetEditor(editorId);node.d2l_control.PasteDelayed(editorId,delayedFunction,selectionProvider,htmlProvider)},SetActionId:function(actionName,actionId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editorId=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-htmleditor",D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue())).id;var actionIdMap=me.GetActionIdMap(editorId);actionIdMap[actionName]=actionId},SelectNode:function(editorId,nodeToSelect){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=me.GetEditor(editorId);node.d2l_control.SelectNode(editorId,nodeToSelect)},SetHtml:function(editorId,html,baseRelativePath){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var evt=new D2L.LP.Web.UI.Events.Event;var node=me.GetEditor(editorId);var orgUnitId=node.getAttribute("data-d2l-htmlorgunitid");var filterMode=node.getAttribute("data-d2l-filtermode");node.d2l_files=[];node.d2l_files_queued=0;var convertResponseHandler=function(response){node.d2l_control.SetHtml(editorId,response);evt.Trigger()};
var params={filterMode:filterMode,html:html};if(baseRelativePath!==undefined)params.baseRelativePath=baseRelativePath;var options={success:convertResponseHandler,failure:function(){evt.Release()}};D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,(new D2L.LP.Web.Http.UrlLocation("/d2l/lp/htmleditor/converttoabsolute")).WithQueryString("ou",orgUnitId),params,options);return evt},SetIsResizeDisplayedByNode:function(node,isDisplayed){var resizeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-resize",
node);if(isDisplayed)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",resizeNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",resizeNode)},SetSize:function(editorId,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.SetSize(editorId,height,width)},SetSpellcheckText:function(editorId,response){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.SetSpellcheckText(editorId,response)},
ToggleDisplayComponents:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide-components",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-hide-components",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-hide-components",node);me.UpdateComponentVisibilityByNode(node)},TriggerFileAdded:function(editorId,file){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());
node.d2l_files.push(file);node.d2l_files_queued+=1;var onFileAdded=D2L.LP.Web.UI.ObjectRepository.TryGet(editorId.GetValue(),"onFileAdded");if(onFileAdded!=null)onFileAdded.call(onFileAdded)},UpdateComponentVisibilityByNode:function(node){var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-header",node);var containerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-component-container",node);var visibilityToggleNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-component-toggle",
toolbarNode);if(visibilityToggleNode==null)return;var openMenuFlyouts=D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.GetOpenMenuFlyouts(toolbarNode);for(var i=0;i<openMenuFlyouts.length;i++)D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.CloseByNode(openMenuFlyouts[i]);var boundingWidth=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(toolbarNode).width-D2L.LP.Web.UI.Html.Dom.GetBoundingRect(visibilityToggleNode).width-8;if(boundingWidth<=0)return;if(containerNode.d2l_initialized===undefined){var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1",
containerNode);for(var i=0;i<componentNodes.length;i++){var componentNode=componentNodes[i];componentNode.d2l_width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(componentNode).width+4;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-hide1-hidden",componentNode)}containerNode.d2l_initialized=true}if(containerNode.scrollWidth>=boundingWidth){var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1",containerNode);var componentNumber=componentNodes.length;while(componentNumber--){var componentNode=
componentNodes[componentNumber];if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide1-hidden",componentNode)){componentNode.d2l_width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(componentNode).width+4;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-hide1-hidden",componentNode);if(containerNode.scrollWidth<boundingWidth)break}}}else{var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1-hidden",containerNode);for(var i=0;i<componentNodes.length;i++){var componentNode=
componentNodes[i];var componentWidth=componentNode.d2l_width;if(containerNode.scrollWidth+componentWidth<boundingWidth)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-hide1-hidden",componentNode);else break;if(containerNode.scrollWidth>=boundingWidth)break}}if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide-components",node)&&D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1-hidden",containerNode).length==0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-disabled",
visibilityToggleNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-disabled",visibilityToggleNode);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide-components",node)){var showTitle=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-toolbar-toggle-show");D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(visibilityToggleNode,showTitle);D2L.LP.Web.UI.Common.Controls.Button.SetTitleNode(visibilityToggleNode,showTitle)}else{var hideTitle=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-toolbar-toggle-hide");
D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(visibilityToggleNode,hideTitle);D2L.LP.Web.UI.Common.Controls.Button.SetTitleNode(visibilityToggleNode,hideTitle)}},UpdateFilesNodeByNode:function(node){var filesNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-files",node);D2L.LP.Web.UI.Html.Dom.RemoveChildElements(filesNode);if(node.d2l_files.length===0)return;var files=node.d2l_files;var scope=filesNode.getAttribute("data-d2l-scope");for(var i=0;i<files.length;i++){var fileNumber=
i+1;var idPrefix;if(fileNumber<2)idPrefix=scope+"$files$";else idPrefix=scope+"$files`"+fileNumber+"$";var fsTypeNode=filesNode.appendChild(document.createElement("input"));fsTypeNode.setAttribute("id",idPrefix+"FileSystemType");fsTypeNode.setAttribute("name",idPrefix+"FileSystemType");fsTypeNode.setAttribute("value",files[i].GetFileSystemType());var idNode=filesNode.appendChild(document.createElement("input"));idNode.setAttribute("id",idPrefix+"Id");idNode.setAttribute("name",idPrefix+"Id");idNode.setAttribute("value",
files[i].GetId());var locationNode=filesNode.appendChild(document.createElement("input"));locationNode.setAttribute("id",idPrefix+"Location");locationNode.setAttribute("name",idPrefix+"Location");locationNode.setAttribute("value",files[i].GetLocation())}},ValidateRequired:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return!me.IsEmpty(editorId)}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents={};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor={AppendHtml:function(editorId,html,isInline){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var current=me.GetHtml(editorId);var result;if(isInline)result=current+html;else{var loc=current.indexOf("</body>");result=current.substring(0,loc)+html+current.substring(loc,current.length)}me.SetHtml(editorId,result)},ExecuteCommand:function(editorId,name,value){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var node=
tinyMCE.activeEditor.settings.d2l_context.Node;me.MoveToBookmarkByNode(node);tinyMCE.execCommand(name,false,value)},FocusByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(node);var focus=function(){setTimeout(function(){tinyMCE.execCommand("mceFocus",false,textAreaId)},0)};var editor=me.GetEditorInstanceByNode(node);if(editor===undefined)tinyMCE.onAddEditor.add(function(mgr,ed){if(textAreaId==ed.id)focus()});else focus()},GetComputedStyle:function(editorId,
styleAttribute){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var node=me.GetSelectedNode(editorId);return me.GetComputedStyleByNode(node,styleAttribute)},GetComputedStyleByNode:function(node,styleAttribute){if(node==null)return;if(node.nodeType==9)node=node.body;var getStyleValue=function(node){var value=D2L.LP.Web.UI.Html.Css.GetStyle(node,styleAttribute);if(styleAttribute=="background-color"&&value=="transparent"&&node.parentNode!=null)value=getStyleValue(node.parentNode);return value};
return getStyleValue(node)},GetControlManager:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return htmlEditor.GetEditorInstanceById(editorId).controlManager},GetEditorInstanceByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(node);return tinymce.get(textAreaId)},GetHtml:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editor=htmlEditor.GetEditorInstanceById(editorId);return editor.getContent({source_view:true})},
GetOnChangeEventByNode:function(node){return node.d2l_changeEvent},GetSelectedNode:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=null;if(tinyMCE.isIE){var node=htmlEditor.GetEditor(editorId).d2l_selectedNode;if(node!=null)return node}var editor=htmlEditor.GetEditorInstanceById(editorId);if(editor.selection!=null)node=editor.selection.getNode();return node},GetSelectionContent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var editor=
me.GetEditorInstanceByNode(editorId);var content="";if(editor.selection)content=tinymce.DOM.decode(editor.selection.getContent());return content},GetSpellcheckText:function(editorId){var editor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditorInstanceById(editorId);var walk=function(n,f){var d=editor.getDoc();var w;if(d.createTreeWalker){w=d.createTreeWalker(n,NodeFilter.SHOW_TEXT,null,false);while((n=w.nextNode())!=null)f.call(f,n)}else tinymce.walk(n,f,"childNodes")};var tx="";var nodeDic=new D2L.Util.Dictionary;
var nodeIden=0;walk(editor.getBody(),function(n){if(n.nodeType==3&&n.nodeValue.trim()!=""){nodeDic.Add(nodeIden,n);tx+=n.nodeValue+"["+nodeIden+":d2lsciden]";nodeIden++}});editor.d2l_nodeDic=nodeDic;return tx},GetTextAreaId:function(nodeOrId){if(nodeOrId.GetValue)nodeOrId=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeOrId.GetValue());var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",nodeOrId);return textAreaNode.getAttribute("id")},InitializeCallback:function(textAreaId,
body,doc){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-htmleditor",textAreaNode);var editor=me.GetEditorInstanceByNode(node);var iFrameNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(editor.getContentAreaContainer());var title=node.getAttribute("data-d2l-editor-title");if(title!=null)iFrameNode.title=
title;var labelledById=node.getAttribute("data-d2l-editor-labelledbyid");if(labelledById!=null)D2L.LP.Web.UI.Html.Aria.SetAttribute(iFrameNode,"labelledby",labelledById);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",iFrameNode.contentWindow,function(e){node.d2l_onContentFocus.Trigger();node.d2l_hasFocus=true;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-frosted",node)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",iFrameNode.contentWindow,function(e){node.d2l_hasFocus=false;setTimeout(function(){if(!node.d2l_hasFocus)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-frosted",
node)},0);node.d2l_changeEvent.Trigger()});if(tinyMCE.isIE){var getBookmark=function(evt){if(editor.selection!=null){node.d2l_selectedNode=editor.selection.getNode();node.d2l_bookmark=editor.selection.getBookmark(1)}else{node.d2l_selectedNode=null;node.d2l_bookmark=null}};var editorBody=editor.getBody();D2L.LP.Web.UI.Html.Dom.AddEventListener("select",editorBody,getBookmark,true);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",editorBody,getBookmark,true);D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",
editorBody,getBookmark);editor.onMouseUp.add(function(ed,e){getBookmark()});if(tinyMCE.isIE){var parentPlaceholders=D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName("d2l-placeholder-live",iFrameNode);if(parentPlaceholders!==null&&parentPlaceholders!==undefined)for(var i=0;i<parentPlaceholders.length;i++)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(parentPlaceholders[i],"aria-live")}}D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,node.d2l_changeEvent,function(){var value=htmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute("id")));
var serializer=new D2L.LP.Web.Serialization.Url.Serializer;value._serialize(serializer);return serializer.Serialize()});me.SetSizeByNode(node,node.getAttribute("data-d2l-height"),node.getAttribute("data-d2l-width"));node.style.visibility="visible"},InitializeLayout:function(settings,layoutNode,editorWrapper,parentNode){var pluginLayoutInitializers=settings.d2l_context.PluginLayoutInitializers;if(pluginLayoutInitializers!=null)for(var i=0;i<pluginLayoutInitializers.length;i++){var pluginLayoutInitializer=
pluginLayoutInitializers[i];pluginLayoutInitializer.call(pluginLayoutInitializer)}var iFrameTableRow=layoutNode.appendChild(document.createElement("tr"));var iFrameTableData=iFrameTableRow.appendChild(document.createElement("td"));D2L.LP.Web.UI.Html.Dom.AddClassName("mceIframeContainer",iFrameTableData);var iFrameTable=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("mceLayout",layoutNode);var editorNode=D2L.LP.Web.UI.Html.Dom.GetElementById(settings.d2l_context.Id);var resizeHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-resize",
editorNode);var resizeSettings={Handle:resizeHandle,DisplayType:"hidden",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var onResize=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(editorNode,resizeSettings,window,window);var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;onResize.AddListener(function(size){htmlEditor.SetSize(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(editorNode.getAttribute("id")),size.height+"px",size.width+"px")});D2L.LP.Web.UI.Events.OnResize.AddListener(function(){htmlEditor.UpdateComponentVisibilityByNode(editorNode)});
return iFrameTableData},IsDirty:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editor=htmlEditor.GetEditorInstanceById(editorId);return editor.isDirty()},MoveToBookmarkByNode:function(node){if(!tinyMCE.isIE)return;var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;if(node.d2l_bookmark!=null){var editor=me.GetEditorInstanceByNode(node);editor.selection.moveToBookmark(node.d2l_bookmark)}},MoveToStart:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
setTimeout(function(){var editor=htmlEditor.GetEditorInstanceById(editorId);tinyMCE.execInstanceCommand(editor.id,"selectall",false,null);editor.selection.collapse(true)},0)},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var editor=me.GetEditorInstanceByNode(node);delayedFunction.call(delayedFunction).AddListener(function(obj){var doInsert=
function(html){if(selectionProvider!=null)selectionProvider.call(selectionProvider);me.MoveToBookmarkByNode(node);if(html!=null)editor.execCommand("mceInsertContent",false,html)};if(htmlProvider!==undefined){var htmlResult=htmlProvider.call(htmlProvider,obj);if(typeof htmlResult==="string")doInsert(htmlResult);else if(typeof htmlResult==="object"&&htmlResult.AddListener!==undefined)htmlResult.AddListener(function(html){doInsert(html)})}else doInsert(obj)})},SelectNode:function(editorId,nodeToSelect){var htmlEditor=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editor=htmlEditor.GetEditorInstanceById(editorId);editor.selection.select(nodeToSelect)},SetHeightByNode:function(node,height){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var editor=me.GetEditorInstanceByNode(node);if(height.substr(height.length-2,2)=="px"){var pixelHeight=parseInt(height.substr(0,height.length));var toolbarHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-header",
node)).height;var footerHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-footer",node)).height;pixelHeight-=toolbarHeight+footerHeight;if(pixelHeight<120)pixelHeight="120";height=pixelHeight+"px"}var iFrameContainer=editor.contentAreaContainer;iFrameContainer.style.height=height;var bogusTable=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("mceLayout",iFrameContainer);bogusTable.style.height="100%";iFrameContainer.firstChild.style.height=
"100%";D2L.LP.Web.UI.Events.OnSizingFinished.Trigger()},SetHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var editor=me.GetEditorInstanceByNode(node);editor.setContent(html,{source_view:true})},SetSize:function(editorId,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;me.SetSizeByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue()),
height,width)},SetSizeByNode:function(node,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;me.SetWidthByNode(node,width);setTimeout(function(){me.SetHeightByNode(node,height)},0)},SetSpellcheckText:function(editorId,response){var editor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditorInstanceById(editorId);var nodeDic=editor.d2l_nodeDic;if(nodeDic===undefined||nodeDic===null)return;var phrases=response.split(":d2lsciden]");var dic=new D2L.Util.Dictionary;for(var i=
0;i<phrases.length;i++){var phrase=phrases[i];var iden=phrase.substring(phrase.lastIndexOf("[")+1);var txt=phrase.substring(0,phrase.lastIndexOf("["));dic.Add(iden,txt)}for(var j=0;j<nodeDic.Keys().length;j++){var node=nodeDic.Get(nodeDic.Keys()[j]);var text=dic.Get(nodeDic.Keys()[j]);if(text!==null&&text!==undefined)node.data=text}editor.d2l_nodeDic=undefined},SetWidthByNode:function(node,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var editor=me.GetEditorInstanceByNode(node);if(width.substr(width.length-2,2)=="px")if(parseInt(width.substr(0,width.length))<200)width="200px";node.style.width=width;var iFrameContainer=editor.contentAreaContainer;iFrameContainer.style.width=width;var bogusTable=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("mceLayout",iFrameContainer);bogusTable.style.width="100%";htmlEditor.UpdateComponentVisibilityByNode(node);return width},UpdateTextArea:function(textAreaId){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);
if(textAreaNode)textAreaNode.value=tinymce.get(textAreaId).getContent()}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor={AppendHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;me.SetHtml(editorId,me.GetHtml(editorId)+html)},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);textAreaNode.focus()},GetComputedStyle:function(editorId,styleAttribute){},GetControlManager:function(editorId){},GetEditorInstanceByNode:function(node){var me=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;var textAreaId=me.GetTextAreaId(node);return D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId)},GetHtml:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);return textAreaNode.value},GetOnChangeEventByNode:function(node){return node.d2l_changeEvent},GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return""},
GetSpellcheckText:function(editorId){return this.GetHtml(editorId)},GetTextAreaId:function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);return textAreaNode.getAttribute("id")},IsDirty:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_isDirty},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){},SelectNode:function(editorId,nodeToSelect){},
SetHtml:function(editorId,html){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);textAreaNode.value=html;node.d2l_isDirty=true},SetSize:function(editorId,height,width){},SetSpellcheckText:function(editorId,response){var editNode=this.SetHtml(editorId,response)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.NoEditor={AppendHtml:function(editorId,html){},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){},GetComputedStyle:function(editorId,styleAttribute){},GetControlManager:function(editorId){},GetEditorInstanceByNode:function(node){},GetHtml:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);return hiddenNode.value},GetOnChangeEventByNode:function(node){},
GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return""},IsDirty:function(editorId){},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){},SelectNode:function(editorId,nodeToSelect){},SetHtml:function(editorId,html){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);hiddenNode.value=html},SetSize:function(editorId,
height,width){}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FileData=D2L.Class.Create({Construct:function(fileSystemType,id,name,size,location){if(fileSystemType===undefined)fileSystemType="";this.m_fileSystemType=fileSystemType;if(id===undefined)id="";this.m_id=id;if(name===undefined)name="";this.m_name=name;if(size===undefined)size=0;this.m_size=size;if(location===undefined)location="";this.m_location=location},_serialize:function(serializer){serializer.AddMember("fileSystemType",this.m_fileSystemType);serializer.AddMember("id",
this.m_id);serializer.AddMember("location",this.m_location)},GetFileSystemType:function(){return this.m_fileSystemType},GetId:function(){return this.m_id},GetName:function(){return this.m_name},GetLocation:function(){return this.m_location},GetSize:function(){return this.m_size}});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param=D2L.Class.Create({Construct:function(id,html,htmlOrgUnitId,files){if(id===undefined)id="";this.m_id=id;if(html===undefined)html="";this.m_html=html;if(htmlOrgUnitId===undefined)htmlOrgUnitId=0;this.m_htmlOrgUnitId=htmlOrgUnitId;if(files===undefined)files=[];this.m_files=files},_serialize:function(serializer){serializer.AddMember("id",this.m_id);serializer.AddMember("html",this.m_html);serializer.AddMember("htmlOrgUnitId",this.m_htmlOrgUnitId);serializer.AddMember("files",
this.m_files)},GetFiles:function(){return this.m_files},GetHtml:function(){return this.m_html}});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button={GetOnActiveChangeByNode:function(node){if(node.d2l_onActiveChange===undefined)node.d2l_onActiveChange=new D2L.LP.Web.UI.Events.Event;return node.d2l_onActiveChange},GetOnEnabledChangeByNode:function(node){if(node.d2l_onEnabledChange===undefined)node.d2l_onEnabledChange=new D2L.LP.Web.UI.Events.Event;return node.d2l_onEnabledChange},Initialize:function(){tinyMCE.create("d2l.tinymce.ui.Button:tinymce.ui.Control",{Button:function(id,s){this.parent(id,
s)},node:null,getNode:function(){if(this.node===null)this.node=D2L.LP.Web.UI.Html.Dom.GetElementById(this.settings.Id.GetValue());return this.node},setDisabled:function(value){if(value!=this.disabled){var action=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;if(value)action.SetIsEnabledByNode(this.getNode(),false);else action.SetIsEnabledByNode(this.getNode(),true);this.disabled=value}},setActive:function(value){if(value!=this.active){var action=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;
if(value)action.SetIsActiveByNode(this.getNode(),true);else action.SetIsActiveByNode(this.getNode(),false);this.active=value}}})},InitializeByNode:function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"title");if(title!=null&&title.length>0)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",title);D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",node);
if(isDisabled)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true");var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-onclick");if(!hasOnClick)return;var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",node);if(!isDisabled)eval(onClick)})},Register:function(name,
id,controlManager){var control=new d2l.tinymce.ui.Button(name,{Id:id});controlManager.add(control)},SetIsActive:function(id,isActive){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var buttonId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId);me.SetIsActiveByNode(node,isActive)},SetIsActiveByNode:function(node,isActive){if(isActive==D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-active",node))return;if(isActive)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-button-active",
node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-button-active",node);if(node.d2l_onActiveChange!==undefined)node.d2l_onActiveChange.Trigger(isActive)},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetIsEnabledByNode(node,isEnabled)},SetIsEnabledByNode:function(node,isEnabled){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",node);
if(!isEnabled==isDisabled)return;D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled",!isEnabled);if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-button-disabled",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-button-disabled",node);if(node.d2l_onEnabledChange!==undefined)node.d2l_onEnabledChange.Trigger(isEnabled)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ColorButton={SetColorSample:function(id,value){var sampleNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-color-sample",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));sampleNode.style.background=value},UpdateClassName:function(id,className,addClassName){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(addClassName==D2L.LP.Web.UI.Html.Dom.HasClassName(className,node))return;if(addClassName)D2L.LP.Web.UI.Html.Dom.AddClassName(className,
node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,node)}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Menu={Register:function(menuId,editorNode){editorNode.d2l_onContentFocus.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(menuId)})}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SelectList={Initialize:function(){tinyMCE.create("d2l.tinymce.ui.SelectList:tinymce.ui.Control",{SelectList:function(id,s){this.parent(id,s)},select:function(value){if(value!=this.selectedValue){var newValue="";var selectList=D2L.LP.Web.UI.Common.Controls.SelectList;if(value!=undefined)if(value.call){var values=selectList.GetValues(this.settings.Id);for(var i=0;i<values.length;i++){var valueObject=values[i];if(this.settings.ValueAdapter)valueObject=
this.settings.ValueAdapter(values[i]);if(value(valueObject)){newValue=values[i];break}}}else newValue=value;selectList.SetSelectedValue(this.settings.Id,newValue);this.selectedValue=value}}})},Register:function(name,id,controlManager,valueAdapter){var settings;if(valueAdapter!==undefined)settings={Id:id,ValueAdapter:valueAdapter};else settings={Id:id};var control=new d2l.tinymce.ui.SelectList(name,settings);controlManager.add(control)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton={DoAction:function(splitButtonId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(splitButtonId.GetValue());var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var activeItem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-split-item-active",menuContainer);D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",activeItem)},SetIsActiveByNode:function(node,isActive){if(isActive)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-split-button-active",
node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-split-button-active",node)},SetIsEnabledByNode:function(node,isEnabled){if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-split-button-disabled",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-split-button-disabled",node)},SetSelectedItemByNode:function(menuItem){var node=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-htmleditor-toolbar-item",
menuItem));D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(node,menuItem.getAttribute("data-d2l-key"))},Update:function(splitButtonId,itemKey){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(splitButtonId.GetValue()),itemKey)},UpdateByNode:function(node,itemKey){if(node.getAttribute("data-d2l-key")===itemKey)return;var itemData=node.d2l_itemsData[itemKey];if(itemData===undefined)return;var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton;
node.setAttribute("title",itemData.title);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",itemData.title);node.setAttribute("data-d2l-key",itemData.key);var iconNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-split-button-icon",node);iconNode.src=itemData.src;iconNode.className="d2l-htmleditor-split-button-icon "+itemData.className;var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-buttonmenuitem",
menuContainer);for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];var key=menuItem.getAttribute("data-d2l-key");if(key!==itemKey)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-split-item-active",menuItem);else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-split-item-active",menuItem);me.SetIsActiveByNode(node,D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-active",menuItem));me.SetIsEnabledByNode(node,!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",
menuItem))}}}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AttributesAction={GetAttributesData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName=="BODY"||node.nodeType==9||node.getAttribute===undefined)return null;var title="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"title"))title=node.getAttribute("title");var idValue="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"id"))idValue=node.getAttribute("id");var className=node.className;
var style="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"style"))style=node.getAttribute("style");var textDirection="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"dir"))textDirection=node.getAttribute("dir");return{title:title,id:idValue,className:className,style:style,textDirection:textDirection}},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("attributes",buttonId);tinymce.create("d2l.tinymce.plugins.Attributes",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,
"attributes");editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isDisabled=node!=null&&(node.nodeName=="BODY"||node.nodeName=="BR"||node.nodeType==9);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabled(actionId,!isDisabled)})}});tinymce.PluginManager.add("d2l_attributes",d2l.tinymce.plugins.Attributes);return"-d2l_attributes"},SetAttributes:function(editorId,delayedFunction){delayedFunction.call(delayedFunction).AddListener(function(obj){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);
if(node==null)return;var setAttr=function(name,value){if(value=="")node.removeAttribute(name);else node.setAttribute(name,value)};node.className=obj.className;setAttr("title",obj.title);setAttr("id",obj.id);setAttr("style",obj.style);setAttr("dir",obj.textDirection)})}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AttributesAction.View={GetAttributes:function(id){var nodeId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId);var getTitle=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getTitle");var title=getTitle.call(getTitle);var getId=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getId");var idValue=getId.call(getId);var getClassName=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getClassName");var className=getClassName.call(getClassName);
className=className.replace(/,[\s]*|;[\s]*/g," ");var getStyle=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getStyle");var style=getStyle.call(getStyle);var getTextDirection=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getTextDirection");var textDirection=getTextDirection.call(getTextDirection);return{title:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,title),id:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,idValue),className:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,className),style:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,
style),textDirection:textDirection}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.CodeAction={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-code",function(node){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-dialog-body",node);var textArea=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-dialog-textarea",node);var wordWrap=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node));var wordWrapRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(wordWrap);var resizeTextArea=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);
textArea.style.width=rect.width-46+"px";textArea.style.height=rect.height-wordWrapRect.height-35+"px"};D2L.LP.Web.UI.Events.OnResize.AddListener(function(){setTimeout(resizeTextArea,0)})});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.CodeAction.View={GetCode:function(id){var textArea=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return textArea.value},SetWrap:function(id,isWrap){var textArea=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var wrapType="off";if(isWrap)wrapType="soft";textArea.setAttribute("wrap",wrapType)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction={InitializeLtr:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;me.GetPlugin().LtrButtonId=id;return"-d2l_directionality"},InitializeRtl:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;me.GetPlugin().RtlButtonId=id;return"-d2l_directionality"},GetPlugin:function(){var plugin=tinymce.PluginManager.get("d2l_directionality");if(!plugin){tinymce.create("d2l.tinymce.plugins.Directionality",
{init:function(editor,url){var me=this;editor.onNodeChange.add(function(ed,cm,node){var dom=ed.dom;node=dom.getParent(node,dom.isBlock);var buttonToggle=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;if(!node){buttonToggle.SetIsEnabled(plugin.LtrButtonId,false);buttonToggle.SetIsEnabled(plugin.RtlButtonId,false);return}var direction=dom.getAttrib(node,"dir");buttonToggle.SetIsActive(plugin.LtrButtonId,direction=="ltr");buttonToggle.SetIsEnabled(plugin.LtrButtonId,true);buttonToggle.SetIsActive(plugin.RtlButtonId,
direction=="rtl");buttonToggle.SetIsEnabled(plugin.RtlButtonId,true)},me)}});plugin=tinymce.PluginManager.add("d2l_directionality",d2l.tinymce.plugins.Directionality)}return plugin},SetDirection:function(editorId,direction){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editorInstance=htmlEditor.GetEditorInstanceById(editorId);var selectedNode=htmlEditor.GetSelectedNode(editorId);var element=editorInstance.dom.getParent(selectedNode,editorInstance.dom.isBlock);if(element)if(editorInstance.dom.getAttrib(element,
"dir")!=direction)editorInstance.dom.setAttrib(element,"dir",direction);else editorInstance.dom.setAttrib(element,"dir","");editorInstance.nodeChanged();editorInstance.focus()}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.EquationActions={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1)if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}else if(node.attributes.getNamedItem("hack")!=null){var applet=node.attributes.getNamedItem("hack").value;
var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math="";if(tempDiv!=null&&tempDiv.firstChild!=null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++)if(params[i].attributes!=null){var paramNameAtt=params[i].attributes.getNamedItem("name");if(paramNameAtt!=null&&paramNameAtt.value=="eq"){var paramValueAtt=params[i].attributes.getNamedItem("value");math=paramValueAtt.value;
mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("webeq","",math,math);break}}}}return mathML}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.LatexEquationAction={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className=="equation")if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}return mathML},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("latex_editor",
buttonId);tinymce.create("d2l.tinymce.plugins.LatexEquation",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"latex_editor");var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue());editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isEnabled=true;var isActive=false;if(!isCollapsed&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1){isEnabled=node.getAttribute("data-d2l-mathml").indexOf("latex")>
-1;isActive=isEnabled;if(isEnabled)D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.SetSelectedItemByNode(buttonNode)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabledByNode(buttonNode,isEnabled);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActiveByNode(buttonNode,isActive)})}});tinymce.PluginManager.add("d2l_latexequation",d2l.tinymce.plugins.LatexEquation);return"-d2l_latexequation"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className=="equation")if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}else if(node.attributes.getNamedItem("hack")!=null){var applet=node.attributes.getNamedItem("hack").value;
var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math="";if(tempDiv!=null&&tempDiv.firstChild!=null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++)if(params[i].attributes!=null){var paramNameAtt=params[i].attributes.getNamedItem("name");if(paramNameAtt!=null&&paramNameAtt.value=="eq"){var paramValueAtt=params[i].attributes.getNamedItem("value");math=paramValueAtt.value;
mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("webeq","",math,math);break}}}}return mathML},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("graphical_editor",buttonId);tinymce.create("d2l.tinymce.plugins.GraphicalEquation",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"graphical_editor");var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue());var convertToImages=function(obj){var func=
function(match){var height=80;var width=80;var title=match.match(/title=(\"|\')([^\"]*)(\"|\')/i);if(title!=null&&title.length==4&&title[2]!=null)title=title[2];else title="";var annotationRegex=/<annotation encoding="([^"]*)">/gi;var annotationMatch=annotationRegex.exec(match);var classString="equation";if(annotationMatch==null)classString+=" mathmlequation";else if(annotationMatch[1]=="wiris")classString+=" graphicalequation";else if(annotationMatch[1]=="latex")classString+=" latexequation";else classString+=
" mathmlequation";return'<img class="'+classString+'" title="'+title+'" alt="'+title+'" src="/d2l/img/LP/htmlEditor/eq_trans.gif" width="'+width+'" height="'+height+'" style="vertical-align:middle;" hspace="5" vspace="5" data-d2l-mathml="'+encodeURIComponent(match)+'" />'};var appletFunc=function(match){var math=match.match(/<math[^>]*>(.|\n|\r)*<\/math>/gi);if(math!=null&&math.length>0)math=math[0];return func(D2L.LP.Web.UI.Html.Math.AnnotateMathML("wiris","",math,math))};obj.content=obj.content.replace(/<applet[^>]*>(.|\n|\r)*(<math[^>]*>(.|\n|\r)*<\/math>)(.|\n|\r)*<\/applet>/gi,
appletFunc);obj.content=obj.content.replace(/<math[^>]*>(.|\n|\r)*?<\/math>/gi,func)};var convertToMath=function(obj){var func=function(match,sub1,sub2){var hackRegEx=/^<img[^>]*\s+data-d2l-mathml=\"([^\"]*)\"(.|\n|\r)*/i;var hackResult=hackRegEx.exec(match);var hack=decodeURIComponent(hackResult[1]);return hack};obj.content=obj.content.replace(/<img[^>]*\s+data-d2l-mathml=\"[^\"]*\"[^>]*>/gi,func)};editor.onInit.add(function(){editor.selection.onBeforeSetContent.add(function(se,o){convertToImages(o)})});
editor.onBeforeSetContent.add(function(editor,o){convertToImages(o)});editor.onPostProcess.add(function(editor,o){if(o.get)convertToMath(o)});editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isEnabled=true;var isActive=false;if(!isCollapsed&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1){isEnabled=node.getAttribute("data-d2l-mathml").indexOf("wiris")>-1;isActive=isEnabled;if(isEnabled)D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.SetSelectedItemByNode(buttonNode)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabledByNode(buttonNode,
isEnabled);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActiveByNode(buttonNode,isActive)})}});tinymce.PluginManager.add("d2l_graphicalequation",d2l.tinymce.plugins.GraphicalEquation);return"-d2l_graphicalequation"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.MathMLEquationAction={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className=="equation")if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}else if(node.attributes.getNamedItem("hack")!=null){var applet=node.attributes.getNamedItem("hack").value;
var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math="";if(tempDiv!=null&&tempDiv.firstChild!=null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++)if(params[i].attributes!=null){var paramNameAtt=params[i].attributes.getNamedItem("name");if(paramNameAtt!=null&&paramNameAtt.value=="eq"){var paramValueAtt=params[i].attributes.getNamedItem("value");math=paramValueAtt.value;
mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("webeq","",math,math);break}}}}return mathML},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("mathml_editor",buttonId);tinymce.create("d2l.tinymce.plugins.MathMLEquation",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"mathml_editor");var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue());var convertToImages=function(obj){var func=
function(match){var height=80;var width=80;var title=match.match(/title=(\"|\')([^\"]*)(\"|\')/i);if(title!=null&&title.length==4&&title[2]!=null)title=title[2];else title="";return'<img class="equation" title="'+title+'" alt="'+title+'" src="/d2l/img/LP/htmlEditor/eq_trans.gif" width="'+width+'" height="'+height+'" style="vertical-align:middle;" hspace="5" vspace="5" data-d2l-mathml="'+encodeURIComponent(match)+'" />'};var appletFunc=function(match){var math=match.match(/<math[^>]*>(.|\n|\r)*<\/math>/gi);
if(math!=null&&math.length>0)math=math[0];return func(D2L.LP.Web.UI.Html.Math.AnnotateMathML("mathml","",math,math))};obj.content=obj.content.replace(/<applet[^>]*>(.|\n|\r)*(<math[^>]*>(.|\n|\r)*<\/math>)(.|\n|\r)*<\/applet>/gi,appletFunc);obj.content=obj.content.replace(/<math[^>]*>(.|\n|\r)*?<\/math>/gi,func)};var convertToMath=function(obj){var func=function(match,sub1,sub2){var hackRegEx=/^<img[^>]*\s+data-d2l-mathml=\"([^\"]*)\"(.|\n|\r)*/i;var hackResult=hackRegEx.exec(match);var hack=decodeURIComponent(hackResult[1]);
return hack};obj.content=obj.content.replace(/<img[^>]*\s+data-d2l-mathml=\"[^\"]*\"[^>]*>/gi,func)};editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isEnabled=true;var isActive=false;if(!isCollapsed&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1){var mathml=node.getAttribute("data-d2l-mathml");isEnabled=mathml.indexOf("latex")==-1&&mathml.indexOf("wiris")==-1;isActive=isEnabled;if(isEnabled)D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.SetSelectedItemByNode(buttonNode)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabledByNode(buttonNode,
isEnabled);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActiveByNode(buttonNode,isActive)})}});tinymce.PluginManager.add("d2l_mathmlequation",d2l.tinymce.plugins.MathMLEquation);return"-d2l_mathmlequation"}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FontSizeAction={AdaptValue:function(value){return{fontSize:value}}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction={IsFullscreen:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_isFullscreen===true},SetIsFullscreen:function(editorId,buttonId,isFullscreen){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction;if(me.IsFullscreen(editorId)==isFullscreen)return;var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());
var bodyNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-body");if(bodyNode==null)bodyNode=document.getElementById("d2l_body");var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-header",node);var footerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-footer",node);if(node.d2l_fullscreenResize===undefined)node.d2l_fullscreenResize=function(){var toolbarRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(toolbarNode);var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footerNode);
var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,viewPort.height+"px",viewPort.width+"px")};if(isFullscreen){var boundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);node.d2l_nomralSize={height:boundingRect.height,width:boundingRect.width};var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();bodyNode.style.overflow="hidden";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-fullscreen",node);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,
viewPort.height+"px",viewPort.width+"px");D2L.LP.Web.UI.Events.OnResize.AddListener(node.d2l_fullscreenResize)}else{D2L.LP.Web.UI.Events.OnResize.RemoveListener(node.d2l_fullscreenResize);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,node.d2l_nomralSize.height+"px",node.d2l_nomralSize.width+"px");D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-fullscreen",node);bodyNode.style.overflow="visible"}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetIsResizeDisplayedByNode(node,!isFullscreen);
button.SetIsActive(buttonId,isFullscreen);node.d2l_isFullscreen=isFullscreen},ToggleFullscreen:function(editorId,buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction;me.SetIsFullscreen(editorId,buttonId,!me.IsFullscreen(editorId))}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.HorizontalRuleAction={GetHorizontalRuleData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!="HR")return null;var width=node.style.width;var widthType;if(width.indexOf("%")!=-1){width=width.replace("%","");widthType="%"}else if(width.indexOf("px")!=-1){width=width.replace("px","");widthType="px"}else return null;var height=node.style.height;if(height=="auto"||height.indexOf("px")==
-1)height=0;else height=height.replace("px","");var borderType="inset";if(node.style.borderStyle!="inset")borderType="solid";return{width:width,widthType:widthType,height:height,borderType:borderType}},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("horizontal_rule",buttonId);tinymce.create("d2l.tinymce.plugins.HorizontalRule",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"horizontal_rule");
editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActive(actionId,node.nodeName=="HR")});editor.onClick.add(function(editor,e){e=e.target;if(e.nodeName==="HR")editor.selection.select(e)})}});tinymce.PluginManager.add("d2l_hr",d2l.tinymce.plugins.HorizontalRule);return"-d2l_hr"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.HorizontalRuleAction.View={GetHorizontalRule:function(id){var nodeId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId);var getWidthType=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getWidthType");var widthType=getWidthType.call(getWidthType);if(widthType!="px")widthType="%";var getWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getWidthValue");var widthValue=getWidthValue.call(getWidthValue);if(widthValue==null){widthValue=
100;widthType="%"}var getHeightValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getHeightValue");var heightValue=getHeightValue.call(getHeightValue);if(heightValue==null)heightValue="auto";else heightValue=heightValue+"px";var getShadow=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getShadow");var shadow=getShadow.call(getShadow);var borderStyle="solid";if(shadow)borderStyle="inset";var hr='<hr style="width: '+widthValue+widthType+"; "+"height: "+heightValue+"; "+"color: #ffffff; "+"border-style: "+
borderStyle+"; "+"border-width: 1px; "+'border-color: #cccccc;" />';return hr}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ImageAction={Insert:function(editorId,openFunction,orgUnitPath,tempFilePath){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(editorId,openFunction,null,function(responseValues){var files=responseValues[0];var isDecorative=responseValues[1];var altText=responseValues[2];if(isDecorative)altText="";else altText=D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(altText);var src;if(files[0].FileSystemType.toLowerCase()=="content"){src=files[0].FileId;if(src.substr(0,
1)!="/")src=orgUnitPath+src;src=D2L.LP.Web.UI.Html.JavaScript.UrlEncodePath(src);src=src.replace("%2E",".")}else if(files[0].FileSystemType.toLowerCase()=="temp")src=tempFilePath.replace("%7b0%7d",files[0].FileId);else if(files[0].FileSystemType.toLowerCase()=="external")src=files[0].GetFileId();D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TriggerFileAdded(editorId,new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FileData(files[0].FileSystemType,files[0].FileId,files[0].FileName,files[0].Size,src));var html=
'<img src="'+D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(src)+'"'+' alt="'+altText+'" title="'+altText+'" />';return html})}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.IsfAction={Initialize:function(isWindowModeOpaque){tinymce.create("d2l.tinymce.plugins.Isf",{init:function(ed,url){var me=this;me.editor=ed;me.url=url;me.mce_href=new RegExp('_mce_href="[^"]*"',"g");me.mce_src=new RegExp('_mce_src="[^"]*"',"g");me.widthReAttribute=new RegExp("width=[\"']{1}[0-9px]+['\"]","gi");me.widthReQueryString=new RegExp("width=[0-9px]+","gi");me.heightReAttribute=new RegExp("height=[\"']{1}[0-9px]+['\"]","gi");me.heightReQueryString=
new RegExp("height=[0-9px]+","gi");ed.onInit.add(function(){ed.selection.onBeforeSetContent.add(function(se,o){me._convertToImages(o)})});ed.onBeforeSetContent.add(function(ed,o){me._convertToImages(o)});ed.onPostProcess.add(function(ed,o){if(o.get){me._convertToElements(o);return}})},_convertToImages:function(context){var me=this;if(context.content!=null&&context.content.length>0&&context.content.search(/(<object|<embed|<iframe)/i)!=-1){var html=context.content;var sb=new D2L.Util.StringBuilder;
var embedStartRe=new RegExp("(<embed)","i");var objectStartRe=new RegExp("(<object)","i");var iFrameStartRe=new RegExp("(<iframe)","i");var scriptStartRe=new RegExp("(<script|<mce:script)","i");var searchRe=new RegExp("(<object|<embed|<iframe|<script|<mce:script)","i");var toIndex=0;while(html.length>0){toIndex=html.search(searchRe);if(toIndex==0){embedStartRe.lastIndex=0;scriptStartRe.lastIndex=0;objectStartRe.lastIndex=0;iFrameStartRe.lastIndex=0;searchRe.lastIndex=toIndex;var match=searchRe.exec(html)[0];
if(scriptStartRe.test(match)){var scriptEndIndex=html.indexOf(">",toIndex);if(html.substr(scriptEndIndex-1,1)=="/")toIndex=scriptEndIndex+1;else{var scriptEndRe=new RegExp("(<\/script>|</mce:script>)","i");scriptEndIndex=html.search(scriptEndRe);if(scriptEndIndex!=-1)toIndex=html.indexOf(">",scriptEndIndex)+1;else toIndex=html.indexOf(">",toIndex)+1}sb.Append(html.substring(0,toIndex));html=html.substring(toIndex)}else if(objectStartRe.test(match)){var isValidObject=true;var objectHtml=html.substring(0).toLowerCase();
var objectCount=1;var objectFromIndex=7;var objectStartIndex=0;var objectEndIndex=0;while(objectCount>0){objectStartIndex=objectHtml.indexOf("<object",objectFromIndex);objectEndIndex=objectHtml.indexOf("</object>",objectFromIndex);if(objectStartIndex!=-1&&objectStartIndex<objectEndIndex){objectCount+=1;objectFromIndex=objectStartIndex+7}else if(objectEndIndex!=-1){objectCount-=1;objectFromIndex=objectEndIndex+9}if(objectEndIndex==-1){isValidObject=false;break}}if(isValidObject){sb.Append(me._createImage(html.substring(0,
objectFromIndex)));html=html.substring(objectFromIndex)}else{sb.Append(html);html=""}}else if(embedStartRe.test(match)){var embedEndIndex=html.indexOf(">");if(html.substr(embedEndIndex-1,1)=="/")embedEndIndex=embedEndIndex+1;else{var embedEndRe=new RegExp("</embed>","i");embedEndIndex=html.search(embedEndRe);if(embedEndIndex!=-1)embedEndIndex=embedEndIndex+8;else embedEndIndex=html.indexOf(">")+1}sb.Append(me._createImage(html.substring(0,embedEndIndex)));html=html.substring(embedEndIndex)}else if(iFrameStartRe.test(match)){var iFrameEndIndex=
html.indexOf(">");var iFrameHtml=html.substring(0,iFrameEndIndex+1);var iFrameSrcRe=new RegExp("src=('|\")[^>]*youtube[^'\">]*('|\")","i");iFrameHtml=iFrameHtml.replace(iFrameSrcRe,function(srcHtml){if(isWindowModeOpaque)if(srcHtml.indexOf("wmode")==-1)if(srcHtml.indexOf("?")==-1)return srcHtml.substring(0,srcHtml.length-1)+"?wmode=opaque"+srcHtml.substring(srcHtml.length-1);else return srcHtml.substring(0,srcHtml.length-1)+"&amp;wmode=opaque"+srcHtml.substring(srcHtml.length-1);else return srcHtml.replace(/wmode=([^&#\'\"]*)/,
"wmode=opaque");else if(srcHtml.indexOf("wmode")!=-1)return srcHtml=srcHtml.replace(/wmode=([^&#\'\"]*)/,"wmode=");else return srcHtml});sb.Append(iFrameHtml);html=html.substring(iFrameEndIndex+1)}}else if(toIndex==-1){sb.Append(html);break}else{sb.Append(html.substring(0,toIndex));html=html.substring(toIndex)}}context.content=sb.ToString()}},_convertToElements:function(context){var me=this;if(context.content!=null&&context.content.length>0&&context.content.search(/data-isf-content/i)!=-1){var html=
context.content;var sb=new D2L.Util.StringBuilder;var toIndex=0;var imgStartRe=new RegExp("(<img)","i");while(html.length>0){imgStartRe.lastIndex=0;toIndex=html.search(imgStartRe);if(toIndex==0){var imgEndIndex=html.indexOf(">");if(html.substr(imgEndIndex-1,1)=="/")imgEndIndex=imgEndIndex+1;else{var imgEndRe=new RegExp("</img>","i");imgEndIndex=html.search(imgEndRe);if(imgEndIndex!=-1)imgEndIndex=imgEndIndex+6;else imgEndIndex=html.indexOf(">")+1}var imgHtml=html.substring(0,imgEndIndex);if(imgHtml.indexOf("data-isf-content")!=
-1)sb.Append(me._createElement(me._getAttributeValue("data-isf-content",imgHtml),me._getAttributeValue("height",imgHtml),me._getAttributeValue("width",imgHtml)));else sb.Append(imgHtml);html=html.substring(imgEndIndex)}else if(toIndex==-1){sb.Append(html);break}else{sb.Append(html.substring(0,toIndex));html=html.substring(toIndex)}}context.content=sb.ToString()}},_createElement:function(html,height,width){var me=this;if(width==null)width="100px";if(height==null)height="100px";html=decodeURIComponent(html);
html=html.replace(me.mce_href,"");html=html.replace(me.mce_src,"");html=html.replace(me.widthReAttribute,'width="'+width+'"');html=html.replace(me.heightReAttribute,'height="'+height+'"');html=html.replace(me.widthReQueryString,"width="+width);html=html.replace(me.heightReQueryString,"height="+height);return html},_createImage:function(html){var me=this;var dom=me.editor.dom;var width=me._getAttributeValue("width",html);if(width==null)width="100px";var height=me._getAttributeValue("height",html);
if(height==null)height="100px";var classId=me._getAttributeValue("classid",html);if(classId==null)classId=me._getAttributeValue("type",html);return'<img src="/d2l/img/LP/htmlEditor/eq_trans.gif" '+'width="'+width+'" '+'height="'+height+'" '+'class="'+me._getImageClassName(classId)+'" '+'data-isf-content="'+encodeURIComponent(html)+'" />'},_getImageClassName:function(classId){if(classId!=null){classId=classId.toLowerCase();var guidIndex=classId.indexOf(":");if(guidIndex!=-1&&classId.length>guidIndex+
1)classId=classId.substring(guidIndex+1)}else classId="";switch(classId){case "d27cdb6e-ae6d-11cf-96b8-444553540000":case "application/x-shockwave-flash":case "d2l_flash":return"disf_flash";case "166b1bca-3f9c-11cf-8075-444553540000":return"disf_shockwave";case "6bf52a52-394a-11d3-b153-00c04f79faa6":case "22d6f312-b0f6-11d0-94ab-0080c74c7e95":case "05589fa1-c356-11ce-bf01-00aa0055595a":return"disf_windowsmedia";case "02bf25d5-8c17-4b23-bc80-d3488abddc6b":case "d2l_qt":return"disf_quicktime";case "cfcdaa03-8be4-11cf-b84b-0020afbbccfa":return"disf_realmedia";
default:return"disf_default"}},_getAttribute:function(attributeName,html){var attRe=new RegExp(attributeName+"=(\"[^<>\"]*\"|'[^<>']*'|w+)","i");var attMatch=attRe.exec(html);if(attMatch!=null&&attMatch.length>0)return attMatch[0];else return null},_getAttributeValue:function(attributeName,html){var attValue=null;var attRe=new RegExp(attributeName+"=(\"[^<>\"]*\"|'[^<>']*'|w+)","i");var attMatch=attRe.exec(html);if(attMatch!=null&&attMatch.length>1)if(attMatch[1].length>1&&(attMatch[1].substr(0,1)==
"'"||attMatch[1].substr(0,1)=='"'))attValue=attMatch[1].substring(1,attMatch[1].length-1);else attValue=attMatch[1];return attValue}});tinymce.PluginManager.add("d2l_isf",d2l.tinymce.plugins.Isf);return"-d2l_isf"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.LinkAction={GetLinkData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!="A")return null;var href=node.getAttribute("href");var title=D2L.LP.Web.UI.Html.Dom.GetTextContent(node);var target=node.getAttribute("target");if(target=="_top")target=1;else if(target=="_blank")target=2;else target=0;return{href:href,target:target,title:title}},GetLinkSelectedText:function(editorId){var text;
var selectedNode=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(selectedNode&&selectedNode.nodeName==="A")text=D2L.LP.Web.UI.Html.Dom.GetTextContent(selectedNode);else text=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectionContent(editorId);if(text===undefined||text===null)text="";return text},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("link",buttonId);tinymce.create("d2l.tinymce.plugins.Link",{init:function(editor,url){var actionId=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"link");editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActive(actionId,node.nodeName=="A")});editor.onClick.add(function(editor,e){e=e.target;if(e.nodeName==="A")editor.selection.select(e)})}});tinymce.PluginManager.add("d2l_link",d2l.tinymce.plugins.Link);return"-d2l_link"},SelectLink:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var selectedNode=htmlEditor.GetSelectedNode(editorId);if(selectedNode==null)return;if(selectedNode.nodeName=="A")htmlEditor.SelectNode(editorId,selectedNode)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.PasteAction={PasteWord:function(editorId,pastedContent){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.ExecuteCommand(editorId,"mceInsertClipboardContent",{content:pastedContent,wordContent:true})},InitializePastePlainText:function(notifyAlways){tinymce.create("d2l.tinymce.plugins.PastePlainText",{init:function(editor,url){editor.settings["paste_text_notifyalways"]=notifyAlways}});tinymce.PluginManager.add("d2l_pastePlainText",d2l.tinymce.plugins.PastePlainText);
return"paste,-d2l_pastePlainText"},InitializePasteWord:function(){return"paste"}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-paste",function(node){var doc=node.contentWindow.document;var cssHtml="";doc.open();doc.write("<html><head>"+cssHtml+'</head><body class="mceContentBody" spellcheck="false"></body></html>');doc.close();doc.designMode="on";var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-dialog-body",node);var pasteIntr=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);var pasteIntrRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(pasteIntr);
var resizePasteFrame=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);node.style.width=rect.width-46+"px";node.style.height=rect.height-pasteIntrRect.height-35+"px"};D2L.LP.Web.UI.Events.OnResize.AddListener(function(){setTimeout(resizePasteFrame,0)});window.setTimeout(function(){node.contentWindow.focus()},10)});D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.PasteWordAction={GetContent:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.contentWindow.document.body.innerHTML}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-preview",function(node){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-dialog-body",node);var resizeFrame=function(){setTimeout(function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);node.style.width="100%";node.style.height=rect.height-8+"px"},50)};D2L.LP.Web.UI.Events.OnResize.AddListener(resizeFrame)});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SpellcheckAction={Apply:function(editorId,openFunction){openFunction.call(openFunction).AddListener(function(responseValue){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSpellcheckText(editorId,responseValue)})},GetText:function(editorId){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSpellcheckText(editorId)}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction={};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View={GetEntityFromString:function(charValue){var entityExp=/&#[^;]*;/g;var result=entityExp.exec(charValue);if(result==null||result[0].length<4)return"";return result[0]},GetSelectedSymbol:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute("data-d2l-editId"));var charValue=
D2L.LP.Web.UI.Common.Controls.Edit.GetValue(editId);return me.GetEntityFromString(charValue)},SetSelectedSymbol:function(id,charValue){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetSelectedSymbolByNode(node,charValue)},SetSelectedSymbolByNode:function(node,charValue){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;if(node.d2l_selectedCharacter==charValue)return;charValue=
me.GetEntityFromString(charValue);if(node.d2l_charNodes===undefined)node.d2l_charNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-symbol-char",node);var htmlCodeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-symbol-htmlcode",node));htmlCodeNode.innerHTML="&nbsp;";for(var i=0;i<node.d2l_charNodes.length;i++){var charNode=node.d2l_charNodes[i];if(charNode.d2l_isSelected){charNode.d2l_isSelected=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-symbol-char-selected",
charNode)}if(charNode.getAttribute("data-d2l-numcode")==charValue){charNode.d2l_isSelected=true;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-symbol-char-selected",charNode);htmlCodeNode.innerHTML=charNode.getAttribute("data-d2l-htmlcode").replace("&","&amp;")}}node.d2l_selectedCharacter=charValue;var symbolNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-symbol-symbol",node);if(charValue.length==0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-symbol-symbol-invalid",
symbolNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-symbol-symbol-invalid",symbolNode);D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(symbolNode).innerHTML=node.d2l_selectedCharacter}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction={Initialize:function(buttonId){return"table"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript={Initialize:function(replace){tinymce.create("d2l.tinymce.plugins.ReplaceString",{init:function(editor,url){var decodeReplaceStrings=function(obj){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript.DecodeReplaceStrings(obj)};var encodeReplaceStrings=function(obj){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript.EncodeReplaceStrings(obj,replace)};editor.onInit.add(function(){editor.selection.onBeforeSetContent.add(function(se,
obj){encodeReplaceStrings(obj)})});editor.onBeforeSetContent.add(function(ed,obj){encodeReplaceStrings(obj)});editor.onPostProcess.add(function(ed,obj){if(obj.get){decodeReplaceStrings(obj);return}})}});tinymce.PluginManager.add("d2l_replacestring",d2l.tinymce.plugins.ReplaceString);return"-d2l_replacestring"},EncodeReplaceStrings:function(obj,replace){var html=obj.content;if(html!=null&&html.length>0){var func=function(match){var tempNode=document.createElement("div");tempNode.innerHTML=match;var img=
tempNode.firstChild;var mce_src=img.getAttribute("data-mce-src");var src=null;if(mce_src!=null)src=mce_src;else src=img.getAttribute("src");var originalSrc=src;for(var key in replace){var regEx=new RegExp("{"+key+"}","i");src=src.replace(regEx,replace[key])}if(src!=originalSrc){img.setAttribute("src",src);img.setAttribute("data-d2l-src",encodeURIComponent(originalSrc));if(mce_src!=null)img.setAttribute("mce_src",src);var temp=tempNode.innerHTML;temp=temp.replace(/<\/iframe>/gi,"");return temp}else return match};
obj.content=html.replace(/<(img|iframe)[^>]*\ssrc[\s]*=[\s]*(\'([^\']*)\'|\"([^\"]*)\"|([^>^\s^\/]*))[^>]*>/gi,func)}},DecodeReplaceStrings:function(obj){var html=obj.content;if(html!=null&&html.length>0){var func=function(match){var tempNode=document.createElement("div");tempNode.innerHTML=match;var img=tempNode.firstChild;var d2l_src=img.getAttribute("data-d2l-src");if(d2l_src!=""){img.setAttribute("src",decodeURIComponent(d2l_src));img.removeAttribute("data-d2l-src");if(img.getAttribute("data-mce-src")!=
null)img.setAttribute("data-mce-src",decodeURIComponent(d2l_src));var temp=tempNode.innerHTML;temp=temp.replace(/<\/iframe>/gi,"");return temp}else return match};html=html.replace(/<(img|iframe)[^>]*\sdata-d2l-src[\s]*=[\s]*(\'([^\']*)\'|\"([^\"]*)\"|([^>^\s^\/]*))[^>]*>/gi,func);obj.content=html.replace(/(%7B(orgId|orgName|orgUnitId|OrgUnitName|OrgUnitCode|OrgUnitPath|UserId|UserName|OrgDefinedId|FirstName|LastName|ExternalEmail|InternalEmail|RoleId)%7D)/gi,"{$2}")}}};
D2L.LP.Web.UI.Desktop.Controls.InlineHelp={m_popupLocation:null,Init:function(popupLocation){var me=D2L.LP.Web.UI.Desktop.Controls.InlineHelp;me.m_popupLocation=popupLocation},SetText:function(id,text){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"InlineHelp not found: '"+idVal+"'.";node.innerHTML=text},PopupHelp:function(titleTerm,descriptionTerm){var me=D2L.LP.Web.UI.Desktop.Controls.InlineHelp;var loc=me.m_popupLocation;loc=loc.WithQueryString("titleTerm",
titleTerm);loc=loc.WithQueryString("descriptionTerm",descriptionTerm);var name=titleTerm.toLowerCase().replace(".","_").replace("\\","_");D2L.LP.Web.UI.Html.Dom.OpenWindow("popupHelp_"+name,loc,600,400,false,false)}};
D2L.LP.Web.UI.Desktop.Controls.LoadMorePager={Pagers:[],Init:function(id,controlProvider,pageableControlId,showFunction,hideFunction,setLoadingTextFunction,setNormalTextFunction){var pager=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(pager===null)return;var me=D2L.LP.Web.UI.Desktop.Controls.LoadMorePager;var pageableControl=controlProvider.call(controlProvider);var info={ControlProvider:controlProvider,IsLoading:false,SetLoadingFunction:setLoadingTextFunction,PageableControl:pageableControl,PageableControlId:pageableControlId};
me.Pagers[id]=info;var setIsVisible=function(isVisible){if(isVisible)showFunction();else hideFunction()};var onLoadCompleteFunction=function(hasMoreItems){setIsVisible(hasMoreItems)};pageableControl.GetOnLoadCompletedEvent(pageableControlId).AddListener(onLoadCompleteFunction);var onLoadMoreCompleteFunction=function(hasMoreItems){me.Pagers[id].IsLoading=false;setNormalTextFunction();setIsVisible(hasMoreItems)};pageableControl.GetOnLoadMoreCompletedEvent(pageableControlId).AddListener(onLoadMoreCompleteFunction);
pager.d2l_onLoadCompleteHandle=onLoadCompleteFunction;pager.d2l_onLoadMoreHandle=onLoadMoreCompleteFunction;pager.d2l_pageableControl=pageableControl;pager.d2l_pageableControlId=pageableControlId;setIsVisible(pageableControl.GetHasMoreItems(pageableControlId))},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.LoadMorePager;var info=me.Pagers[id];if(info===undefined||info.IsLoading)return;info.IsLoading=true;setTimeout(function(){if(info.IsLoading)info.SetLoadingFunction()},1E3);info.PageableControl.LoadMore(info.PageableControlId)}};
D2L.LP.Web.UI.Desktop.Controls.MenuFlyout={Init:function(menuNode,openerNode,contentsNode,textNode,openFunction,openFirstFunction,closeFunction){D2L.LP.Web.UI.Html.Aria.SetRole(openerNode,"button");D2L.LP.Web.UI.Html.Aria.SetAttribute(openerNode,"controls",contentsNode.id);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"hidden","true");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(contentsNode,"tabindex","0");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,
"live",D2L.LP.Web.UI.Html.Aria.Politeness.Assertive);if(textNode!==null){var id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();textNode.id=id;D2L.LP.Web.UI.Html.Aria.SetAttribute(openerNode,"labelledby",id);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"labelledby",id)}var isOpen=false;var opening=false;var isFirst=true;var isAuto=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-contents-left",contentsNode)&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-contents-right",contentsNode);
var onFocus=function(){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(contentsNode,activeNode)&&!D2L.LP.Web.UI.Html.Dom.IsAncestor(menuNode,activeNode))close()};var open=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-open",menuNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-closed",menuNode);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"hidden","false");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"expanded","true");
isOpen=true;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",document.body,onFocus,true);D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.UpdatePosition(isAuto,contentsNode,menuNode);if(openFunction)openFunction.call(openFunction);if(isFirst&&openFirstFunction){isFirst=false;openFirstFunction.call(openFirstFunction)}D2L.LP.Web.UI.Html.Dom.FocusNode(contentsNode)};var close=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-open",menuNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-closed",
menuNode);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"hidden","true");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"expanded","false");isOpen=false;D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",document.body,onFocus,true);if(closeFunction)closeFunction.call(closeFunction)};menuNode.d2l_closeHandle=close;var onclick=function(){if(isOpen)close();else{opening=true;setTimeout(function(){opening=false},200);open()}};D2L.LP.Web.UI.Events.OnClick.AddListener(function(){if(!isOpen||opening)return;
close()});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",openerNode,onclick);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",contentsNode,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e)});var handleKeyPress=function(arg){if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){close();D2L.LP.Web.UI.Html.Dom.FocusNode(openerNode)}else return true;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(arg.GetEventObject());return false};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(contentsNode,
handleKeyPress)},UpdatePosition:function(isAuto,contentsNode,menuNode){if(!isAuto)return;var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-contents-left",contentsNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-contents-right",contentsNode);var parent=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-max-width",contentsNode)||document.body;
var flyoutRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(menuNode);var parentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parent);var contentsRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(contentsNode);var left=Math.max(flyoutRect.right-parentRect.left,0);var right=Math.max(parentRect.right-flyoutRect.left,0);var rightOverflow;if(isRTL)rightOverflow=left-contentsRect.width;else rightOverflow=right-contentsRect.width;if(rightOverflow>0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-contents-right",
contentsNode);else if((isRTL?right:left)-contentsRect.width>0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-contents-left",contentsNode);else if(isRTL)contentsNode.style.right=rightOverflow+"px";else contentsNode.style.left=rightOverflow+"px"},Close:function(id){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!flyout)return;D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.CloseByNode(flyout)},CloseByNode:function(node){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-open",
node))return;node.d2l_closeHandle.call(node.d2l_closeHandle)},GetOpenMenuFlyouts:function(node){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-menuflyout-open",node)},IsOpen:function(id){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!flyout)return;return D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-open",flyout)},SetTitle:function(id,val){var flyout=id.$();if(flyout.length===0)return;var openerAnchor=$(".d2l-menuflyout-opener",flyout);openerAnchor.prop("title",
val);$(".d2l-menuflyout-text",openerAnchor).text(val)}};
D2L.LP.Web.UI.Common.Controls.MessageArea={IsVisible:false,PlaceholderId:null,ErrorLocation:null,Apply:function(delegate){var ma=D2L.LP.Web.UI.Html.Dom.GetElementById(D2L.LP.Web.UI.Common.Controls.MessageArea.PlaceholderId);if(ma!==null)delegate.call(delegate,ma)},CreateBalloon:function(message){var tipNode=document.createElement("div");tipNode.className="d2l-form-balloon-tip";var borderNode=document.createElement("div");borderNode.className="d2l-form-balloon-border";var balloonId=new D2L.LP.Web.UI.Html.UniqueHtmlId;
var balloon=document.createElement("div");balloon.id=balloonId.GetValue();balloon.className="d2l-form-balloon";var balloonChildren=document.createElement("div");balloonChildren.className="d2l-form-balloon-children";var balloonTextSpan=document.createElement("span");balloonTextSpan.className="d2l-form-balloon-text";balloonTextSpan.appendChild(document.createTextNode(message));balloonChildren.appendChild(borderNode);balloonChildren.appendChild(tipNode);balloonChildren.appendChild(balloonTextSpan);balloon.appendChild(balloonChildren);
return balloon},Init:function(placeholderId,errorLocation){var me=D2L.LP.Web.UI.Common.Controls.MessageArea;me.PlaceholderId=placeholderId;me.ErrorLocation=errorLocation},Reset:function(balloonContainer){D2L.LP.Web.UI.Common.Controls.MessageArea.SetIsVisible(false);var balloons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-balloon",balloonContainer);for(var i=0;i<balloons.length;i++){if(balloons[i].d2l_input!==undefined){D2L.LP.Web.UI.Html.Aria.SetAttribute(balloons[i].d2l_input,"labelledby",
"");balloons[i].d2l_input.style.marginBottom=balloons[i].d2l_input_original_bottom_margin;balloons[i].d2l_input=null}balloons[i].parentNode.removeChild(balloons[i])}},RpcReceivePayloadProvider:function(data){var me=D2L.LP.Web.UI.Common.Controls.MessageArea;var count=0;var updateVisibility=function(){count++;if(data.Items.length===0||count===data.Items.length)me.Apply(function(node){node.innerHTML=data.Html;D2L.LP.Web.UI.Events.OnViewRender.Trigger(node);me.SetIsVisible(true);D2L.LP.Web.UI.Html.Dom.FocusNode(node)})};
if(data.Items.length===0)updateVisibility();for(var i=0;i<data.Items.length;i++)(function(index){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(data.Items[index].Key);if(input===null){updateVisibility();return}var balloon=me.CreateBalloon(data.Items[i].Message);balloon.d2l_input=input;var balloonChildrenNode=balloon.firstChild;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(balloon,input);D2L.LP.Web.UI.Html.Aria.SetAttribute(input,"labelledby",balloon.id);setTimeout(function(){var bottomMargin=D2L.LP.Web.UI.Html.Css.GetStyle(input,
"margin-bottom");if(bottomMargin===undefined){bottomMargin=D2L.LP.Web.UI.Html.Css.GetStyle(input,"marginBottom");if(bottomMargin===undefined)bottomMargin="0px"}balloon.d2l_input_original_bottom_margin=bottomMargin;input.style.marginBottom=balloonChildrenNode.offsetHeight+10+"px";balloon.style.marginTop=-balloonChildrenNode.offsetHeight+"px";balloon.style.height=balloonChildrenNode.offsetHeight+"px";updateVisibility()},0)})(i)},SetIsVisible:function(isVisible){D2L.LP.Web.UI.Common.Controls.MessageArea.Apply(function(ma){var me=
D2L.LP.Web.UI.Common.Controls.MessageArea;if(me.IsVisible==isVisible)return;ma.style.display=isVisible?"block":"none";me.IsVisible=isVisible;D2L.LP.Web.UI.Events.OnContentHeightChange.Trigger()})},ShowErrors:function(errors){D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,D2L.LP.Web.UI.Common.Controls.MessageArea.ErrorLocation,{errors:errors})}};
D2L.LP.Web.UI.Desktop.Controls.SearchSimple={Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;var searchId=id.GetValue();me.GetInputNode(id).value="";var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(searchId);hidden.value="";me.SetClearLinkIsVisible(id,false);if(!D2L.LP.Web.UI.ObjectRepository.HasKey(searchId))return;var onClear=D2L.LP.Web.UI.ObjectRepository.Get(searchId,0);if(onClear==null)return;onClear.call(onClear)},Focus:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;
D2L.LP.Web.UI.Html.Dom.Focus(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(me.GetInputNode(id).id))},GetInputNode:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-searchsimple",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-searchsimple-input",node)[0]},GetInputValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;return me.GetInputNode(id).value.trim()},IsSearched:function(id){var searchId=id.GetValue();
var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(searchId);return hidden.value!=""},OnBeforeSearch:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;var searchId=id.GetValue();var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(searchId);hidden.value=me.GetInputValue(id);me.SetClearLinkIsVisible(id,true)},Search:function(id){var formNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(formNode)},
SetValue:function(id,value){var input=D2L.LP.Web.UI.Desktop.Controls.SearchSimple.GetInputNode(id);input.value=value},SetClearLinkIsVisible:function(id,isVisible){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;var spanNode=me.GetInputNode(id).parentNode;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-searchsimple-clear-visible",spanNode))return;var isCurrentlyVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-searchsimple-clear-hidden",spanNode);if(isVisible){if(!isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-searchsimple-clear-hidden",
spanNode)}else if(isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-searchsimple-clear-hidden",spanNode)}};
D2L.LP.Web.UI.Desktop.Controls.Shim={m_shim:null,m_zIndex:1E3,Delete:function(handle){var me=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim;if(handle===undefined||handle===null)return;var resetRoles=function(nodes){for(var i=0;i<nodes.length;i++){var node=nodes[i];if(node.setAttribute===undefined)return;if(node.d2l_role==""){node.removeAttribute("role");node.d2l_role=undefined}else{D2L.LP.Web.UI.Html.Aria.SetRole(node,node.d2l_role);node.d2l_role=undefined}}};var resetAria=function(nodes){for(var i=
0;i<nodes.length;i++){var node=nodes[i];if(node.setAttribute===undefined)return;if(node.d2l_aria_hidden==""){node.removeAttribute("aria-hidden");node.d2l_aria_hidden=undefined}else{D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"aria-hidden",node.d2l_aria_hidden);node.d2l_aria_hidden=undefined}}};if(handle.hiddenNodes.length>0)resetRoles(handle.hiddenNodes.pop());if(handle.hiddenAriaNodes.length>0)resetAria(handle.hiddenAriaNodes.pop());if(handle.zIndices.length>0){var lastZIndex=handle.zIndices.pop();
me.m_shim.shim.style.zIndex=lastZIndex}else{D2L.LP.Web.UI.Html.Dom.RemoveElement(me.m_shim.shim);handle.rootWin.D2L.LP.Web.UI.Events.OnResize.RemoveListener(handle.onresize);me.m_shim=null}},GetZIndex:function(){D2L.LP.Web.UI.Desktop.Controls.Shim.m_zIndex++;return D2L.LP.Web.UI.Desktop.Controls.Shim.m_zIndex},AddShim:function(handle,w,node,isTransparent){var me=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim;var shim=document.createElement("div");shim.className="d2l-shim";if(!isTransparent)shim.className+=
" d2l-shim-opaque";shim.style.zIndex=me.GetZIndex();setTimeout(function(){shim.style.opacity="0.5"},100);handle.shim=shim;if(node===w.document){var resize=function(){var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);shim.style.width="1px";shim.style.height="1px";var page=D2L.LP.Web.UI.Html.Dom.GetPageSize(handle.rootWin);shim.style.height=Math.max(page.height,viewport.height)+"px";shim.style.width="100%"};resize();handle.onresize=function(){resize()};D2L.LP.Web.UI.Events.OnResize.AddListener(handle.onresize)}handle.rootWin.document.body.appendChild(shim)},
HideAccessibleElements:function(handle){var hidden=[];var hiddenAria=[];handle.hiddenNodes.push(hidden);handle.hiddenAriaNodes.push(hiddenAria);var recurse=function(node){var abort=node==handle.dialog||node==handle.node||node.setAttribute===undefined||node.nodeName===undefined||node.nodeName.toLowerCase()==="iframe";if(abort)return;var oldRole=node.getAttribute("role");if(node.d2l_role===undefined){hidden.push(node);if(oldRole!=null)node.d2l_role=oldRole;else node.d2l_role=""}D2L.LP.Web.UI.Html.Aria.SetRole(node,
"presentation");if(node.nodeName==="FORM"||node.nodeName==="A"){var oldHidden=node.getAttribute("aria-hidden");if(node.d2l_aria_hidden===undefined){hiddenAria.push(node);if(oldHidden!=null)node.d2l_aria_hidden=oldHidden;else node.d2l_aria_hidden=""}D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"aria-hidden","true")}for(var i=0;i<node.childNodes.length;i++)recurse(node.childNodes[i])};recurse(handle.rootWin.document.body)},Create:function(node,isTransparent){var rootWindow=null;var currWin=window;while(currWin!=
null&&currWin.D2L!=null&&currWin.D2L!=undefined){if(currWin==rootWindow)break;rootWindow=currWin;currWin=currWin.parent}var me=rootWindow.D2L.LP.Web.UI.Desktop.Controls.Shim;if(me.m_shim===null){var handle={shim:null,zIndices:[],onresize:null,node:node,win:window,rootWin:rootWindow,hiddenNodes:[],hiddenAriaNodes:[]};me.AddShim(handle,window,window.document,isTransparent);me.m_shim=handle}else{me.m_shim.zIndices.push(me.m_shim.shim.style.zIndex);me.m_shim.shim.style.zIndex=me.GetZIndex()}me.HideAccessibleElements(me.m_shim);
node.style.zIndex=me.GetZIndex();return me.m_shim}};
D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput={GetValue:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=node.getElementsByTagName("input");var value="none";var originalValue="none";for(var i=0;i<inputs.length;i++)if(D2L.LP.Web.UI.Html.Dom.GetAttribute(inputs[i],"type")=="radio"&&inputs[i].checked)value=inputs[i].value;else if(D2L.LP.Web.UI.Html.Dom.GetAttribute(inputs[i],"type")=="hidden")originalValue=inputs[i].value;var param=new D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput.Param(value,
originalValue);return param},InitHandle:function(node){var handle={node:node,labels:[],noneInput:null,votesNode:null,currentMessageNode:null,upMessageNode:null,downMessageNode:null,noneMessageNode:null,showToolTip:true,upVotes:0,downVotes:0};handle.labels=node.getElementsByTagName("label");var noneLabel=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-none",node)[0];handle.noneInput=noneLabel.getElementsByTagName("input")[0];handle.votesNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-votes",
node)[0];handle.showToolTip=D2L.LP.Web.UI.Html.Dom.HasAttribute(handle.votesNode,"title");var messages=handle.votesNode.getElementsByTagName("span");for(var i=0;i<messages.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",messages[i])){handle.currentMessageNode=messages[i];break}handle.upMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-msg-up",handle.votesNode)[0];handle.downMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-msg-down",
handle.votesNode)[0];handle.noneMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-msg-none",handle.votesNode)[0];handle.upVotes=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-upvotes");handle.downVotes=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-downvotes");return handle},SetMessage:function(handle,messageNode){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",handle.currentMessageNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",messageNode);if(handle.showToolTip){var title=
D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,"data-d2l-title");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.votesNode,"title",title)}handle.currentMessageNode=messageNode},SetSelected:function(handle,index,clickLabel){var me=D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput;var label=handle.labels[index];var input=label.getElementsByTagName("input")[0];if(clickLabel)if(input.checked)handle.noneInput.checked=true;else input.checked=true;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-updownvote-active",
label)){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-updownvote-active",label);if(index==0)handle.upVotes--;else if(index==1)handle.downVotes--;me.SetMessage(handle,handle.noneMessageNode)}else{var selectedNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-active",handle.node)[0];D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-updownvote-active",selectedNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-updownvote-active",label);if(index==0){handle.upVotes++;me.SetMessage(handle,handle.upMessageNode)}else if(index==
1){handle.downVotes++;me.SetMessage(handle,handle.downMessageNode)}}var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id);if(onChange!==null)onChange()}};
D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput.Param=D2L.Class.Create({Construct:function(value,originalValue){if(value===undefined){value="";originalValue=""}this.m_value=value;this.m_originalValue=originalValue},_serialize:function(serializer){serializer.AddMember("value",this.m_value);serializer.AddMember("originalValue",this.m_originalValue)},GetValue:function(){return this.m_value},GetOriginalValue:function(){return this.m_originalValue}});
D2L.LP.QuickLinks={Web:{Desktop:{Controls:{},Dialog:{},HtmlEditor:{}}}};
D2L.LP.QuickLinks.Web.Desktop.HtmlEditor.QuickLinksDialogComponent={GetQuickLinkItems:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(node.d2l_quicklinks!==undefined)return node.d2l_quicklinks;return[]},GetQuickLinkData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!="A")return null;var href=node.getAttribute("href");var title=D2L.LP.Web.UI.Html.Dom.GetTextContent(node);var target=
node.getAttribute("target");if(target=="_top")target="WholeWindow";else if(target=="_blank")target="NewWindow";else target="SameFrame";var properties=[];properties.push({name:"target",value:target});return new D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData("",null,href,title,properties,"html")},GetQuickLinkSelectedText:function(editorId){var text;var selectedNode=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(selectedNode&&selectedNode.nodeName==="A")text=
D2L.LP.Web.UI.Html.Dom.GetTextContent(selectedNode);else text=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectionContent(editorId);if(text===undefined||text===null)text="";return text},Insert:function(editorId,openFunction,quicklinksProvider,selectionProvider){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(editorId,openFunction,selectionProvider,function(quicklinkItems){var evt=new D2L.LP.Web.UI.Events.Event;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_quicklinks=
quicklinkItems;quicklinksProvider.call(quicklinksProvider).AddListener(function(quicklinks){if(quicklinks==null||quicklinks.length==0){evt.Trigger("");return}var quicklinksHtml="";for(var i=0;i<quicklinks.length;i++)quicklinksHtml+=quicklinks[i].html;evt.Trigger(quicklinksHtml)});return evt})},SelectLink:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var selectedNode=htmlEditor.GetSelectedNode(editorId);if(selectedNode==null)return;if(selectedNode.nodeName=="A")htmlEditor.SelectNode(editorId,
selectedNode)}};
D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector={ClearSelection:function(id){var controlId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(controlId);node.d2l_selectedItems=[];var onSelectionChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(controlId,"onSelectionChanged");if(onSelectionChanged!=null)onSelectionChanged.call(onSelectionChanged)},GetOutputFormat:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var outputFormat=node.getAttribute("data-d2l-outputformat");if(outputFormat===
undefined||outputFormat===null)return"";else return outputFormat},GetSelectedItem:function(id){var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;var items=me.GetSelectedItems(id);if(items.length==0)return null;return items[items.length-1]},GetSelectedItems:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_selectedItems!=null)return node.d2l_selectedItems;return[]},OnSelectItem:function(id,typeKey,itemId,itemTitle,itemProperties){if(itemId==null)return;
if(itemTitle==null)itemTitle="";var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;me.OnSelectItemHelper(id,new me.ItemData(typeKey,itemId,null,itemTitle,itemProperties,me.GetOutputFormat(id)))},OnSelectPublicItem:function(id,typeKey,itemUrl,itemTitle,itemProperties){if(itemUrl==null)return;if(itemTitle==null)itemTitle="";var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;me.OnSelectItemHelper(id,new me.ItemData(typeKey,null,itemUrl,itemTitle,itemProperties,me.GetOutputFormat(id)))},
OnSelectItemHelper:function(id,item){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_selectedItems===undefined)node.d2l_selectedItems=[];node.d2l_selectedItems.push(item);var onSelect=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"onSelect");if(onSelect!=null)onSelect.call(onSelect);var onSelectionChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"onSelectionChanged");if(onSelectionChanged!=null)onSelectionChanged.call(onSelectionChanged)},TriggerOnManage:function(id){setTimeout(function(){var onManage=
D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"onManage");if(onManage!=null)onManage.call(onManage)},0)}};
D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData=D2L.Class.Create({Construct:function(typeKey,id,url,title,properties,outputFormat){this.m_typeKey=typeKey;if(id==null)id="";this.m_id=id;if(url==null)url="";this.m_url=url;this.m_title=title;if(properties==null)properties=[];this.m_properties=properties;if(outputFormat==null)outputFormat="";this.m_outputFormat=outputFormat},_serialize:function(serializer){serializer.AddMember("typeKey",this.m_typeKey);serializer.AddMember("id",this.m_id);
serializer.AddMember("url",this.m_url);serializer.AddMember("title",this.m_title);serializer.AddMember("outputFormat",this.m_outputFormat);var properties=this.m_properties;for(var i=0;i<properties.length;i++)serializer.AddMember(properties[i].name,properties[i].value)}});D2L.LP.Web.UI.Events.OnClick=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.OnContentHeightChange=new D2L.LP.Web.UI.Events.Event(function(){var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body");if(body===null)body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-body");var height=Math.max(body.scrollHeight,body.offsetHeight);return[height]});D2L.LP.Web.UI.Events.OnKeyPress=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnMouseMove=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnMouseUp=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.OnResize=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnSizingFinished=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnStorage=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnViewRender=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnVisibilityChange=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnLoad=D2L.LP.Web.UI.Events.OnLoad||new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnProcessingBegin=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.OnProcessingEnd=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.VisibilityManager={AddListener:function(node,callback){D2L.LP.Web.UI.Events.VisibilityManager.Listeners.push({node:node,callback:callback})},Initialize:function(){D2L.LP.Web.UI.Events.OnVisibilityChange.AddListener(function(node,isDisplayed){var listeners=D2L.LP.Web.UI.Events.VisibilityManager.Listeners;for(var i=0;i<listeners.length;i++)if(D2L.LP.Web.UI.Html.Dom.IsAncestor(node,listeners[i].node))if(D2L.LP.Web.UI.Html.Css.GetStyle(listeners[i].node,"display")!="none")listeners[i].callback.call(listeners[i].callback,
isDisplayed)})},Listeners:[]};D2L.LP.Web.UI.Events.VisibilityManager.Initialize();D2L.LP.Web.UI.Events.OnLoad.AddListener(function(){D2L.LP.Web.UI.Events.OnViewRender.Trigger(document)});
D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(node){if(node.nodeType!=9&&node.nodeType!=1)return;if(node!==document)$(node).trigger("vui-viewrender");vui.applyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassInitializers,node);var tagInitializers=D2L.LP.Web.UI.Html.Dom.TagInitializers;for(var tagName in tagInitializers){var nodes=node.getElementsByTagName(tagName);var nodesCopy=[];for(var j=0;j<nodes.length;j++)nodesCopy.push(nodes[j]);for(var j=0;j<nodesCopy.length;j++)for(var k=0;k<tagInitializers[tagName].length;k++)tagInitializers[tagName][k].call(tagInitializers[tagName],
nodesCopy[j])}});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(sourceNode){if(sourceNode===document)return;D2L.LP.Web.UI.Html.Math.UpdateNode(sourceNode)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dialog-close",function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitClose(node,window)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dialog-title",function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitle(node,window)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dialog-resize",function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitResize(node,window)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-page-buttons",function(node){D2L.LP.Web.UI.Desktop.Controls.PageButtons.Init(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("dba",function(node){var isBottom=$(node).is(".dba_b");if(!isBottom)return;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.PageButtons.Init(node)},300)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-flash-message",function(node){var over=false;var fadedOut=false;var $node=$(node);$node.attr("role","alert");var $pageMessage=$node.closest(".d2l-page-message");if($pageMessage===undefined)return;var pageMessageId=$pageMessage.attr("id");if(pageMessageId===undefined)return;pageMessageId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(pageMessageId);var autoHide=$(node).data("d2l-autohide")!==undefined;var FadeOut=function(){if(over)return;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Close(pageMessageId);
setTimeout(function(){fadedOut=true},2E3)};if(autoHide){setTimeout(FadeOut,4E3);$pageMessage.on("mouseover",function(){if(fadedOut)return;over=true;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(pageMessageId)}).on("mouseout",function(){over=false;setTimeout(FadeOut,4E3)})}setTimeout(function(){var $messageNode=$node.find(".d2l-flash-message-text");var text=$("<p></p>").append($messageNode.attr("data-message-text"));$messageNode.append(text);$node.css("visibility","hidden");$node.css("visibility",
"visible");D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(pageMessageId)},100)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("vui-button",function(node){D2L.LP.Web.UI.Common.Controls.Button.Init(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("vui-button");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-form",function(form){var submitFormOnEnterBuster=document.createElement("input");submitFormOnEnterBuster.type="text";submitFormOnEnterBuster.className="d2l-hidden";form.appendChild(submitFormOnEnterBuster);var onChangeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,"change");if(onChangeFunc!==null)D2L.LP.Web.UI.Common.Controls.ChangeTracking.OnChange.AddListener(function(changedElement){onChangeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,"change");
if(onChangeFunc!==null)if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,changedElement))onChangeFunc.call(onChangeFunc)});var trackChanges=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-form-track-changes",form)&&D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",document)==null&&D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-track-changes",form)==null;if(!trackChanges)return;form.m_stopChangeTrackingPrompt=false;window.onbeforeunload=function(){if(form.m_stopChangeTrackingPrompt)return;
if(D2L.LP.Web.UI.Common.Controls.Form.HasChangedNode(form))return"Unsaved Changes"}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-clickable",function(node){D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-clickable");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe",function(iframe){var onClick=D2L.LP.Web.UI.Events.OnClick;var $iframe=$(iframe);var loadingIcon=$iframe.prev(".d2l-iframe-loading-container");var showContent=function(){loadingIcon.hide();$iframe.removeClass("d2l-iframe-offscreen")};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,showContent);var loadHandler=function(){var handleClick=function(evt){onClick.Trigger(evt)};try{D2L.LP.Web.UI.Html.Dom.AddEventListener("click",iframe.contentWindow.document,
handleClick)}catch(e){}try{var mathJaxMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementById("MathJax_MSIE_Frame",iframe.contentWindow.document);if(mathJaxMessageNode&&mathJaxMessageNode.parentNode&&mathJaxMessageNode.parentNode.parentNode)mathJaxMessageNode.parentNode.parentNode.removeChild(mathJaxMessageNode.parentNode)}catch(e){}};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,loadHandler)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe-fullscreen",function(iframe){document.body.style.overflow="hidden";var pagePadding=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-main-padding",document);if(pagePadding!==null&&pagePadding!==undefined)pagePadding.style.paddingBottom=0;var dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",document);if(dialogBody===null)dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-popup-body",document);
var resize=function(){var viewportHeight;if(dialogBody===null)viewportHeight=D2L.LP.Web.UI.Html.Dom.GetViewportSize().height;else viewportHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody).height;var height=viewportHeight;if(dialogBody===null){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(iframe);height-=rect.top}else height-=5;iframe.style.height=height+"px"};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,resize);setTimeout(function(){D2L.LP.Web.UI.Events.OnResize.AddListener(function(){resize()})})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe-fit",function(iframe){var doResize=function(){try{var body=iframe.contentWindow.document.body;if(body){var scrollHeight=body.scrollHeight;if(iframe.contentWindow.document.documentElement&&navigator.appVersion.indexOf("MSIE")<0){var documentElementHeight=iframe.contentWindow.document.documentElement.scrollHeight;scrollHeight=Math.min(documentElementHeight,scrollHeight)}body.style.overflowY="hidden";iframe.style.height=scrollHeight+"px"}}catch(e){}setTimeout(function(){doResize()},
500)};var resize=function(){var body=null;try{body=iframe.contentWindow.document.body}catch(e){}if(body===null)return;doResize()};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,resize)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe-fit-user-content",function(iframe){var id=D2L.LP.Web.UI.Common.Controls.IFrame.GetNextGeneratedId();var doResize=function(){try{var isLOR=false;var innerLorFrame=null;var body=null;var contentType=null;try{var heightDefault=$(iframe).attr("data-default-height");if(iframe.contentWindow.document.getElementsByTagName("iframe").length===1){var iframeName=iframe.contentWindow.document.getElementsByTagName("iframe")[0].attributes["name"];if(iframeName&&
iframeName.value==="frmContentObject"){isLOR=true;innerLorFrame=iframe.contentWindow.document.getElementsByTagName("iframe")[0];innerLorFrame.style.height="auto";innerLorFrame.scrolling="no";innerLorFrame.style.overflowY="hidden";try{if(innerLorFrame.contentWindow.document.getElementsByTagName("frameset").length>0){innerLorFrame.style.height=heightDefault+"px";innerLorFrame.scrolling="auto";iframe.style.height=heightDefault+"px";iframe.scrolling="auto"}body=innerLorFrame.contentWindow.document.body||
innerLorFrame.document.body}catch(e){iframe.style.height=heightDefault+"px";iframe.scrolling="auto";innerLorFrame.style.height=heightDefault+"px";innerLorFrame.scrolling="auto";innerLorFrame.style.overflowY="scroll"}try{if(innerLorFrame.attributes["data-contenttype"].value==="html")contentType="html";else if(innerLorFrame.attributes["data-contenttype"].value==="image")contentType="image";else contentType="other"}catch(e){}}else{body=iframe.contentWindow.document.body;iframe.style.height=heightDefault+
"px"}}else{if(iframe.contentWindow.document.getElementsByTagName("frameset").length>0){iframe.style.height=heightDefault+"px";return}body=iframe.contentWindow.document.body}}catch(e){iframe.style.height=getSafeHeight(height)+"px";body=iframe.contentWindow.document.body}if(body){var height=Math.max(body.scrollHeight,body.offsetHeight,body.clientHeight);if(isLOR===false){var docElement=iframe.contentWindow.document.documentElement;if(docElement)height=Math.max(height,docElement.scrollHeight,docElement.offsetHeight,
docElement.clientHeight);if(iframe.contentWindow.innerHeight)height=Math.max(height,iframe.contentWindow.innerHeight)}else{var docElement=innerLorFrame.contentWindow.document.documentElement;if(contentType==="other")height=$(iframe).attr("data-default-height");else{var docElement=innerLorFrame.contentWindow.document.documentElement;if(docElement)height=Math.max(height,docElement.scrollHeight,docElement.offsetHeight,docElement.clientHeight);if(innerLorFrame.contentWindow.innerHeight)height=Math.max(height,
iframe.contentWindow.document.getElementsByTagName("iframe")[0].contentWindow.innerHeight)}innerLorFrame.style.height=height+"px";if(contentType==="image")try{var img=innerLorFrame.contentWindow.document.getElementsByTagName("img")[0];img.style.maxWidth="100%"}catch(e){innerLorFrame.scrolling="yes"}}body.style.overflowY="hidden";iframe.style.height=getSafeHeight(height)+"px"}}catch(e){iframe.style.height=getSafeHeight(height)+"px"}if(isLOR===false||contentType==="html"||contentType==="image")setTimeout(function(){doResize()},
500)};var resize=function(){var body=null;try{body=iframe.contentWindow.document.body;doResize()}catch(e){window.addEventListener("message",listenForCrossDomainSizeChanges,false);requestIframeSize()}};var requestIframeSize=function(){iframe.contentWindow.postMessage(JSON.stringify({handler:"d2l.iframe.client",id:id}),"*")};var listenForCrossDomainSizeChanges=function(event){try{var data=JSON.parse(event.data);if(!(data.handler==="d2l.iframe.host"))return;iframe.scrolling="no";iframe.style.overflowY=
"hidden";iframe.style.height=getSafeHeight(data.height)+"px"}catch(e){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("iframe resize: not handling unexpected message posted by another window: ",event.data)}};var getSafeHeight=function(height){if(!height||height<30)height=$(iframe).attr("data-default-height");return height};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,resize)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-imagelink",function(node){var me=D2L.LP.Web.UI.Common.Controls.ImageLink;var isDisabled=!me.IsEnabledNode(node);if(isDisabled)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true");var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-onclick");if(hasOnClick){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"data-onclick");if(onClick)D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
node,function(){if(D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node))eval(onClick)})}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-imagelink");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-select",function(node){var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.selectedIndex});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){changeEvent.Trigger()});var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-select-container",node);if(container===null)return;var arrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-select-arrow",
container);if(arrow===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-container-focus",container);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-arrow-focus",arrow)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-select-container-focus",container);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-select-arrow-focus",arrow)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-select-optgroup",function(node){for(var i=0;i<node.childNodes.length;i++){var option=node.childNodes[i];if(option.nodeType==1)option.title=node.label}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-select");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-text-imagelink",function(node){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"href"))D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-text-imagelink");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-breadcrumbs",function(node){var breadCrumbs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-breadcrumb",node);if(breadCrumbs.length===0)return;var lastChild=breadCrumbs[breadCrumbs.length-1];D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-breadcrumb-last",lastChild)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-button-menu",function(node){D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.Init(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-button-menu");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-calendar-mini",function(node){var navMatrix=new Array;var prevMonthArrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-prevmonth",node);var nextMonthArrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-nextmonth",node);var navLocation={col:0,row:0,daysPerWeek:7};var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var setOnClick=
function(onclick,days,i,j){days[i+j].onclick=function(event){if(node.editNode!=null&&node.editNode.closeMiniCalendar)node.editNode.closeMiniCalendar();onclick(event)};days[i+j].onkeypress=function(kpEvent){var keyCodeEvent=kpEvent||window.event;var keyCode=keyCodeEvent.keyCode;if(keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter||keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Space){if(node.editNode!=null&&node.editNode.closeMiniCalendar)node.editNode.closeMiniCalendar();onclick(kpEvent)}}};
var monthChangeAdditionalOnClick=function(){setTimeout(function(){if(node.editNode!=null&&node.editNode.onMiniCalendarChange)node.editNode.onMiniCalendarChange()},200)};var initNavMatrix=function(){D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnClick(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(prevMonthArrow.id),monthChangeAdditionalOnClick);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnClick(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(nextMonthArrow.id),monthChangeAdditionalOnClick);var days=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-calendar-mini-day",
node);for(var i=0;i<days.length;i+=7){navMatrix.push(new Array);for(var j=0;j<7;j++){setOnClick(days[i+j].onclick,days,i,j);navMatrix[navMatrix.length-1].push(days[i+j]);days[i+j].tabIndex=-1}}};var navMatrixBoundaryCheck=function(){return navLocation.row>=0&&navLocation.row<navMatrix.length&&navLocation.col>=0&&navLocation.col<navLocation.daysPerWeek};var navFocusSelectedDay=function(){var day=1;var selectedDay=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-selected",node);
if(selectedDay!==undefined&&selectedDay!==null)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",selectedDay))day=D2L.LP.Web.UI.Html.Dom.GetAttribute(selectedDay,"data-date");navFocusDay(day)};var navRestoreColumnFocus=function(col,startFromBottom){var row=startFromBottom?navMatrix.length-1:0;var day=navMatrix[row][col];while(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",day)){row=startFromBottom?row-1:row+1;day=navMatrix[row][col];if(row<0||row>navMatrix.length)return}navLocation.col=
col;navLocation.row=row;day.focus()};var navFocusDay=function(day){if(day===undefined||day===null)day=1;var days=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-calendar-mini-day",node);var firstDayOffset=0;for(var i=0;i<days.length;i++)if(D2L.LP.Web.UI.Html.Dom.GetAttribute(days[i],"data-date")==="1"){firstDayOffset=i;break}day=day-0;firstDayOffset=firstDayOffset-0;var row=Math.floor(day/navLocation.daysPerWeek);if(day%navLocation.daysPerWeek==0)row=row-1;var col=day%navLocation.daysPerWeek;if(col==
0)col=navLocation.daysPerWeek;col=col+firstDayOffset;if(col>navLocation.daysPerWeek){row=row+1;col=col%navLocation.daysPerWeek}if(row!=null&&row!=undefined&&col!=null&&col!=undefined)navFocusNode(row,col-1)};var navFocusNode=function(optRow,optCol){if(optRow!=null&&optRow!=undefined&&optCol!=null&&optCol!=undefined){navLocation.row=optRow;navLocation.col=optCol}if(navMatrixBoundaryCheck())if(navMatrix[navLocation.row][navLocation.col]!==null)navMatrix[navLocation.row][navLocation.col].focus()};var changeMonth=
function(changeMonthEvent){changeMonthEvent.click(changeMonthEvent)};var preserveColumn=function(col,startFromBottom){if(col!==undefined&&col!==null&&node.parentNode&&node.parentNode.parentNode){var placeHolder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-placeholder",node);D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,"data-restoreColumn",col);D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,"data-startFromBottom",startFromBottom)}};var preserveDate=function(col,row){if(col===undefined||
col===null||row===undefined||row===null)return;var placeHolder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-placeholder",node);if(placeHolder===undefined||placeHolder===null)return;var day=navMatrix[row][col];if(day!==null&&D2L.LP.Web.UI.Html.Dom.HasAttribute(day,"data-date")){var dayStr=D2L.LP.Web.UI.Html.Dom.GetAttribute(day,"data-date");D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,"data-restoreDate",dayStr)}};var navArrowHandler=function(col,row){navLocation.col+=col*(isRTL?-1:1);
navLocation.row+=row;var rowMax=navMatrix.length-1;if(navLocation.row<0){preserveColumn(navLocation.col,true);changeMonth(prevMonthArrow);return}else if(navLocation.row>rowMax){preserveColumn(navLocation.col,false);changeMonth(nextMonthArrow);return}else if(navLocation.col<0&&navLocation.row==0){preserveColumn(6,true);changeMonth(prevMonthArrow);return}else if(navLocation.col>=navLocation.daysPerWeek&&navLocation.row==rowMax){preserveColumn(0,false);changeMonth(nextMonthArrow);return}else if(navLocation.col<
0){navLocation.row=navLocation.row-1;navLocation.col=navLocation.daysPerWeek-1}else if(navLocation.col>navLocation.daysPerWeek-1){navLocation.row=navLocation.row+1;navLocation.col=0}else{var day=navMatrix[navLocation.row][navLocation.col];if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",day)){preserveDate(navLocation.col,navLocation.row);navLocation.row==0?changeMonth(prevMonthArrow):changeMonth(nextMonthArrow);return}}navFocusNode()};var navOnKeyPress=function(kpArgs){var result=
false;var e=kpArgs.GetEventObject();if(!D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed)if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){navArrowHandler(0,-1);result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){navArrowHandler(0,1);result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){navArrowHandler(-1,0);result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){navArrowHandler(1,
0);result=true}else{if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape||kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){navLocation.col=0;navLocation.row=0;navFocusNode(0,0)}if(node.editNode!=null&&node.editNode.closeMiniCalendar)node.editNode.closeMiniCalendar()}}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){changeMonth(prevMonthArrow);result=true}else if(kpArgs.GetKey()==
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){changeMonth(nextMonthArrow);result=true}return result};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){var result=navOnKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});initNavMatrix();node.navLocation=navLocation;node.navFocusNode=navFocusNode;node.navFocusDay=navFocusDay;node.navRestoreColumnFocus=navRestoreColumnFocus;node.navFocusSelectedDay=navFocusSelectedDay});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-contextmenu",function(node){var contextMenuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item",node);for(var i=0;i<contextMenuItems.length;i++)D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem.Initialize(contextMenuItems[i],new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id));var floatingContainerNode=node.parentNode;D2L.LP.Web.UI.Desktop.Controls.ContextMenu.InstallKeyboardSupport(node);D2L.LP.Web.UI.Html.Aria.SetRole(floatingContainerNode,
"menu");D2L.LP.Web.UI.Html.Aria.SetRole(node,"presentation");floatingContainerNode.tabIndex="-1";var contextMenuSeparators=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-separator",node);for(var i=0;i<contextMenuSeparators.length;i++)D2L.LP.Web.UI.Html.Aria.SetRole(contextMenuSeparators[i],"separator")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-contextmenu-ph",function(node){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"haspopup","true");var contextMenuId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create($(node).attr("data-contextMenuId"));if(contextMenuId!==null)D2L.LP.Web.UI.Desktop.Controls.ContextMenu.InitPlaceholder(node,contextMenuId,"d2l-contextmenu-ph-hover")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-contextmenu");
D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-contextmenu-ph");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListId=node.parentNode.getAttribute("id");if(dataListId!=null){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListId);var totalItemCount;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(dataListId,2))totalItemCount=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,2);var pageNumber;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(dataListId,3))pageNumber=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,
3);var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item",node);me.SetIsNewItems(itemNodes);setTimeout(function(){var hasMoreItems=me.GetHasMoreItems(id);if(!hasMoreItems&&totalItemCount!==undefined&&itemNodes.length<totalItemCount)hasMoreItems=true;me.GetOnLoadCompletedEvent(id).Trigger(hasMoreItems,itemNodes,totalItemCount,pageNumber)})}D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-checkboxitem",function(node){D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.InitializeCheckboxItem(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-radioitem",function(node){D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems.InitializeRadioItem(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-placeholder",function(node){var dataListNode=node.parentNode;D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(function(id){if(id.GetValue()==node.id)D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(dataListNode)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-item-actionable",function(node){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-content",node);var actionNode;var actionControlId=node.getAttribute("data-d2l-actionId");if(actionControlId!=null){actionNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionControlId);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-actioncontrol",actionNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("vui-outline",
actionNode)}var addFocusClassName=function(node,className){if(className.length>0)node.className+=" "+className};var removeFocusClassName=function(node,className){if(className.length>0)node.className=node.className.replace(" "+className,"")};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",actionNode,function(){addFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",actionNode,function(){removeFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",
contentNode,function(){addFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",contentNode,function(){removeFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",contentNode,function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);while(eventTarget!==contentNode&&eventTarget!==null){var onClickRule=dataList.CaptureOnClickRules[eventTarget.nodeName.toUpperCase()];if(onClickRule!==undefined&&
onClickRule===true)return;eventTarget=eventTarget.parentNode}var href=actionNode.getAttribute("href");actionNode.removeAttribute("href");D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",actionNode);actionNode.href=href;if(href!==null&&href!=="javascript:void(0);")D2L.LP.Web.UI.Html.Dom.Navigate(new D2L.LP.Web.Http.UrlLocation(href))})});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-datalist-item-actionable");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datetime-selector",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datetime-selector-date-input",node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);var nodes=me.GetNodes(id);var phid=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-placeholder",nodes.floatingContainer).id;nodes.container.d2l_onChange=new D2L.LP.Web.UI.Events.Event;nodes.container.d2l_onChange.AddListener(function(){var onChangeFunction=
D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,"OnDateTimeChangeFunction");if(onChangeFunction)onChangeFunction.call(onChangeFunction)});D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,nodes.container.d2l_onChange,function(){return edit.value});edit.d2l_lastGoodDate=me.GetSelectedDateTimeNodes(nodes);var locale=D2L.LP.Globalization.Locale;var dateTimeParser=locale.GetDateTimeParser();var closing=false;var onMiniCalendarChange=function(){nodes=me.GetNodes(id,phid);if(nodes.floatingContainer!=
null&&nodes.floatingContainer!=undefined)nodes.floatingContainer.tabIndex=-1;if(nodes.miniCalendar!=null&&nodes.miniCalendar!=undefined)nodes.miniCalendar.editNode=nodes.edit};var isMiniCalendarOpen=function(){return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(nodes.floatingContainer)};var openMiniCalendarFunc=D2L.LP.Web.UI.ObjectRepository.Get(nodes.edit.id,"OpenMiniCalendar");var openMiniCalendar=function(){if(closing||nodes.floatingContainer==null||isMiniCalendarOpen())return;openMiniCalendarFunc.call(openMiniCalendarFunc);
onMiniCalendarChange()};var closeMiniCalendar=function(){closing=true;if(nodes.floatingContainer!=null&&isMiniCalendarOpen())D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(nodes.floatingContainer);setTimeout(function(){closing=false},200)};var onChange=function(){var dateTime=edit.d2l_lastGoodDate;try{var parsedDate=dateTimeParser.TryParseInputDate(edit.value);var time=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes.timeNodes);if(parsedDate!==null){dateTime=parsedDate;dateTime.m_hour=
time.m_hour;dateTime.m_minute=time.m_minute}}catch(e){}me.SetSelectedDateTimeByNode(nodes,dateTime)};var navOnKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){openMiniCalendar();if(nodes.miniCalendar!=null&&nodes.miniCalendar.navFocusDay)nodes.miniCalendar.navFocusSelectedDay();result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab||kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)closeMiniCalendar();
return result};var onFocus=function(e){openMiniCalendar()};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(nodes.edit,function(kpArgs){var result=navOnKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",nodes.edit,onFocus);D2L.LP.Web.UI.Html.Dom.AddEventListener("change",nodes.edit,onChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",nodes.edit,openMiniCalendar);nodes.edit.closeMiniCalendar=
closeMiniCalendar;nodes.edit.onMiniCalendarChange=onMiniCalendarChange});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-datetime-selector");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable",function(node){if(!D2L.LP.Web.UI.ObjectRepository.HasKey(node.id))return;var anchor=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);D2L.LP.Web.UI.Html.Dom.SetAttribute(anchor,"href","javascript:void(0);");var autoResize=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-editable-autosize",node);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(e){var target=e.srcElement||e.target;if(target.nodeName=="A"){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);
return false}D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",anchor)});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",anchor,function(){D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ClickHelper(node,autoResize)});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchor,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-editable-focus",node)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",anchor,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-editable-focus",node)});D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ModifyAnchors(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable-target-edit",function(node){var isRequired=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-editable-target-edit-required",node);var input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-edit",node);var finish2=function(hasChanged,isEmpty){input.d2l_value=null;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(node,hasChanged,isEmpty)};var finish=function(bypassType){if(input.d2l_value===null)return;var value=input.value.trim();var isEmpty=
value.length===0;var bypassValidation=true;if(bypassType===1)input.value=input.d2l_value;else if(bypassType===2&&isEmpty&&isRequired)input.value=input.d2l_value;else{input.value=value;bypassValidation=false}value=input.value;isEmpty=value.length===0;var hasChanged=input.d2l_value.trim()!==value;if(!bypassValidation&&isRequired){if(!isEmpty)finish2(hasChanged,isEmpty)}else finish2(hasChanged,isEmpty)};var handleKeyPress=function(kpArgs){var key=kpArgs.GetKey();if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)finish(0);
else if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)finish(1)};D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",input,function(){finish(2)});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(input,handleKeyPress)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable-target-longedit",function(node){var input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-longedit",node);var finish=function(bypassType){if(input.d2l_value===null)return;var value=input.value.trim();if(bypassType==1)value=input.d2l_value;var hasChanged=input.d2l_value!==value;var isEmpty=value.length===0;input.value=value;input.d2l_value=null;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(node,hasChanged,isEmpty)};var handleKeyPress=
function(kpArgs){var key=kpArgs.GetKey();if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)finish(1)};D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",input,finish);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(input,handleKeyPress)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-editable");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable-target-htmleditor",function(node){node.d2l_editorLoadedEvt=new D2L.LP.Web.UI.Events.Event});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-floating-container-movable",function(node){var titleHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-floating-container-titlebar",node);var closeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-floating-container-close",titleHandle);var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;dragSettings.SetHandle(titleHandle);dragSettings.SetIsDelayed(false);dragSettings.SetDragDropEffect(D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move);
if(closeNode)dragSettings.AddHandleException(closeNode);dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow);dragSettings.SetIsAutoScroll(false);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,dragSettings)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-floating-container-autoclose",function(elem){D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(elem,function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(elem,true)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-toolbar",function(node){var toolbarLabel=node.getAttribute("data-d2l-toolbar-label");if(toolbarLabel!=null)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",toolbarLabel);D2L.LP.Web.UI.Html.Aria.SetRole(node,"toolbar")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-wysiwyg",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var id=node.getAttribute("id");var textAreaId=me.GetTextAreaId(node);var isInline=htmlEditor.IsInlineByNode(node);var pluginInitializers=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"pluginInitializers");var pluginLayoutInitializers=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"pluginLayoutInitializers");
var contentCss=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"contentCssLocation");node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var delimitedPlugins="autolink";if(!isInline)delimitedPlugins+=", fullpage";if(pluginInitializers!=null)for(var i=0;i<pluginInitializers.length;i++){var pluginInitializer=pluginInitializers[i];var pluginName=pluginInitializer.call(pluginInitializer);if(pluginName!=null&&pluginName.length>0)if(delimitedPlugins.length>0)delimitedPlugins+=","+pluginName;
else delimitedPlugins+=pluginName}var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;tinyMCE.init({mode:"none",apply_source_formatting:true,auto_reset_designmode:true,content_css:contentCss,convert_fonts_to_spans:true,convert_urls:false,language:"",paste_strip_class_attributes:"mso",plugins:delimitedPlugins,relative_urls:false,setupcontent_callback:"D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.InitializeCallback",
theme:"advanced",theme_advanced_layout_manager:"customlayout",theme_advanced_custom_layout:"D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.InitializeLayout",theme_advanced_path:false,d2l_context:{Id:id,Node:node,TextAreaId:textAreaId,PluginLayoutInitializers:pluginLayoutInitializers},directionality:isRTL?"rtl":"ltr",paste_retain_style_properties:"all",valid_elements:"*[*]",extended_valid_elements:"@[accesskey|class|contenteditable|contextmenu|dir|draggable|dropzone|hidden|id|inert|itemid|itemprop|itemref|itemscope|itemtype|lang|spellcheck|style|tabindex|title|translate],"+
"address,"+"article,"+"aside,"+"audio[src|crossorigin|preload|autoplay|mediagroup|loop|muted|controls],"+"bdi,"+"canvas[width|height],"+"datalist,"+"details[open],"+"figcaption,"+"figure,"+"footer,"+"header,"+"hgroup,"+"main,"+"mark,"+"menu[type|label],"+"menuitem[checked|command|default|disabled|icon|label|radiogroup|type],"+"meter[value|min|max|low|high|optimal],"+"nav,"+"output[for|form|name],"+"progress[value|max],"+"section,"+"source[src|type|media],"+"summary,"+"span[*],"+"time[datetime],"+
"track[kind|src|srclang|label|default],"+"video[src|crossorigin|poster|preload|autoplay|mediagroup|loop|muted|controls|width|height],"+"wbr,"});if(!isInline){var fullPageFontSize=node.getAttribute("data-d2l-editor-fullpage-fontsize");if(fullPageFontSize!=null&&fullPageFontSize.length>0)tinyMCE.settings["fullpage_default_font_size"]=fullPageFontSize;var fullPageFontFace=node.getAttribute("data-d2l-editor-fullpage-fontface");if(fullPageFontFace!=null&&fullPageFontFace.length>0)tinyMCE.settings["fullpage_default_font_family"]=
fullPageFontFace}if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_files=[];node.d2l_files_queued=0;node.d2l_onContentFocus=new D2L.LP.Web.UI.Events.Event;node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event;var editor=me.GetEditorInstanceByNode(node);if(editor!==undefined)tinyMCE.remove(editor);tinyMCE.execCommand("mceAddEditor",false,textAreaId)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.Initialize();D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SelectList.Initialize();
node.d2l_onBeforeSubmitHandle=function(form){htmlEditor.UpdateFilesNodeByNode(node);me.UpdateTextArea(textAreaId)};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.AddListener(node.d2l_onBeforeSubmitHandle);var skipToolbarsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-skiptoolbars",node);var onClickSkipToolbars=skipToolbarsNode.getAttribute("data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",skipToolbarsNode,function(){setTimeout(function(){skipToolbarsNode.d2l_onClickHandle=
function(){eval(onClickSkipToolbars)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",skipToolbarsNode,skipToolbarsNode.d2l_onClickHandle)},0)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",skipToolbarsNode,function(){D2L.LP.Web.UI.Html.Dom.RemoveEventListener("click",skipToolbarsNode,skipToolbarsNode.d2l_onClickHandle)});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,function(e){node.d2l_hasFocus=true;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-frosted",node)},true);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",
node,function(e){node.d2l_hasFocus=false;setTimeout(function(){if(!node.d2l_hasFocus)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-frosted",node)},0)},true);var focus=function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.FocusByNode(node)};node.focus=focus;D2L.LP.Web.UI.Events.VisibilityManager.AddListener(node,function(isDisplayed){if(isDisplayed)htmlEditor.UpdateComponentVisibilityByNode(node)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-texteditor",function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_isDirty=false;node.d2l_files=[];node.d2l_files_queued=0;node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event}var controlWidth=node.getAttribute("data-d2l-width");var controlHeight=node.getAttribute("data-d2l-height");var footerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-footer",
node);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);var setSize=function(height,width){node.style.width=width;node.style.height=height;var controlRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footerNode);textAreaNode.style.height=controlRect.height-footerRect.height-10+"px"};setSize(controlHeight,controlWidth);var resizeHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-resize",
node);var resizeSettings={Handle:resizeHandle,DisplayType:"hidden",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var onResize=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(node,resizeSettings,window,window);onResize.AddListener(function(size){setSize(size.height+"px",size.width+"px")});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",textAreaNode,function(){node.d2l_isDirty=true;node.d2l_changeEvent.Trigger()})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-noeditor",function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.NoEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_files=[];node.d2l_files_queued=0}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-button",function(node){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.InitializeByNode(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-buttonmenuitem",function(node){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.InitializeByNode(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-color-button",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"title");if(title!=null&&title.length>0)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",title);D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-split-button",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"title");if(title!=null&&title.length>0)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",title);D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,
"data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){eval(onClick)});var iconNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-split-button-icon",node);var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-buttonmenuitem",menuContainer);var activeKey=null;var itemsData={};var registerMenuItemEvents=function(menuItemNode){var menuItemKey=menuItemNode.getAttribute("data-d2l-key");
menuItemNode.d2l_activeHandler=function(isActive){if(menuItemKey===node.getAttribute("data-d2l-key"))me.SetIsActiveByNode(node,isActive)};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnActiveChangeByNode(menuItemNode).AddListener(menuItemNode.d2l_activeHandler);menuItem.d2l_enabledHandler=function(isEnabled){if(menuItemKey===node.getAttribute("data-d2l-key"))me.SetIsEnabledByNode(node,isEnabled)};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnEnabledChangeByNode(menuItemNode).AddListener(menuItem.d2l_enabledHandler)};
for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];var key=menuItem.getAttribute("data-d2l-key");var txtNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-buttonmenuitem-text",menuItem);var imgNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-buttonmenuitem-icon",menuItem);if(key!==undefined&&key!=null){itemsData[key]={className:imgNode.className.replace("d2l-htmleditor-buttonmenuitem-icon",""),key:key,src:imgNode.src,title:D2L.LP.Web.UI.Html.Dom.GetTextContent(txtNode)};
if(activeKey===null)activeKey=key}registerMenuItemEvents(menuItem)}node.d2l_itemsData=itemsData;if(activeKey===null)return;D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(node,activeKey)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-symbol",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-symbol-list",node);var charNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-symbol-char",listNode);var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute("data-d2l-editId"));var installOnClick=function(charNode){D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(charNode);
D2L.LP.Web.UI.Html.Dom.AddEventListener("click",charNode,function(){var numCode=charNode.getAttribute("data-d2l-numcode");D2L.LP.Web.UI.Common.Controls.Edit.SetValue(editId,numCode);me.SetSelectedSymbolByNode(node,numCode)})};for(var i=0;i<charNodes.length;i++){var charNode=charNodes[i];installOnClick(charNode)}D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",charNodes[0])});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-newwindow",function(node){var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"href");if(!hasHref)return;node.target="_blank"});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-menuflyout",function(node){var opener=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-opener",node);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-text",node);var openFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFunction");var openFirstFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFirstFunction");var closeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"MenuFlyout.CloseFunction");var contentsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-contents",node);if(contentsNode!=null)D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Init(node,opener,contentsNode,textNode,openFunction,openFirstFunction,closeFunction)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-menuflyout-link",function(node){var opener=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-opener",node);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-textblock",opener);var openFirstFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFirstFunction");var link=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-link-link",node);var contentsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-contents",
node);var focus=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-link-focus",node)};var blur=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-link-focus",node)};if(contentsNode!=null){D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",link,focus);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",opener,focus);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",link,blur);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",opener,blur);D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Init(node,
opener,contentsNode,textNode,null,openFirstFunction)}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-menuflyout-link");D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-menuflyout");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-searchsimple",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"search");var buttons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node);for(var i=0;i<buttons.length;i++)D2L.LP.Web.UI.Html.Aria.SetRole(buttons[i],"button")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-searchsimple-input",function(node){var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.id);var numKeyPresses=1;if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-keypresses"))numKeyPresses=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-keypresses"));var onKeyPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)D2L.LP.Web.UI.Desktop.Controls.SearchSimple.Search(id);if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,
"key")){var val=D2L.LP.Web.UI.Desktop.Controls.SearchSimple.GetInputValue(id);if(val.length>=numKeyPresses){var onKeyPressFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"key");setTimeout(function(){onKeyPressFunction.call(onKeyPressFunction)},0)}}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,onKeyPress)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-searchsimple-input");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-time-selector",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var timeSelectorData=$(node).data();var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);id.$().data(timeSelectorData);var data=id.$().data();var nodes=me.GetNodesByNode(edit);var useEditValue=true;nodes.container.d2l_onChange=new D2L.LP.Web.UI.Events.Event;nodes.container.d2l_onChange.AddListener(function(){var onChangeFunction=
D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,"OnDateTimeChangeFunction");if(onChangeFunction)onChangeFunction.call(onChangeFunction)});D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,nodes.container.d2l_onChange,function(){return edit.value});var locale=D2L.LP.Globalization.Locale;var dateTimeParser=locale.GetDateTimeParser();var closing=false;var selectedIndex=0;var lastGoodTime=me.GetTimeNodes(nodes);var refreshSelectedIndex=function(){var interval=data.timeinterval;
if(interval===null||interval===undefined||interval<5||interval>60){data.timeinterval=30;interval=30}var time=dateTimeParser.TryParseTime(nodes.edit.value);if(time===null||time===undefined)time=lastGoodTime;var hour=time.GetHour();var minute=time.GetMinute();if(data.enforcetimeintervals){var remainder=minute%interval;if(minute>0&&minute<interval)minute=interval;else if(remainder>0)minute+=interval-remainder;while(minute>=60){minute-=60;++hour}hour=Math.min(23,hour);time=new D2L.LocalTime(hour,minute,
0)}lastGoodTime=time;me.SetTimeNodes(nodes,time);var index=hour*60/interval;index+=minute/interval;selectedIndex=Math.floor(index)};var selectSelectedItem=function(){var item=nodes.list.childNodes[selectedIndex];me.SetTimeNodes(nodes,item.d2l_time,false)};var updateSelectedItem=function(applyOffset){var selectedItem=null;for(var i=0;i<nodes.list.childNodes.length;i++){var item=nodes.list.childNodes[i];if(i===selectedIndex){item.className="d2l-time-selector-listitem-selected";selectedItem=item;D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,
"aria-activedescendant",item.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-activedescendant",item.id)}else item.className=""}if(selectedItem===null){D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-activedescendant","");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-activedescendant","");return}var divBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(nodes.floatingContainer);var itemBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(selectedItem);var offset=applyOffset?
(divBox.height-itemBox.height)/2:0;if(itemBox.bottom>divBox.bottom)nodes.floatingContainer.scrollTop+=itemBox.bottom-divBox.bottom+offset;else if(itemBox.top<divBox.top)nodes.floatingContainer.scrollTop-=divBox.top-itemBox.top-offset};var close=function(doDelay,ignoreFocus){closing=true;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(nodes.floatingContainer,ignoreFocus);setTimeout(function(){closing=false},0);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-expanded",
"false");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-hidden","true")},doDelay?200:0)};var open=function(){if(isOpen()||closing)return;me.BuildSelectList(nodes,data.timeinterval);refreshSelectedIndex();D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(nodes.floatingContainer,id,{AttachToBody:true,AutoCloseExclusions:[edit],FocusOnOpen:false,Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TabIndex:-1});updateSelectedItem(true);nodes.edit.focus();D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,
"aria-expanded","true");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-hidden","false")};var isOpen=function(){return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(nodes.floatingContainer)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",nodes.edit,open);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",nodes.edit,function(){refreshSelectedIndex();D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,
"aria-hidden","true")});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",nodes.edit,open);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",nodes.floatingContainer,function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget&&eventTarget.tagName.toLowerCase()=="li"){selectedIndex=eventTarget.d2l_index;selectSelectedItem();close(false,false)}});var keys=D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key;D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(nodes.edit,function(kpArgs){var key=
kpArgs.GetKey();if(key==keys.ArrowUp||key==keys.ArrowDown){if(!isOpen())open();else{var maxIndex=60/data.timeinterval*24-1;if(key==keys.ArrowUp){--selectedIndex;if(selectedIndex==-1)selectedIndex=maxIndex}else{++selectedIndex;if(selectedIndex==maxIndex+1)selectedIndex=0}updateSelectedItem(false)}useEditValue=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject())}else if(key==keys.Enter){useEditValue?refreshSelectedIndex():selectSelectedItem();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());
close(false,false)}else if(key==keys.Escape||key==keys.Tab){close(false,true);nodes.edit.focus()}else if(key!=keys.Shift&&key!=keys.Control&&key!=keys.PageUp&&key!=keys.PageDown&&key!=keys.End&&key!=keys.Home&&key!=keys.ArrowLeft&&key!=keys.ArrowRight){close(false,false);useEditValue=true}});D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-haspopup","true");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-owns",nodes.floatingContainer.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"role",
"combobox");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-autocomplete","list");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"tabindex","0");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-hidden","true")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-time-selector");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-updownvote-input",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput;var handle=me.InitHandle(node);for(var i=0;i<handle.labels.length;i++){var label=handle.labels[i];var input=label.getElementsByTagName("input")[0];D2L.LP.Web.UI.Html.Dom.AddEventListener("click",label,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);me.SetSelected(handle,index,true)}}(i));
D2L.LP.Web.UI.Html.Dom.AddEventListener("click",input,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);me.SetSelected(handle,index,false)}}(i))}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-updownvote-input");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-tool-areas",function(node){var isRtl=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var selected=null;var bar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-tool-areas-bar",node);var applyBar=function(link,first){var item=link.parentNode;var prev=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(item);var pos=$(item).position();var width=$(item).width()-(prev!==
null?30:15);var left=pos.left+(prev!==null||isRtl?15:0);var properties={"width":width+"px","left":left};if(!first)$(bar).animate(properties,100);else $(bar).css(properties).show()};var over=false;var newSelection=false;var onOver=function(){if(newSelection)return;over=true;applyBar(this,false)};var onOut=function(){if(newSelection)return;over=false;setTimeout(function(){if(!over)applyBar(selected,false)},300)};$(node).find(".d2l-tool-areas-link").each(function(index,item){if($(item).parent().hasClass("d2l-tool-areas-item-selected")){selected=
item;applyBar(selected,true)}$(item).hover(onOver,onOut).focus(onOver).blur(onOut).click(function(){newSelection=true})})});D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-htmleditor-wysiwyg",function(node){if(node.d2l_onBeforeSubmitHandle!==undefined)D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.RemoveListener(node.d2l_onBeforeSubmitHandle)});D2L.LP.Web.UI.Html.DragDrop={};
D2L.LP.Web.UI.Html.DragDrop={Install:function(id,ddType,draggableSettings,droppableSettings){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,draggableSettings,droppableSettings)},InstallNode:function(node,ddType,draggableSettings,droppableSettings){if(ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.Draggable||ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.DraggableDroppable)D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,draggableSettings);
if(ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.Droppable||ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.DraggableDroppable)D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings)},CreateGhost:function(ghostType,node,initialPos,win){var ghost;if(ghostType==D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow){ghost=win.document.createElement("div");ghost.className="d2l-dragdrop-shadow"}else if(ghostType==D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow){var clearFloat=win.document.createElement("div");
clearFloat.className="d2l-clear";var ghostWrapper=win.document.createElement("div");var clonedNode=node.cloneNode(true);clonedNode.style.margin=0;ghostWrapper.appendChild(clonedNode);ghostWrapper.appendChild(clearFloat);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-dragdrop-clone-shadow",ghostWrapper);ghost=ghostWrapper}ghost.style.left=initialPos.left+"px";ghost.style.top=initialPos.top+"px";ghost.style.width=initialPos.width+1+"px";ghost.style.height=initialPos.height+1+"px";ghost.style.zIndex=win.D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex();
win.document.body.appendChild(ghost);return ghost},RemoveDrag:function(dragObject){D2L.LP.Web.UI.Html.Dom.RemoveElement(dragObject.GetDragNode())}};D2L.LP.Web.UI.Html.DragDrop.DragDropEffect={None:0,Move:1};D2L.LP.Web.UI.Html.DragDrop.DragObject=D2L.Class.Create({Construct:function(dragNode,draggableSettings){this.m_dragNode=dragNode;this.m_draggableSettings=draggableSettings},GetDragNode:function(){return this.m_dragNode},GetDraggableSettings:function(){return this.m_draggableSettings}});
D2L.LP.Web.UI.Html.DragDrop.DropEffect={None:0,Move:1,Swap:2};
D2L.LP.Web.UI.Html.DragDrop.DragDropManager={RefreshDroppables:function(){var nodes=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes;for(var i=0;i<nodes.length;i++)D2L.LP.Web.UI.Html.DragDrop.DragDropManager.RefreshDroppable(nodes[i])},RefreshDroppable:function(node){node.m_rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node)},AddDroppable:function(node){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes.push(node)},SetDrag:function(dragObject){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetIsDragging(true);
D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag=dragObject},GetDrag:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag},GetDragParam:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag.GetDraggableSettings().GetParam()},GetDragKey:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag.GetDraggableSettings().GetKey()},IsDragging:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging},SetIsDragging:function(isDragging){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging=
isDragging}};D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag=null;D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging=false;D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes=[];D2L.LP.Web.UI.Html.DragDrop.DragDropType={Draggable:0,Droppable:1,DraggableDroppable:2};
D2L.LP.Web.UI.Html.DragDrop.DraggableSettings=D2L.Class.Create({Construct:function(){this.m_key=null;this.m_handleNode=null;this.m_handleExceptions=[];this.m_ghostType=D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow;this.m_param=null;this.m_isDelayed=true;this.m_isAutoScroll=true;this.m_dragDropEffect=D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.None;this.m_dragStartEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragEndEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragGroup=null},_deserialize:function(deserializer){this.m_key=
deserializer.GetMember("Key");this.m_param=deserializer.GetMember("Param");this.m_dragGroup=deserializer.GetMember("DragGroup");var dragStartFunction=deserializer.GetMember("OnDragStartFunction");if(dragStartFunction!=null)this.GetDragStartEvent().AddListener(dragStartFunction)},AddHandleException:function(node){this.m_handleExceptions.push(node)},GetIsAutoScroll:function(){return this.m_isAutoScroll},GetDragDropEffect:function(){return this.m_dragDropEffect},GetDragGroup:function(){return this.m_dragGroup},
GetDragStartEvent:function(){return this.m_dragStartEvent},GetDragEndEvent:function(){return this.m_dragEndEvent},GetGhostType:function(){return this.m_ghostType},GetHandle:function(){return this.m_handleNode},GetHandleExceptions:function(){return this.m_handleExceptions},GetKey:function(){return this.m_key},GetParam:function(){return this.m_param},IsDelayed:function(){return this.m_isDelayed},SetIsDelayed:function(isDelayed){this.m_isDelayed=isDelayed},SetHandle:function(node){this.m_handleNode=
node},SetDragGroup:function(groupName){this.m_dragGroup=groupName},SetGhostType:function(ghostType){this.m_ghostType=ghostType},SetIsAutoScroll:function(autoScroll){this.m_isAutoScroll=autoScroll},SetDragDropEffect:function(dragDropEffect){this.m_dragDropEffect=dragDropEffect},SetKey:function(key){this.m_key=key},SetParam:function(param){this.m_param=param}});
D2L.LP.Web.UI.Html.DragDrop.DroppableSettings=D2L.Class.Create({Construct:function(){this.m_dropEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragInEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragOutEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragOverEvent=new D2L.LP.Web.UI.Events.Event;this.m_dropEffect=D2L.LP.Web.UI.Html.DragDrop.DropEffect.None;this.m_eventPropagation=true;this.m_padding={top:0,left:0,right:0,bottom:0};this.m_acceptableDragGroups=[]},_deserialize:function(deserializer){var dropFunction=
deserializer.GetMember("OnDropFunction");if(dropFunction!=null)this.GetDropEvent().AddListener(dropFunction);var dragInFunction=deserializer.GetMember("OnDragInFunction");if(dragInFunction!=null)this.GetDragInEvent().AddListener(dragInFunction);var dragOutFunction=deserializer.GetMember("OnDragOutFunction");if(dragOutFunction!=null)this.GetDragOutEvent().AddListener(dragOutFunction);this.m_dropEffect=deserializer.GetMember("DropEffect");this.m_eventPropagation=deserializer.GetMember("EventPropagation")},
AddAcceptableDragGroup:function(groupName){this.m_acceptableDragGroups.push(groupName)},GetAcceptableDragGroups:function(){return this.m_acceptableDragGroups},GetDropEvent:function(){return this.m_dropEvent},GetDragInEvent:function(){return this.m_dragInEvent},GetDragOutEvent:function(){return this.m_dragOutEvent},GetDragOverEvent:function(){return this.m_dragOverEvent},GetPadding:function(){return this.m_padding},GetDropEffect:function(){return this.m_dropEffect},GetEventPropagation:function(){return this.m_eventPropagation},
SetAcceptableDragGroups:function(acceptableDragGroups){this.m_acceptableDragGroups=acceptableDragGroups},SetDropEffect:function(dropEffect){this.m_dropEffect=dropEffect},SetPadding:function(padding){this.m_padding=padding},SetEventPropagation:function(propagate){this.m_eventPropagation=propagate}});D2L.LP.Web.UI.Html.DragDrop.GhostType={OriginalShadow:1,CloneShadow:2};
D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode=function(node,draggableSettings,nodeWin,outerWin){if(draggableSettings===undefined)draggableSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;nodeWin=nodeWin||window;outerWin=outerWin||window;var handle=draggableSettings.GetHandle()||node;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-dragdrop-draggable",handle);var initialCursorPos=null;var initialPos=null;var newPos=null;var shadow=null;var scrollTopTimeout;var scrollTopInstalled;var scrollBottomTimeout;
var scrollBottomInstalled;var scrollLeftTimeout;var scrollLeftInstalled;var scrollRightTimeout;var scrollRightInstalled;var scrollSpeed=10;var scrollInterval=50;var scrollZone=40;var clearHorizontalAutoScroll=function(){scrollLeftInstalled=false;scrollRightInstalled=false;clearTimeout(scrollLeftTimeout);clearTimeout(scrollRightTimeout)};var clearVerticalAutoScroll=function(){scrollTopInstalled=false;scrollBottomInstalled=false;clearTimeout(scrollTopTimeout);clearTimeout(scrollBottomTimeout)};var clearAutoScroll=
function(){clearHorizontalAutoScroll();clearVerticalAutoScroll()};var MouseMove=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);if(initialCursorPos===null||initialPos===null||shadow===null)return;var newCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(outerWin,evt);newPos={x:initialPos.left+newCursorPos.x-initialCursorPos.x,y:initialPos.top+newCursorPos.y-initialCursorPos.y};var pageSize=D2L.LP.Web.UI.Html.Dom.GetPageSize(outerWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(outerWin);
var dialogBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(shadow);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(outerWin);if(newPos.x+dialogBox.width>pageSize.width)newPos.x=pageSize.width-dialogBox.width;if(newPos.y+dialogBox.height>viewport.height+scroll.top)newPos.y=viewport.height+scroll.top-dialogBox.height;if(newPos.x<0)newPos.x=0;if(newPos.y<scroll.top)newPos.y=scroll.top;shadow.style.left=newPos.x+"px";shadow.style.top=newPos.y+"px";if(draggableSettings.GetIsAutoScroll()){var viewPortSize=
D2L.LP.Web.UI.Html.Dom.GetViewportSize();var scrollPosition=D2L.LP.Web.UI.Html.Dom.GetScrollPosition();var topDelta=newCursorPos.y-scrollPosition.top;var bottomDelta=scrollPosition.top+viewPortSize.height-newCursorPos.y;if(topDelta<scrollZone){var scrollTop=function(){if(D2L.LP.Web.UI.Html.Dom.GetScrollPosition().top>0){scrollTopInstalled=true;scrollTopTimeout=setTimeout(function(){scrollBy(0,-scrollSpeed);shadow.style.top=shadow.offsetTop-scrollSpeed+"px";scrollTop()},scrollInterval)}};if(!scrollTopInstalled)scrollTop()}else if(bottomDelta<
scrollZone){var scrollBottom=function(){scrollBottomInstalled=true;scrollBottomTimeout=setTimeout(function(){scrollBy(0,scrollSpeed);shadow.style.top=shadow.offsetTop+scrollSpeed+"px";scrollBottom()},scrollInterval)};if(!scrollBottomInstalled)scrollBottom()}else clearVerticalAutoScroll();var leftDelta=newCursorPos.x-scrollPosition.left;var rightDelta=scrollPosition.left+viewPortSize.width-newCursorPos.x;if(leftDelta<scrollZone){var scrollLeft=function(){if(D2L.LP.Web.UI.Html.Dom.GetScrollPosition().left>
0){scrollLeftInstalled=true;scrollLeftTimeout=setTimeout(function(){scrollBy(-scrollSpeed,0);shadow.style.left=shadow.offsetLeft-scrollSpeed+"px";scrollLeft()},scrollInterval)}};if(!scrollLeftInstalled)scrollLeft()}else if(rightDelta<scrollZone){var scrollRight=function(){scrollRightInstalled=true;scrollRightTimeout=setTimeout(function(){scrollBy(scrollSpeed,0);shadow.style.left=shadow.offsetLeft+scrollSpeed+"px";scrollRight()},scrollInterval)};if(!scrollRightInstalled)scrollRight()}else clearHorizontalAutoScroll()}};
var Finish=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(Finish);shadow.parentNode.removeChild(shadow);if(draggableSettings.GetDragDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move){node.style.left=newPos.x+"px";node.style.top=newPos.y+"px";node.style.display="block"}D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetIsDragging(false);clearAutoScroll();
draggableSettings.GetDragEndEvent().Trigger(e)};var Start=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);var handleExceptions=draggableSettings.GetHandleExceptions();for(var i=0;i<handleExceptions.length;i++)if(handleExceptions[i]==target||$.contains(handleExceptions[i],target))return;var dragObject=new D2L.LP.Web.UI.Html.DragDrop.DragObject(node,draggableSettings);D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetDrag(dragObject);
D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);initialPos=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);newPos={x:initialPos.left,y:initialPos.top};initialCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(nodeWin,evt);initialCursorPos={x:initialCursorPos.x+(nodeWin!=outerWin?initialPos.left:0),y:initialCursorPos.y+(nodeWin!=outerWin?initialPos.top:0)};shadow=D2L.LP.Web.UI.Html.DragDrop.CreateGhost(draggableSettings.GetGhostType(),node,initialPos,outerWin);if(draggableSettings.GetGhostType()==
D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow)node.style.display="none";setTimeout(function(){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.RefreshDroppables()});outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(Finish);draggableSettings.GetDragStartEvent().Trigger(evt)};var BeforeStart=function(clickEvt){var cancelDrag=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(clickEvt);var onDownCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,
clickEvt);if(draggableSettings.IsDelayed()){var moveThreshold=3;var moved=false;var MoveTimer=function(e){var onMoveCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,e);if(Math.abs(onMoveCursorPos.y-onDownCursorPos.y)>moveThreshold||Math.abs(onMoveCursorPos.x-onDownCursorPos.x)>moveThreshold){outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(UpTimer);if(!cancelDrag)Start(clickEvt);moved=true}};var UpTimer=function(e){D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MoveTimer);
D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(UpTimer);cancelDrag=true;if(!moved)if(clickEvt.changedTouches!==undefined||clickEvt.targetTouches!==undefined)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(clickEvt));return false};outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(UpTimer)}else Start(clickEvt)};var BeforeStartTouch=function(touchEvt){var isDragEvent=true;var touchMoveTimer=function(){isDragEvent=
false};var touchUpTimer=function(){isDragEvent=false};setTimeout(function(){D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(touchMoveTimer);D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(touchUpTimer);if(isDragEvent)BeforeStart(touchEvt)},50);outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(touchMoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(touchUpTimer)};if(handle.m_dragInstalled)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("touchstart",handle,BeforeStartTouch);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",
handle,BeforeStart);handle.m_dragInstalled=true};
D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode=function(node,droppableSettings){if(droppableSettings===undefined)droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings;var isDragIn=false;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-dragdrop-droppable",node);var IsOverNode=function(targetDroppableNode,targetEvent,forgivenessPadding){var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,targetEvent);return cursorPos.x>=targetDroppableNode.m_rect.left-forgivenessPadding.left&&cursorPos.x<=
targetDroppableNode.m_rect.right+forgivenessPadding.right&&cursorPos.y>=targetDroppableNode.m_rect.top-forgivenessPadding.top&&cursorPos.y<=targetDroppableNode.m_rect.bottom+forgivenessPadding.bottom};var IsOver=function(evt){if(node.m_rect===undefined||!D2L.LP.Web.UI.Html.DragDrop.DragDropManager.IsDragging())return false;var forgivenessPadding=droppableSettings.GetPadding();var acceptableDragGroups=droppableSettings.GetAcceptableDragGroups();var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();
var dragGroup=dragObject.GetDraggableSettings().GetDragGroup();if(acceptableDragGroups.length>0){if(dragGroup==null)return false;var containsGroup=false;for(var i=0;i<acceptableDragGroups.length;i++)if(acceptableDragGroups[i]===dragGroup)containsGroup=true;if(!containsGroup)return false}var propagateEvent=droppableSettings.GetEventPropagation();if(!propagateEvent){var descendantDroppables=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dragdrop-droppable",node);for(var i=0;i<descendantDroppables.length;i++)if(IsOverNode(descendantDroppables[i],
evt,forgivenessPadding))return false}var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,evt);var isOverResult=IsOverNode(node,evt,forgivenessPadding);if(isOverResult){var mouseDelta={topDelta:cursorPos.y-node.m_rect.top,rightDelta:node.m_rect.right-cursorPos.x,bottomDelta:node.m_rect.bottom-cursorPos.y,leftDelta:cursorPos.x-node.m_rect.left,nodeHeight:node.m_rect.height};droppableSettings.GetDragOverEvent().Trigger(dragObject,mouseDelta)}return isOverResult};var MouseUp=function(evt){if(isDragIn){var dragObject=
D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();if(droppableSettings.GetDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DropEffect.Move)node.appendChild(dragObject.GetDragNode());else if(droppableSettings.GetDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DropEffect.Swap)D2L.LP.Web.UI.Html.Dom.SwapElements(node,dragObject.GetDragNode());droppableSettings.GetDropEvent().Trigger(dragObject)}};var MouseOut=function(evt){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();isDragIn=false;droppableSettings.GetDragOutEvent().Trigger(dragObject)};
var MouseIn=function(evt){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();isDragIn=true;droppableSettings.GetDragInEvent().Trigger(dragObject)};D2L.LP.Web.UI.Events.OnMouseUp.AddListener(MouseUp);if(node.m_dropInstalled)return;var mouseIn=false;var BeforeMouseMove=function(evt){if(IsOver(evt)){if(!mouseIn){mouseIn=true;MouseIn(evt)}}else if(mouseIn){mouseIn=false;MouseOut(evt)}};D2L.LP.Web.UI.Html.DragDrop.DragDropManager.AddDroppable(node);D2L.LP.Web.UI.Events.OnMouseMove.AddListener(BeforeMouseMove);
node.m_dropInstalled=true};
D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode=function(node,settings,nodeWin,outerWin){var ghost;var initialPos;var initialMousePos;var newWidth=200;var newHeight=200;var maxWidth=500;var maxHeight=500;var resizeEvent=new D2L.LP.Web.UI.Events.Event;var MouseMove=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);var newMousePos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(outerWin,evt);newWidth=Math.min(Math.max(initialPos.width+newMousePos.x-initialMousePos.x,200),maxWidth);newHeight=
Math.min(Math.max(initialPos.height+newMousePos.y-initialMousePos.y,200),maxHeight);ghost.style.width=newWidth+"px";ghost.style.height=newHeight+"px"};var Finish=function(){outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(Finish);ghost.parentNode.removeChild(ghost);if(settings.DisplayType=="none")node.style.display="";else{node.style.visibility="";settings.Handle.style.visibility=""}resizeEvent.Trigger({width:newWidth,height:newHeight});
node.style.display="block"};var Start=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);initialPos=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);newWidth=initialPos.width;newHeight=initialPos.height;initialMousePos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(nodeWin,evt);initialMousePos={x:initialMousePos.x+(outerWin!=nodeWin?initialPos.left:0),y:initialMousePos.y+(outerWin!=nodeWin?initialPos.top:0)};var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(outerWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(outerWin);
maxWidth=scroll.left+viewport.width-initialPos.left-20;maxHeight=scroll.top+viewport.height-initialPos.top-20;ghost=D2L.LP.Web.UI.Html.DragDrop.CreateGhost(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow,node,initialPos,outerWin);ghost.style.cursor="nw-resize";if(settings.DisplayType=="none")node.style.display="none";else{node.style.visibility="hidden";settings.Handle.style.visibility="hidden"}outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(Finish)};
if(settings.Handle.m_resizeInstalled)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",settings.Handle,Start);D2L.LP.Web.UI.Html.Dom.AddEventListener("touchstart",settings.Handle,Start);settings.Handle.m_resizeInstalled=true;return resizeEvent};D2L.LP.Web.UI.Files={};
D2L.LP.Web.UI.Files.File=D2L.Class.Create({Construct:function(id,fileSystemType,name,size){this.m_id=id;this.m_fileSystemType=fileSystemType;this.m_name=name;this.m_size=size},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember("FileSystemType",this.m_fileSystemType);serializer.AddMember("Id",this.m_id)},GetFileSystemType:function(){return this.m_fileSystemType},GetId:function(){return this.m_id},GetName:function(){return this.m_name},GetSize:function(){return this.m_size}});
D2L.LP.Web.UI.Html.Files={};
D2L.LP.Web.UI.Html.Files.FileUpload={Upload:function(uploadLocation,files,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload;var uploadStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var errorsNode;var progressNode;var progressFileNode;var progressFileNodes;if(params.IsStatusEnabled){if(progressNode===undefined||errorsNode===undefined){errorsNode=uploadStatus.GetErrorsContainerNode();progressNode=uploadStatus.GetProgressContainerNode()}uploadStatus.RemoveErrorMessages(errorsNode)}var isUploading=false;
var uploadHandle=null;var fileNumber=0;var raiseError=function(errorNumber){if(params.IsStatusEnabled)uploadStatus.AddErrorMessage(errorsNode,params.ErrorMessages[errorNumber-1]);params.OnError.call(params.OnError,errorNumber)};var removeAllProgressFiles=function(){if(params.IsStatusEnabled){for(var k=0;k<progressFileNodes.length;k++)uploadStatus.RemoveFile(progressFileNodes[k]);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}};var resetUpload=function(){isUploading=false;uploadHandle=
null};if(!params.IsMultipleAllowed&&files.length>1){raiseError(1);return}for(var i=0;i<files.length;i++){if(files[i].name.length>params.MaxFileNameLength){raiseError(6);return}if(!me.IsExtensionValid(files[i].name,params.Extensions,params.RestrictedExtensions)){raiseError(2);return}if(params.MaxFileSize>0&&files[i].size>params.MaxFileSize){raiseError(3);return}if(!me.IsFileNameValid(files[i].name)){raiseError(5);return}}var requestParams={BytesPerSlice:params.BytesPerSlice,OnFileStarted:function(fileName){if(params.IsStatusEnabled){progressFileNode=
progressFileNodes[fileNumber];fileNumber+=1}},OnProgress:function(progress){if(params.IsStatusEnabled)uploadStatus.UpdateFile(progressFileNode,progress.GetFileName(),progress.GetFilePercent());params.OnProgress.call(params.OnProgress,progress)},OnFileComplete:function(tempFile){if(params.IsStatusEnabled)uploadStatus.SetIsFileCompleted(progressFileNode,tempFile.FileName);var file=new D2L.LP.Web.UI.Files.File(tempFile.FileId,"Temp",tempFile.FileName,tempFile.Size);params.OnFileComplete.call(params.OnFileComplete,
file)},OnFilesComplete:function(){if(params.IsStatusEnabled)uploadStatus.SetIsProgressContainerVisible(progressNode,false);params.OnFilesComplete.call(params.OnFilesComplete);resetUpload()},OnAbort:function(){removeAllProgressFiles();params.OnAbort.call(params.OnAbort);resetUpload();params.OnProgress.call(params.OnProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress("",0,0,0,0))},OnError:function(){resetUpload();raiseError(4)},UploadLocation:uploadLocation};params.OnProgress.call(params.OnProgress,
new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress("",0,0,0,0));isUploading=true;params.OnFilesStarted.call(params.OnFilesStarted);if(params.IsStatusEnabled){progressFileNodes=[];for(var j=0;j<files.length;j++)progressFileNodes.push(uploadStatus.AddFile(progressNode,files[j].name));setTimeout(function(){if(isUploading)uploadStatus.SetIsProgressContainerVisible(progressNode,true)},500)}uploadHandle=D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest.UploadFiles(files,requestParams);return uploadHandle},
GetFileExtension:function(fileName){var extStart=fileName.lastIndexOf(".");if(extStart<0)return null;return fileName.substr(extStart+1).toLowerCase()},IsFileNameValid:function(fileName){var filenameRegex=/^([^\\\\/:\*\?\"<>\|]{0,127}[^\\\./:\*\?\"<>\|])\.*[^\\\./:\*\?\"<>\|]*$/;var match=filenameRegex.exec(fileName);return match!=null},IsExtensionValid:function(fileName,extensions,restrictedExtensions){var me=D2L.LP.Web.UI.Html.Files.FileUpload;var extension=me.GetFileExtension(fileName);if(extension!=
null){if(D2L.LP.Web.UI.Html.Dom.IndexOf(restrictedExtensions,extension)!=-1)return false;if(D2L.LP.Web.UI.Html.Dom.IndexOf(extensions,"*.*")==-1&&D2L.LP.Web.UI.Html.Dom.IndexOf(extensions,extension)==-1)return false}else return false;return true}};
D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest={CallbackNumber:0,ERRCODE_MAXFILESIZE:"1000",ERRCODE_TOTALFILESIZE:"1001",ERRCODE_RESTRICTEDFILEEXT:"1002",Upload:function(openerId,uploadLocation,fileNode,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest;var fileUpload=D2L.LP.Web.UI.Html.Files.FileUpload;var uploadStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var errorsNode;var progressNode;var progressFileNode;if(params.IsStatusEnabled){if(progressNode===undefined||errorsNode===
undefined){errorsNode=uploadStatus.GetErrorsContainerNode();progressNode=uploadStatus.GetProgressContainerNode()}uploadStatus.RemoveErrorMessages(errorsNode)}var raiseError=function(errorNumber){if(params.IsStatusEnabled)uploadStatus.AddErrorMessage(errorsNode,params.ErrorMessages[errorNumber-1]);params.OnError.call(params.OnError,errorNumber)};if(!fileUpload.IsExtensionValid(fileNode.value,params.Extensions,params.RestrictedExtensions)){raiseError(2);return}var iFrameId=openerId.GetValue()+"_iframe_"+
me.CallbackNumber;var iFrameNode=D2L.LP.Web.UI.Html.Dom.GetElementById(iFrameId);if(iFrameNode==null){iFrameNode=document.createElement("IFRAME");D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,"id",iFrameId);D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,"name",iFrameId);D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,"src","/d2l/tools/blank.html");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen",iFrameNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",iFrameNode);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(iFrameNode,
fileNode)}D2L.LP.Web.UI.Html.Dom.SetAttribute(fileNode,"name","uploadFile");var uploadHandle={Abort:function(){if(this.IsUploading){if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}if(params.OnAbort!=null)params.OnAbort.call(params.OnAbort)}},IsUploading:false};var uploadCallback=function(fileData){uploadHandle.IsUploading=false;var json=fileData;var response=D2L.LP.Web.Serialization.Json.Deserialize(json);
var failCode=response.ResponseCode;var failReason=response.Message;if(failCode!="0"||response.File==null){if(failCode==me.ERRCODE_MAXFILESIZE||failCode==me.ERRCODE_TOTALFILESIZE)raiseError(3);else if(failCode==me.ERRCODE_RESTRICTEDFILEEXT)raiseError(2);if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}return}var file=new D2L.LP.Web.UI.Files.File(response.File.FileId,response.File.FileSystemType,response.File.FileName,
response.File.Size);if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode,response.File.FileName);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}params.OnFileComplete.call(params.OnFileComplete,file);params.OnFilesComplete.call(params.OnFilesComplete)};var callbackId=me.GetUniqueCallbackId(iFrameId);window[callbackId]=uploadCallback;var fileName=me.StripFilePath(fileNode.value);var location=uploadLocation.WithQueryString("cb",callbackId).WithQueryString("fileName",
fileName).WithQueryString("iframe",true).GetUrl();var formNode=document.createElement("FORM");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"action",location);D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"id",openerId.GetValue()+"_form");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"method","post");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"enctype","multipart/form-data");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"encoding","multipart/form-data");formNode.appendChild(D2L.LP.Web.Authentication.Xsrf.CreateXsrfHidden());
formNode.target=iFrameId;formNode.onsubmit="return false;";fileNode.parentNode.removeChild(fileNode);formNode.appendChild(fileNode);var doLoad=true;D2L.LP.Web.UI.Html.Dom.AddEventListener("load",iFrameNode,function(){if(doLoad){doLoad=false;uploadHandle.IsUploading=true;params.OnFilesStarted.call(params.OnFilesStarted);params.OnProgress.call(params.OnProgress.call,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(fileName));if(params.IsStatusEnabled){progressFileNode=uploadStatus.AddFile(progressNode,
fileName);uploadStatus.UpdateFile(progressFileNode,fileName);setTimeout(function(){if(uploadHandle.IsUploading)uploadStatus.SetIsProgressContainerVisible(progressNode,true)},500)}var iFrameBodyNode=iFrameNode.contentDocument.body;iFrameBodyNode.appendChild(formNode);formNode.submit()}else if(uploadHandle.IsUploading){uploadHandle.IsUploading=false;raiseError(3)}});return uploadHandle},GetUniqueCallbackId:function(iFrameId){var me=D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest;var date=new Date;
var time=date.getTime();me.CallbackNumber+=1;return iFrameId+"_cb_"+time+"_"+me.CallbackNumber},StripFilePath:function(fileName){var index=fileName.lastIndexOf("\\");return fileName.substring(index+1)}};
D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress=D2L.Class.Create({Construct:function(fileName,fileSentBytes,fileSizeBytes,totalSentBytes,totalSizeBytes){this.m_fileName=fileName;this.m_fileSentBytes=fileSentBytes;this.m_fileSizeBytes=fileSizeBytes;this.m_totalSentBytes=totalSentBytes;this.m_totalSizeBytes=totalSizeBytes},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember("FileName",this.m_fileName);serializer.AddMember("FileSentBytes",this.m_fileSentBytes);
serializer.AddMember("FileSizeBytes",this.m_fileSizeBytes);serializer.AddMember("TotalSentBytes",this.m_totalSentBytes);serializer.AddMember("TotalSizeBytes",this.m_totalSizeBytes)},GetFileName:function(){return this.m_fileName},GetFileSentBytes:function(){return this.m_fileSentBytes},GetFileSizeBytes:function(){return this.m_fileSizeBytes},GetFilePercent:function(){if(this.m_fileSizeBytes===0)return 0;else{if(this.m_fileSentBytes>this.m_fileSizeBytes)this.m_fileSentBytes=this.m_fileSizeBytes;return Math.round(this.m_fileSentBytes*
100/this.m_fileSizeBytes)}},GetTotalSentBytes:function(){return this.m_totalSentBytes},GetTotalSizeBytes:function(){return this.m_totalSizeBytes},GetTotalPercent:function(){if(this.m_totalSizeBytes===0)return 0;else return Math.round(this.m_totalSentBytes*100/this.m_totalSizeBytes)}});
D2L.LP.Web.UI.Html.Files.FileUpload.Status={AddFile:function(node,fileName){var fileNode=document.createElement("li");fileNode.className="d2l-filedrop-status-file";fileNode.innerHTML=fileName;fileNode.d2l_isComplete=false;return node.childNodes[0].appendChild(fileNode)},AddErrorMessage:function(node,message){node.childNodes[1].innerHTML=message;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filedrop-status-errors-hidden",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-status-errors-hidden",
node)},GetContainerNode:function(){var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filedrop-status-container");if(node!=null)return node;node=document.createElement("div");node.className="d2l-filedrop-status-container";var errorNode=document.createElement("div");errorNode.className="d2l-filedrop-status-errors d2l-filedrop-status-errors-hidden";node.appendChild(errorNode);var errorCloseNode=document.createElement("span");errorCloseNode.className="d2l-filedrop-status-errors-close";D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
errorCloseNode,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-errors-hidden",errorNode)});errorNode.appendChild(errorCloseNode);var errorTextNode=document.createElement("span");errorNode.appendChild(errorTextNode);var progressNode=document.createElement("div");progressNode.className="d2l-filedrop-status-progress d2l-filedrop-status-progress-hidden";node.appendChild(progressNode);var filesNode=document.createElement("ul");filesNode.className="d2l-filedrop-status-files";progressNode.appendChild(filesNode);
return document.body.appendChild(node)},GetErrorsContainerNode:function(){var me=D2L.LP.Web.UI.Html.Files.FileUpload.Status;return me.GetContainerNode().childNodes[0]},GetProgressContainerNode:function(){var me=D2L.LP.Web.UI.Html.Files.FileUpload.Status;return me.GetContainerNode().childNodes[1]},SetIsProgressContainerVisible:function(node,isVisible){if(isVisible){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filedrop-status-progress-hidden",node)){var fileCount=node.childNodes[0].childNodes.length;
for(var i=0;i<fileCount;i++){var fileNode=node.childNodes[0].childNodes[i];if(fileNode.d2l_isComplete)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fileNode)}D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-status-progress-hidden",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-status-container-hidden",node.parentNode)}}else{var fileCount=node.childNodes[0].childNodes.length;for(var i=0;i<fileCount;i++){var fileNode=node.childNodes[0].childNodes[i];if(!fileNode.d2l_isComplete)return}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-progress-hidden",
node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-container-hidden",node.parentNode)}},SetIsFileCompleted:function(node,fileName){node.d2l_isComplete=true;this.UpdateFile(node,fileName,100)},RemoveErrorMessages:function(node){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-errors-hidden",node);node.childNodes[1].innerHTML=""},RemoveFile:function(node){node.d2l_isComplete=true;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-file-hidden",node)},UpdateFile:function(node,
fileName,percent){if(node==null)return;if(percent!==undefined)node.innerHTML=fileName+" - "+percent+"%";else node.innerHTML=fileName+" - "+"Uploading"}};
D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest={UploadFiles:function(files,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest;if(files===undefined||files.length==0)return;var fileNumber=0;var fileCount=files.length;var fileUploadHandle;var handle={Abort:function(){if(fileUploadHandle!=null)fileUploadHandle.Abort()}};var totalLoaded=0;var totalFileSize=0;for(var i=0;i<files.length;i++)totalFileSize+=files[i].size;var onProgress=params.OnProgress;params.OnProgress=function(progress){if(onProgress==
null)return;progress=new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(progress.GetFileName(),progress.GetFileSentBytes(),progress.GetFileSizeBytes(),totalLoaded+progress.GetFileSentBytes(),totalFileSize);onProgress.call(onProgress,progress)};var onFileComplete=params.OnFileComplete;params.OnFileComplete=function(file){totalLoaded+=files[fileNumber].size;onFileComplete.call(onFileComplete,file);fileUploadHandle=null;fileNumber+=1;if(fileNumber<fileCount)fileUploadHandle=me.UploadFile(files[fileNumber],
params);else if(params.OnFilesComplete!=null)params.OnFilesComplete.call(params.OnFilesComplete)};onProgress.call(onProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress("",0,1,0,1));fileUploadHandle=me.UploadFile(files[fileNumber],params);return handle},UploadFile:function(file,params){if(file===undefined)return;var fileSize=file.size;var xhr;var handle={Abort:function(){if(this.IsUploading&&xhr!=null)xhr.abort()},IsUploading:false};var bytesLoaded=0;var onProgress=function(evt){if(params.OnProgress==
null)return;if(evt.lengthComputable){var progress=new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(file.name,bytesLoaded+evt.loaded,fileSize,bytesLoaded+evt.loaded,fileSize);params.OnProgress.call(params.OnProgress,progress)}};var sliceFunc;if(file.slice!==undefined)sliceFunc="slice";else if(file.mozSlice!==undefined)sliceFunc="mozSlice";else if(file.webkitSlice)sliceFunc="webkitSlice";var bytesPerSlice=params.BytesPerSlice;if(sliceFunc===undefined||bytesPerSlice===undefined)bytesPerSlice=
0;var getEndByte=function(startByte){var endByte=startByte+bytesPerSlice;if(endByte<fileSize)return endByte;else return fileSize};var isLastSlice=false;var uploadSlice=function(startByte,streamId){var endByte=getEndByte(startByte);var slice;if(bytesPerSlice>0){slice=file[sliceFunc](startByte,endByte);if(endByte>=fileSize)isLastSlice=true}else{slice=file;isLastSlice=true}var location=params.UploadLocation.WithQueryString("isLastSlice",isLastSlice);if(streamId!==undefined)location=location.WithQueryString("streamId",
streamId);location=location.GetUrl();var formData=new FormData;formData.append("fileName",file.name);formData.append("uploadFile",slice);formData.append(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());xhr=new XMLHttpRequest;D2L.LP.Web.UI.Html.Dom.AddEventListener("progress",xhr.upload,onProgress);D2L.LP.Web.UI.Html.Dom.AddEventListener("load",xhr.upload,onProgress);xhr.onload=function(evt){if(xhr.status==200){bytesLoaded+=slice.size;var json=
evt.target.responseText;var response=D2L.LP.Web.Serialization.Json.Deserialize(json);if(response.ResponseCode=="0")if(response.File!==undefined){handle.IsUploading=false;params.OnFileComplete.call(params.OnFileComplete,response.File)}else{startByte=endByte;if(!isLastSlice)uploadSlice(startByte,response.StreamId)}else{handle.IsUploading=false;if(params.OnError!=null)params.OnError.call(params.OnError)}}else{handle.IsUploading=false;if(params.OnError!=null)params.OnError.call(params.OnError)}slice=
null};xhr.onerror=function(){handle.IsUploading=false;if(params.OnError!=null)params.OnError.call(params.OnError)};xhr.onabort=function(){handle.IsUploading=false;if(params.OnAbort!=null)params.OnAbort.call(params.OnAbort)};xhr.open("POST",location);xhr.send(formData)};handle.IsUploading=true;if(params.OnFileStarted!=null)params.OnFileStarted.call(params.OnFileStarted,file.name);uploadSlice(0);return handle}};D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse={};
D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default={Abort:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(node.d2l_fu_handles===undefined)return;for(var i=0;i<node.d2l_fu_handles.length;i++){node.d2l_fu_handles[i].Abort();node.d2l_fu_handles.splice(0,1)}},Browse:function(openerId,settings){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var inputNode=document.createElement("input");
inputNode.className="d2l-fileinput-input d2l-font";inputNode.type="file";var isFileAPISupported=me.IsFileAPISupported();if(isFileAPISupported&&settings.IsMultipleAllowed)inputNode.setAttribute("multiple","multiple");var params={BytesPerSlice:settings.BytesPerSlice,ErrorMessages:settings.ErrorMessages,Extensions:settings.Extensions,RestrictedExtensions:settings.RestrictedExtensions,IsMultipleAllowed:settings.IsMultipleAllowed,IsStatusEnabled:settings.IsStatusEnabled,MaxFileSize:settings.MaxFileSize,
MaxFileNameLength:settings.MaxFileNameLength,OnFilesStarted:function(){if(settings.OnFilesStarted!==null)settings.OnFilesStarted.call(settings.OnFilesStarted)},OnProgress:function(progress){node.d2l_fu_progress=progress;if(settings.OnProgress!=null)settings.OnProgress.call(settings.OnProgress)},OnFileComplete:function(file){node.d2l_fu_files.push(file);node.d2l_fu_files_queued+=1;if(settings.OnFileComplete!==null)settings.OnFileComplete.call(settings.OnFileComplete)},OnFilesComplete:function(){if(settings.OnFilesComplete!==
null)settings.OnFilesComplete.call(settings.OnFilesComplete)},OnAbort:function(){if(settings.OnAbort!==null)settings.OnAbort.call(settings.OnAbort)},OnError:function(errorNumber){node.d2l_fu_errorNumber=errorNumber;if(settings.OnError!==null)settings.OnError.call(settings.OnError)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("change",inputNode,function(){if(node.d2l_fu_files===undefined)node.d2l_fu_files=[];if(node.d2l_fu_files_queued===undefined)node.d2l_fu_files_queued=0;if(node.d2l_fu_handles===undefined)node.d2l_fu_handles=
[];node.d2l_fu_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.Upload(settings.UploadLocation,inputNode.files,params))});D2L.LP.Web.UI.Html.Dom.InsertElementAfter(inputNode,node);inputNode.click()},GetErrorNumber:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var errorNumber=node.d2l_fu_errorNumber;return errorNumber},GetFile:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var files=node.d2l_fu_files;if(files.length===
0||files.length<node.d2l_fu_files_queued)return;var file=files[files.length-node.d2l_fu_files_queued];node.d2l_fu_files_queued-=1;return file},GetFiles:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var files=node.d2l_fu_files;if(files.length===0||files.length<node.d2l_fu_files_queued)return;var queuedFiles=[];var queuedIndex=files.length-node.d2l_fu_files_queued;for(var i=queuedIndex;i<files.length;i++){queuedFiles.push(files[i]);node.d2l_fu_files_queued-=
1}return queuedFiles},GetProgress:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var progress=node.d2l_fu_progress;return progress},InitializeLegacyBrowse:function(openerId,settings,buttonText){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node);if(node.d2l_fu_files===undefined)node.d2l_fu_files=[];if(node.d2l_fu_files_queued===undefined)node.d2l_fu_files_queued=0;if(node.d2l_fu_handles===
undefined)node.d2l_fu_handles=[];var inputNumber=0;var labelNode=document.createElement("label");labelNode.className="d2l-filebrowse-label d2l-filebrowse-label-hov";labelNode.innerHTML=buttonText;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(labelNode,node);var params;var createInputNode=function(){var containerNode=document.createElement("div");containerNode.className="d2l-offscreen";D2L.LP.Web.UI.Html.Dom.InsertElementAfter(containerNode,node);inputNumber+=1;var inputId=openerId.GetValue()+"_input_"+
inputNumber;labelNode.setAttribute("for",inputId);containerNode.innerHTML='<input id="'+inputId+'" type="file"/>';var inputNode=containerNode.firstChild;var cleanup=function(){containerNode.parentNode.removeChild(containerNode)};params={ErrorMessages:settings.ErrorMessages,Extensions:settings.Extensions,RestrictedExtensions:settings.RestrictedExtensions,IsMultipleAllowed:settings.IsMultipleAllowed,IsStatusEnabled:settings.IsStatusEnabled,MaxFileSize:settings.MaxFileSize,MaxFileNameLength:settings.MaxFileNameLength,
OnFilesStarted:function(){if(settings.OnFilesStarted!==null)settings.OnFilesStarted.call(settings.OnFilesStarted)},OnProgress:function(progress){node.d2l_fu_progress=progress;if(settings.OnProgress!=null)settings.OnProgress.call(settings.OnProgress)},OnFileComplete:function(file){node.d2l_fu_files.push(file);node.d2l_fu_files_queued+=1;cleanup();if(settings.OnFileComplete!==null)settings.OnFileComplete.call(settings.OnFileComplete)},OnFilesComplete:function(){if(settings.OnFilesComplete!==null)settings.OnFilesComplete.call(settings.OnFilesComplete)},
OnAbort:function(){cleanup();if(settings.OnAbort!==null)settings.OnAbort.call(settings.OnAbort)},OnError:function(errorNumber){node.d2l_fu_errorNumber=errorNumber;cleanup();if(settings.OnError!==null)settings.OnError.call(settings.OnError)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("change",inputNode,function(){node.d2l_fu_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest.Upload(openerId,settings.UploadLocation,inputNode,params));createInputNode()})};createInputNode()},IsFileAPISupported:function(){return window.FileReader!==
undefined},SetIsBrowseLabelEnabled:function(labelNode,isEnabled){if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filebrowse-label-disabled",labelNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filebrowse-label-disabled",labelNode)}};D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop={};D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-filedrop",function(node){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;me.MakeFileDropNode(node)});
D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default={Abort:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_fd_handles===undefined)return;for(var i=0;i<node.d2l_fd_handles.length;i++)node.d2l_fd_handles[i].Abort()},GetVerticalDragPosition:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.m_verticalDragPosition)return node.m_verticalDragPosition;else return null},GetErrorNumber:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var errorNumber=node.d2l_fd_errorNumber;return errorNumber},GetFile:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_fd_files;if(files.length===0||files.length<node.d2l_fd_files_queued)return;var file=files[files.length-node.d2l_fd_files_queued];node.d2l_fd_files_queued-=1;return file},GetFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_fd_files;if(files.length===0||files.length<node.d2l_fd_files_queued)return;
var queuedFiles=[];var queuedIndex=files.length-node.d2l_fd_files_queued;for(var i=queuedIndex;i<files.length;i++){queuedFiles.push(files[i]);node.d2l_fd_files_queued-=1}return queuedFiles},GetProgress:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var progress=node.d2l_fd_progress;return progress},IsMultipleAllowedByNode:function(node){return node.d2l_fd_isMultipleAllowed},MakeFileDropNode:function(node){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;var dropStatus=
D2L.LP.Web.UI.Html.Files.FileUpload.Status;var bytesPerSlice=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"bytesPerSlice");var maxFileSize=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"maxFileSize");var maxFileNameLength=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"maxFileNameLength");var extensions=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"extensions");var uploadLocation=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"uploadLocation");var restrictedExtensions=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"x-extensions");var statusIndicator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"statusIndicator");var isMultiple=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"isMultipleAllowed");var errorMessages=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"errorMessages");var onProgress=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onProgress");var onFileOver=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileOver");var onFileEnter=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileEnter");var onFileLeave=
D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileLeave");var fileOverCssClass=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"fileOverCssClass");var isStatusEnabled=statusIndicator==="auto";node.d2l_fd_isUploading=false;node.d2l_fd_files=[];node.d2l_fd_files_queued=0;node.d2l_fd_handles=[];me.SetIsEnabledByNode(node,true);me.SetIsMultipleAllowedByNode(node,isMultiple);var errorsNode;var progressNode;var progressFileNode;var progressFileNodes;var noopHandler=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt);
D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt)};var isFileDropValid=function(evt){if(node.d2l_fd_isAllowed&&!node.d2l_fd_isUploading&&evt.dataTransfer!=null&&evt.dataTransfer.types!=null){var dataTypes=evt.dataTransfer.types;for(var i=0;i<dataTypes.length;i++){if(dataTypes[i]=="application/x-moz-file-promise")return false;if(dataTypes[i]=="Files")return true}}return false};var dragEnterCount=0;var onDropFiles=function(evt){dragEnterCount=0;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-drag",
node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);if(onFileLeave)onFileLeave.call(onFileLeave);if(!isFileDropValid(evt))return;var files=evt.dataTransfer.files;if(files==null||files.length==0)return;var resetUpload=function(){node.d2l_fd_isUploading=false};var params={BytesPerSlice:bytesPerSlice,ErrorMessages:errorMessages,Extensions:extensions,RestrictedExtensions:restrictedExtensions,IsMultipleAllowed:isMultiple,IsStatusEnabled:isStatusEnabled,MaxFileSize:maxFileSize,
MaxFileNameLength:maxFileNameLength,OnFilesStarted:function(){var onFilesStarted=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFilesStarted");if(onFilesStarted!=null)onFilesStarted.call(onFilesStarted)},OnProgress:function(progress){node.d2l_fd_progress=progress;if(onProgress!=null)onProgress.call(onProgress)},OnFileComplete:function(file){node.d2l_fd_files.push(file);node.d2l_fd_files_queued+=1;var onFileComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileComplete");if(onFileComplete!=
null)onFileComplete.call(onFileComplete)},OnFilesComplete:function(){var onFilesComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFilesComplete");if(onFilesComplete!=null)onFilesComplete.call(onFilesComplete);resetUpload()},OnAbort:function(){var onAbort=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onAbort");if(onAbort!=null)onAbort.call(onAbort);resetUpload()},OnError:function(errorNumber){resetUpload();node.d2l_fd_errorNumber=errorNumber;var onError=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"onError");if(onError!=null)onError.call(onError)}};node.d2l_fd_isUploading=true;node.d2l_fd_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.Upload(uploadLocation,files,params))};D2L.LP.Web.UI.Html.Dom.AddEventListener("dragenter",node,function(evt){dragEnterCount++;if(isFileDropValid(evt)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.AddClassName(fileOverCssClass,node);if(onFileEnter)onFileEnter.call(onFileEnter)}noopHandler(evt)});D2L.LP.Web.UI.Html.Dom.AddEventListener("dragleave",
node,function(evt){node.m_rect=null;dragEnterCount--;if(evt.relatedTarget!=null){var relatedTarget=evt.relatedTarget;if(relatedTarget!=node){var tempNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-filedrop-drag",relatedTarget);if(tempNode==null||tempNode!=node){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);if(onFileLeave)onFileLeave.call(onFileLeave);noopHandler(evt)}}}else if(dragEnterCount==
0){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);if(onFileLeave)onFileLeave.call(onFileLeave)}});var onDragOverHandler=function(evt){if(onFileOver)if(isFileDropValid(evt)){var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,evt);if(!node.m_rect)node.m_rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);var topDelta=cursorPos.y-node.m_rect.top;node.m_verticalDragPosition=topDelta/node.m_rect.height;
onFileOver.call(onFileOver)}noopHandler(evt)};D2L.LP.Web.UI.Html.Dom.AddEventListener("dragover",node,onDragOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("drop",node,function(evt){noopHandler(evt);onDropFiles(evt);node.m_rect=null})},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetIsEnabledByNode(node,isEnabled)},SetIsEnabledByNode:function(node,isAllowed){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filedrop",
node))return;node.d2l_fd_isAllowed=isAllowed;if(isAllowed)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-add",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-add",node)},SetIsMultipleAllowedByNode:function(node,isAllowed){node.d2l_fd_isMultipleAllowed=isAllowed}};D2L.LP.Web.UI.Legacy={MasterPages:{}};
D2L.LP.Web.UI.Legacy.MasterPages.Dialog={InstallTitle:function(handle,closeText){var doc=handle.container.ownerDocument;var nodeWin=handle.frame.contentWindow;var titleNode=D2L.LP.Web.UI.Html.Dom.GetElementById("d_page_title",doc);var title="";if(titleNode!==null){titleNode.style.display="none";title=titleNode.innerHTML}handle.nodes.title=doc.createElement("div");handle.nodes.title.className="d2l-dialog-title";handle.nodes.heading=doc.createElement("h1");handle.nodes.heading.className="d2l-heading";
handle.nodes.heading.id=nodeWin.UI.GetUniqueHtmlId();handle.nodes.heading.innerHTML=title;handle.nodes.title.appendChild(handle.nodes.heading);handle.nodes.close=doc.createElement("a");handle.nodes.close.className="d2l-dialog-close";var closeImg=doc.createElement("span");handle.nodes.close.appendChild(closeImg);var closeTextElem=doc.createElement("span");closeTextElem.className="d2l-offscreen";closeTextElem.appendChild(doc.createTextNode(closeText));closeImg.appendChild(closeTextElem);handle.nodes.title.appendChild(handle.nodes.close);
handle.container.insertBefore(handle.nodes.title,handle.container.firstChild)},InstallFooter:function(handle,adapter,buttons){var doc=handle.container.ownerDocument;adapter.m_footerNode=doc.createElement("div");adapter.m_footerNode.className="d2l-dialog-footer";if(buttons.length>0)for(var i=0;i<buttons.length;i++){var buttonAdapter=adapter.AddCustomButton(new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.TextAdapter(buttons[i].Text),0,buttons[i].ResponseType,buttons[i].Param,buttons[i].Key,buttons[i].IsPrimary);
buttonAdapter.SetIsEnabled(buttons[i].IsEnabled)}var resize=doc.createElement("span");resize.className="d2l-dialog-resize";adapter.m_footerNode.appendChild(resize);handle.container.appendChild(adapter.m_footerNode);handle.nodes.footer=adapter.m_footerNode},CreateSettings:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var onload=function(handle){var nodeWin=handle.frame.contentWindow;if(nodeWin.D2L===
undefined)return;var adapter=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter(handle,responseDataKey,srcCallback,resizeCallback);me.InstallTitle(handle,closeText);me.InstallFooter(handle,adapter,buttons);handle.body.style.overflow="auto";nodeWin.UI.SetParentDialog(adapter);nodeWin.d2l_Onload()};var settings={Onload:onload,Width:width!==null?width:undefined,Height:height!==null?height:undefined};return settings},Open:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,
height,closeText,buttons){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;location=(new D2L.LP.Web.Http.UrlLocation(location.GetUrl())).WithQueryString("d2l_body_type","2");var settings=me.CreateSettings(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons);return dialog.Open(openerId,location,settings)},OpenWithParam:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,
buttons,params){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;location=(new D2L.LP.Web.Http.UrlLocation(location.GetUrl())).WithQueryString("d2l_body_type","2");var settings=me.CreateSettings(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons);return dialog.OpenWithParam(openerId,location,params,settings)}};
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.ButtonAdapter=D2L.Class.Create({Construct:function(dialog,srcCallback,win,doc,text,responseType,responseParam,key,isPrimary){if(responseType===undefined)responseType=1;if(responseParam===undefined)responseParam="";this.m_domNode=null;this.m_dialog=dialog;this.m_srcCallback=srcCallback;this.m_win=win;this.m_doc=doc;this.m_text=text;this.m_dialog=dialog;this.m_responseType=responseType;this.m_responseParam=responseParam;this.m_key=key;this.m_isEnabled=true;this.m_isDisplayed=
true;this.m_onClick=null;this.m_isPrimary=isPrimary;this.m_isRendered=false},BuildDom:function(){var me=this;var b=D2L.LP.Web.UI.Common.Controls.Button;this.m_onClick=function(){var response=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.Response(me.m_dialog,me.m_responseType,me.m_responseParam);if(me.m_win[me.m_srcCallback]!==undefined)me.m_win[me.m_srcCallback](response);else me.m_dialog.CallCallback(response)};this.m_domNode=b.Build(this.m_doc);return this.m_domNode},Init:function(){this.m_isRendered=
true;var b=D2L.LP.Web.UI.Common.Controls.Button;D2L.LP.Web.UI.Common.Controls.Button.Init(this.m_domNode);b.SetIsPrimaryNode(this.m_domNode,this.m_isPrimary);this.SetIsDisplayed(this.m_isDisplayed);this.SetIsEnabled(this.m_isEnabled);this.SetOnClick(this.m_onClick);this.SetText(this.m_text)},GetDomNode:function(){return this.m_domNode},GetText:function(){return this.m_text},SetIsDisplayed:function(isDisplayed){this.m_isDisplayed=isDisplayed;if(!this.m_isRendered)return;D2L.LP.Web.UI.Common.Controls.Button.SetIsVisibleNode(this.m_domNode,
isDisplayed)},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(!this.m_isRendered)return;D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabledNode(this.m_domNode,isEnabled)},SetIsPrimary:function(){},SetText:function(text){this.m_text=text;if(!this.m_isRendered)return;var me=this;this.m_text.GetText().Register(function(val){D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(me.m_domNode,val)})},SetOnClick:function(onClick){this.m_onClick=null;if(!this.m_isRendered)return;D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(this.m_domNode,
onClick)}});
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter=D2L.Class.Create({Construct:function(handle,dataKey,srcCallback,resizeCallback){this.m_handle=handle;this.m_footerNode=null;this.m_dataKey=dataKey;this.m_positiveButton=null;this.m_srcCallback=srcCallback;this.m_buttons=[];if(resizeCallback!==undefined){resizeCallback=handle.frame.contentWindow[resizeCallback];if(resizeCallback!==undefined)handle.dialog.OnResize.AddListener(function(){try{resizeCallback()}catch(ex){}})}},AddButton:function(type,responseParam,
key,isPrimary){if(responseParam===undefined)responseParam="";var win=this.m_handle.frame.contentWindow;var text=win.D2L.Control.Button.GetTermForType(type);var responseType=1;if(type==1||type==9)responseType=0;else if(type==4)responseType=2;return this.AddCustomButton(text,0,responseType,responseParam,key,isPrimary)},AddCustomButton:function(text,position,responseType,responseParam,key,isPrimary){var doc=this.m_handle.container.ownerDocument;var nodeWin=this.m_handle.frame.contentWindow;var button=
new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.ButtonAdapter(this,this.m_srcCallback,this.m_handle.frame.contentWindow,doc,text,responseType,responseParam,key,isPrimary);this.m_buttons.push(button);button.BuildDom();if(responseType===1)this.m_positiveButton=button;var buttonsNode=null;var buttonsNodes=nodeWin.D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-buttons",this.m_footerNode);if(buttonsNodes.length===0){buttonsNode=doc.createElement("div");buttonsNode.className="d2l-dialog-buttons";
this.m_footerNode.appendChild(buttonsNode)}else buttonsNode=buttonsNodes[0];buttonsNode.appendChild(button.GetDomNode());button.Init();buttonsNode.appendChild(doc.createTextNode(" "));return button},CallCallback:function(response){var result=[];var dataKeys=[];if(this.m_dataKey.length>0)dataKeys=this.m_dataKey.split(",");for(var j=0;j<dataKeys.length;j++){var itemResult=undefined;var dataItemKeys=dataKeys[j].split(".");if(dataItemKeys.length>0){itemResult=response.GetData(dataItemKeys[0]);if(itemResult!==
undefined)for(var i=1;i<dataItemKeys.length;i++)if(itemResult[dataItemKeys[i]]!==undefined)itemResult=itemResult[dataItemKeys[i]]}result.push(itemResult)}if(result.length==0)result=undefined;else if(result.length==1)result=result[0];D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(response.GetType()>0,true,result,this.m_handle)},Close:function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(true,true,undefined,this.m_handle)},GetButton:function(key){for(var i=0;i<this.m_buttons.length;i++)if(this.m_buttons[i].m_key==
key)return this.m_buttons[i];return null},GetButtonCount:function(){return 0},GetContentHeight:function(){return this.m_handle.body.clientHeight},GetPositiveButton:function(){return this.m_positiveButton},GetFooterText:function(){return""},RemoveButton:function(button){for(var i=0;i<this.m_buttons.length;i++)if(this.m_buttons[i]==button){button.m_domNode.parentNode.removeChild(button.m_domNode);this.m_buttons.splice(i,1)}},RemoveButtons:function(){for(var i=0;i<this.m_buttons.length;i++)this.m_buttons[i].m_domNode.parentNode.removeChild(this.m_buttons[i].m_domNode);
this.m_buttons=[]},SetFooterText:function(text){},SetSize:function(width,height){D2L.LP.Web.UI.Common.MasterPages.Dialog.SetSize(this.m_handle,width,height)},SetTitle:function(text){}});
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.Response=D2L.Class.Create({Construct:function(dialog,type,param){this.m_data=[];this.m_dialog=dialog;this.m_type=type;this.m_param=param},CallCallback:function(){this.GetDialog().CallCallback(this)},GetData:function(key){return this.m_data[key]},GetDialog:function(){return this.m_dialog},GetParam:function(){return this.m_param},GetType:function(){return this.m_type},SetData:function(key,value){this.m_data[key]=value}});
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.TextAdapter=D2L.Class.Create({Construct:function(text){this.m_text=text},AssignText:function(obj,attrName){obj[attrName]=this.m_text},GetText:function(){var text=this.m_text;return{Register:function(callback){callback(text)}}}});D2L.LP.DocumentViewers={};D2L.LP.DocumentViewers.Legacy={};
D2L.LP.DocumentViewers.Legacy.Container={SetIsDisplayed:function(id,isDisplayed){var node=document.getElementById(id);if(node!=null)node.style.display=isDisplayed?"inline":"none"},SetLocation:function(id,location){if(id===undefined||location===undefined)return;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node!==null)node.src=location.GetUrl()}};
D2L.LP.Web.UI.Desktop.Controls.GooglePlusOne={Init:function(node){var data={"size":"medium","count":"true"};if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-href"))data["href"]=node.getAttribute("data-href");gapi.plusone.render(node,data)}};D2L.LP.Web.UI.Desktop.Controls.TweetButton={Init:function(node){D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){var win=window.open(node.getAttribute("href"),"twitterWin","height=420,width=555,menubar=no,toolbar=no");win.focus()})}};
D2L.LP.ActivityBar={Init:function(pollLocation,pollInterval,bucketClassNameFormat,updateVariableNameFormat){var myWindow=window;var findTopWindow=function(win){try{if(win&&win["D2L"]!==undefined){if(win.parent&&win.parent!=win)return findTopWindow(win.parent);return win}}catch(e){}};var topWindow=findTopWindow(myWindow);if(myWindow!==topWindow||myWindow===null)return;pollInterval=pollInterval*1E3;var processPollResponse=function(data){for(var i=0;i<data.length;i++){var bucketClassName=bucketClassNameFormat.replace("{0}",
data[i]);var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)continue;D2L.LP.ActivityBar.SetAlertStatus(bucketClassName);var updateVariable=updateVariableNameFormat.replace("{0}",data[i]);D2L.VS(updateVariable,true);var messageDisplayed=bucket.m_ariaMessageDisplayed;if(!messageDisplayed){bucket.m_ariaMessageDisplayed=true;var ariaMessage=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"aria-message");D2L.LP.Web.UI.Html.Aria.LogMessage(ariaMessage)}}setTimeout(poll,
pollInterval)};var poll=function(){var expired=D2L.PT.Auth.SessionTimeout.IsExpired();if(expired){setTimeout(poll,pollInterval);return}var rpcEvt=D2L.LP.Web.UI.Rpc.ConnectObject(D2L.LP.Web.UI.Rpc.Verbs.GET,pollLocation,null,{keepAlive:false,failure:function(){return true}});rpcEvt.AddListener(processPollResponse)};setTimeout(poll,pollInterval)},SetAlertStatus:function(bucketClassName){var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)return;var alertImage=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("Alert",bucket);var newAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewAlert",bucket);var openAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("OpenAlert",bucket);var newOpenAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewOpenAlert",bucket);var bucketId=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"flyout-id");var isOpen=D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.IsOpen(bucketId);D2L.LP.ActivityBar.UpdateTitle(bucketClassName,
true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(alertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newAlertImage,!isOpen);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(openAlertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newOpenAlertImage,isOpen)},OpenBucket:function(bucketClassName){var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)return;bucket.m_ariaMessageDisplayed=false;var alertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("Alert",
bucket);var newAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewAlert",bucket);var openAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("OpenAlert",bucket);var newOpenAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewOpenAlert",bucket);D2L.LP.ActivityBar.UpdateTitle(bucketClassName,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(alertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newAlertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newOpenAlertImage,
false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(openAlertImage,true)},CloseBucket:function(bucketClassName){var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)return;bucket.m_ariaMessageDisplayed=false;var alertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("Alert",bucket);var openAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("OpenAlert",bucket);var newAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewAlert",bucket);
var newOpenAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewOpenAlert",bucket);var hasAlert=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",newOpenAlertImage);D2L.LP.ActivityBar.UpdateTitle(bucketClassName,hasAlert);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(alertImage,!hasAlert);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(openAlertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newAlertImage,hasAlert);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newOpenAlertImage,false)},UpdateTitle:function(bucketClassName,
hasNewAlerts){var bucketId=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"flyout-id");var title;if(hasNewAlerts)title=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"new-alert-title");else title=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"title");D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.SetTitle(bucketId,title)}};D2L.PT.Auth=D2L.PT.Auth||{};
D2L.PT.Auth.SessionTimeout={InitData:{ExpireIsVisible:false,ExpireFunc:function(){},Extending:false,ExtendFunc:function(){},IsInit:false,LogoutFunc:function(){},NewUserFunc:function(){},DismissNewUserFunc:function(){},RequiresSession:false,SessionTimeout:180*6E4,UserId:0,WarningBuffer:5*6E4,WarningIsVisible:false,WarningMessageId:null,WarningAlertId:null,WarningCheckId:null,WarningTimeoutIntervalIds:[]},SessionManager:null,ApplyTimeoutConstraints:function(oldTimeout){var newTimeout=oldTimeout;if(oldTimeout<
1)newTimeout=1;if(oldTimeout>35796)newTimeout=35796;return newTimeout},Expire:function(sm,expiredState){if(!sm.InitData.RequiresSession||sm.InitData.ExpireIsVisible)return;sm.InitData.ExpireIsVisible=true;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Expired",expiredState);sm.HideWarning(sm);if(expiredState==="1")sm.InitData.LogoutFunc();else if(expiredState==="2")sm.InitData.ExpireFunc()},ExpiryInit:function(closeDialogFunc){var handleStorageChange=function(e){if(e.Key==="Session.Expired"&&
e.NewValue==="0")closeDialogFunc()};D2L.LP.Web.UI.Events.OnStorage.AddListener(handleStorageChange)},FinalizeLogin:function(){if(!window.opener)return;window.close()},FinalizeLoginUsernamePassword:function(){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired","0")},GetWarningBuffer:function(){var me=D2L.PT.Auth.SessionTimeout;var buffer=10*60*1E3;if(me.InitData.SessionTimeout<=buffer)if(me.InitData.SessionTimeout>6E4)buffer=6E4;else buffer=0;return buffer},HandleSessionStorageChange:function(sm,
expired){if(expired==="1"||expired==="2")sm.Expire(sm,expired);else{sm.InitData.ExpireIsVisible=false;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Resumed");D2L.PT.Auth.SessionTimeout.HideWarning(sm)}},HandleLastAccessedStorageChange:function(sm){if(sm.InitData.SessionTimeout<18E4)return;if(sm.InitData.WarningTimeoutIntervalIds.length>0){sm.HideWarning(sm);for(var i=0;i<sm.InitData.WarningTimeoutIntervalIds.length;i++)clearTimeout(sm.InitData.WarningTimeoutIntervalIds[i])}var timeout=sm.InitData.SessionTimeout-
sm.InitData.WarningBuffer;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Resetting timeout");sm.InitData.WarningTimeoutIntervalIds=[setTimeout(function(){sm.ShowWarning(sm)},timeout)]},HandleUserStorageChange:function(sm,e){D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: User change",e.OldValue,e.NewValue);sm.InitData.DismissNewUserFunc();if(e.NewValue!==sm.InitData.UserId)sm.InitData.NewUserFunc()},HideWarning:function(sm){if(!sm.InitData.WarningIsVisible)return;var isExpired=sm.IsExpired();
D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: hiding warning");sm.InitData.WarningIsVisible=false;sm.InitData.Extending=false;var timeout=0;if(!isExpired){D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningAlertId).style.display="none";D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningCheckId).style.display="block";timeout=1E3}setTimeout(function(){D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Close(sm.InitData.WarningMessageId)},timeout)},IsExpired:function(){var expiredState=
D2L.LP.Web.UI.Html.Dom.Storage.Local.Get("Session.Expired");var isExpired=expiredState==="1"||expiredState==="2";return isExpired},Init:function(userId,sessionTimeout,warningBuffer,warningMessageId,warningAlertId,warningCheckId,extendFunc,expireFunc,logoutFunc,newUserFunc,dismissNewUserFunc){var me=D2L.PT.Auth.SessionTimeout;var verifiedSessionTimeout=me.ApplyTimeoutConstraints(sessionTimeout);me.InitData.ExpireFunc=expireFunc;me.InitData.ExtendFunc=extendFunc;me.InitData.IsInit=true;me.InitData.LogoutFunc=
logoutFunc;me.InitData.NewUserFunc=newUserFunc;me.InitData.DismissNewUserFunc=dismissNewUserFunc;me.InitData.RequiresSession=true;me.InitData.SessionTimeout=verifiedSessionTimeout*6E4;me.InitData.UserId=userId;me.InitData.WarningBuffer=warningBuffer*6E4;me.InitData.WarningAlertId=warningAlertId;me.InitData.WarningCheckId=warningCheckId;me.InitData.WarningMessageId=warningMessageId;var findSessionManager=function(win){try{if(win&&win.D2L!==undefined){if(win.D2L.PT.Auth.SessionTimeout.InitData.IsInit)me.SessionManager=
win.D2L.PT.Auth.SessionTimeout;if(win.parent&&win.parent!=win)findSessionManager(win.parent)}}catch(e){}};findSessionManager(window);if(me.SessionManager===null)return;var expired="0";var lastAccessed="0";if(me.SessionManager!==D2L.PT.Auth.SessionTimeout){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.LastAccessed",(new Date).getTime().toString());D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.UserId",userId);return}var handleStorageChange=function(e){if(e.Key==="Session.Expired"){if(expired!==
e.NewValue){expired=e.NewValue;me.HandleSessionStorageChange(me,expired)}}else if(e.Key==="Session.UserId"){if(userId!==e.NewValue){userId=e.NewValue;me.HandleUserStorageChange(me,e)}}else if(e.Key==="Session.LastAccessed")if(lastAccessed!==e.NewValue){lastAccessed=e.NewValue;me.HandleLastAccessedStorageChange(me)}};var handleClickKey=function(){if(!me.InitData.WarningIsVisible||me.InitData.Extending)return;me.InitData.Extending=true;me.InitData.ExtendFunc()};D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired",
expired);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.UserId",userId);D2L.LP.Web.UI.Events.OnClick.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnKeyPress.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnStorage.AddListener(handleStorageChange);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.LastAccessed",(new Date).getTime().toString())},RpcReceivePayloadProvider:function(result){var sm=D2L.PT.Auth.SessionTimeout.SessionManager;if(sm===null)return;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Rpc update, has expired:",
result.HasExpired,"Keep alive:",result.KeepAlive);if(sm.IsExpired()){D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: already expired");return}if(result.HasExpired)D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired","2");else if(result.KeepAlive)D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.LastAccessed",(new Date).getTime().toString())},ShowWarning:function(sm){if(sm.InitData.WarningIsVisible||sm.IsExpired())return;var timeout=5E4;var shake=function(){D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Shake(sm.InitData.WarningMessageId);
sm.InitData.WarningTimeoutIntervalIds.push(setTimeout(shake,timeout));timeout=6E4};D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: showing warning");sm.InitData.WarningIsVisible=true;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(sm.InitData.WarningMessageId);setTimeout(function(){var checkNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningCheckId);if(checkNode)checkNode.style.display="none";var alertNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningAlertId);if(alertNode)alertNode.style.display=
"block";sm.InitData.WarningTimeoutIntervalIds.push(setTimeout(shake,5E3))},50)}};
D2L.PT.Auth.Logout=function(logoutLocation){var frm=document.createElement("form");frm.target="_top";frm.action=logoutLocation;frm.method="post";var hidden=document.createElement("input");hidden.type="hidden";hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();frm.appendChild(hidden);document.body.appendChild(frm);frm.submit();D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: logging out...");D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired",
"1",false)};D2L.PT.Navbars={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-minibar",function(node){var placeholder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-minibar-placeholder",node);if(placeholder===null)return;var flyouts=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-menuflyout-contents",node);var adjustFlyouts=function(minibarHeight){if(flyouts.length===0)return;var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(window);var maxHeight=Math.max(viewport.height-minibarHeight-10,100);for(var i=0;i<flyouts.length;i++)flyouts[i].style.maxHeight=
maxHeight+"px"};var adjustHeight=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);placeholder.style.height=rect.height+"px";adjustFlyouts(rect.height)};D2L.LP.Web.UI.Events.OnResize.AddListener(adjustHeight);adjustHeight()});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-navbar",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"navigation");var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var editLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-navbar-edit",node);var manageLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-navbar-manage",node);var container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-max-width",
node);if(editLink===null||container===null)return;var show=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(container);editLink.style.top=rect.top+25+"px";manageLink.style.top=rect.top+5+"px";var left;if(isRTL){left=rect.right;if(rect.right-13<rect.width)left=left+-13;editLink.style.left=left+"px";editLink.style.right="auto";manageLink.style.left=left+"px";manageLink.style.right="auto"}else{left=rect.left+-13;if(left<0)left=0;editLink.style.left=left+"px";manageLink.style.left=left+"px"}};
var hide=function(){if(isRTL){editLink.style.right="-10000px";manageLink.style.right="-10000px"}else{editLink.style.left="-10000px";manageLink.style.left="-10000px"}};D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,show);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",editLink,show);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",manageLink,show);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,hide);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",editLink,hide);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",
manageLink,hide)});D2L.PT.ExternalUrls={Web:{Desktop:{HtmlEditor:{},Whitelisting:{},XSPL:{IFrame:{}}}}};
D2L.PT.ExternalUrls.Web.Desktop.HtmlEditor.XSPLScript={Initialize:function(replace){tinymce.create("d2l.tinymce.plugins.XSPLScript",{init:function(ed,url){var me=this;me.editor=ed;ed.onBeforeSetContent.add(function(ed,o){me._convertXSPLIFrameToXSPLImagePlaceholder(o);return});ed.onPostProcess.add(function(ed,o){me._convertXSPLImagePlaceholderToOriginalContent(o);return})},_convertXSPLIFrameToXSPLImagePlaceholder:function(context){var me=this;if(context.content==null||context.content.length==0)return;
var tempContent=context.content;var replace=function(match){var originalContent=me._getOriginalContent(match);var originalContentEncoded=tinymce.html.Entities.encodeAllRaw(originalContent);var img='<img style="'+me._getImageStyle()+'" class="d2l-xspl-image-placehoder" src="'+me.editor.theme.url+'/img/trans.gif"'+' data-d2l-xspl-original-html="'+originalContentEncoded+'"/>';return img};tempContent=tempContent.replace(me._xsplIFrameRegEx(),replace);context.content=tempContent},_xsplIFrameRegEx:function(){return/<iframe[^>]*class=\"d2l-xspl-box\"[^>]*>(.|\n|\r)*?<\/iframe>/gi},
_getImageStyle:function(height,width){return"border:1px solid #333399; background-position:center;"+" height:"+(height||173)+"px;"+"width:"+(width||330)+"px;"+" background-repeat:no-repeat; background-color:#ffffcc;"+" background-image: url(/d2l/img/lp/xspl/html_editor_media.png);"},_getOriginalContent:function(html){var me=this;var tempContent=html;var replace=function(match){var originalContent=match;var originalContentHtmlEncodedMatch=match.match(/ data-original-html=\"([^\"]*)\"/i);if(originalContentHtmlEncodedMatch&&
originalContentHtmlEncodedMatch[1]){var originalContentHtmlEncoded=originalContentHtmlEncodedMatch[1];originalContent=tinymce.html.Entities.decode(originalContentHtmlEncoded);originalContent=me._getOriginalContent(originalContent)}return originalContent};tempContent=tempContent.replace(me._xsplIFrameRegEx(),replace);return tempContent},_convertXSPLImagePlaceholderToOriginalContent:function(context){if(context.content==null||context.content.length==0)return;var tempContent=context.content;var replace=
function(match){var originalContent=match;var originalContentHtmlEncodedMatch=match.match(/ data-d2l-xspl-original-html=\"([^\"]*)\"/i);if(originalContentHtmlEncodedMatch&&originalContentHtmlEncodedMatch[1]){var originalContentHtmlEncoded=originalContentHtmlEncodedMatch[1];originalContent=tinymce.html.Entities.decode(originalContentHtmlEncoded)}return originalContent};tempContent=tempContent.replace(/<img[^>]*class=\"d2l-xspl-image-placehoder\"[^>]*>/gi,replace);context.content=tempContent}});tinymce.PluginManager.add("d2l_xspl",
d2l.tinymce.plugins.XSPLScript);return"-d2l_xspl"}};
D2L.PT.ExternalUrls.Web.Desktop.Whitelisting.ClearGridEdit=function(idString){var grid=$(".d2l-grid-wrapper");var editTargets=grid.find(".d2l-editable-target");var editables=grid.find(".d2l-editable-padding");var edits=grid.find(".d2l-edit");for(i=0;i<editTargets.length;++i){if(editTargets[i].id===idString)continue;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.Finish(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(editTargets[i].id));D2L.LP.Web.UI.Common.Controls.Edit.SetValue(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edits[i].id),editables[i].children[0].textContent)}};
D2L.PT.ExternalUrls.Web.Desktop.Whitelisting.StripLRM=function(id){var input=id.$();var value=input.val();value=value.replace(/\u200E/g,"");input.val(value)};D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml=function(url,xsplNode){var originalHtml=D2L.LP.Web.UI.Html.Dom.GetAttribute(xsplNode,"data-original-html");originalHtml=D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames(url,originalHtml);if(originalHtml)$(xsplNode).replaceWith(originalHtml)};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow=function(xsplNode,url,blockLinkText){var linkContainer=document.createElement("div");var originalXSPLCode;if(xsplNode.outerHTML!==undefined)originalXSPLCode=xsplNode.outerHTML;else originalXSPLCode=$("<div>").append($(xsplNode).clone()).html();var onClickHandler=function(){originalXSPLCode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.AddUnTrustParam(originalXSPLCode);$(linkContainer).prev().replaceWith(originalXSPLCode);$(linkContainer).remove()};var link=D2L.PT.ExternalUrls.Web.Desktop.XSPL.BuildBlockLink(blockLinkText,
onClickHandler);linkContainer.appendChild(link);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(linkContainer,xsplNode);D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml(url,xsplNode);return true};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames=function(url,originalXSPLCode){var tempContent=originalXSPLCode;var replace=function(match){var originalContent=match;var src=match.match(/ src=\"([^\"]*)\"/i);if(src&&src[1]&&decodeURIComponent(src[1]).indexOf(url)>=-1){var encodedOriginalContentMatch=match.match(/ data-original-html=\"([^\"]*)\"/i);if(encodedOriginalContentMatch&&encodedOriginalContentMatch[1]){var originalContentHtmlEncoded=encodedOriginalContentMatch[1];originalContent=
$("<div/>").html(originalContentHtmlEncoded).text();originalContent=D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames(url,originalContent)}}return originalContent};tempContent=tempContent.replace(/<iframe[^>]*class=\"d2l-xspl-box\"[^>]*>(.|\n|\r)*?<\/iframe>/gi,replace);return tempContent};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.BuildBlockLink=function(blockLinkText,onClickHandler){var link=document.createElement("a");link.className="xspl-block-link";if(link.textContent!==undefined)link.textContent=blockLinkText;else if(node.innerText!==undefined)link.innerText=blockLinkText;D2L.LP.Web.UI.Html.Aria.SetRole(link,"button");D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(link);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",link,onClickHandler);return link};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.AddUnTrustParam=function(originalXSPLCode){if(originalXSPLCode.indexOf("/lp/externalUrls/xspl?untrust=1")<0)originalXSPLCode=originalXSPLCode.replace("/lp/externalUrls/xspl?","/lp/externalUrls/xspl?untrust=1&");return originalXSPLCode};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.ReplaceMeWithOriginalHtml=function(url){var parentWindow=window.parent;var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();parentWindow.D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml(url,iframeNode)};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.Allow=function(url,blockLinkText){var parentWindow=window.parent;var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();parentWindow.D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow(iframeNode,url,blockLinkText)};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.ResizeToContent=function(){var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();var height=D2L.LP.Web.UI.Html.Dom.GetPageSize(window).height;iframeNode.style.height=height+"px"};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame=function(){var doc=undefined;try{doc=window.parent.document}catch(e){}if(doc===undefined)return null;var iframes=window.parent.document.getElementsByTagName("iframe");for(var i=0;i<iframes.length;i++)if(iframes[i].contentWindow==window)return iframes[i];return null};if(window["D2L"]!==undefined&&D2L.LP.Web.Packaging!==undefined)D2L.LP.Web.Packaging.Register("D2L.LP.Web.Core.default");